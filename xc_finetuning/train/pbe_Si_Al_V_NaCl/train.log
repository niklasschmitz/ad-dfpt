┌ Info: Threading setup: 
│   Threads.nthreads() = 4
│   n_DFTK = 4
│   n_fft = 1
└   n_blas = 4
Found previous trajectory, loading θ_init from it
θ_init = (κ = 0.6713012612563571, μ = 0.2082576725722106)
┌ Info: 2025-05-20T10:47:20.632
└   θ = ComponentVector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}(κ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.6713012612563571,1.0,0.0), μ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.2082576725722106,0.0,1.0))
┌ Info: 2025-05-20T10:47:21.182
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.454860109877                   -0.96    7.0    8.65s
  2   -8.456686817250       -2.74       -1.74    2.0    3.69s
  3   -8.456743076127       -4.25       -2.83    3.6    925ms
  4   -8.456743856318       -6.11       -3.80    4.2    1.13s
  5   -8.456743866969       -7.97       -4.62    4.6    1.02s
  6   -8.456743867281       -9.51       -5.50    4.6    1.11s
  7   -8.456743867284      -11.55       -6.40    3.8    1.04s
  8   -8.456743867284      -13.35       -7.41    3.7    893ms
Iter     Function value   Gradient norm 
     0    -8.456744e+00     1.936596e-03
 * time: 3.600120544433594e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.454865250098                   -0.96    7.3    1.47s
  2   -8.456686221510       -2.74       -1.74    2.0    642ms
  3   -8.456746643063       -4.22       -2.83    3.9    1.10s
  4   -8.456747477803       -6.08       -3.81    4.4    1.13s
  5   -8.456747487839       -8.00       -4.60    4.7    1.00s
  6   -8.456747488167       -9.48       -5.48    4.7    1.10s
  7   -8.456747488170      -11.46       -6.32    3.9    944ms
  8   -8.456747488170      -13.12       -7.46    3.8    1.04s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.454863405828                   -0.96    7.3    1.50s
  2   -8.456687224460       -2.74       -1.74    2.0    778ms
  3   -8.456746612034       -4.23       -2.83    3.9    935ms
  4   -8.456747477566       -6.06       -3.81    4.6    1.11s
  5   -8.456747487842       -7.99       -4.60    4.7    973ms
  6   -8.456747488167       -9.49       -5.47    5.0    1.11s
  7   -8.456747488170      -11.43       -6.34    3.8    907ms
  8   -8.456747488170      -13.19       -7.49    3.9    1.05s
     1    -8.456747e+00     1.802799e-03
 * time: 28.27258610725403
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.454841260434                   -0.96    7.5    1.48s
  2   -8.456704924471       -2.73       -1.74    2.2    652ms
  3   -8.456770029281       -4.19       -2.83    3.8    1.07s
  4   -8.456770779113       -6.13       -3.83    4.5    1.12s
  5   -8.456770789623       -7.98       -4.56    4.7    1.00s
  6   -8.456770790003       -9.42       -5.37    5.0    1.13s
  7   -8.456770790009      -11.22       -6.27    3.8    882ms
  8   -8.456770790009      -12.98       -7.58    3.9    1.03s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.454859425406                   -0.96    7.5    1.50s
  2   -8.456710010497       -2.73       -1.74    2.2    800ms
  3   -8.456769988831       -4.22       -2.83    3.8    903ms
  4   -8.456770779500       -6.10       -3.81    4.5    1.12s
  5   -8.456770789652       -7.99       -4.58    4.8    1.00s
  6   -8.456770790005       -9.45       -5.42    4.8    1.11s
  7   -8.456770790009      -11.35       -6.27    3.9    899ms
  8   -8.456770790009      -13.00       -7.53    3.8    1.02s
     2    -8.456771e+00     2.439039e-05
 * time: 55.936320066452026
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.454855668274                   -0.96    7.2    1.41s
  2   -8.456708180341       -2.73       -1.74    2.2    633ms
  3   -8.456770027725       -4.21       -2.83    3.8    1.01s
  4   -8.456770781823       -6.12       -3.81    4.5    1.29s
  5   -8.456770793853       -7.92       -4.58    4.6    1.16s
  6   -8.456770794200       -9.46       -5.43    4.9    1.04s
  7   -8.456770794205      -11.34       -6.31    3.9    892ms
  8   -8.456770794205      -13.06       -7.50    3.8    977ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.454856701255                   -0.96    7.4    1.44s
  2   -8.456705544021       -2.73       -1.74    2.2    754ms
  3   -8.456769965841       -4.19       -2.83    3.7    871ms
  4   -8.456770782720       -6.09       -3.82    4.3    1.06s
  5   -8.456770793824       -7.95       -4.56    4.7    956ms
  6   -8.456770794199       -9.43       -5.35    4.7    1.04s
  7   -8.456770794205      -11.20       -6.26    3.7    848ms
  8   -8.456770794205      -12.99       -7.49    3.8    996ms
     3    -8.456771e+00     3.005832e-07
 * time: 82.31805300712585
 * Status: success

 * Candidate solution
    Final objective value:     -8.456771e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.48e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.38e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 4.20e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 4.96e-10 ≰ 0.0e+00
    |g(x)|                 = 3.01e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   82  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.454862133742                   -0.96    7.3    1.51s
  2   -8.456710100023       -2.73       -1.74    2.2    660ms
  3   -8.456769984774       -4.22       -2.83    3.8    1.08s
  4   -8.456770783561       -6.10       -3.81    4.6    1.02s
  5   -8.456770793887       -7.99       -4.61    4.7    1.16s
  6   -8.456770794202       -9.50       -5.49    4.9    1.01s
  7   -8.456770794205      -11.50       -6.36    4.0    934ms
  8   -8.456770794205      -13.22       -7.52    3.8    1.04s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.14e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.50e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.33e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 8.36e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.81e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 7.70e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.65e-09
└ * number of operations = 8
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.454861538412                   -0.96    7.3    1.55s
  2   -8.456710034231       -2.73       -1.74    2.1    675ms
  3   -8.456769989247       -4.22       -2.83    3.8    964ms
  4   -8.456770783716       -6.10       -3.80    4.5    1.19s
  5   -8.456770793895       -7.99       -4.63    4.5   1000ms
  6   -8.456770794203       -9.51       -5.52    4.9    1.05s
  7   -8.456770794205      -11.62       -6.43    3.9    1.11s
  8   -8.456770794205      -13.34       -7.46    4.0    909ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 8.30e-02
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.25e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.59e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.98e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 6.79e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 1.28e-08
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 9.77e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.90e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.91e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 9.17e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.23e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.99e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.30e-09
└ * number of operations = 8
Si: 437.387118 seconds (794.78 M allocations: 275.088 GiB, 6.05% gc time, 43.54% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-20T10:54:38.811
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18808751976                   -1.17    9.2    7.88s
  2   -62.19224411961       -2.38       -1.22    3.9    3.84s
  3   -62.19653446143       -2.37       -2.07    5.8    5.16s
  4   -62.19656408383       -4.53       -2.91    4.6    4.80s
  5   -62.19656460476       -6.28       -3.63    4.3    4.91s
  6   -62.19656462288       -7.74       -4.45    5.4    5.11s
  7   -62.19656462314       -9.59       -5.04    4.6    5.06s
  8   -62.19656462315      -10.78       -6.49    4.1    4.83s
  9   -62.19656462315      -13.30       -7.52    5.3    5.31s
Iter     Function value   Gradient norm 
     0    -6.219656e+01     1.544481e-03
 * time: 4.100799560546875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18808960999                   -1.17    9.0    7.72s
  2   -62.19226447457       -2.38       -1.22    3.6    3.75s
  3   -62.19653651363       -2.37       -2.06    5.5    5.09s
  4   -62.19656639866       -4.52       -2.89    4.4    4.75s
  5   -62.19656696558       -6.25       -3.59    4.1    4.71s
  6   -62.19656698543       -7.70       -4.39    5.2    5.01s
  7   -62.19656698575       -9.49       -5.06    4.1    4.74s
  8   -62.19656698577      -10.80       -6.50    4.3    4.80s
  9   -62.19656698577      -13.55       -7.48    5.2    5.36s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18809354190                   -1.17    8.7    7.73s
  2   -62.19226005448       -2.38       -1.22    3.5    3.81s
  3   -62.19653650741       -2.37       -2.06    5.3    5.00s
  4   -62.19656643554       -4.52       -2.90    4.4    4.65s
  5   -62.19656696636       -6.28       -3.60    4.2    4.89s
  6   -62.19656698546       -7.72       -4.41    5.2    4.90s
  7   -62.19656698575       -9.53       -5.05    4.4    4.89s
  8   -62.19656698577      -10.80       -6.57    4.3    4.81s
  9   -62.19656698577      -13.19       -7.49    5.6    5.37s
     1    -6.219657e+01     1.514945e-03
 * time: 122.44442105293274
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18840049449                   -1.17    9.6    8.04s
  2   -62.19255778991       -2.38       -1.23    4.1    3.93s
  3   -62.19659743903       -2.39       -2.08    5.6    5.11s
  4   -62.19662480832       -4.56       -2.93    4.5    4.66s
  5   -62.19662524889       -6.36       -3.62    4.2    4.73s
  6   -62.19662526667       -7.75       -4.42    5.5    4.96s
  7   -62.19662526694       -9.57       -5.04    4.4    4.97s
  8   -62.19662526696      -10.75       -6.45    4.2    4.82s
  9   -62.19662526696      -13.85       -7.51    5.5    5.39s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18839968133                   -1.17    9.6    8.35s
  2   -62.19256602566       -2.38       -1.23    4.4    4.07s
  3   -62.19659741426       -2.39       -2.08    5.7    5.20s
  4   -62.19662482097       -4.56       -2.93    4.7    4.76s
  5   -62.19662524935       -6.37       -3.63    4.3    4.91s
  6   -62.19662526670       -7.76       -4.43    5.4    5.09s
  7   -62.19662526694       -9.62       -5.05    4.4    4.93s
  8   -62.19662526696      -10.83       -6.61    4.3    4.83s
  9   -62.19662526696      -13.15       -7.52    5.9    5.68s
     2    -6.219663e+01     6.503287e-05
 * time: 247.02189207077026
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18838790166                   -1.17    9.5    8.09s
  2   -62.19254083287       -2.38       -1.23    4.0    3.94s
  3   -62.19659767758       -2.39       -2.08    5.5    5.08s
  4   -62.19662491027       -4.56       -2.93    4.7    4.65s
  5   -62.19662535139       -6.36       -3.64    4.3    4.80s
  6   -62.19662536850       -7.77       -4.45    5.4    4.85s
  7   -62.19662536874       -9.62       -5.02    4.4    4.59s
  8   -62.19662536876      -10.74       -6.46    4.1    4.47s
  9   -62.19662536876      -13.37       -7.51    5.3    5.11s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18838785880                   -1.17    9.3    8.01s
  2   -62.19254258741       -2.38       -1.23    4.0    4.03s
  3   -62.19659764153       -2.39       -2.08    5.6    5.15s
  4   -62.19662493639       -4.56       -2.95    4.6    4.68s
  5   -62.19662535217       -6.38       -3.66    4.5    5.02s
  6   -62.19662536852       -7.79       -4.47    5.6    5.12s
  7   -62.19662536874       -9.65       -5.04    4.6    4.97s
  8   -62.19662536876      -10.80       -6.50    4.0    4.58s
  9   -62.19662536876      -13.45       -7.52    5.4    5.33s
     3    -6.219663e+01     2.558021e-06
 * time: 368.28373098373413
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18839239111                   -1.17    9.6    7.86s
  2   -62.19254985091       -2.38       -1.23    4.0    3.92s
  3   -62.19659749488       -2.39       -2.08    5.7    5.08s
  4   -62.19662489510       -4.56       -2.92    4.6    4.72s
  5   -62.19662535078       -6.34       -3.62    4.2    4.83s
  6   -62.19662536863       -7.75       -4.42    5.5    4.97s
  7   -62.19662536890       -9.58       -5.00    4.4    4.93s
  8   -62.19662536891      -10.72       -6.48    4.1    4.62s
  9   -62.19662536891      -13.85       -7.46    5.4    5.28s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18838862661                   -1.17    9.5    7.82s
  2   -62.19255252216       -2.38       -1.23    4.0    4.05s
  3   -62.19659764649       -2.39       -2.08    5.6    5.09s
  4   -62.19662490928       -4.56       -2.93    4.3    4.63s
  5   -62.19662535152       -6.35       -3.63    4.3    4.93s
  6   -62.19662536865       -7.77       -4.44    5.8    5.23s
  7   -62.19662536890       -9.60       -5.02    4.6    4.99s
  8   -62.19662536891      -10.76       -6.55    3.9    4.65s
  9   -62.19662536891      -13.45       -7.50    5.7    5.69s
     4    -6.219663e+01     9.296574e-09
 * time: 488.2454330921173
 * Status: success

 * Candidate solution
    Final objective value:     -6.219663e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.23e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.16e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.59e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.55e-12 ≰ 0.0e+00
    |g(x)|                 = 9.30e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   488  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18839136618                   -1.17    9.6    11.5s
  2   -62.19255238004       -2.38       -1.23    3.9    4.84s
  3   -62.19659756940       -2.39       -2.08    5.6    6.20s
  4   -62.19662492906       -4.56       -2.94    4.5    5.78s
  5   -62.19662535172       -6.37       -3.64    4.4    4.82s
  6   -62.19662536867       -7.77       -4.45    5.6    5.05s
  7   -62.19662536890       -9.63       -5.04    4.6    4.77s
  8   -62.19662536891      -10.80       -6.49    4.1    4.66s
  9   -62.19662536891      -13.07       -7.52    5.4    6.67s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.08e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.01e+00
[ Info: GMRES linsolve in iteration 1; step 2: normres = 6.01e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.05e-02
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.84e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.79e-05
[ Info: GMRES linsolve in iteration 1; step 6: normres = 6.48e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 2.36e-08
└ * number of operations = 9
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18839038133                   -1.17    9.7    9.34s
  2   -62.19254924562       -2.38       -1.23    3.9    3.84s
  3   -62.19659764412       -2.39       -2.08    5.8    4.83s
  4   -62.19662494128       -4.56       -2.94    4.7    4.67s
  5   -62.19662535215       -6.39       -3.65    4.4    5.88s
  6   -62.19662536868       -7.78       -4.46    5.3    7.15s
  7   -62.19662536890       -9.66       -5.04    4.7    7.08s
  8   -62.19662536891      -10.79       -6.50    4.0    4.96s
  9   -62.19662536891   +  -13.37       -7.51    5.5    7.91s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 7.90e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.80e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.58e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.23e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.07e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 6.34e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 2.71e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 8.20e-09
└ * number of operations = 9
[ Info: GMRES linsolve starts with norm of residual = 2.57e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.54e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 9.91e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.28e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.46e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.58e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 2.64e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 2.10e-08
└ * number of operations = 9
NaCl: 1732.952883 seconds (1.81 G allocations: 1.616 TiB, 5.52% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T11:23:31.765
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316554758795                   -1.46    5.5    1.07s
  2   -2.316640108242       -4.07       -1.84    1.4    457ms
  3   -2.316658972881       -4.72       -3.59    3.2    743ms
  4   -2.316659187898       -6.67       -4.11    4.7    972ms
  5   -2.316659188339       -9.36       -4.43    2.4    616ms
  6   -2.316659188450       -9.95       -5.03    2.7    635ms
  7   -2.316659188454      -11.42       -5.81    2.4    588ms
  8   -2.316659188454      -13.05       -6.46    2.7    669ms
  9   -2.316659188454      -14.35       -7.20    2.4    611ms
Iter     Function value   Gradient norm 
     0    -2.316659e+00     7.505142e-04
 * time: 3.504753112792969e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316561506633                   -1.46    5.3    1.14s
  2   -2.316640845286       -4.10       -1.84    1.3    652ms
  3   -2.316659502323       -4.73       -3.57    3.1    679ms
  4   -2.316659739594       -6.62       -4.07    4.5    993ms
  5   -2.316659740109       -9.29       -4.40    2.4    818ms
  6   -2.316659740237       -9.89       -5.00    2.7    615ms
  7   -2.316659740241      -11.36       -5.79    2.4    569ms
  8   -2.316659740241      -12.98       -6.50    2.9    684ms
  9   -2.316659740241      -14.51       -7.32    2.4    788ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316562474872                   -1.46    5.5    1.12s
  2   -2.316640786654       -4.11       -1.84    1.3    650ms
  3   -2.316659512077       -4.73       -3.58    3.1    679ms
  4   -2.316659739622       -6.64       -4.08    4.6    987ms
  5   -2.316659740109       -9.31       -4.40    2.4    650ms
  6   -2.316659740238       -9.89       -5.02    2.8    787ms
  7   -2.316659740241      -11.43       -5.79    2.4    570ms
  8   -2.316659740241      -12.97       -6.48    2.8    681ms
  9   -2.316659740241      -14.35       -7.20    2.5    824ms
     1    -2.316660e+00     7.199173e-04
 * time: 39.635156869888306
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316565544070                   -1.46    5.5    1.23s
  2   -2.316647656145       -4.09       -1.84    1.3    464ms
  3   -2.316665894722       -4.74       -3.56    3.3    769ms
  4   -2.316666154977       -6.58       -4.04    4.5    1.11s
  5   -2.316666155575       -9.22       -4.36    2.5    595ms
  6   -2.316666155739       -9.79       -4.97    2.8    687ms
  7   -2.316666155744      -11.31       -5.61    2.5    819ms
  8   -2.316666155744      -12.67       -6.49    2.6    599ms
  9   -2.316666155744      -14.12       -7.04    2.9    642ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316568674118                   -1.46    5.5    1.27s
  2   -2.316647373946       -4.10       -1.84    1.3    447ms
  3   -2.316665932895       -4.73       -3.55    3.3    782ms
  4   -2.316666154864       -6.65       -4.01    4.5    1.10s
  5   -2.316666155553       -9.16       -4.33    2.3    568ms
  6   -2.316666155739       -9.73       -4.94    2.8    660ms
  7   -2.316666155744      -11.32       -5.59    2.2    772ms
  8   -2.316666155744      -12.63       -6.48    2.7    602ms
  9   -2.316666155744      -14.15       -7.12    2.8    630ms
     2    -2.316666e+00     8.419216e-06
 * time: 78.54482102394104
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316569131248                   -1.46    5.5    1.14s
  2   -2.316647809220       -4.10       -1.84    1.4    650ms
  3   -2.316665945206       -4.74       -3.55    3.3    698ms
  4   -2.316666155826       -6.68       -4.03    4.6    989ms
  5   -2.316666156455       -9.20       -4.36    2.5    671ms
  6   -2.316666156622       -9.78       -4.96    2.8    788ms
  7   -2.316666156627      -11.29       -5.59    2.5    583ms
  8   -2.316666156627      -12.61       -6.54    2.6    642ms
  9   -2.316666156627      -14.05       -7.11    3.0    896ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316569018572                   -1.46    5.5    1.09s
  2   -2.316647743771       -4.10       -1.84    1.4    631ms
  3   -2.316665930434       -4.74       -3.56    3.3    706ms
  4   -2.316666155894       -6.65       -4.05    4.5    963ms
  5   -2.316666156464       -9.24       -4.37    2.4    658ms
  6   -2.316666156622       -9.80       -4.97    2.7    784ms
  7   -2.316666156627      -11.30       -5.62    2.6    578ms
  8   -2.316666156627      -12.68       -6.46    2.5    620ms
  9   -2.316666156627      -14.10       -7.13    2.8    852ms
     3    -2.316666e+00     2.596064e-08
 * time: 118.0351710319519
 * Status: success

 * Candidate solution
    Final objective value:     -2.316666e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.09e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.74e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 8.83e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.81e-10 ≰ 0.0e+00
    |g(x)|                 = 2.60e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   118  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316568041525                   -1.46    5.5    1.14s
  2   -2.316647967952       -4.10       -1.84    1.3    641ms
  3   -2.316665941295       -4.75       -3.57    3.4    701ms
  4   -2.316666155890       -6.67       -4.05    4.5    956ms
  5   -2.316666156465       -9.24       -4.37    2.5    645ms
  6   -2.316666156622       -9.81       -4.97    2.8    859ms
  7   -2.316666156627      -11.26       -5.61    2.5    598ms
  8   -2.316666156627      -12.65       -6.50    2.6    620ms
  9   -2.316666156627      -14.18       -7.08    2.8    687ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 6.02e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.74e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.35e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.81e-06
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 3.53e-08
└ * number of operations = 6
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316570900711                   -1.46    5.5    1.05s
  2   -2.316648383009       -4.11       -1.84    1.4    424ms
  3   -2.316665944231       -4.76       -3.57    3.2    876ms
  4   -2.316666155895       -6.67       -4.05    4.6    922ms
  5   -2.316666156467       -9.24       -4.37    2.5    863ms
  6   -2.316666156622       -9.81       -4.97    2.8    859ms
  7   -2.316666156627      -11.26       -5.61    2.5    967ms
  8   -2.316666156627      -12.64       -6.38    2.6    852ms
  9   -2.316666156627      -13.94       -7.04    2.7    886ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 3.15e-03
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.70e-05
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.75e-06
┌ Info: GMRES linsolve converged at iteration 1, step 3:
│ * norm of residual = 7.48e-08
└ * number of operations = 5
[ Info: GMRES linsolve starts with norm of residual = 2.42e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.60e-03
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.11e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 9.04e-07
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 1.05e-08
└ * number of operations = 6
Al: 265.228014 seconds (263.37 M allocations: 112.819 GiB, 7.02% gc time, 0.03% compilation time)
┌ Info: 2025-05-20T11:27:56.993
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.75983840235                   -0.87    9.7    5.60s
  2   -73.77107555972       -1.95       -1.07    5.4    3.08s
  3   -73.77748795629       -2.19       -1.41    6.6    4.00s
  4   -73.77854411894       -2.98       -1.77    5.8    3.25s
  5   -73.77870068590       -3.81       -2.24    4.9    2.98s
  6   -73.77872131110       -4.69       -3.08    5.5    3.39s
  7   -73.77872132954       -7.73       -3.51    4.8    3.12s
  8   -73.77872133423       -8.33       -4.08    4.7    3.02s
  9   -73.77872133396   +   -9.58       -4.44    5.4    3.36s
 10   -73.77872133449       -9.28       -4.77    5.5    3.26s
 11   -73.77872133451      -10.68       -5.60    4.3    2.83s
 12   -73.77872133451      -12.37       -6.40    4.8    3.21s
 13   -73.77872133451   +  -13.37       -6.57    3.7    2.65s
 14   -73.77872133451   +  -13.55       -6.96    4.9    3.05s
 15   -73.77872133451   +  -13.15       -7.69    5.2    3.25s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.377872e+01     8.522567e-03
 * time: 4.100799560546875e-5
┌ Warning: Negative ρcore detected: -3.3890991677160605e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76007449432                   -0.87    9.7    5.80s
  2   -73.77118036459       -1.95       -1.07    5.3    3.06s
  3   -73.77756362258       -2.19       -1.41    6.8    3.92s
  4   -73.77861070786       -2.98       -1.77    5.8    3.32s
  5   -73.77876754439       -3.80       -2.23    5.0    3.08s
  6   -73.77878850103       -4.68       -3.07    5.6    3.52s
  7   -73.77878851906       -7.74       -3.51    5.0    3.11s
  8   -73.77878852363       -8.34       -4.08    4.4    2.83s
  9   -73.77878852338   +   -9.59       -4.41    5.5    3.28s
 10   -73.77878852395       -9.24       -4.77    5.5    3.13s
 11   -73.77878852397      -10.67       -5.56    4.4    2.80s
 12   -73.77878852397      -11.66       -6.37    4.7    2.99s
 13   -73.77878852397      -13.55       -6.60    4.7    3.07s
 14   -73.77878852397      -13.07       -6.95    5.0    3.06s
 15   -73.77878852397   +  -13.85       -7.73    5.2    3.20s
┌ Warning: Negative ρcore detected: -3.3890991677160605e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76008647815                   -0.87    9.7    5.60s
  2   -73.77116586105       -1.96       -1.07    5.3    3.00s
  3   -73.77756538748       -2.19       -1.41    6.8    4.00s
  4   -73.77861057954       -2.98       -1.77    5.8    3.39s
  5   -73.77876744396       -3.80       -2.23    4.9    3.06s
  6   -73.77878850022       -4.68       -3.07    5.6    3.44s
  7   -73.77878851910       -7.72       -3.51    5.0    3.20s
  8   -73.77878852367       -8.34       -4.10    4.6    2.95s
  9   -73.77878852339   +   -9.55       -4.42    5.5    3.45s
 10   -73.77878852395       -9.25       -4.78    5.5    3.24s
 11   -73.77878852397      -10.66       -5.57    4.5    2.94s
 12   -73.77878852397      -11.64       -6.37    4.6    3.04s
 13   -73.77878852397   +    -Inf       -6.61    4.7    3.07s
 14   -73.77878852397      -13.25       -6.96    5.1    3.08s
 15   -73.77878852397   +    -Inf       -7.75    5.2    3.22s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.3890991677160605e-8,-4.9185609416503596e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     1    -7.377879e+01     7.242746e-03
 * time: 155.18597507476807
┌ Warning: Negative ρcore detected: -3.118453373182819e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76127864254                   -0.87    9.8    5.76s
  2   -73.77167439480       -1.98       -1.07    5.2    3.05s
  3   -73.77775540921       -2.22       -1.42    6.7    3.98s
  4   -73.77880274077       -2.98       -1.79    5.7    3.18s
  5   -73.77894003258       -3.86       -2.28    5.0    2.93s
  6   -73.77895733424       -4.76       -3.09    5.5    3.37s
  7   -73.77895737030       -7.44       -3.57    4.4    2.91s
  8   -73.77895737909       -8.06       -4.04    5.2    3.05s
  9   -73.77895737848   +   -9.22       -4.49    5.5    3.24s
 10   -73.77895737936       -9.05       -4.79    5.6    2.98s
 11   -73.77895737941      -10.33       -5.47    5.0    2.95s
 12   -73.77895737941      -11.48       -6.22    4.7    3.05s
 13   -73.77895737941      -12.94       -6.37    4.4    2.93s
 14   -73.77895737941   +  -13.85       -6.94    5.1    3.06s
 15   -73.77895737941   +  -12.85       -7.81    5.0    3.20s
┌ Warning: Negative ρcore detected: -3.118453373182819e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76128040934                   -0.87    9.7    5.77s
  2   -73.77168481294       -1.98       -1.08    5.3    3.03s
  3   -73.77775401292       -2.22       -1.42    6.7    3.94s
  4   -73.77880277573       -2.98       -1.79    5.7    3.17s
  5   -73.77894000346       -3.86       -2.28    4.9    2.81s
  6   -73.77895733201       -4.76       -3.09    5.6    3.29s
  7   -73.77895737070       -7.41       -3.56    4.5    2.96s
  8   -73.77895737909       -8.08       -4.04    5.1    3.13s
  9   -73.77895737851   +   -9.23       -4.49    5.4    3.24s
 10   -73.77895737937       -9.07       -4.79    5.6    3.32s
 11   -73.77895737941      -10.37       -5.47    4.9    3.06s
 12   -73.77895737941      -11.51       -6.23    4.7    3.06s
 13   -73.77895737941      -13.15       -6.38    3.9    2.73s
 14   -73.77895737941   +  -12.81       -6.95    5.2    3.08s
 15   -73.77895737941   +  -13.85       -7.82    5.1    3.18s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.118453373182819e-8,-4.764552454054577e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     2    -7.377896e+01     3.343225e-04
 * time: 308.62156105041504
┌ Warning: Negative ρcore detected: -3.1275945004869117e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76123841633                   -0.87    9.6    5.57s
  2   -73.77166133996       -1.98       -1.07    5.2    3.05s
  3   -73.77775408278       -2.22       -1.42    6.8    4.07s
  4   -73.77880187652       -2.98       -1.79    5.8    3.35s
  5   -73.77894000140       -3.86       -2.28    5.0    3.11s
  6   -73.77895767985       -4.75       -3.09    5.5    3.40s
  7   -73.77895771350       -7.47       -3.57    4.3    2.85s
  8   -73.77895772221       -8.06       -4.04    5.1    3.12s
  9   -73.77895772158   +   -9.20       -4.49    5.4    3.25s
 10   -73.77895772248       -9.04       -4.80    5.6    3.20s
 11   -73.77895772252      -10.35       -5.49    5.0    3.02s
 12   -73.77895772253      -11.49       -6.22    4.7    2.97s
 13   -73.77895772253      -12.94       -6.35    4.4    2.92s
 14   -73.77895772253   +  -12.85       -6.94    5.1    3.06s
 15   -73.77895772253      -13.07       -7.82    5.0    3.19s
┌ Warning: Negative ρcore detected: -3.1275945004869117e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76123798677                   -0.87    9.7    5.72s
  2   -73.77165631634       -1.98       -1.07    5.2    2.89s
  3   -73.77775462278       -2.21       -1.42    6.7    3.97s
  4   -73.77880193178       -2.98       -1.79    5.8    3.32s
  5   -73.77893975866       -3.86       -2.27    5.0    3.06s
  6   -73.77895767883       -4.75       -3.09    5.6    3.43s
  7   -73.77895771383       -7.46       -3.56    4.4    2.96s
  8   -73.77895772221       -8.08       -4.04    5.2    3.13s
  9   -73.77895772166   +   -9.26       -4.50    5.4    3.25s
 10   -73.77895772248       -9.08       -4.79    5.6    3.26s
 11   -73.77895772252      -10.36       -5.47    4.9    3.01s
 12   -73.77895772253      -11.45       -6.21    4.8    3.00s
 13   -73.77895772253      -13.00       -6.36    4.4    2.88s
 14   -73.77895772253   +  -13.15       -6.93    5.2    3.47s
 15   -73.77895772253      -13.15       -7.77    5.0    3.18s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1275945004869117e-8,-3.828841152639614e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     3    -7.377896e+01     1.152749e-05
 * time: 462.7937550544739
┌ Warning: Negative ρcore detected: -3.127321811676573e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76123895298                   -0.87    9.7    5.88s
  2   -73.77166871464       -1.98       -1.07    5.3    3.05s
  3   -73.77775367266       -2.22       -1.41    6.8    3.97s
  4   -73.77880153142       -2.98       -1.79    5.8    3.31s
  5   -73.77893985275       -3.86       -2.27    5.1    3.13s
  6   -73.77895767738       -4.75       -3.09    5.5    3.41s
  7   -73.77895771356       -7.44       -3.56    4.4    3.00s
  8   -73.77895772260       -8.04       -4.03    5.2    3.17s
  9   -73.77895772205   +   -9.26       -4.49    5.5    3.35s
 10   -73.77895772290       -9.07       -4.79    5.6    3.51s
 11   -73.77895772294      -10.38       -5.47    4.9    3.46s
 12   -73.77895772294      -11.43       -6.21    4.7    4.17s
 13   -73.77895772294   +    -Inf       -6.36    4.4    2.99s
 14   -73.77895772294      -13.85       -6.93    5.1    3.00s
 15   -73.77895772294   +  -13.07       -7.81    5.0    3.09s
┌ Warning: Negative ρcore detected: -3.127321811676573e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76124368595                   -0.87    9.7    5.73s
  2   -73.77165825278       -1.98       -1.07    5.3    3.07s
  3   -73.77775410151       -2.21       -1.41    6.8    4.43s
  4   -73.77880158737       -2.98       -1.79    5.8    4.05s
  5   -73.77894001559       -3.86       -2.27    5.0    3.39s
  6   -73.77895768074       -4.75       -3.09    5.5    3.60s
  7   -73.77895771435       -7.47       -3.56    4.4    2.95s
  8   -73.77895772261       -8.08       -4.04    5.1    2.87s
  9   -73.77895772204   +   -9.25       -4.49    5.5    3.20s
 10   -73.77895772290       -9.07       -4.78    5.7    3.33s
 11   -73.77895772294      -10.37       -5.46    4.9    3.03s
 12   -73.77895772294      -11.40       -6.23    4.8    3.07s
 13   -73.77895772294      -13.25       -6.37    4.3    2.90s
 14   -73.77895772294   +  -13.25       -6.93    5.2    3.11s
 15   -73.77895772294   +  -13.25       -7.80    5.1    3.24s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.127321811676573e-8,-3.859790373030236e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     4    -7.377896e+01     1.768219e-08
 * time: 620.9102330207825
 * Status: success

 * Candidate solution
    Final objective value:     -7.377896e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 7.09e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.26e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 4.17e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 5.65e-12 ≰ 0.0e+00
    |g(x)|                 = 1.77e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   621  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

Computing hessian ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.127321811676573e-8,-3.859790373030236e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.127321811676573e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76123958098                   -0.87    9.8    5.64s
  2   -73.77166535020       -1.98       -1.07    5.2    3.00s
  3   -73.77775231821       -2.22       -1.41    6.8    3.90s
  4   -73.77880240610       -2.98       -1.79    5.8    3.31s
  5   -73.77894005115       -3.86       -2.28    5.0    2.94s
  6   -73.77895767845       -4.75       -3.09    5.5    3.41s
  7   -73.77895771394       -7.45       -3.56    4.4    2.91s
  8   -73.77895772260       -8.06       -4.03    5.2    3.13s
  9   -73.77895772201   +   -9.23       -4.48    5.5    3.18s
 10   -73.77895772290       -9.05       -4.78    5.7    3.42s
 11   -73.77895772294      -10.38       -5.46    4.8    3.06s
 12   -73.77895772294      -11.43       -6.22    4.8    3.05s
 13   -73.77895772294      -13.15       -6.36    4.5    2.73s
 14   -73.77895772294   +  -13.37       -6.93    5.1    2.94s
 15   -73.77895772294      -13.15       -7.82    5.1    3.04s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.37e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.01e+01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.23e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.08e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 5.92e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 6.57e-07
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.60e-08
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 1.15e-08
└ * number of operations = 9
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}(Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.127321815329937e-8,-3.859790375302922e-8),Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.8597903772054555e-8,4.364448514534133e-6))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Computing cross-derivative ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.127321811676573e-8,0.0,0.0)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.127321811676573e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76124050066                   -0.87    9.8    5.58s
  2   -73.77165602200       -1.98       -1.07    5.2    3.24s
  3   -73.77775375064       -2.21       -1.42    6.8    3.88s
  4   -73.77880206843       -2.98       -1.79    5.9    3.04s
  5   -73.77893968705       -3.86       -2.27    4.9    3.20s
  6   -73.77895768088       -4.74       -3.09    5.5    3.39s
  7   -73.77895771372       -7.48       -3.56    4.4    2.81s
  8   -73.77895772259       -8.05       -4.04    5.2    3.14s
  9   -73.77895772204   +   -9.26       -4.49    5.5    3.45s
 10   -73.77895772289       -9.07       -4.78    5.5    3.19s
 11   -73.77895772294      -10.35       -5.46    5.0    3.15s
 12   -73.77895772294      -11.39       -6.21    4.8    3.13s
 13   -73.77895772294      -13.55       -6.37    4.5    2.83s
 14   -73.77895772294   +  -13.15       -6.93    5.2    3.16s
 15   -73.77895772294   +  -13.25       -7.79    5.0    3.25s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.29e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 9.43e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.76e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.42e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 7.87e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 8.52e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.13e-09
└ * number of operations = 8
[ Info: GMRES linsolve starts with norm of residual = 4.68e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.61e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.73e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.03e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 7.05e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.63e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 2.00e-09
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}, KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.127321815329937e-8,0.0,0.0),Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.8597903703270675e-8,0.0,0.0))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
V: 1422.365465 seconds (1.20 G allocations: 1.218 TiB, 8.32% gc time, 0.01% compilation time)
Iter     Function value   Gradient norm 
     0     1.061944e-04     3.796457e-04
 * Current step size: 1.0
 * time: 2.6941299438476562e-5
 * g(x): (κ = 0.00037964566791473265, μ = 0.00037874884126980625)
 * ~inv(H): [1.0 0.0; 0.0 1.0]
 * x: (κ = 0.6713012612563571, μ = 0.2082576725722106)
┌ Info: 2025-05-20T11:51:40.138
└   θ = ComponentVector{Float64}(κ = 0.6709216155884424, μ = 0.20787892373094077)
┌ Info: 2025-05-20T11:51:40.176
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.319564068916891)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.454717688038                   -0.96    7.3    1.54s
  2   -8.456562287548       -2.73       -1.74    2.1    660ms
  3   -8.456619259938       -4.24       -2.83    3.8    1.17s
  4   -8.456619964580       -6.15       -3.81    4.3    944ms
  5   -8.456619974720       -7.99       -4.61    4.7    1.04s
  6   -8.456619975043       -9.49       -5.49    4.9    1.17s
  7   -8.456619975047      -11.49       -6.36    4.0    952ms
  8   -8.456619975047      -13.15       -7.47    3.8    943ms
Iter     Function value   Gradient norm 
     0    -8.456620e+00     2.103516e-05
 * time: 3.218650817871094e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.454706658552                   -0.96    7.4    1.55s
  2   -8.456554325140       -2.73       -1.74    2.2    615ms
  3   -8.456619183391       -4.19       -2.83    3.8    889ms
  4   -8.456619963943       -6.11       -3.81    4.4    1.11s
  5   -8.456619975107       -7.95       -4.57    4.6    976ms
  6   -8.456619975467       -9.44       -5.37    4.9    995ms
  7   -8.456619975473      -11.22       -6.25    3.9    1.06s
  8   -8.456619975473      -12.92       -7.51    3.8    930ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.454710706840                   -0.96    7.3    1.32s
  2   -8.456558452139       -2.73       -1.74    2.2    858ms
  3   -8.456619083148       -4.22       -2.83    3.7    886ms
  4   -8.456619963739       -6.06       -3.78    4.5    1.02s
  5   -8.456619975174       -7.94       -4.64    4.7    1.16s
  6   -8.456619975471       -9.53       -5.52    4.8    984ms
  7   -8.456619975473      -11.64       -6.41    3.8    948ms
  8   -8.456619975473      -13.30       -7.41    4.0    1.12s
     1    -8.456620e+00     1.954371e-05
 * time: 26.637046098709106
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.454710308475                   -0.96    7.5    1.53s
  2   -8.456555694374       -2.73       -1.74    2.3    671ms
  3   -8.456619185065       -4.20       -2.83    3.8    1.14s
  4   -8.456619966866       -6.11       -3.82    4.5    976ms
  5   -8.456619977803       -7.96       -4.57    4.8    1.13s
  6   -8.456619978163       -9.44       -5.39    5.0    1.30s
  7   -8.456619978168      -11.30       -6.27    3.9    1.24s
  8   -8.456619978168      -13.00       -7.51    3.9    1.11s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.454701816274                   -0.96    7.5    1.49s
  2   -8.456558758018       -2.73       -1.74    2.1    640ms
  3   -8.456619305487       -4.22       -2.83    3.8    1.14s
  4   -8.456619967091       -6.18       -3.82    4.4    912ms
  5   -8.456619977822       -7.97       -4.59    4.8    1.02s
  6   -8.456619978163       -9.47       -5.43    4.9    1.22s
  7   -8.456619978168      -11.36       -6.28    3.9    911ms
  8   -8.456619978168      -13.01       -7.54    3.8    950ms
     2    -8.456620e+00     7.033998e-09
 * time: 54.52338910102844
 * Status: success

 * Candidate solution
    Final objective value:     -8.456620e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.76e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.67e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.69e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.19e-10 ≰ 0.0e+00
    |g(x)|                 = 7.03e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   55  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Si: 70.730170 seconds (141.06 M allocations: 41.107 GiB, 11.67% gc time, 0.03% compilation time)
┌ Info: 2025-05-20T11:52:50.909
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.668505008617494)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18744807362                   -1.17    9.6    7.93s
  2   -62.19159732733       -2.38       -1.23    3.8    3.96s
  3   -62.19565175235       -2.39       -2.08    5.5    5.69s
  4   -62.19567901120       -4.56       -2.95    4.6    4.63s
  5   -62.19567942152       -6.39       -3.66    4.5    4.89s
  6   -62.19567943775       -7.79       -4.49    5.7    5.00s
  7   -62.19567943796       -9.69       -5.03    4.6    4.94s
  8   -62.19567943797      -10.77       -6.43    3.8    4.49s
  9   -62.19567943797      -13.15       -7.48    5.2    5.27s
Iter     Function value   Gradient norm 
     0    -6.219568e+01     1.185669e-05
 * time: 4.601478576660156e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18745393338                   -1.17    9.6    8.03s
  2   -62.19161102314       -2.38       -1.23    4.0    3.75s
  3   -62.19565161489       -2.39       -2.08    5.5    4.83s
  4   -62.19567898326       -4.56       -2.93    4.7    4.48s
  5   -62.19567942069       -6.36       -3.64    4.2    4.39s
  6   -62.19567943786       -7.77       -4.45    5.7    4.99s
  7   -62.19567943810       -9.62       -5.05    4.7    4.96s
  8   -62.19567943811      -10.83       -6.43    4.2    4.75s
  9   -62.19567943811      -13.85       -7.47    5.3    5.27s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18745005695                   -1.17    9.8    7.98s
  2   -62.19160507551       -2.38       -1.23    3.9    3.87s
  3   -62.19565171808       -2.39       -2.08    5.7    5.12s
  4   -62.19567900411       -4.56       -2.94    4.5    4.63s
  5   -62.19567942123       -6.38       -3.65    4.4    4.82s
  6   -62.19567943786       -7.78       -4.46    5.5    4.98s
  7   -62.19567943810       -9.62       -5.03    4.7    4.93s
  8   -62.19567943811      -10.75       -6.46    4.1    4.58s
  9   -62.19567943811      -13.67       -7.52    5.4    6.88s
     1    -6.219568e+01     1.161410e-05
 * time: 122.3516800403595
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18745338373                   -1.17    9.4    7.85s
  2   -62.19160863819       -2.38       -1.23    3.8    4.04s
  3   -62.19565183084       -2.39       -2.08    5.8    5.01s
  4   -62.19567897488       -4.57       -2.93    4.4    4.70s
  5   -62.19567942415       -6.35       -3.64    4.4    4.88s
  6   -62.19567944112       -7.77       -4.47    5.5    5.06s
  7   -62.19567944136       -9.62       -5.08    4.7    4.98s
  8   -62.19567944137      -10.81       -6.44    4.1    4.73s
  9   -62.19567944137      -13.25       -7.54    5.1    5.42s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18745768651                   -1.17    9.4    7.79s
  2   -62.19161384854       -2.38       -1.23    3.6    3.72s
  3   -62.19565184570       -2.39       -2.08    5.6    5.01s
  4   -62.19567899400       -4.57       -2.94    4.6    4.66s
  5   -62.19567942446       -6.37       -3.64    4.3    4.76s
  6   -62.19567944114       -7.78       -4.47    5.5    5.05s
  7   -62.19567944136       -9.66       -5.06    4.5    4.85s
  8   -62.19567944137      -10.83       -6.40    4.2    4.69s
  9   -62.19567944137      -13.85       -7.51    5.1    5.23s
     2    -6.219568e+01     1.366092e-07
 * time: 241.71858406066895
 * Status: success

 * Candidate solution
    Final objective value:     -6.219568e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 5.68e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 5.32e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 3.26e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 5.24e-11 ≰ 0.0e+00
    |g(x)|                 = 1.37e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   242  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

NaCl: 309.594305 seconds (543.00 M allocations: 188.069 GiB, 7.69% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T11:58:00.504
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.623307134426657)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316546360401                   -1.46    5.5    1.29s
  2   -2.316625802512       -4.10       -1.84    1.4    570ms
  3   -2.316644357873       -4.73       -3.55    3.3    795ms
  4   -2.316644595897       -6.62       -4.03    4.5    1.12s
  5   -2.316644596517       -9.21       -4.37    2.5    575ms
  6   -2.316644596681       -9.79       -4.97    2.8    657ms
  7   -2.316644596686      -11.29       -5.60    2.5    855ms
  8   -2.316644596686      -12.66       -6.46    2.6    720ms
  9   -2.316644596686      -14.01       -7.12    2.9    648ms
Iter     Function value   Gradient norm 
     0    -2.316645e+00     1.199358e-05
 * time: 3.0994415283203125e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316549973996                   -1.46    5.5    1.15s
  2   -2.316626471583       -4.12       -1.84    1.3    666ms
  3   -2.316644364274       -4.75       -3.55    3.3    682ms
  4   -2.316644595979       -6.64       -4.02    4.6    1.12s
  5   -2.316644596641       -9.18       -4.34    2.4    852ms
  6   -2.316644596821       -9.75       -4.95    2.9    961ms
  7   -2.316644596827      -11.25       -5.59    2.4    761ms
  8   -2.316644596827      -12.61       -6.47    2.7    670ms
  9   -2.316644596827      -14.03       -7.12    3.0    1.01s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316551338044                   -1.46    5.5    1.12s
  2   -2.316626390068       -4.12       -1.84    1.3    712ms
  3   -2.316644336787       -4.75       -3.55    3.3    703ms
  4   -2.316644596063       -6.59       -4.04    4.5    973ms
  5   -2.316644596666       -9.22       -4.37    2.5    825ms
  6   -2.316644596822       -9.81       -4.97    2.8    734ms
  7   -2.316644596827      -11.30       -5.61    2.5    664ms
  8   -2.316644596827      -12.70       -6.46    2.6    647ms
  9   -2.316644596827      -14.03       -7.10    2.8    832ms
     1    -2.316645e+00     1.151214e-05
 * time: 40.437750816345215
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316549522426                   -1.46    5.6    1.32s
  2   -2.316626378686       -4.11       -1.84    1.4    581ms
  3   -2.316644366406       -4.75       -3.57    3.2    813ms
  4   -2.316644597701       -6.64       -4.04    4.6    1.07s
  5   -2.316644598306       -9.22       -4.36    2.5    750ms
  6   -2.316644598472       -9.78       -4.96    2.9    693ms
  7   -2.316644598477      -11.28       -5.60    2.5    981ms
  8   -2.316644598478      -12.62       -6.50    2.5    708ms
  9   -2.316644598478      -14.07       -7.09    2.9    673ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316549907288                   -1.46    5.7    1.08s
  2   -2.316626414826       -4.12       -1.84    1.4    466ms
  3   -2.316644384572       -4.75       -3.56    3.4    916ms
  4   -2.316644597690       -6.67       -4.04    4.5    997ms
  5   -2.316644598307       -9.21       -4.36    2.4    836ms
  6   -2.316644598473       -9.78       -4.97    2.8    994ms
  7   -2.316644598477      -11.32       -5.60    2.5    688ms
  8   -2.316644598478      -12.59       -6.50    2.7    640ms
  9   -2.316644598478      -14.21       -7.10    2.9    678ms
     2    -2.316645e+00     8.166452e-09
 * time: 81.47318196296692
 * Status: success

 * Candidate solution
    Final objective value:     -2.316645e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.87e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.76e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.65e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 7.12e-10 ≰ 0.0e+00
    |g(x)|                 = 8.17e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   81  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Al: 106.521751 seconds (99.85 M allocations: 27.920 GiB, 6.69% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T11:59:47.027
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.6445713647272155)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.127321811676573e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76052291421                   -0.87    9.7    6.20s
  2   -73.77096929655       -1.98       -1.07    5.2    3.07s
  3   -73.77706478162       -2.21       -1.41    6.8    4.03s
  4   -73.77811568325       -2.98       -1.79    5.8    3.34s
  5   -73.77825425676       -3.86       -2.28    5.0    3.05s
  6   -73.77827172171       -4.76       -3.09    5.5    3.41s
  7   -73.77827175617       -7.46       -3.57    4.4    2.94s
  8   -73.77827176395       -8.11       -4.04    5.1    3.10s
  9   -73.77827176329   +   -9.19       -4.48    5.5    3.31s
 10   -73.77827176420       -9.04       -4.78    5.6    3.30s
 11   -73.77827176424      -10.39       -5.46    4.9    3.04s
 12   -73.77827176425      -11.42       -6.25    4.7    3.06s
 13   -73.77827176425      -13.00       -6.39    3.9    2.78s
 14   -73.77827176425   +    -Inf       -6.95    5.2    3.13s
 15   -73.77827176425   +  -13.07       -7.84    5.1    3.18s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.127321811676573e-8,-3.859790373030236e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.377827e+01     4.276647e-05
 * time: 4.100799560546875e-5
┌ Warning: Negative ρcore detected: -3.127156325707808e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76052382239                   -0.87    9.8    5.35s
  2   -73.77096998251       -1.98       -1.07    5.2    2.84s
  3   -73.77706560708       -2.21       -1.41    6.8    3.91s
  4   -73.77811533074       -2.98       -1.79    5.8    3.38s
  5   -73.77825398762       -3.86       -2.27    5.0    3.12s
  6   -73.77827171986       -4.75       -3.09    5.6    3.49s
  7   -73.77827175783       -7.42       -3.56    4.6    3.07s
  8   -73.77827176563       -8.11       -4.03    5.1    3.19s
  9   -73.77827176504   +   -9.23       -4.49    5.4    3.36s
 10   -73.77827176588       -9.07       -4.79    5.6    3.41s
 11   -73.77827176593      -10.35       -5.49    5.0    3.21s
 12   -73.77827176593      -11.51       -6.23    4.7    3.13s
 13   -73.77827176593      -13.15       -6.37    4.2    2.93s
 14   -73.77827176593   +  -13.37       -6.95    5.2    3.16s
 15   -73.77827176593   +  -13.85       -7.83    5.1    3.30s
┌ Warning: Negative ρcore detected: -3.127156325707808e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76052559541                   -0.87    9.8    5.90s
  2   -73.77097649922       -1.98       -1.07    5.3    4.04s
  3   -73.77706452911       -2.22       -1.41    6.8    4.08s
  4   -73.77811539543       -2.98       -1.79    5.8    3.24s
  5   -73.77825393876       -3.86       -2.27    5.0    2.95s
  6   -73.77827171856       -4.75       -3.09    5.6    3.41s
  7   -73.77827175838       -7.40       -3.56    4.6    3.16s
  8   -73.77827176564       -8.14       -4.03    5.2    4.38s
  9   -73.77827176505   +   -9.23       -4.49    5.4    4.65s
 10   -73.77827176589       -9.08       -4.79    5.7    3.42s
 11   -73.77827176593      -10.39       -5.47    4.9    3.08s
 12   -73.77827176593      -11.50       -6.24    4.7    3.09s
 13   -73.77827176593      -13.07       -6.38    4.1    3.47s
 14   -73.77827176593      -13.55       -6.95    5.2    4.34s
 15   -73.77827176593   +  -13.25       -7.82    5.1    3.82s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.127156325707808e-8,-3.878458579378088e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     1    -7.377827e+01     3.582477e-05
 * time: 161.68417596817017
┌ Warning: Negative ρcore detected: -3.1262896781583625e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76053225468                   -0.87   10.0    6.10s
  2   -73.77096683567       -1.98       -1.07    5.4    3.19s
  3   -73.77706548541       -2.21       -1.41    6.9    4.19s
  4   -73.77811576751       -2.98       -1.79    5.9    3.41s
  5   -73.77825416630       -3.86       -2.28    5.0    3.12s
  6   -73.77827172820       -4.76       -3.09    5.6    3.53s
  7   -73.77827176089       -7.49       -3.57    4.4    2.92s
  8   -73.77827176957       -8.06       -4.04    5.3    3.06s
  9   -73.77827176893   +   -9.19       -4.48    5.6    3.48s
 10   -73.77827176986       -9.03       -4.78    5.7    4.30s
 11   -73.77827176990      -10.39       -5.46    5.1    3.17s
 12   -73.77827176991      -11.40       -6.22    4.8    4.00s
 13   -73.77827176991      -13.00       -6.37    4.4    3.27s
 14   -73.77827176991   +  -13.25       -6.93    5.3    4.35s
 15   -73.77827176991   +  -13.37       -7.79    5.1    3.54s
┌ Warning: Negative ρcore detected: -3.1262896781583625e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76051421232                   -0.87   10.0    5.98s
  2   -73.77097320057       -1.98       -1.07    5.4    3.14s
  3   -73.77706665598       -2.22       -1.41    6.9    4.12s
  4   -73.77811580547       -2.98       -1.79    5.9    3.54s
  5   -73.77825405013       -3.86       -2.28    5.1    3.07s
  6   -73.77827172601       -4.75       -3.09    5.6    3.40s
  7   -73.77827176191       -7.44       -3.57    4.5    2.94s
  8   -73.77827176963       -8.11       -4.04    5.2    2.97s
  9   -73.77827176896   +   -9.17       -4.48    5.5    3.24s
 10   -73.77827176986       -9.05       -4.80    5.7    3.37s
 11   -73.77827176991      -10.37       -5.49    5.0    3.12s
 12   -73.77827176991      -11.52       -6.24    4.7    3.06s
 13   -73.77827176991      -13.37       -6.38    3.9    2.74s
 14   -73.77827176991   +  -13.15       -6.97    5.2    3.10s
 15   -73.77827176991      -13.55       -7.83    5.0    3.20s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1262896781583625e-8,-3.974896792477832e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     2    -7.377827e+01     2.321450e-09
 * time: 321.36276602745056
 * Status: success

 * Candidate solution
    Final objective value:     -7.377827e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.21e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.91e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 3.98e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 5.39e-11 ≰ 0.0e+00
    |g(x)|                 = 2.32e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   321  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

V: 410.289078 seconds (359.51 M allocations: 208.840 GiB, 9.16% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T12:06:37.485
└   θ = ComponentVector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}(κ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.6709216155884424,1.0,0.0), μ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.20787892373094077,0.0,1.0))
┌ Info: 2025-05-20T12:06:37.491
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.319267392376007)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.454705222232                   -0.96    7.4    1.36s
  2   -8.456556091986       -2.73       -1.74    2.1    845ms
  3   -8.456619155775       -4.20       -2.83    3.8    898ms
  4   -8.456619966512       -6.09       -3.82    4.5    1.04s
  5   -8.456619977821       -7.95       -4.58    4.8    1.19s
  6   -8.456619978162       -9.47       -5.39    5.0    982ms
  7   -8.456619978168      -11.28       -6.26    3.9    978ms
  8   -8.456619978168      -13.00       -7.51    3.8    1.06s
Iter     Function value   Gradient norm 
     0    -8.456620e+00     7.608187e-09
 * time: 3.910064697265625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.456620e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 7.61e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.454699711427                   -0.96    7.5    1.53s
  2   -8.456556938417       -2.73       -1.74    2.1    677ms
  3   -8.456619150203       -4.21       -2.83    3.8    974ms
  4   -8.456619967788       -6.09       -3.80    4.5    1.16s
  5   -8.456619977837       -8.00       -4.60    4.8    978ms
  6   -8.456619978164       -9.48       -5.46    5.0    1.05s
  7   -8.456619978168      -11.44       -6.34    3.8    1.09s
  8   -8.456619978168      -13.15       -7.43    3.8    880ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.14e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.50e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.33e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 8.36e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.81e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 7.69e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.60e-09
└ * number of operations = 8
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.454699511664                   -0.96    7.6    1.54s
  2   -8.456553994385       -2.73       -1.74    2.2    668ms
  3   -8.456619210235       -4.19       -2.83    3.7    950ms
  4   -8.456619966404       -6.12       -3.82    4.7    1.18s
  5   -8.456619977799       -7.94       -4.57    4.8    1.00s
  6   -8.456619978162       -9.44       -5.39    4.8    1.01s
  7   -8.456619978168      -11.25       -6.27    4.0    1.11s
  8   -8.456619978168      -13.01       -7.48    3.8    875ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 8.28e-02
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.24e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.58e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.98e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 6.79e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 1.28e-08
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 9.77e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.90e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.92e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 9.20e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.24e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.99e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.30e-09
└ * number of operations = 8
Si: 171.226710 seconds (251.58 M allocations: 208.378 GiB, 10.37% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T12:09:28.718
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.667925526888542)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18745415129                   -1.17    9.4    7.70s
  2   -62.19161446956       -2.38       -1.23    3.8    3.80s
  3   -62.19565178625       -2.39       -2.08    5.4    4.95s
  4   -62.19567897414       -4.57       -2.93    4.6    4.68s
  5   -62.19567942410       -6.35       -3.64    4.4    4.81s
  6   -62.19567944113       -7.77       -4.46    5.4    4.90s
  7   -62.19567944136       -9.64       -5.10    4.5    4.82s
  8   -62.19567944137      -10.87       -6.54    4.2    4.66s
  9   -62.19567944137      -13.30       -7.58    5.7    5.37s
Iter     Function value   Gradient norm 
     0    -6.219568e+01     1.351128e-07
 * time: 4.1961669921875e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.219568e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.35e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18745361747                   -1.17    9.2    7.12s
  2   -62.19160880249       -2.38       -1.23    3.7    3.73s
  3   -62.19565178370       -2.39       -2.08    5.7    5.10s
  4   -62.19567899111       -4.57       -2.93    4.4    4.58s
  5   -62.19567942415       -6.36       -3.64    4.2    4.73s
  6   -62.19567944113       -7.77       -4.46    5.5    4.93s
  7   -62.19567944135       -9.65       -5.03    4.6    4.63s
  8   -62.19567944137      -10.78       -6.48    4.0    4.54s
  9   -62.19567944137      -13.45       -7.52    5.5    5.33s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.08e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.01e+00
[ Info: GMRES linsolve in iteration 1; step 2: normres = 6.01e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.05e-02
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.85e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.80e-05
[ Info: GMRES linsolve in iteration 1; step 6: normres = 6.48e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 2.36e-08
└ * number of operations = 9
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18745543937                   -1.17    9.5    7.73s
  2   -62.19160945040       -2.38       -1.23    4.0    3.89s
  3   -62.19565182727       -2.39       -2.08    5.7    4.97s
  4   -62.19567896696       -4.57       -2.93    4.5    4.33s
  5   -62.19567942387       -6.34       -3.63    4.3    4.74s
  6   -62.19567944112       -7.76       -4.46    5.5    4.92s
  7   -62.19567944136       -9.64       -5.06    4.5    4.80s
  8   -62.19567944137      -10.80       -6.42    4.2    4.49s
  9   -62.19567944137      -13.19       -7.48    5.2    5.36s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 7.90e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.80e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.58e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.23e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.07e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 6.34e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 2.72e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 8.19e-09
└ * number of operations = 9
[ Info: GMRES linsolve starts with norm of residual = 2.58e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.54e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 9.91e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.28e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.46e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.58e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 2.59e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 2.13e-08
└ * number of operations = 9
NaCl: 1222.997997 seconds (962.55 M allocations: 1.322 TiB, 4.93% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T12:29:51.717
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.623008353599482)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316543195444                   -1.46    5.6    1.03s
  2   -2.316625646196       -4.08       -1.84    1.4    446ms
  3   -2.316644392867       -4.73       -3.57    3.3    725ms
  4   -2.316644597771       -6.69       -4.06    4.6    954ms
  5   -2.316644598321       -9.26       -4.38    2.5    622ms
  6   -2.316644598473       -9.82       -4.98    2.8    632ms
  7   -2.316644598477      -11.31       -5.64    2.5    601ms
  8   -2.316644598478      -12.73       -6.46    2.5    651ms
  9   -2.316644598478      -14.07       -7.08    2.8    687ms
Iter     Function value   Gradient norm 
     0    -2.316645e+00     7.178352e-09
 * time: 3.409385681152344e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.316645e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 7.18e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316546271956                   -1.46    5.6    1.32s
  2   -2.316625591220       -4.10       -1.84    1.3    456ms
  3   -2.316644383883       -4.73       -3.54    3.3    789ms
  4   -2.316644597616       -6.67       -4.01    4.6    1.14s
  5   -2.316644598292       -9.17       -4.34    2.5    587ms
  6   -2.316644598472       -9.75       -4.95    2.8    672ms
  7   -2.316644598477      -11.25       -5.58    2.5    632ms
  8   -2.316644598478      -12.61       -6.51    2.6    829ms
  9   -2.316644598478      -14.07       -7.12    3.0    689ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 6.02e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.74e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.36e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.79e-06
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 3.50e-08
└ * number of operations = 6
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316547474056                   -1.46    5.6    1.14s
  2   -2.316626259181       -4.10       -1.84    1.4    625ms
  3   -2.316644399995       -4.74       -3.56    3.3    731ms
  4   -2.316644597722       -6.70       -4.05    4.6    1.00s
  5   -2.316644598307       -9.23       -4.37    2.6    842ms
  6   -2.316644598473       -9.78       -4.97    2.9    612ms
  7   -2.316644598477      -11.33       -5.60    2.5    592ms
  8   -2.316644598478      -12.64       -6.49    2.6    643ms
  9   -2.316644598478      -13.94       -7.10    2.9    863ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 3.14e-03
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.71e-05
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.75e-06
┌ Info: GMRES linsolve converged at iteration 1, step 3:
│ * norm of residual = 7.46e-08
└ * number of operations = 5
[ Info: GMRES linsolve starts with norm of residual = 2.42e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.59e-03
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.10e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 9.02e-07
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 1.04e-08
└ * number of operations = 6
Al: 140.354352 seconds (149.01 M allocations: 80.903 GiB, 7.38% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T12:32:12.072
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.644307888785144)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.1262896781583625e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76052716436                   -0.87   10.0    5.85s
  2   -73.77097556883       -1.98       -1.07    5.4    3.06s
  3   -73.77706489103       -2.22       -1.41    6.9    3.95s
  4   -73.77811584947       -2.98       -1.79    5.9    3.24s
  5   -73.77825399810       -3.86       -2.28    5.0    2.96s
  6   -73.77827172481       -4.75       -3.09    5.7    3.34s
  7   -73.77827176069       -7.45       -3.56    4.5    2.98s
  8   -73.77827176958       -8.05       -4.03    5.2    3.18s
  9   -73.77827176898   +   -9.22       -4.49    5.5    3.37s
 10   -73.77827176986       -9.06       -4.80    5.7    3.40s
 11   -73.77827176990      -10.37       -5.48    5.1    3.20s
 12   -73.77827176991      -11.49       -6.20    4.9    3.18s
 13   -73.77827176991      -13.55       -6.35    4.4    3.01s
 14   -73.77827176991      -13.85       -6.94    5.2    3.14s
 15   -73.77827176991   +  -13.37       -7.82    5.0    3.23s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1262896781583625e-8,-3.974896792477832e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.377827e+01     1.777688e-09
 * time: 3.886222839355469e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.377827e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.78e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.1262896781583625e-8,-3.974896792477832e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.1262896781583625e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76053092073                   -0.87   10.0    5.96s
  2   -73.77096757660       -1.98       -1.07    5.3    3.08s
  3   -73.77706494580       -2.21       -1.41    6.9    4.05s
  4   -73.77811611265       -2.98       -1.79    5.9    3.41s
  5   -73.77825395316       -3.86       -2.27    5.1    2.86s
  6   -73.77827172660       -4.75       -3.09    5.5    3.39s
  7   -73.77827176134       -7.46       -3.56    4.4    2.92s
  8   -73.77827176959       -8.08       -4.04    5.2    3.04s
  9   -73.77827176896   +   -9.20       -4.48    5.6    3.10s
 10   -73.77827176986       -9.04       -4.79    5.6    3.34s
 11   -73.77827176990      -10.36       -5.46    5.0    3.13s
 12   -73.77827176991      -11.44       -6.22    4.8    3.15s
 13   -73.77827176991      -13.85       -6.37    4.4    2.76s
 14   -73.77827176991      -13.37       -6.94    5.1    2.97s
 15   -73.77827176991      -13.85       -7.81    5.0    3.09s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.37e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.01e+01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.23e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.10e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 5.95e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 6.63e-07
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.61e-08
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 1.18e-08
└ * number of operations = 9
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}(Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.126289679372518e-8,-3.974896782805951e-8),Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.974896790583705e-8,4.373078083128886e-6))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Computing cross-derivative ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.1262896781583625e-8,0.0,0.0)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.1262896781583625e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76053835111                   -0.87   10.0    5.87s
  2   -73.77096855078       -1.98       -1.07    5.4    3.15s
  3   -73.77706487256       -2.21       -1.41    6.9    4.05s
  4   -73.77811595528       -2.98       -1.79    5.8    3.11s
  5   -73.77825446751       -3.86       -2.28    5.1    3.04s
  6   -73.77827172658       -4.76       -3.09    5.7    3.36s
  7   -73.77827176268       -7.44       -3.58    4.5    2.67s
  8   -73.77827176965       -8.16       -4.05    5.3    3.06s
  9   -73.77827176897   +   -9.17       -4.48    5.4    3.14s
 10   -73.77827176986       -9.05       -4.79    5.7    3.18s
 11   -73.77827176991      -10.38       -5.49    5.0    3.18s
 12   -73.77827176991      -11.51       -6.26    4.8    3.15s
 13   -73.77827176991      -13.37       -6.40    4.0    2.61s
 14   -73.77827176991   +  -13.07       -6.97    5.3    3.19s
 15   -73.77827176991      -13.07       -7.85    5.1    3.14s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.28e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 9.41e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.76e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.42e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 7.90e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 8.53e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.13e-09
└ * number of operations = 8
[ Info: GMRES linsolve starts with norm of residual = 4.68e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.60e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.72e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.03e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 7.12e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.62e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.93e-09
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}, KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.126289679372518e-8,0.0,0.0),Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.9748967908891955e-8,0.0,0.0))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
V: 805.048312 seconds (635.63 M allocations: 920.762 GiB, 7.60% gc time, 0.00% compilation time)
     1     1.059022e-04     3.769440e-04
 * Current step size: 1.0
 * time: 3237.7648310661316
 * g(x): (κ = 0.00037694395853699557, μ = 0.00037272869088838655)
 * ~inv(H): [44.55286701883269 43.06815492269078; 43.06815492269078 43.58548983147846]
 * x: (κ = 0.6709216155884424, μ = 0.20787892373094077)
┌ Info: 2025-05-20T12:45:37.209
└   θ = ComponentVector{Float64}(κ = 0.6380749445268785, μ = 0.17539908036088106)
┌ Info: 2025-05-20T12:45:37.209
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.319267392376007)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441696287704                   -0.96    7.4    1.54s
  2   -8.443585123894       -2.72       -1.76    2.2    635ms
  3   -8.443652905720       -4.17       -2.85    3.9    1.15s
  4   -8.443653624111       -6.14       -3.81    4.7    967ms
  5   -8.443653634759       -7.97       -4.55    4.4    1.01s
  6   -8.443653635144       -9.41       -5.35    4.8    1.16s
  7   -8.443653635151      -11.18       -6.20    3.8    897ms
  8   -8.443653635151      -12.81       -7.49    3.8    958ms
Iter     Function value   Gradient norm 
     0    -8.443654e+00     1.817088e-03
 * time: 3.409385681152344e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441692184853                   -0.96    7.1    1.51s
  2   -8.443591299745       -2.72       -1.76    2.0    609ms
  3   -8.443655962476       -4.19       -2.86    3.7    938ms
  4   -8.443656810007       -6.07       -3.79    4.4    1.19s
  5   -8.443656819950       -8.00       -4.61    4.6    973ms
  6   -8.443656820263       -9.50       -5.46    4.7    1.08s
  7   -8.443656820267      -11.45       -6.31    3.7    1.03s
  8   -8.443656820267      -13.05       -7.45    3.7    886ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441667276099                   -0.96    7.0    1.27s
  2   -8.443581902688       -2.72       -1.76    2.0    839ms
  3   -8.443656075049       -4.13       -2.86    3.8    903ms
  4   -8.443656809349       -6.13       -3.82    4.3    1.02s
  5   -8.443656819846       -7.98       -4.53    4.4    1.16s
  6   -8.443656820258       -9.39       -5.28    4.6    1.07s
  7   -8.443656820267      -11.04       -6.13    3.7    1.20s
  8   -8.443656820267      -12.67       -7.53    3.8    1.05s
     1    -8.443657e+00     1.688616e-03
 * time: 27.453214168548584
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441650107539                   -0.96    6.9    1.48s
  2   -8.443605772454       -2.71       -1.76    2.1    642ms
  3   -8.443675919479       -4.15       -2.85    3.8    1.12s
  4   -8.443676804152       -6.05       -3.79    4.3    968ms
  5   -8.443676813986       -8.01       -4.58    4.5    1.06s
  6   -8.443676814327       -9.47       -5.41    4.6    1.13s
  7   -8.443676814332      -11.36       -6.20    3.7    908ms
  8   -8.443676814332      -12.85       -7.41    3.7    1.07s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441651924883                   -0.96    7.0    1.50s
  2   -8.443602593606       -2.71       -1.76    1.9    635ms
  3   -8.443676043374       -4.13       -2.85    3.9    1.20s
  4   -8.443676803751       -6.12       -3.82    4.4    938ms
  5   -8.443676813927       -7.99       -4.54    4.5    1.04s
  6   -8.443676814324       -9.40       -5.32    4.6    1.15s
  7   -8.443676814332      -11.12       -6.16    3.9    949ms
  8   -8.443676814332      -12.72       -7.45    3.8    895ms
     2    -8.443677e+00     2.075592e-05
 * time: 54.44565415382385
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441654650794                   -0.96    6.9    1.45s
  2   -8.443607405858       -2.71       -1.76    1.9    593ms
  3   -8.443676065106       -4.16       -2.85    3.8    950ms
  4   -8.443676806797       -6.13       -3.82    4.3    1.14s
  5   -8.443676816957       -7.99       -4.58    4.4    952ms
  6   -8.443676817302       -9.46       -5.38    4.8    1.00s
  7   -8.443676817308      -11.24       -6.24    3.8    1.07s
  8   -8.443676817308      -12.90       -7.51    3.7    878ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441645786559                   -0.96    6.9    1.23s
  2   -8.443604646170       -2.71       -1.76    2.0    824ms
  3   -8.443676058967       -4.15       -2.85    3.8    878ms
  4   -8.443676805927       -6.13       -3.82    4.4    1.03s
  5   -8.443676816870       -7.96       -4.50    4.6    1.15s
  6   -8.443676817298       -9.37       -5.26    4.6    957ms
  7   -8.443676817308      -10.99       -6.12    3.7    1.06s
  8   -8.443676817308      -12.72       -7.54    3.7    851ms
     3    -8.443677e+00     2.315784e-07
 * time: 81.27554297447205
 * Status: success

 * Candidate solution
    Final objective value:     -8.443677e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.90e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.82e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.98e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.53e-10 ≰ 0.0e+00
    |g(x)|                 = 2.32e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   81  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 97.640255 seconds (196.70 M allocations: 56.519 GiB, 11.70% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T12:47:14.850
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.667925526888542)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.10584354515                   -1.18    9.4    8.00s
  2   -62.10970213240       -2.41       -1.24    3.6    3.75s
  3   -62.11343156076       -2.43       -2.09    5.4    5.00s
  4   -62.11345523663       -4.63       -2.86    4.6    4.72s
  5   -62.11345597933       -6.13       -3.59    4.2    4.80s
  6   -62.11345600337       -7.62       -4.47    5.6    5.18s
  7   -62.11345600357       -9.70       -5.06    4.5    5.03s
  8   -62.11345600358      -10.89       -6.53    4.3    4.78s
  9   -62.11345600358      -13.85       -7.33    5.9    7.62s
Iter     Function value   Gradient norm 
     0    -6.211346e+01     1.085944e-03
 * time: 4.1961669921875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.10584965781                   -1.18    9.4    7.93s
  2   -62.10970467624       -2.41       -1.24    3.8    4.27s
  3   -62.11343278081       -2.43       -2.09    5.7    5.53s
  4   -62.11345632355       -4.63       -2.84    4.7    4.86s
  5   -62.11345714606       -6.08       -3.57    4.2    4.81s
  6   -62.11345717085       -7.61       -4.45    5.3    5.06s
  7   -62.11345717107       -9.66       -5.05    4.5    4.89s
  8   -62.11345717108      -10.84       -6.47    4.4    4.88s
  9   -62.11345717108      -13.55       -7.26    5.5    5.45s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.10584476498                   -1.18    9.6    8.02s
  2   -62.10969816266       -2.41       -1.24    3.7    3.76s
  3   -62.11343289129       -2.43       -2.09    5.7    5.09s
  4   -62.11345636280       -4.63       -2.85    4.8    4.93s
  5   -62.11345714713       -6.11       -3.59    4.3    4.81s
  6   -62.11345717086       -7.62       -4.48    5.4    7.32s
  7   -62.11345717107       -9.69       -5.06    4.7    7.04s
  8   -62.11345717108      -10.88       -6.48    4.3    4.82s
  9   -62.11345717108      -13.07       -7.41    5.8    5.54s
     1    -6.211346e+01     1.064262e-03
 * time: 127.9779441356659
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.10602379681                   -1.18    9.1    9.93s
  2   -62.10987374088       -2.41       -1.25    3.6    3.98s
  3   -62.11346177371       -2.45       -2.10    5.3    6.93s
  4   -62.11348430996       -4.65       -2.88    4.4    4.76s
  5   -62.11348496444       -6.18       -3.60    4.2    4.76s
  6   -62.11348498773       -7.63       -4.48    5.3    6.50s
  7   -62.11348498792       -9.73       -5.05    4.7    4.93s
  8   -62.11348498793      -10.88       -6.65    4.3    4.74s
  9   -62.11348498793      -13.19       -7.35    6.1    5.65s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.10602341299                   -1.18    9.1    7.70s
  2   -62.10986622769       -2.42       -1.25    3.7    3.79s
  3   -62.11346177602       -2.44       -2.10    5.4    5.81s
  4   -62.11348429508       -4.65       -2.87    4.5    4.76s
  5   -62.11348496434       -6.17       -3.59    4.2    4.73s
  6   -62.11348498773       -7.63       -4.48    5.4    6.72s
  7   -62.11348498792       -9.73       -5.03    4.6    4.97s
  8   -62.11348498793      -10.86       -6.61    4.3    4.71s
  9   -62.11348498793      -13.45       -7.32    6.0    5.65s
     2    -6.211348e+01     3.062675e-05
 * time: 255.3186731338501
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.10601555455                   -1.18    9.3    7.62s
  2   -62.10986453498       -2.41       -1.25    3.5    3.80s
  3   -62.11346164941       -2.44       -2.10    5.4    4.91s
  4   -62.11348430542       -4.64       -2.87    4.6    6.49s
  5   -62.11348498599       -6.17       -3.59    4.2    6.76s
  6   -62.11348500993       -7.62       -4.46    5.3    5.05s
  7   -62.11348501014       -9.69       -5.02    4.6    4.96s
  8   -62.11348501015      -10.83       -6.64    4.2    4.70s
  9   -62.11348501015      -13.67       -7.33    6.0    5.68s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.10601335258                   -1.18    9.1    7.73s
  2   -62.10987267344       -2.41       -1.25    3.7    4.04s
  3   -62.11346165797       -2.45       -2.10    5.5    5.09s
  4   -62.11348431334       -4.64       -2.87    4.4    4.70s
  5   -62.11348498627       -6.17       -3.59    4.2    4.67s
  6   -62.11348500995       -7.63       -4.48    5.1    4.90s
  7   -62.11348501014       -9.72       -5.07    4.7    5.02s
  8   -62.11348501015      -10.92       -6.48    4.3    4.76s
  9   -62.11348501015      -13.15       -7.33    5.4    5.38s
     3    -6.211349e+01     8.338260e-07
 * time: 379.6053509712219
 * Status: success

 * Candidate solution
    Final objective value:     -6.211349e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.49e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.40e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.22e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.58e-10 ≰ 0.0e+00
    |g(x)|                 = 8.34e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   380  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

NaCl: 449.977553 seconds (751.93 M allocations: 261.188 GiB, 7.40% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T12:54:44.856
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.623008353599482)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314674491870                   -1.45    5.6    1.31s
  2   -2.314771280113       -4.01       -1.84    1.5    480ms
  3   -2.314794928570       -4.63       -3.54    3.4    770ms
  4   -2.314795125460       -6.71       -4.11    4.6    1.10s
  5   -2.314795125795       -9.47       -4.65    2.6    610ms
  6   -2.314795125826      -10.50       -5.89    2.9    652ms
  7   -2.314795125827      -12.23       -6.34    3.8    1.01s
  8   -2.314795125827      -13.73       -6.83    2.4    569ms
  9   -2.314795125827      -14.75       -7.43    2.8    652ms
Iter     Function value   Gradient norm 
     0    -2.314795e+00     1.023448e-03
 * time: 3.0994415283203125e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314676229284                   -1.45    5.4    1.31s
  2   -2.314772295327       -4.02       -1.83    1.4    502ms
  3   -2.314795898825       -4.63       -3.50    3.4    753ms
  4   -2.314796151546       -6.60       -4.05    4.4    997ms
  5   -2.314796151970       -9.37       -4.59    2.5    818ms
  6   -2.314796152014      -10.36       -5.91    2.8    619ms
  7   -2.314796152015      -12.03       -6.51    3.8    817ms
  8   -2.314796152015      -14.21       -7.01    2.3    629ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314671260713                   -1.45    5.5    1.10s
  2   -2.314771843696       -4.00       -1.83    1.4    655ms
  3   -2.314795895551       -4.62       -3.52    3.3    712ms
  4   -2.314796151610       -6.59       -4.08    4.5    969ms
  5   -2.314796151980       -9.43       -4.62    2.5    654ms
  6   -2.314796152014      -10.47       -5.88    2.9    969ms
  7   -2.314796152015      -12.07       -6.28    3.7    792ms
  8   -2.314796152015      -13.63       -6.84    2.5    628ms
  9   -2.314796152015      -14.65       -7.45    2.7    916ms
     1    -2.314796e+00     9.818948e-04
 * time: 39.42546510696411
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314694354797                   -1.45    5.5    1.16s
  2   -2.314785139729       -4.04       -1.83    1.4    442ms
  3   -2.314807571207       -4.65       -3.54    3.4    759ms
  4   -2.314807765325       -6.71       -4.20    4.5    1.07s
  5   -2.314807765549       -9.65       -4.80    2.7    597ms
  6   -2.314807765564      -10.83       -5.91    3.0    667ms
  7   -2.314807765564      -12.37       -6.30    3.5    996ms
  8   -2.314807765564      -13.83       -6.76    2.3    530ms
  9   -2.314807765564   +    -Inf       -7.58    2.3    640ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314696438115                   -1.45    5.5    1.26s
  2   -2.314785348023       -4.05       -1.83    1.4    526ms
  3   -2.314807601082       -4.65       -3.53    3.4    804ms
  4   -2.314807765326       -6.78       -4.20    4.5    1.08s
  5   -2.314807765551       -9.65       -4.80    2.7    778ms
  6   -2.314807765564      -10.88       -5.81    2.9    683ms
  7   -2.314807765564      -12.26       -6.24    3.4    1.12s
  8   -2.314807765564      -13.75       -6.66    2.5    702ms
  9   -2.314807765564      -14.88       -7.53    1.8    586ms
     2    -2.314808e+00     3.498611e-05
 * time: 79.54253315925598
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314691676480                   -1.45    5.3    1.27s
  2   -2.314784303023       -4.03       -1.83    1.3    532ms
  3   -2.314807534006       -4.63       -3.52    3.4    771ms
  4   -2.314807779181       -6.61       -4.16    4.4    980ms
  5   -2.314807779454       -9.57       -4.76    2.7    994ms
  6   -2.314807779473      -10.72       -6.11    3.0    660ms
  7   -2.314807779473      -12.41       -6.44    3.9    858ms
  8   -2.314807779473      -14.24       -7.14    2.2    806ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314695836694                   -1.45    5.4    1.08s
  2   -2.314785684506       -4.05       -1.83    1.4    734ms
  3   -2.314807571905       -4.66       -3.54    3.3    717ms
  4   -2.314807779221       -6.68       -4.19    4.5    969ms
  5   -2.314807779457       -9.63       -4.79    2.7    860ms
  6   -2.314807779473      -10.81       -5.93    3.0    703ms
  7   -2.314807779473      -12.34       -6.29    3.5    798ms
  8   -2.314807779473      -13.86       -6.80    2.3    563ms
  9   -2.314807779473      -14.88       -7.55    2.5    778ms
     3    -2.314808e+00     1.529299e-06
 * time: 118.89536619186401
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314691875192                   -1.45    5.4    1.25s
  2   -2.314784689890       -4.03       -1.83    1.4    566ms
  3   -2.314807631135       -4.64       -3.53    3.4    795ms
  4   -2.314807779240       -6.83       -4.19    4.4    1.36s
  5   -2.314807779483       -9.61       -4.80    2.7    634ms
  6   -2.314807779500      -10.79       -5.97    3.0    701ms
  7   -2.314807779500      -12.40       -6.32    3.6    1.10s
  8   -2.314807779500      -13.82       -6.78    2.3    699ms
  9   -2.314807779500   +    -Inf       -7.56    2.2    700ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314690363924                   -1.45    5.4    1.25s
  2   -2.314785053763       -4.02       -1.83    1.4    564ms
  3   -2.314807595111       -4.65       -3.54    3.3    1.01s
  4   -2.314807779270       -6.73       -4.21    4.5    882ms
  5   -2.314807779487       -9.66       -4.81    2.7    639ms
  6   -2.314807779499      -10.89       -5.80    3.0    701ms
  7   -2.314807779500      -12.31       -6.24    3.4    949ms
  8   -2.314807779500      -13.77       -6.72    2.3    688ms
  9   -2.314807779500      -15.05       -7.52    2.2    714ms
     4    -2.314808e+00     2.415052e-09
 * time: 159.94645619392395
 * Status: success

 * Candidate solution
    Final objective value:     -2.314808e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.48e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.59e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.67e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.15e-11 ≰ 0.0e+00
    |g(x)|                 = 2.42e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   160  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

Al: 185.053000 seconds (174.80 M allocations: 49.222 GiB, 6.83% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T12:57:49.910
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.644307888785144)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.1262896781583625e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69848494302                   -0.85   10.0    5.99s
  2   -73.71071891985       -1.91       -1.05    5.5    3.22s
  3   -73.71759273936       -2.16       -1.38    7.0    4.19s
  4   -73.71878199364       -2.92       -1.76    6.1    3.45s
  5   -73.71894436857       -3.79       -2.26    5.1    3.15s
  6   -73.71896296996       -4.73       -3.09    5.6    3.64s
  7   -73.71896298558       -7.81       -3.55    4.8    3.34s
  8   -73.71896299121       -8.25       -4.08    5.0    4.10s
  9   -73.71896299084   +   -9.44       -4.48    5.7    4.10s
 10   -73.71896299148       -9.19       -4.82    5.8    3.35s
 11   -73.71896299151      -10.52       -5.52    4.9    3.11s
 12   -73.71896299152      -11.73       -6.37    4.9    3.06s
 13   -73.71896299152   +    -Inf       -6.64    3.8    2.50s
 14   -73.71896299152   +  -13.07       -7.03    5.0    3.01s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1262896781583625e-8,-3.974896792477832e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.371896e+01     3.801152e-03
 * time: 3.910064697265625e-5
┌ Warning: Negative ρcore detected: -3.107991248392985e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69857148643                   -0.85    9.6    5.74s
  2   -73.71075652431       -1.91       -1.05    5.4    3.02s
  3   -73.71761042397       -2.16       -1.38    6.7    3.89s
  4   -73.71879727280       -2.93       -1.76    5.8    3.21s
  5   -73.71895688780       -3.80       -2.25    5.1    3.00s
  6   -73.71897625024       -4.71       -3.09    5.5    3.98s
  7   -73.71897626993       -7.71       -3.54    4.1    3.60s
  8   -73.71897627526       -8.27       -4.05    4.8    3.14s
  9   -73.71897627500   +   -9.59       -4.53    5.3    3.35s
 10   -73.71897627552       -9.29       -4.82    5.6    3.42s
 11   -73.71897627555      -10.49       -5.53    4.9    3.12s
 12   -73.71897627555      -11.89       -6.33    4.6    3.34s
 13   -73.71897627555   +  -13.85       -6.59    4.8    4.80s
 14   -73.71897627555   +  -13.37       -7.03    5.1    3.16s
┌ Warning: Negative ρcore detected: -3.107991248392985e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69857564621                   -0.85    9.5    5.77s
  2   -73.71074569092       -1.91       -1.05    5.3    3.10s
  3   -73.71761463234       -2.16       -1.39    6.7    4.13s
  4   -73.71879632761       -2.93       -1.76    5.9    3.24s
  5   -73.71895683068       -3.79       -2.25    5.0    3.01s
  6   -73.71897625059       -4.71       -3.09    5.5    3.40s
  7   -73.71897627011       -7.71       -3.54    4.1    2.90s
  8   -73.71897627527       -8.29       -4.05    4.9    3.05s
  9   -73.71897627501   +   -9.58       -4.53    5.3    3.35s
 10   -73.71897627552       -9.29       -4.82    5.5    3.93s
 11   -73.71897627555      -10.48       -5.54    4.9    4.14s
 12   -73.71897627555      -11.87       -6.34    4.6    2.99s
 13   -73.71897627555      -13.85       -6.61    4.6    2.97s
 14   -73.71897627555   +  -13.00       -7.04    5.1    3.05s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.107991248392985e-8,-5.660808179489523e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     1    -7.371898e+01     3.188188e-03
 * time: 153.6592960357666
┌ Warning: Negative ρcore detected: -3.2160119810886656e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69910878016                   -0.85    9.6    5.83s
  2   -73.71093975188       -1.93       -1.05    5.2    3.06s
  3   -73.71765316540       -2.17       -1.39    6.7    4.01s
  4   -73.71884012902       -2.93       -1.77    5.7    3.31s
  5   -73.71899054509       -3.82       -2.28    4.9    3.03s
  6   -73.71900736203       -4.77       -3.09    5.5    3.40s
  7   -73.71900739921       -7.43       -3.57    4.6    3.00s
  8   -73.71900740554       -8.20       -4.03    4.9    3.08s
  9   -73.71900740517   +   -9.42       -4.53    5.2    3.24s
 10   -73.71900740581       -9.19       -4.80    5.5    3.36s
 11   -73.71900740585      -10.37       -5.49    5.0    3.13s
 12   -73.71900740585      -11.67       -6.25    4.9    3.15s
 13   -73.71900740585      -12.77       -6.45    4.7    3.12s
 14   -73.71900740585   +  -12.73       -7.00    5.1    3.23s
┌ Warning: Negative ρcore detected: -3.2160119810886656e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69908947453                   -0.85    9.6    5.84s
  2   -73.71095701750       -1.93       -1.05    5.4    3.17s
  3   -73.71765173238       -2.17       -1.39    6.6    3.99s
  4   -73.71884031017       -2.92       -1.77    5.7    3.31s
  5   -73.71899025632       -3.82       -2.28    4.9    3.04s
  6   -73.71900735919       -4.77       -3.09    5.5    3.39s
  7   -73.71900739940       -7.40       -3.56    4.6    3.02s
  8   -73.71900740554       -8.21       -4.03    5.0    3.11s
  9   -73.71900740517   +   -9.43       -4.53    5.2    3.26s
 10   -73.71900740581       -9.19       -4.80    5.6    3.40s
 11   -73.71900740585      -10.38       -5.50    4.9    3.14s
 12   -73.71900740585      -11.75       -6.27    4.8    3.19s
 13   -73.71900740585      -13.25       -6.45    4.4    2.98s
 14   -73.71900740585   +  -13.07       -7.02    5.2    3.11s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.2160119810886656e-8,1.309011622141342e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     2    -7.371901e+01     5.293979e-05
 * time: 302.7757329940796
┌ Warning: Negative ρcore detected: -3.211764754270689e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69908084515                   -0.85    9.6    5.72s
  2   -73.71093609033       -1.93       -1.05    5.2    3.00s
  3   -73.71765420518       -2.17       -1.39    6.7    4.00s
  4   -73.71883995261       -2.93       -1.77    5.7    3.25s
  5   -73.71899044947       -3.82       -2.28    4.9    3.07s
  6   -73.71900737355       -4.77       -3.09    5.5    3.37s
  7   -73.71900740721       -7.47       -3.57    4.4    2.90s
  8   -73.71900741402       -8.17       -4.04    5.0    4.80s
  9   -73.71900741363   +   -9.40       -4.53    5.4    3.30s
 10   -73.71900741429       -9.18       -4.80    5.5    3.34s
 11   -73.71900741433      -10.35       -5.48    5.0    3.17s
 12   -73.71900741434      -11.60       -6.26    4.9    3.21s
 13   -73.71900741434      -12.85       -6.47    4.2    2.99s
 14   -73.71900741434   +  -12.73       -7.00    5.2    3.15s
┌ Warning: Negative ρcore detected: -3.211764754270689e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69908669667                   -0.85    9.6    5.79s
  2   -73.71093905078       -1.93       -1.05    5.3    3.02s
  3   -73.71765468500       -2.17       -1.39    6.7    4.64s
  4   -73.71883958615       -2.93       -1.77    5.6    4.03s
  5   -73.71898988274       -3.82       -2.27    4.9    3.02s
  6   -73.71900736997       -4.76       -3.09    5.5    3.24s
  7   -73.71900740750       -7.43       -3.56    4.5    2.83s
  8   -73.71900741401       -8.19       -4.02    5.0    2.94s
  9   -73.71900741370   +   -9.51       -4.54    5.3    3.31s
 10   -73.71900741429       -9.23       -4.80    5.5    3.30s
 11   -73.71900741434      -10.38       -5.48    4.9    3.09s
 12   -73.71900741434      -11.63       -6.27    4.8    3.16s
 13   -73.71900741434      -13.55       -6.46    4.2    2.91s
 14   -73.71900741434   +  -12.94       -7.00    5.2    3.15s
 15   -73.71900741434   +  -13.00       -7.84    5.0    3.21s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.211764754270689e-8,1.3213948717715939e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     3    -7.371901e+01     5.259100e-07
 * time: 456.2358238697052
 * Status: success

 * Candidate solution
    Final objective value:     -7.371901e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.23e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 5.75e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 8.48e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.15e-10 ≰ 0.0e+00
    |g(x)|                 = 5.26e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   456  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

V: 544.119912 seconds (476.09 M allocations: 274.116 GiB, 9.32% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T13:06:54.031
└   θ = ComponentVector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}(κ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.6380749445268785,1.0,0.0), μ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.17539908036088106,0.0,1.0))
┌ Info: 2025-05-20T13:06:54.037
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.293856832401326)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441652838380                   -0.96    6.9    1.25s
  2   -8.443609559380       -2.71       -1.76    2.0    793ms
  3   -8.443676062074       -4.18       -2.85    3.8    880ms
  4   -8.443676807427       -6.13       -3.81    4.3    969ms
  5   -8.443676816951       -8.02       -4.57    4.5    1.11s
  6   -8.443676817303       -9.45       -5.39    4.5    907ms
  7   -8.443676817308      -11.27       -6.24    3.7    893ms
  8   -8.443676817308      -12.92       -7.50    3.8    1.02s
Iter     Function value   Gradient norm 
     0    -8.443677e+00     2.326435e-07
 * time: 3.695487976074219e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.443677e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 2.33e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441651351426                   -0.96    7.0    1.50s
  2   -8.443603860831       -2.71       -1.76    2.0    677ms
  3   -8.443675838424       -4.14       -2.85    3.8    962ms
  4   -8.443676807294       -6.01       -3.79    4.4    1.18s
  5   -8.443676816959       -8.01       -4.58    4.4    908ms
  6   -8.443676817303       -9.46       -5.38    4.7    956ms
  7   -8.443676817308      -11.30       -6.17    3.8    1.03s
  8   -8.443676817308      -12.79       -7.40    3.7    848ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.15e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.50e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.47e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 8.21e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.74e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 6.18e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.81e-09
└ * number of operations = 8
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441650007385                   -0.96    6.9    1.94s
  2   -8.443608306097       -2.71       -1.76    2.0    871ms
  3   -8.443675956817       -4.17       -2.85    3.9    1.13s
  4   -8.443676807297       -6.07       -3.80    4.3    1.03s
  5   -8.443676816959       -8.01       -4.58    4.5    1.33s
  6   -8.443676817304       -9.46       -5.41    4.7    1.40s
  7   -8.443676817308      -11.35       -6.24    3.7    1.32s
  8   -8.443676817308      -12.92       -7.44    3.7    1.21s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 6.70e-02
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.02e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.67e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.48e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 6.48e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 1.26e-08
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 1.03e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 5.36e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.75e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.21e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.64e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.46e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.47e-09
└ * number of operations = 8
Si: 171.969364 seconds (251.29 M allocations: 206.626 GiB, 9.82% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T13:09:46.007
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.615028153332453)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.10601427192                   -1.18    9.3    8.18s
  2   -62.10987057289       -2.41       -1.25    3.5    4.39s
  3   -62.11346156237       -2.44       -2.10    5.8    5.02s
  4   -62.11348427718       -4.64       -2.86    4.5    5.05s
  5   -62.11348498568       -6.15       -3.58    4.1    5.92s
  6   -62.11348500993       -7.62       -4.46    5.1    4.99s
  7   -62.11348501014       -9.67       -5.05    4.5    6.24s
  8   -62.11348501015      -10.87       -6.63    4.2    4.81s
  9   -62.11348501015      -13.11       -7.32    5.9    5.89s
Iter     Function value   Gradient norm 
     0    -6.211349e+01     8.343576e-07
 * time: 4.291534423828125e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.211349e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 8.34e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.10601451692                   -1.18    9.3    10.5s
  2   -62.10986133144       -2.41       -1.25    3.5    3.76s
  3   -62.11346182472       -2.44       -2.10    5.6    5.03s
  4   -62.11348432027       -4.65       -2.88    4.4    5.43s
  5   -62.11348498685       -6.18       -3.60    4.2    5.39s
  6   -62.11348500995       -7.64       -4.48    5.3    5.29s
  7   -62.11348501014       -9.73       -5.01    4.6    5.68s
  8   -62.11348501015      -10.82       -6.57    4.1    4.45s
  9   -62.11348501015      -13.55       -7.28    5.8    5.36s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.11e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.00e+00
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.96e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.11e-02
[ Info: GMRES linsolve in iteration 1; step 4: normres = 3.52e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 2.71e-05
[ Info: GMRES linsolve in iteration 1; step 6: normres = 6.58e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 3.56e-08
└ * number of operations = 9
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.10601565090                   -1.18    9.4    9.15s
  2   -62.10987051771       -2.41       -1.25    3.8    4.29s
  3   -62.11346169167       -2.44       -2.10    5.4    5.01s
  4   -62.11348431936       -4.65       -2.87    4.4    6.87s
  5   -62.11348498647       -6.18       -3.59    4.3    6.76s
  6   -62.11348500994       -7.63       -4.47    5.4    6.34s
  7   -62.11348501014       -9.71       -5.04    4.5    4.66s
  8   -62.11348501015      -10.87       -6.51    4.2    4.61s
  9   -62.11348501015   +  -13.55       -7.29    5.6    5.33s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 7.07e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.61e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.06e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.20e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.05e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 6.21e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 2.92e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 8.66e-09
└ * number of operations = 9
[ Info: GMRES linsolve starts with norm of residual = 2.90e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.12e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.08e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.78e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.01e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.19e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 3.30e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 1.13e-08
└ * number of operations = 9
NaCl: 1237.355060 seconds (959.37 M allocations: 1.287 TiB, 4.90% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T13:30:23.363
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.598598510980381)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314692418579                   -1.45    5.5    1.04s
  2   -2.314785147113       -4.03       -1.83    1.4    445ms
  3   -2.314807522616       -4.65       -3.54    3.4    752ms
  4   -2.314807779240       -6.59       -4.17    4.6    958ms
  5   -2.314807779484       -9.61       -4.77    2.6    666ms
  6   -2.314807779499      -10.81       -5.96    2.9    663ms
  7   -2.314807779500      -12.33       -6.31    3.6    856ms
  8   -2.314807779500      -13.86       -6.91    2.3    797ms
  9   -2.314807779500      -15.05       -7.47    2.8    654ms
Iter     Function value   Gradient norm 
     0    -2.314808e+00     3.165842e-09
 * time: 3.314018249511719e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.314808e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.17e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314692255554                   -1.45    5.4    1.09s
  2   -2.314784667351       -4.03       -1.83    1.4    483ms
  3   -2.314807544178       -4.64       -3.53    3.4    823ms
  4   -2.314807779218       -6.63       -4.18    4.5    1.14s
  5   -2.314807779481       -9.58       -4.77    2.6    636ms
  6   -2.314807779500      -10.73       -6.08    2.9    696ms
  7   -2.314807779500      -12.47       -6.40    3.8    881ms
  8   -2.314807779500      -14.15       -7.01    2.1    738ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.88e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.60e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.08e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.47e-06
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 1.44e-08
└ * number of operations = 6
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314693381027                   -1.45    5.5    1.11s
  2   -2.314784730908       -4.04       -1.83    1.4    492ms
  3   -2.314807589732       -4.64       -3.52    3.4    911ms
  4   -2.314807779219       -6.72       -4.17    4.5    950ms
  5   -2.314807779482       -9.58       -4.78    2.7    671ms
  6   -2.314807779500      -10.76       -6.04    3.0    882ms
  7   -2.314807779500      -12.45       -6.37    3.7    787ms
  8   -2.314807779500      -13.95       -6.93    2.2    575ms
  9   -2.314807779500      -15.35       -7.62    2.7    654ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.49e-03
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.92e-05
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.54e-06
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.34e-08
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 1.85e-10
└ * number of operations = 6
[ Info: GMRES linsolve starts with norm of residual = 2.22e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.72e-03
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.71e-05
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.71e-07
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 4.23e-09
└ * number of operations = 6
Al: 145.360918 seconds (150.41 M allocations: 83.510 GiB, 7.62% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T13:32:48.725
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.621058875879847)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.211764754270689e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69908599824                   -0.85    9.5    5.97s
  2   -73.71094074981       -1.93       -1.05    5.2    3.04s
  3   -73.71765359820       -2.17       -1.39    6.6    4.01s
  4   -73.71884005550       -2.93       -1.77    5.8    3.29s
  5   -73.71899002068       -3.82       -2.27    4.9    3.06s
  6   -73.71900736773       -4.76       -3.09    5.5    3.47s
  7   -73.71900740805       -7.39       -3.56    4.6    3.04s
  8   -73.71900741402       -8.22       -4.03    5.1    3.11s
  9   -73.71900741371   +   -9.50       -4.54    5.1    3.12s
 10   -73.71900741429       -9.23       -4.81    5.5    3.27s
 11   -73.71900741434      -10.39       -5.50    4.9    3.08s
 12   -73.71900741434      -11.74       -6.26    4.7    3.04s
 13   -73.71900741434      -12.85       -6.45    4.0    2.76s
 14   -73.71900741434   +  -12.62       -7.03    5.2    3.19s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.211764754270689e-8,1.3213948717715939e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.371901e+01     6.837828e-07
 * time: 3.910064697265625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.371901e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 6.84e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.211764754270689e-8,1.3213948717715939e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.211764754270689e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69909463221                   -0.85    9.5    5.77s
  2   -73.71093686457       -1.93       -1.05    5.2    3.64s
  3   -73.71765466558       -2.17       -1.39    6.7    4.00s
  4   -73.71883913289       -2.93       -1.77    5.8    3.44s
  5   -73.71899039244       -3.82       -2.28    5.0    2.84s
  6   -73.71900737092       -4.77       -3.09    5.5    3.30s
  7   -73.71900740758       -7.44       -3.57    4.5    2.89s
  8   -73.71900741403       -8.19       -4.03    5.0    3.08s
  9   -73.71900741367   +   -9.44       -4.54    5.3    2.94s
 10   -73.71900741429       -9.20       -4.81    5.5    3.26s
 11   -73.71900741434      -10.37       -5.50    4.9    3.12s
 12   -73.71900741434      -11.66       -6.25    4.7    3.43s
 13   -73.71900741434      -13.55       -6.45    4.5    2.91s
 14   -73.71900741434   +  -12.89       -7.01    5.1    3.14s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.38e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.01e+01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.37e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 7.24e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 8.62e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 6.96e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 7.84e-08
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}(Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.211764742444506e-8,1.3213948698407132e-7),Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(1.3213948710087314e-7,3.828367625626472e-6))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Computing cross-derivative ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.211764754270689e-8,0.0,0.0)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.211764754270689e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69908396899                   -0.85    9.6    5.86s
  2   -73.71093843525       -1.93       -1.05    5.2    3.07s
  3   -73.71765494187       -2.17       -1.39    6.7    4.11s
  4   -73.71883955896       -2.93       -1.77    5.7    3.17s
  5   -73.71899001880       -3.82       -2.27    5.0    2.94s
  6   -73.71900737148       -4.76       -3.09    5.4    3.23s
  7   -73.71900740704       -7.45       -3.56    4.4    2.71s
  8   -73.71900741401       -8.16       -4.03    5.0    3.01s
  9   -73.71900741366   +   -9.45       -4.53    5.3    3.25s
 10   -73.71900741429       -9.20       -4.80    5.5    3.13s
 11   -73.71900741433      -10.36       -5.48    4.9    3.18s
 12   -73.71900741434      -11.63       -6.26    4.8    3.16s
 13   -73.71900741434      -12.85       -6.45    4.8    2.77s
 14   -73.71900741434   +  -12.67       -7.00    5.2    3.08s
 15   -73.71900741434   +  -13.55       -7.82    5.0    3.23s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.37e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 7.92e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.57e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.02e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 9.93e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 8.60e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.41e-09
└ * number of operations = 8
[ Info: GMRES linsolve starts with norm of residual = 4.93e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.39e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.19e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 8.46e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.39e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.14e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 2.54e-09
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}, KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.211764742444506e-8,0.0,0.0),Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(1.3213948709713026e-7,0.0,0.0))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
V: 774.836053 seconds (610.17 M allocations: 866.771 GiB, 7.35% gc time, 0.00% compilation time)
     2     9.440535e-05     2.250119e-04
 * Current step size: 1.0
 * time: 6844.119137048721
 * g(x): (κ = 0.0001538666469640042, μ = -0.00022501191172592078)
 * ~inv(H): [41.409429073600855 39.49734524774518; 39.49734524774519 39.59724615393882]
 * x: (κ = 0.6380749445268785, μ = 0.17539908036088106)
┌ Info: 2025-05-20T13:45:43.563
└   θ = ComponentVector{Float64}(κ = 0.6405907876849236, μ = 0.1782316083398105)
┌ Info: 2025-05-20T13:45:43.563
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.293856832401326)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.442793861761                   -0.96    6.9    1.46s
  2   -8.444733825233       -2.71       -1.76    2.1    646ms
  3   -8.444802250795       -4.16       -2.85    3.7    1.11s
  4   -8.444803042720       -6.10       -3.82    4.4    950ms
  5   -8.444803053226       -7.98       -4.58    4.4    981ms
  6   -8.444803053579       -9.45       -5.38    4.6    1.12s
  7   -8.444803053585      -11.25       -6.25    3.6    873ms
  8   -8.444803053585      -12.88       -7.53    3.7    891ms
Iter     Function value   Gradient norm 
     0    -8.444803e+00     1.605925e-04
 * time: 3.910064697265625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.442787868463                   -0.96    7.1    1.37s
  2   -8.444731873009       -2.71       -1.76    2.3    873ms
  3   -8.444802267175       -4.15       -2.84    3.9    957ms
  4   -8.444803068138       -6.10       -3.81    4.4    1.07s
  5   -8.444803078071       -8.00       -4.56    4.6    1.19s
  6   -8.444803078436       -9.44       -5.36    4.8    990ms
  7   -8.444803078442      -11.23       -6.18    3.8    1.18s
  8   -8.444803078442      -12.77       -7.45    3.7    848ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.442798107537                   -0.96    7.1    1.55s
  2   -8.444738811096       -2.71       -1.76    2.2    671ms
  3   -8.444802346846       -4.20       -2.84    3.9    1.13s
  4   -8.444803068428       -6.14       -3.81    4.4    996ms
  5   -8.444803078089       -8.02       -4.58    4.5    1.05s
  6   -8.444803078437       -9.46       -5.42    4.9    1.15s
  7   -8.444803078442      -11.36       -6.28    3.8    918ms
  8   -8.444803078442      -12.99       -7.48    3.7    1.12s
     1    -8.444803e+00     1.489676e-04
 * time: 27.39060091972351
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.442793255533                   -0.96    7.1    1.54s
  2   -8.444734549040       -2.71       -1.76    2.1    664ms
  3   -8.444802412839       -4.17       -2.85    3.8    1.17s
  4   -8.444803221874       -6.09       -3.81    4.4    936ms
  5   -8.444803231527       -8.02       -4.59    4.6    1.02s
  6   -8.444803231853       -9.49       -5.40    4.8    1.18s
  7   -8.444803231857      -11.31       -6.23    3.8    884ms
  8   -8.444803231858      -12.89       -7.48    3.8    953ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.442803108930                   -0.96    7.2    1.50s
  2   -8.444737758878       -2.71       -1.76    2.2    638ms
  3   -8.444802560823       -4.19       -2.84    3.9    1.01s
  4   -8.444803221415       -6.18       -3.83    4.4    1.17s
  5   -8.444803231487       -8.00       -4.56    4.5    997ms
  6   -8.444803231852       -9.44       -5.38    4.7    1.01s
  7   -8.444803231857      -11.24       -6.21    3.8    1.08s
  8   -8.444803231858      -12.85       -7.56    3.8    906ms
     2    -8.444803e+00     1.728097e-07
 * time: 55.15307307243347
 * Status: success

 * Candidate solution
    Final objective value:     -8.444803e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.06e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.00e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.53e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.82e-08 ≰ 0.0e+00
    |g(x)|                 = 1.73e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   55  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Si: 71.451551 seconds (141.28 M allocations: 40.741 GiB, 11.22% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T13:46:55.016
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.615028153332453)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.11316381107                   -1.18    9.3    7.84s
  2   -62.11704298877       -2.41       -1.25    3.5    3.78s
  3   -62.12066160277       -2.44       -2.10    5.6    5.11s
  4   -62.12068446994       -4.64       -2.88    4.4    4.55s
  5   -62.12068512143       -6.19       -3.59    4.0    4.68s
  6   -62.12068514428       -7.64       -4.46    5.3    5.03s
  7   -62.12068514448       -9.68       -5.04    4.5    4.98s
  8   -62.12068514450      -10.84       -6.55    4.2    4.75s
  9   -62.12068514450      -13.00       -7.30    5.6    5.55s
Iter     Function value   Gradient norm 
     0    -6.212069e+01     9.849174e-05
 * time: 4.410743713378906e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.11316164421                   -1.18    9.5    8.25s
  2   -62.11704353957       -2.41       -1.25    3.8    3.89s
  3   -62.12066147642       -2.44       -2.10    5.5    4.92s
  4   -62.12068447373       -4.64       -2.87    4.6    4.78s
  5   -62.12068513076       -6.18       -3.59    4.2    4.79s
  6   -62.12068515388       -7.64       -4.46    5.3    5.11s
  7   -62.12068515409       -9.69       -5.06    4.6    5.00s
  8   -62.12068515410      -10.88       -6.51    4.2    4.79s
  9   -62.12068515410      -13.25       -7.27    5.3    5.46s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.11316387144                   -1.18    9.5    9.18s
  2   -62.11705311964       -2.41       -1.25    4.0    3.86s
  3   -62.12066148288       -2.44       -2.10    5.5    5.02s
  4   -62.12068443751       -4.64       -2.86    4.5    4.70s
  5   -62.12068513018       -6.16       -3.58    4.1    4.72s
  6   -62.12068515386       -7.63       -4.44    5.2    5.07s
  7   -62.12068515409       -9.65       -5.08    4.5    4.96s
  8   -62.12068515410      -10.90       -6.60    4.5    4.91s
  9   -62.12068515410      -14.15       -7.26    5.8    5.62s
     1    -6.212069e+01     9.641216e-05
 * time: 122.87110114097595
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.11316126335                   -1.18    9.4    7.97s
  2   -62.11703938512       -2.41       -1.25    3.9    3.91s
  3   -62.12066171616       -2.44       -2.10    5.3    5.05s
  4   -62.12068467996       -4.64       -2.87    4.5    4.76s
  5   -62.12068535065       -6.17       -3.58    4.2    4.79s
  6   -62.12068537398       -7.63       -4.45    5.1    5.08s
  7   -62.12068537418       -9.68       -5.10    4.4    4.98s
  8   -62.12068537420      -10.93       -6.60    4.4    4.88s
  9   -62.12068537420      -12.83       -7.21    5.9    5.70s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.11316101726                   -1.18    9.3    7.87s
  2   -62.11703977852       -2.41       -1.25    3.7    3.80s
  3   -62.12066150912       -2.44       -2.10    5.2    4.99s
  4   -62.12068468193       -4.64       -2.87    4.4    4.68s
  5   -62.12068535021       -6.18       -3.58    4.2    4.79s
  6   -62.12068537397       -7.62       -4.44    5.1    5.05s
  7   -62.12068537418       -9.67       -5.08    4.5    5.01s
  8   -62.12068537420      -10.91       -6.63    4.3    4.86s
  9   -62.12068537420      -13.67       -7.33    6.0    5.73s
     2    -6.212069e+01     5.338872e-08
 * time: 246.91515803337097
 * Status: success

 * Candidate solution
    Final objective value:     -6.212069e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 4.57e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.30e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.20e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.54e-09 ≰ 0.0e+00
    |g(x)|                 = 5.34e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   247  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

NaCl: 316.421168 seconds (543.58 M allocations: 186.899 GiB, 7.45% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T13:52:11.438
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.598598510980381)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314858306234                   -1.45    5.4    1.27s
  2   -2.314944605319       -4.06       -1.83    1.4    484ms
  3   -2.314966618859       -4.66       -3.53    3.4    813ms
  4   -2.314966807479       -6.72       -4.19    4.5    1.13s
  5   -2.314966807746       -9.57       -4.77    2.7    632ms
  6   -2.314966807766      -10.70       -6.10    3.0    728ms
  7   -2.314966807766      -12.47       -6.42    3.8    1.00s
  8   -2.314966807766      -14.35       -7.14    1.8    429ms
Iter     Function value   Gradient norm 
     0    -2.314967e+00     8.715982e-05
 * time: 3.1948089599609375e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314852924391                   -1.45    5.4    1.23s
  2   -2.314943994997       -4.04       -1.83    1.4    480ms
  3   -2.314966611479       -4.65       -3.54    3.3    803ms
  4   -2.314966814923       -6.69       -4.19    4.5    1.10s
  5   -2.314966815178       -9.59       -4.79    2.6    641ms
  6   -2.314966815197      -10.74       -6.07    2.9    721ms
  7   -2.314966815197      -12.54       -6.44    3.7    1.00s
  8   -2.314966815197      -14.65       -7.04    1.9    520ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314853704503                   -1.45    5.4    1.23s
  2   -2.314944310359       -4.04       -1.83    1.4    475ms
  3   -2.314966636906       -4.65       -3.53    3.4    803ms
  4   -2.314966814914       -6.75       -4.18    4.5    1.13s
  5   -2.314966815178       -9.58       -4.78    2.7    638ms
  6   -2.314966815197      -10.74       -6.11    3.0    703ms
  7   -2.314966815197      -12.47       -6.43    3.8    1.06s
  8   -2.314966815197      -14.21       -7.17    1.9    515ms
     1    -2.314967e+00     8.334575e-05
 * time: 39.71688103675842
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314854499200                   -1.45    5.7    1.40s
  2   -2.314944222352       -4.05       -1.83    1.5    513ms
  3   -2.314966728866       -4.65       -3.54    3.4    960ms
  4   -2.314966894585       -6.78       -4.18    4.6    853ms
  5   -2.314966894853       -9.57       -4.77    2.8    650ms
  6   -2.314966894874      -10.68       -6.10    3.1    713ms
  7   -2.314966894875      -12.45       -6.41    4.0    1.05s
  8   -2.314966894875      -14.45       -7.18    2.1    545ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314855338080                   -1.45    5.6    1.27s
  2   -2.314944464039       -4.05       -1.83    1.5    490ms
  3   -2.314966658978       -4.65       -3.52    3.5    804ms
  4   -2.314966894519       -6.63       -4.13    4.6    1.14s
  5   -2.314966894848       -9.48       -4.72    2.7    637ms
  6   -2.314966894874      -10.59       -6.11    3.1    718ms
  7   -2.314966894875      -12.38       -6.40    4.0    1.17s
  8   -2.314966894875      -14.57       -7.27    2.1    674ms
     2    -2.314967e+00     4.252837e-07
 * time: 79.9022889137268
 * Status: success

 * Candidate solution
    Final objective value:     -2.314967e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.90e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.51e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 7.97e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.44e-08 ≰ 0.0e+00
    |g(x)|                 = 4.25e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   80  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Al: 104.933264 seconds (94.24 M allocations: 26.350 GiB, 6.65% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T13:53:56.372
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.621058875879847)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.211764754270689e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70451425915                   -0.85    9.5    5.65s
  2   -73.71622004666       -1.93       -1.05    5.2    3.06s
  3   -73.72284968668       -2.18       -1.39    6.6    3.85s
  4   -73.72402452047       -2.93       -1.78    5.7    3.37s
  5   -73.72417344713       -3.83       -2.28    4.9    3.09s
  6   -73.72419033189       -4.77       -3.09    5.4    3.42s
  7   -73.72419037397       -7.38       -3.56    4.6    3.05s
  8   -73.72419038031       -8.20       -4.03    5.0    3.15s
  9   -73.72419037995   +   -9.44       -4.52    5.3    3.30s
 10   -73.72419038058       -9.19       -4.80    5.5    3.40s
 11   -73.72419038063      -10.38       -5.48    4.9    3.17s
 12   -73.72419038063      -11.85       -6.26    4.8    3.17s
 13   -73.72419038063      -12.70       -6.45    3.9    2.82s
 14   -73.72419038063   +  -12.62       -7.02    5.2    3.15s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.211764754270689e-8,1.3213948717715939e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.372419e+01     3.389502e-04
 * time: 3.814697265625e-5
┌ Warning: Negative ρcore detected: -3.2072639817091225e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70450771566                   -0.85    9.7    5.79s
  2   -73.71620275749       -1.93       -1.05    5.4    3.10s
  3   -73.72285109472       -2.18       -1.39    6.8    3.97s
  4   -73.72402475854       -2.93       -1.78    5.9    3.26s
  5   -73.72417357432       -3.83       -2.28    5.0    3.03s
  6   -73.72419044188       -4.77       -3.09    5.5    3.41s
  7   -73.72419047834       -7.44       -3.57    4.6    2.97s
  8   -73.72419048570       -8.13       -4.03    5.1    3.07s
  9   -73.72419048529   +   -9.39       -4.52    5.4    3.34s
 10   -73.72419048599       -9.16       -4.80    5.6    3.34s
 11   -73.72419048603      -10.36       -5.47    5.0    3.09s
 12   -73.72419048604      -11.70       -6.23    4.8    3.10s
 13   -73.72419048604      -12.85       -6.44    4.6    3.00s
 14   -73.72419048604   +  -12.57       -6.99    5.2    3.26s
 15   -73.72419048604      -13.85       -7.81    5.1    3.17s
┌ Warning: Negative ρcore detected: -3.2072639817091225e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70450697022                   -0.85    9.8    5.95s
  2   -73.71621719248       -1.93       -1.05    5.4    3.11s
  3   -73.72285072226       -2.18       -1.39    6.8    5.18s
  4   -73.72402400282       -2.93       -1.77    6.0    3.42s
  5   -73.72417334316       -3.83       -2.28    5.0    3.10s
  6   -73.72419044078       -4.77       -3.09    5.6    3.41s
  7   -73.72419047820       -7.43       -3.57    4.6    3.03s
  8   -73.72419048571       -8.12       -4.04    5.2    3.14s
  9   -73.72419048530   +   -9.39       -4.52    5.4    3.22s
 10   -73.72419048599       -9.16       -4.81    5.6    3.27s
 11   -73.72419048604      -10.38       -5.49    5.0    3.08s
 12   -73.72419048604      -11.81       -6.24    4.8    3.04s
 13   -73.72419048604      -12.85       -6.43    4.4    3.04s
 14   -73.72419048604   +  -12.62       -7.01    5.2    3.14s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.2072639817091225e-8,1.3343488202047032e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     1    -7.372419e+01     2.826361e-04
 * time: 154.9697391986847
┌ Warning: Negative ρcore detected: -3.1840156251990055e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70447280490                   -0.85    9.7    5.95s
  2   -73.71619475573       -1.93       -1.05    5.4    3.18s
  3   -73.72284722050       -2.18       -1.39    6.8    4.19s
  4   -73.72402428030       -2.93       -1.77    5.9    3.28s
  5   -73.72417349490       -3.83       -2.28    5.0    2.98s
  6   -73.72419068288       -4.76       -3.09    5.7    3.61s
  7   -73.72419072014       -7.43       -3.57    4.6    3.00s
  8   -73.72419072671       -8.18       -4.03    5.2    3.08s
  9   -73.72419072630   +   -9.39       -4.53    5.3    3.15s
 10   -73.72419072697       -9.18       -4.81    5.6    3.27s
 11   -73.72419072701      -10.39       -5.51    5.0    3.00s
 12   -73.72419072701      -11.83       -6.26    4.8    3.01s
 13   -73.72419072701      -12.70       -6.43    4.6    2.99s
 14   -73.72419072701   +  -12.67       -7.02    5.3    3.05s
┌ Warning: Negative ρcore detected: -3.1840156251990055e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70446710948                   -0.85    9.7    6.37s
  2   -73.71620438065       -1.93       -1.05    5.3    3.09s
  3   -73.72284669755       -2.18       -1.39    6.8    3.99s
  4   -73.72402471513       -2.93       -1.77    5.9    3.34s
  5   -73.72417378830       -3.83       -2.28    5.0    3.14s
  6   -73.72419068522       -4.77       -3.09    5.6    3.55s
  7   -73.72419071946       -7.47       -3.57    4.6    3.10s
  8   -73.72419072669       -8.14       -4.04    5.1    3.20s
  9   -73.72419072620   +   -9.31       -4.51    5.5    3.50s
 10   -73.72419072697       -9.11       -4.79    5.7    3.45s
 11   -73.72419072701      -10.41       -5.48    5.1    3.23s
 12   -73.72419072701      -11.71       -6.28    4.8    3.13s
 13   -73.72419072701      -12.89       -6.45    4.3    2.86s
 14   -73.72419072701   +  -12.73       -7.00    5.2    3.08s
 15   -73.72419072701   +  -13.07       -7.84    5.1    3.29s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1840156251990055e-8,1.39868967253043e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     2    -7.372419e+01     5.881503e-07
 * time: 309.3060791492462
 * Status: success

 * Candidate solution
    Final objective value:     -7.372419e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.70e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.03e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.41e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.27e-09 ≰ 0.0e+00
    |g(x)|                 = 5.88e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   309  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

V: 393.971737 seconds (348.16 M allocations: 200.377 GiB, 8.81% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T14:00:30.346
└   θ = ComponentVector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}(κ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.6405907876849236,1.0,0.0), μ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.1782316083398105,0.0,1.0))
┌ Info: 2025-05-20T14:00:30.351
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.296075350203544)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.442804287335                   -0.96    7.2    1.37s
  2   -8.444735064445       -2.71       -1.76    2.0    831ms
  3   -8.444802514842       -4.17       -2.85    3.9    908ms
  4   -8.444803220365       -6.15       -3.81    4.5    1.14s
  5   -8.444803231466       -7.95       -4.55    4.6    1.15s
  6   -8.444803231851       -9.42       -5.33    4.9    980ms
  7   -8.444803231857      -11.16       -6.22    3.8    951ms
  8   -8.444803231858      -12.88       -7.42    3.7    1.03s
Iter     Function value   Gradient norm 
     0    -8.444803e+00     1.713668e-07
 * time: 4.00543212890625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.444803e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.71e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.442793730908                   -0.96    7.0    1.51s
  2   -8.444737031455       -2.71       -1.76    2.2    664ms
  3   -8.444802513579       -4.18       -2.84    3.9    946ms
  4   -8.444803222227       -6.15       -3.82    4.4    1.14s
  5   -8.444803231514       -8.03       -4.57    4.6    979ms
  6   -8.444803231852       -9.47       -5.41    4.7    984ms
  7   -8.444803231857      -11.30       -6.22    3.8    1.06s
  8   -8.444803231858      -12.83       -7.48    3.8    867ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.15e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.50e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.45e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 8.21e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.75e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 6.34e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.70e-09
└ * number of operations = 8
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.442799027323                   -0.96    7.2    1.99s
  2   -8.444738198946       -2.71       -1.76    2.2    912ms
  3   -8.444802373109       -4.19       -2.84    3.8    1.00s
  4   -8.444803221800       -6.07       -3.80    4.4    1.14s
  5   -8.444803231515       -8.01       -4.58    4.6    987ms
  6   -8.444803231853       -9.47       -5.42    4.5    970ms
  7   -8.444803231857      -11.34       -6.25    3.9    1.12s
  8   -8.444803231858      -13.01       -7.42    3.6    857ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 6.85e-02
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.04e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.75e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.54e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 6.54e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 1.27e-08
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 1.03e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 5.31e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.68e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.18e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.60e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.50e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.46e-09
└ * number of operations = 8
Si: 171.992647 seconds (251.84 M allocations: 207.327 GiB, 10.05% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T14:03:22.345
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.619692867321067)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.11316090635                   -1.18    9.3    7.92s
  2   -62.11703447999       -2.41       -1.24    3.8    3.89s
  3   -62.12066161556       -2.44       -2.10    5.3    5.22s
  4   -62.12068471985       -4.64       -2.88    4.5    4.63s
  5   -62.12068535082       -6.20       -3.59    4.2    4.67s
  6   -62.12068537398       -7.64       -4.46    5.6    5.32s
  7   -62.12068537418       -9.69       -5.06    4.5    5.15s
  8   -62.12068537420      -10.89       -6.59    4.1    4.84s
  9   -62.12068537420      -13.45       -7.32    5.9    5.75s
Iter     Function value   Gradient norm 
     0    -6.212069e+01     5.784267e-08
 * time: 3.814697265625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.212069e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 5.78e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.11315832480                   -1.18    9.4    7.67s
  2   -62.11702425424       -2.41       -1.24    3.9    3.83s
  3   -62.12066169236       -2.44       -2.10    5.4    4.81s
  4   -62.12068470904       -4.64       -2.88    4.4    4.66s
  5   -62.12068535126       -6.19       -3.60    4.2    4.57s
  6   -62.12068537398       -7.64       -4.47    5.2    4.80s
  7   -62.12068537418       -9.69       -5.05    4.6    4.97s
  8   -62.12068537420      -10.88       -6.58    4.2    4.63s
  9   -62.12068537420      -13.07       -7.35    5.8    5.55s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.10e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.00e+00
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.96e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.10e-02
[ Info: GMRES linsolve in iteration 1; step 4: normres = 3.46e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 2.62e-05
[ Info: GMRES linsolve in iteration 1; step 6: normres = 6.52e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 3.05e-08
└ * number of operations = 9
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.11315657379                   -1.18    9.3    7.80s
  2   -62.11704799059       -2.41       -1.25    3.7    3.80s
  3   -62.12066139097       -2.44       -2.09    5.4    4.88s
  4   -62.12068467334       -4.63       -2.86    4.4    4.76s
  5   -62.12068534963       -6.17       -3.56    4.2    4.86s
  6   -62.12068537395       -7.61       -4.41    5.3    5.56s
  7   -62.12068537418       -9.64       -5.10    4.3    4.60s
  8   -62.12068537420      -10.91       -6.52    4.6    4.82s
  9   -62.12068537420      -13.37       -7.19    5.8    5.38s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 7.15e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.63e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.11e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.21e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.05e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 6.24e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 2.91e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 8.84e-09
└ * number of operations = 9
[ Info: GMRES linsolve starts with norm of residual = 2.86e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.06e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.07e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.69e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.14e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.53e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 3.07e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 1.31e-08
└ * number of operations = 9
NaCl: 1227.382522 seconds (965.39 M allocations: 1.285 TiB, 4.68% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T14:23:49.728
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.600590301524886)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314853368431                   -1.45    5.7    1.06s
  2   -2.314944086055       -4.04       -1.83    1.5    465ms
  3   -2.314966659588       -4.65       -3.54    3.5    807ms
  4   -2.314966894569       -6.63       -4.17    4.5    959ms
  5   -2.314966894851       -9.55       -4.75    2.8    657ms
  6   -2.314966894874      -10.64       -6.12    3.0    665ms
  7   -2.314966894875      -12.45       -6.41    4.0    881ms
  8   -2.314966894875      -14.45       -7.21    2.2    843ms
Iter     Function value   Gradient norm 
     0    -2.314967e+00     4.265445e-07
 * time: 3.314018249511719e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.314967e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 4.27e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314851601130                   -1.45    5.7    1.30s
  2   -2.314944389017       -4.03       -1.83    1.5    501ms
  3   -2.314966675041       -4.65       -3.55    3.5    834ms
  4   -2.314966894577       -6.66       -4.17    4.5    1.24s
  5   -2.314966894853       -9.56       -4.76    2.7    626ms
  6   -2.314966894874      -10.67       -6.07    3.0    678ms
  7   -2.314966894875      -12.40       -6.37    3.9    877ms
  8   -2.314966894875      -14.57       -7.05    2.1    768ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.90e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.61e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.04e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.69e-06
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 1.56e-08
└ * number of operations = 6
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314853766103                   -1.45    5.6    1.20s
  2   -2.314943844064       -4.05       -1.83    1.5    844ms
  3   -2.314966675357       -4.64       -3.52    3.5    730ms
  4   -2.314966894508       -6.66       -4.13    4.5    968ms
  5   -2.314966894849       -9.47       -4.72    2.8    701ms
  6   -2.314966894874      -10.60       -5.98    3.0    918ms
  7   -2.314966894875      -12.26       -6.34    3.8    782ms
  8   -2.314966894875      -14.65       -6.82    2.3    579ms
  9   -2.314966894875      -14.31       -7.58    2.2    581ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.55e-03
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.94e-05
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.58e-06
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.65e-08
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 2.08e-10
└ * number of operations = 6
[ Info: GMRES linsolve starts with norm of residual = 2.24e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.76e-03
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.43e-05
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.11e-07
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 4.68e-09
└ * number of operations = 6
Al: 154.286466 seconds (150.37 M allocations: 83.542 GiB, 7.01% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T14:26:24.016
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.6230989910812745)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.1840156251990055e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70447078584                   -0.85    9.8    5.94s
  2   -73.71619726748       -1.93       -1.05    5.3    3.12s
  3   -73.72284677063       -2.18       -1.39    6.8    4.12s
  4   -73.72402431693       -2.93       -1.77    5.9    3.29s
  5   -73.72417361059       -3.83       -2.28    5.0    3.04s
  6   -73.72419068433       -4.77       -3.09    5.6    3.47s
  7   -73.72419072008       -7.45       -3.57    4.6    2.96s
  8   -73.72419072670       -8.18       -4.03    5.0    3.02s
  9   -73.72419072627   +   -9.37       -4.52    5.4    3.17s
 10   -73.72419072697       -9.16       -4.80    5.6    3.28s
 11   -73.72419072701      -10.39       -5.48    5.0    3.07s
 12   -73.72419072701      -11.71       -6.26    4.9    3.09s
 13   -73.72419072701      -12.89       -6.45    4.1    2.82s
 14   -73.72419072701   +  -12.64       -7.01    5.2    3.08s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1840156251990055e-8,1.39868967253043e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.372419e+01     4.229661e-07
 * time: 3.790855407714844e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.372419e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 4.23e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.1840156251990055e-8,1.39868967253043e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.1840156251990055e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70446264128                   -0.85    9.8    5.76s
  2   -73.71620427259       -1.93       -1.05    5.4    3.08s
  3   -73.72284784524       -2.18       -1.39    6.8    3.97s
  4   -73.72402400061       -2.93       -1.77    5.9    3.37s
  5   -73.72417388201       -3.82       -2.28    5.1    2.84s
  6   -73.72419068408       -4.77       -3.09    5.6    3.41s
  7   -73.72419071989       -7.45       -3.57    4.5    2.96s
  8   -73.72419072672       -8.17       -4.04    5.2    3.17s
  9   -73.72419072623   +   -9.31       -4.51    5.4    3.10s
 10   -73.72419072697       -9.13       -4.81    5.6    3.43s
 11   -73.72419072701      -10.39       -5.50    5.0    3.10s
 12   -73.72419072701      -11.78       -6.27    4.8    3.07s
 13   -73.72419072701      -13.37       -6.45    4.5    2.75s
 14   -73.72419072701   +  -12.81       -7.02    5.2    3.01s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.38e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.01e+01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.36e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 7.05e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 8.38e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 7.18e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 7.75e-08
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}(Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.184015587518943e-8,1.3986896724672903e-7),Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(1.3986896724672903e-7,3.7491303207134064e-6))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Computing cross-derivative ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.1840156251990055e-8,0.0,0.0)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.1840156251990055e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70447098442                   -0.85    9.8    5.87s
  2   -73.71619047717       -1.93       -1.05    5.3    3.12s
  3   -73.72284975216       -2.18       -1.39    6.8    4.05s
  4   -73.72402348500       -2.93       -1.77    5.9    3.18s
  5   -73.72417384147       -3.82       -2.28    5.0    3.13s
  6   -73.72419068594       -4.77       -3.09    5.5    3.34s
  7   -73.72419071975       -7.47       -3.57    4.5    2.80s
  8   -73.72419072669       -8.16       -4.03    5.1    3.16s
  9   -73.72419072627   +   -9.38       -4.52    5.4    3.30s
 10   -73.72419072697       -9.16       -4.80    5.7    3.17s
 11   -73.72419072701      -10.37       -5.48    4.9    3.21s
 12   -73.72419072701      -11.67       -6.27    4.8    2.93s
 13   -73.72419072701      -12.64       -6.46    4.3    2.71s
 14   -73.72419072701   +  -12.70       -7.00    5.2    3.07s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.45e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 8.06e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.60e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.06e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 9.81e-06
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 8.63e-08
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 4.91e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.41e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.23e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 8.63e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.35e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.12e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 5.84e-09
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}, KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.184015587518943e-8,0.0,0.0),Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(1.3986896719962894e-7,0.0,0.0))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
V: 735.729506 seconds (597.44 M allocations: 813.165 GiB, 7.21% gc time, 0.00% compilation time)
     3     9.424721e-05     1.718044e-04
 * Current step size: 1.0
 * time: 10020.303649902344
 * g(x): (κ = 0.00017180435865201627, μ = -0.00016802730450541726)
 * ~inv(H): [32.162848836163164 34.02524546767947; 34.025245467679476 38.996371897721936]
 * x: (κ = 0.6405907876849236, μ = 0.1782316083398105)
┌ Info: 2025-05-20T14:38:39.748
└   θ = ComponentVector{Float64}(κ = 0.6407822403492742, μ = 0.17893837811972343)
┌ Info: 2025-05-20T14:38:39.748
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.296075350203544)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.443080642752                   -0.96    7.1    1.26s
  2   -8.445013079254       -2.71       -1.76    2.2    633ms
  3   -8.445079709494       -4.18       -2.84    3.9    1.10s
  4   -8.445080394350       -6.16       -3.83    4.5    994ms
  5   -8.445080404543       -7.99       -4.53    4.5    983ms
  6   -8.445080404937       -9.40       -5.33    4.6    1.08s
  7   -8.445080404945      -11.11       -6.17    3.7    873ms
  8   -8.445080404945      -12.80       -7.54    3.7    950ms
Iter     Function value   Gradient norm 
     0    -8.445080e+00     3.859459e-05
 * time: 3.600120544433594e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.443066904669                   -0.96    7.1    1.40s
  2   -8.445014266844       -2.71       -1.76    2.2    893ms
  3   -8.445079583778       -4.18       -2.84    3.9    992ms
  4   -8.445080396402       -6.09       -3.81    4.4    1.06s
  5   -8.445080406043       -8.02       -4.59    4.5    1.17s
  6   -8.445080406377       -9.48       -5.45    4.8    992ms
  7   -8.445080406381      -11.40       -6.30    3.9    1.01s
  8   -8.445080406381      -13.02       -7.46    3.8    1.23s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.443084763496                   -0.96    7.0    1.56s
  2   -8.445014458521       -2.71       -1.76    2.1    667ms
  3   -8.445079587150       -4.19       -2.84    3.7    1.10s
  4   -8.445080396857       -6.09       -3.81    4.5    980ms
  5   -8.445080406051       -8.04       -4.58    4.5    1.01s
  6   -8.445080406376       -9.49       -5.43    4.7    1.15s
  7   -8.445080406381      -11.36       -6.23    3.8    1.24s
  8   -8.445080406381      -12.91       -7.46    3.7    972ms
     1    -8.445080e+00     3.580487e-05
 * time: 27.868999004364014
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.443065358927                   -0.96    7.2    1.45s
  2   -8.445009475682       -2.71       -1.76    2.1    698ms
  3   -8.445079653425       -4.15       -2.84    3.9    956ms
  4   -8.445080404950       -6.12       -3.82    4.4    1.12s
  5   -8.445080414887       -8.00       -4.56    4.5    1.17s
  6   -8.445080415251       -9.44       -5.38    4.7    1.11s
  7   -8.445080415257      -11.22       -6.20    3.8    941ms
  8   -8.445080415257      -12.84       -7.48    3.7    995ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.443078628925                   -0.96    6.9    1.59s
  2   -8.445014257615       -2.71       -1.76    2.1    615ms
  3   -8.445079457861       -4.19       -2.85    3.7    926ms
  4   -8.445080405508       -6.02       -3.78    4.4    1.16s
  5   -8.445080414973       -8.02       -4.63    4.5    997ms
  6   -8.445080415255       -9.55       -5.50    4.9    1.03s
  7   -8.445080415257      -11.56       -6.34    3.7    1.02s
  8   -8.445080415257      -13.13       -7.39    3.8    873ms
     2    -8.445080e+00     3.111603e-08
 * time: 55.326382875442505
 * Status: success

 * Candidate solution
    Final objective value:     -8.445080e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 4.95e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.81e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 8.88e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.05e-09 ≰ 0.0e+00
    |g(x)|                 = 3.11e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   55  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Si: 71.265371 seconds (141.29 M allocations: 40.683 GiB, 9.59% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T14:39:51.014
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.619692867321067)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.11487388274                   -1.18    9.3    8.87s
  2   -62.11875919451       -2.41       -1.24    3.8    4.40s
  3   -62.12238673492       -2.44       -2.10    5.3    5.04s
  4   -62.12240986990       -4.64       -2.87    4.6    4.57s
  5   -62.12241052858       -6.18       -3.59    4.1    4.60s
  6   -62.12241055172       -7.64       -4.46    5.4    5.02s
  7   -62.12241055192       -9.70       -5.09    4.5    4.77s
  8   -62.12241055193      -10.94       -6.65    4.4    4.77s
  9   -62.12241055193      -13.45       -7.27    6.1    5.66s
Iter     Function value   Gradient norm 
     0    -6.212241e+01     1.863075e-05
 * time: 4.291534423828125e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.11487195401                   -1.18    9.3    7.90s
  2   -62.11874456507       -2.41       -1.24    3.6    3.85s
  3   -62.12238677736       -2.44       -2.10    5.4    5.04s
  4   -62.12240991680       -4.64       -2.89    4.6    4.89s
  5   -62.12241052964       -6.21       -3.61    4.2    4.88s
  6   -62.12241055207       -7.65       -4.48    5.5    5.32s
  7   -62.12241055226       -9.72       -5.03    4.6    4.87s
  8   -62.12241055227      -10.88       -6.52    4.2    4.65s
  9   -62.12241055227      -13.25       -7.31    5.6    5.32s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.11487201234                   -1.18    9.3    7.76s
  2   -62.11875739501       -2.41       -1.24    3.5    3.73s
  3   -62.12238655451       -2.44       -2.10    5.4    4.87s
  4   -62.12240984094       -4.63       -2.86    4.5    4.61s
  5   -62.12241052765       -6.16       -3.57    4.2    4.74s
  6   -62.12241055201       -7.61       -4.41    5.4    5.11s
  7   -62.12241055226       -9.61       -5.05    4.3    4.88s
  8   -62.12241055227      -10.85       -6.58    4.5    4.98s
  9   -62.12241055227      -13.15       -7.17    5.9    5.57s
     1    -6.212241e+01     1.823821e-05
 * time: 124.32194876670837
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.11486410053                   -1.18    9.1    7.69s
  2   -62.11874022555       -2.41       -1.24    3.8    3.83s
  3   -62.12238690003       -2.44       -2.10    5.6    5.03s
  4   -62.12240988449       -4.64       -2.88    4.5    4.91s
  5   -62.12241053731       -6.19       -3.60    4.2    4.65s
  6   -62.12241055996       -7.64       -4.47    5.3    4.86s
  7   -62.12241056016       -9.70       -5.02    4.5    5.03s
  8   -62.12241056017      -10.82       -6.57    4.1    4.87s
  9   -62.12241056017   +    -Inf       -7.31    5.6    5.56s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.11486264990                   -1.18    9.3    7.79s
  2   -62.11874061728       -2.41       -1.24    3.7    3.89s
  3   -62.12238676260       -2.44       -2.10    5.6    5.16s
  4   -62.12240986989       -4.64       -2.87    4.4    4.71s
  5   -62.12241053703       -6.18       -3.60    4.3    4.83s
  6   -62.12241055996       -7.64       -4.47    5.3    5.07s
  7   -62.12241056016       -9.71       -5.02    4.6    5.02s
  8   -62.12241056017      -10.84       -6.49    4.1    4.72s
  9   -62.12241056018      -12.97       -7.22    5.5    5.54s
     2    -6.212241e+01     1.045863e-08
 * time: 244.85404586791992
 * Status: success

 * Candidate solution
    Final objective value:     -6.212241e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 8.66e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 8.15e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 7.90e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.27e-10 ≰ 0.0e+00
    |g(x)|                 = 1.05e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   245  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

NaCl: 316.649313 seconds (547.44 M allocations: 187.428 GiB, 7.06% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T14:45:07.664
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.600590301524886)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314891682996                   -1.45    5.7    1.21s
  2   -2.314983676004       -4.04       -1.83    1.5    601ms
  3   -2.315006190815       -4.65       -3.53    3.5    769ms
  4   -2.315006368645       -6.75       -4.17    4.5    1.12s
  5   -2.315006368935       -9.54       -4.74    2.7    631ms
  6   -2.315006368959      -10.62       -6.05    3.1    667ms
  7   -2.315006368959      -12.35       -6.37    3.9    995ms
  8   -2.315006368959      -14.18       -7.15    2.2    540ms
Iter     Function value   Gradient norm 
     0    -2.315006e+00     2.204115e-05
 * time: 2.5033950805664062e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314896274644                   -1.45    5.6    1.07s
  2   -2.314983825702       -4.06       -1.83    1.5    499ms
  3   -2.315006113722       -4.65       -3.54    3.5    1.02s
  4   -2.315006369111       -6.59       -4.15    4.6    938ms
  5   -2.315006369410       -9.52       -4.72    2.8    689ms
  6   -2.315006369434      -10.61       -6.09    3.0    920ms
  7   -2.315006369435      -12.27       -6.37    4.0    806ms
  8   -2.315006369435      -14.31       -7.15    2.2    551ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314890511034                   -1.45    5.6    1.30s
  2   -2.314983236749       -4.03       -1.83    1.5    484ms
  3   -2.315006164554       -4.64       -3.54    3.5    799ms
  4   -2.315006369132       -6.69       -4.17    4.5    1.13s
  5   -2.315006369412       -9.55       -4.76    2.7    633ms
  6   -2.315006369434      -10.66       -6.07    3.0    720ms
  7   -2.315006369435      -12.43       -6.39    3.9    1.05s
  8   -2.315006369435      -14.40       -7.07    2.1    619ms
     1    -2.315006e+00     2.108887e-05
 * time: 40.599847078323364
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314893225968                   -1.45    5.5    1.11s
  2   -2.314983817355       -4.04       -1.83    1.3    436ms
  3   -2.315006133954       -4.65       -3.54    3.4    926ms
  4   -2.315006374274       -6.62       -4.17    4.5    931ms
  5   -2.315006374547       -9.56       -4.75    2.6    648ms
  6   -2.315006374569      -10.66       -6.09    2.9    858ms
  7   -2.315006374569      -12.50       -6.39    3.9    773ms
  8   -2.315006374569      -14.51       -7.11    2.1    529ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314894261108                   -1.45    5.5    1.16s
  2   -2.314983197730       -4.05       -1.83    1.4    452ms
  3   -2.315006133587       -4.64       -3.52    3.3    744ms
  4   -2.315006374179       -6.62       -4.11    4.5    1.07s
  5   -2.315006374539       -9.44       -4.70    2.7    610ms
  6   -2.315006374569      -10.53       -5.92    3.0    667ms
  7   -2.315006374569      -12.26       -6.27    3.7    979ms
  8   -2.315006374569      -14.40       -6.75    2.1    555ms
  9   -2.315006374569      -14.88       -7.51    2.2    560ms
     2    -2.315006e+00     4.127348e-08
 * time: 80.18812894821167
 * Status: success

 * Candidate solution
    Final objective value:     -2.315006e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 4.88e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 6.42e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 5.13e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.22e-09 ≰ 0.0e+00
    |g(x)|                 = 4.13e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   80  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Al: 105.530620 seconds (95.64 M allocations: 26.881 GiB, 5.48% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T14:46:53.196
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.6230989910812745)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.1840156251990055e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70579755516                   -0.85    9.8    5.28s
  2   -73.71748129586       -1.93       -1.05    5.3    2.94s
  3   -73.72411744419       -2.18       -1.39    6.8    3.80s
  4   -73.72529133618       -2.93       -1.77    5.8    3.17s
  5   -73.72544032882       -3.83       -2.28    5.1    3.11s
  6   -73.72545720383       -4.77       -3.09    5.5    3.72s
  7   -73.72545723899       -7.45       -3.57    4.6    2.95s
  8   -73.72545724586       -8.16       -4.03    5.1    3.16s
  9   -73.72545724544   +   -9.37       -4.51    5.4    3.36s
 10   -73.72545724614       -9.16       -4.80    5.7    3.45s
 11   -73.72545724618      -10.37       -5.48    5.1    3.09s
 12   -73.72545724618      -11.71       -6.25    4.8    3.13s
 13   -73.72545724618      -12.73       -6.45    4.2    2.75s
 14   -73.72545724618   +  -12.64       -7.00    5.2    3.14s
 15   -73.72545724618   +  -13.25       -7.86    5.1    3.53s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1840156251990055e-8,1.39868967253043e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.372546e+01     7.754906e-05
 * time: 3.600120544433594e-5
┌ Warning: Negative ρcore detected: -3.1829298329611115e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70579071594                   -0.85    9.7    5.97s
  2   -73.71747964206       -1.93       -1.05    5.4    3.21s
  3   -73.72411921834       -2.18       -1.39    6.7    4.06s
  4   -73.72529125895       -2.93       -1.78    5.9    3.44s
  5   -73.72543990271       -3.83       -2.27    5.0    3.14s
  6   -73.72545720636       -4.76       -3.09    5.5    3.47s
  7   -73.72545724418       -7.42       -3.56    4.7    3.06s
  8   -73.72545725137       -8.14       -4.03    5.1    3.14s
  9   -73.72545725100   +   -9.44       -4.53    5.3    3.37s
 10   -73.72545725165       -9.19       -4.80    5.6    3.41s
 11   -73.72545725170      -10.36       -5.49    5.0    3.19s
 12   -73.72545725170      -11.74       -6.23    4.8    3.21s
 13   -73.72545725170      -12.70       -6.43    4.7    3.74s
 14   -73.72545725170   +  -12.55       -6.99    5.3    3.94s
 15   -73.72545725170   +  -13.00       -7.82    5.1    3.34s
┌ Warning: Negative ρcore detected: -3.1829298329611115e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70579732453                   -0.85    9.6    6.02s
  2   -73.71747483024       -1.93       -1.05    5.3    3.51s
  3   -73.72411861337       -2.18       -1.39    6.7    4.22s
  4   -73.72529086283       -2.93       -1.77    5.8    3.31s
  5   -73.72544006876       -3.83       -2.28    4.9    3.19s
  6   -73.72545720754       -4.77       -3.09    5.5    3.75s
  7   -73.72545724505       -7.43       -3.56    4.6    3.78s
  8   -73.72545725138       -8.20       -4.03    5.1    3.18s
  9   -73.72545725102   +   -9.44       -4.53    5.3    3.23s
 10   -73.72545725165       -9.20       -4.80    5.6    3.34s
 11   -73.72545725170      -10.36       -5.50    5.0    3.07s
 12   -73.72545725170      -11.81       -6.25    4.8    3.08s
 13   -73.72545725170      -12.77       -6.44    4.6    3.10s
 14   -73.72545725170   +  -12.89       -7.02    5.2    3.08s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1829298329611115e-8,1.4015959237562942e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     1    -7.372546e+01     6.453677e-05
 * time: 158.1157009601593
┌ Warning: Negative ρcore detected: -3.177511347999523e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70579550871                   -0.85    9.7    6.00s
  2   -73.71748090585       -1.93       -1.05    5.3    3.18s
  3   -73.72411605539       -2.18       -1.39    6.8    4.16s
  4   -73.72529090049       -2.93       -1.77    5.8    3.48s
  5   -73.72544000751       -3.83       -2.28    4.9    3.97s
  6   -73.72545722033       -4.76       -3.09    5.6    3.46s
  7   -73.72545725751       -7.43       -3.57    4.6    3.04s
  8   -73.72545726402       -8.19       -4.03    5.2    3.19s
  9   -73.72545726359   +   -9.37       -4.52    5.3    3.26s
 10   -73.72545726428       -9.16       -4.80    5.6    3.35s
 11   -73.72545726432      -10.40       -5.50    5.0    3.16s
 12   -73.72545726433      -11.79       -6.27    4.8    3.31s
 13   -73.72545726433      -12.73       -6.45    4.2    2.91s
 14   -73.72545726433   +  -12.62       -7.01    5.2    3.12s
┌ Warning: Negative ρcore detected: -3.177511347999523e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70577712676                   -0.85    9.7    5.71s
  2   -73.71748874032       -1.93       -1.05    5.4    3.12s
  3   -73.72411610695       -2.18       -1.39    6.8    4.02s
  4   -73.72529137611       -2.93       -1.77    5.8    3.26s
  5   -73.72544018862       -3.83       -2.28    5.0    3.08s
  6   -73.72545721869       -4.77       -3.09    5.5    3.35s
  7   -73.72545725710       -7.42       -3.57    4.5    2.90s
  8   -73.72545726402       -8.16       -4.03    5.2    3.18s
  9   -73.72545726357   +   -9.35       -4.52    5.3    3.28s
 10   -73.72545726428       -9.15       -4.81    5.6    3.44s
 11   -73.72545726432      -10.39       -5.50    5.0    3.12s
 12   -73.72545726433      -11.81       -6.25    4.8    3.15s
 13   -73.72545726433      -13.15       -6.43    4.6    3.15s
 14   -73.72545726433   +  -12.77       -7.01    5.2    3.15s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.177511347999523e-8,1.41597545408816e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     2    -7.372546e+01     8.066232e-07
 * time: 311.4948890209198
 * Status: success

 * Candidate solution
    Final objective value:     -7.372546e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.85e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 6.84e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.26e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.71e-10 ≰ 0.0e+00
    |g(x)|                 = 8.07e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   311  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

V: 401.426183 seconds (348.85 M allocations: 200.540 GiB, 8.52% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T14:53:34.625
└   θ = ComponentVector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}(κ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.6407822403492742,1.0,0.0), μ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.17893837811972343,0.0,1.0))
┌ Info: 2025-05-20T14:53:34.631
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.296609290515747)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.443084845916                   -0.96    7.1    1.30s
  2   -8.445014948774       -2.71       -1.76    2.2    823ms
  3   -8.445079567690       -4.19       -2.85    3.7    882ms
  4   -8.445080405563       -6.08       -3.80    4.4    1.01s
  5   -8.445080414938       -8.03       -4.60    4.6    1.13s
  6   -8.445080415253       -9.50       -5.45    4.6    941ms
  7   -8.445080415257      -11.42       -6.27    3.8    918ms
  8   -8.445080415257      -12.99       -7.44    3.8    1.03s
Iter     Function value   Gradient norm 
     0    -8.445080e+00     3.138106e-08
 * time: 3.695487976074219e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.445080e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.14e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.443086826748                   -0.96    7.1    1.52s
  2   -8.445012902805       -2.72       -1.76    2.2    676ms
  3   -8.445079510573       -4.18       -2.85    3.8    970ms
  4   -8.445080405555       -6.05       -3.80    4.4    1.15s
  5   -8.445080414937       -8.03       -4.59    4.4    1.06s
  6   -8.445080415253       -9.50       -5.43    4.7    1.34s
  7   -8.445080415257      -11.37       -6.24    3.8    1.05s
  8   -8.445080415257      -12.91       -7.42    3.7    859ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.14e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.50e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.45e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 8.21e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.75e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 6.37e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.69e-09
└ * number of operations = 8
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.443075263214                   -0.96    7.1    1.62s
  2   -8.445010560928       -2.71       -1.76    2.0    653ms
  3   -8.445079495682       -4.16       -2.85    3.8    996ms
  4   -8.445080405361       -6.04       -3.80    4.5    1.19s
  5   -8.445080414900       -8.02       -4.57    4.5    973ms
  6   -8.445080415253       -9.45       -5.40    4.6    1.02s
  7   -8.445080415257      -11.33       -6.21    3.8    1.12s
  8   -8.445080415257      -12.86       -7.45    3.6    868ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 6.89e-02
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.05e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.77e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.55e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 6.55e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 1.27e-08
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 1.03e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 5.30e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.66e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.17e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.58e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.49e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.42e-09
└ * number of operations = 8
Si: 172.425858 seconds (251.32 M allocations: 206.986 GiB, 9.83% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T14:56:27.057
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.620577133076107)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.11486195846                   -1.18    9.3    7.60s
  2   -62.11874422178       -2.41       -1.24    3.9    3.90s
  3   -62.12238670370       -2.44       -2.10    5.7    5.13s
  4   -62.12240985711       -4.64       -2.87    4.5    4.72s
  5   -62.12241053691       -6.17       -3.59    4.1    4.73s
  6   -62.12241055996       -7.64       -4.47    5.4    5.06s
  7   -62.12241056016       -9.70       -5.06    4.6    4.99s
  8   -62.12241056017      -10.90       -6.59    4.2    4.75s
  9   -62.12241056017      -13.30       -7.26    5.8    5.66s
Iter     Function value   Gradient norm 
     0    -6.212241e+01     1.081936e-08
 * time: 3.3855438232421875e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.212241e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.08e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.11486117611                   -1.18    9.2    9.61s
  2   -62.11875097442       -2.41       -1.24    3.7    3.98s
  3   -62.12238665600       -2.44       -2.10    5.6    5.05s
  4   -62.12240986482       -4.63       -2.87    4.5    4.75s
  5   -62.12241053644       -6.17       -3.58    4.2    4.72s
  6   -62.12241055994       -7.63       -4.44    5.1    4.77s
  7   -62.12241056016       -9.65       -5.03    4.4    4.99s
  8   -62.12241056017      -10.85       -6.62    4.3    4.76s
  9   -62.12241056018      -13.03       -7.24    6.0    5.63s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.10e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.00e+00
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.96e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.10e-02
[ Info: GMRES linsolve in iteration 1; step 4: normres = 3.44e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 2.60e-05
[ Info: GMRES linsolve in iteration 1; step 6: normres = 6.50e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 3.75e-08
└ * number of operations = 9
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.11485816227                   -1.18    9.3    7.89s
  2   -62.11874814830       -2.41       -1.24    3.6    3.87s
  3   -62.12238673888       -2.44       -2.10    5.5    5.00s
  4   -62.12240984801       -4.64       -2.87    4.5    4.65s
  5   -62.12241053652       -6.16       -3.58    4.2    4.64s
  6   -62.12241055995       -7.63       -4.45    5.3    4.95s
  7   -62.12241056016       -9.67       -5.04    4.4    4.51s
  8   -62.12241056017      -10.85       -6.60    4.1    4.62s
  9   -62.12241056017      -13.45       -7.26    5.9    5.37s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 7.18e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.64e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.13e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.21e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.05e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 6.25e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 2.91e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 8.65e-09
└ * number of operations = 9
[ Info: GMRES linsolve starts with norm of residual = 2.85e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.04e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.07e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.67e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.18e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.61e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 3.00e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 1.24e-08
└ * number of operations = 9
NaCl: 1221.429397 seconds (956.35 M allocations: 1.284 TiB, 4.63% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T15:16:48.488
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.601100458744493)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314890540570                   -1.45    5.4    1.22s
  2   -2.314983803649       -4.03       -1.83    1.5    481ms
  3   -2.315006159458       -4.65       -3.54    3.4    859ms
  4   -2.315006374253       -6.67       -4.16    4.4    1.21s
  5   -2.315006374546       -9.53       -4.74    2.7    622ms
  6   -2.315006374569      -10.64       -6.03    3.0    674ms
  7   -2.315006374569      -12.39       -6.34    3.9    1.07s
  8   -2.315006374569      -14.51       -6.97    2.1    518ms
  9   -2.315006374569      -15.05       -7.60    2.5    588ms
Iter     Function value   Gradient norm 
     0    -2.315006e+00     4.196962e-08
 * time: 2.8133392333984375e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.315006e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 4.20e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314895324422                   -1.45    5.5    1.28s
  2   -2.314983587356       -4.05       -1.83    1.4    514ms
  3   -2.315006157862       -4.65       -3.52    3.4    754ms
  4   -2.315006374179       -6.66       -4.12    4.5    1.08s
  5   -2.315006374537       -9.45       -4.70    2.6    647ms
  6   -2.315006374568      -10.51       -5.91    3.0    662ms
  7   -2.315006374569      -12.24       -6.27    3.6    805ms
  8   -2.315006374569      -14.35       -6.77    2.0    713ms
  9   -2.315006374569      -15.35       -7.51    2.2    539ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.91e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.61e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.03e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.75e-06
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 1.59e-08
└ * number of operations = 6
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314890227802                   -1.45    5.5    1.13s
  2   -2.314983711796       -4.03       -1.83    1.4    680ms
  3   -2.315006059481       -4.65       -3.56    3.4    888ms
  4   -2.315006374240       -6.50       -4.14    4.6    976ms
  5   -2.315006374541       -9.52       -4.71    2.6    662ms
  6   -2.315006374569      -10.56       -6.07    2.9    875ms
  7   -2.315006374569      -12.30       -6.34    3.9    783ms
  8   -2.315006374569      -14.24       -7.06    2.1    558ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.57e-03
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.96e-05
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.60e-06
┌ Info: GMRES linsolve converged at iteration 1, step 3:
│ * norm of residual = 4.73e-08
└ * number of operations = 5
[ Info: GMRES linsolve starts with norm of residual = 2.25e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.77e-03
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.61e-05
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.35e-07
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 4.79e-09
└ * number of operations = 6
Al: 142.312819 seconds (145.88 M allocations: 80.254 GiB, 7.25% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T15:19:10.802
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.623561158323459)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.177511347999523e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70576945772                   -0.85    9.8    5.79s
  2   -73.71747587872       -1.93       -1.05    5.4    3.13s
  3   -73.72411925644       -2.18       -1.39    6.9    4.05s
  4   -73.72529097471       -2.93       -1.77    5.9    3.42s
  5   -73.72543999294       -3.83       -2.28    5.0    3.15s
  6   -73.72545722168       -4.76       -3.09    5.5    3.55s
  7   -73.72545725740       -7.45       -3.56    4.5    3.11s
  8   -73.72545726400       -8.18       -4.03    5.1    3.11s
  9   -73.72545726361   +   -9.40       -4.52    5.4    3.24s
 10   -73.72545726428       -9.17       -4.80    5.6    3.34s
 11   -73.72545726432      -10.39       -5.48    4.9    3.07s
 12   -73.72545726433      -11.73       -6.28    4.8    3.16s
 13   -73.72545726433      -12.89       -6.46    3.9    2.73s
 14   -73.72545726433   +  -12.85       -7.01    5.2    3.12s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.177511347999523e-8,1.41597545408816e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.372546e+01     8.077400e-07
 * time: 3.981590270996094e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.372546e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 8.08e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.177511347999523e-8,1.41597545408816e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.177511347999523e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70578996486                   -0.85    9.7    5.87s
  2   -73.71747120698       -1.93       -1.05    5.4    3.12s
  3   -73.72411735305       -2.18       -1.39    6.8    4.01s
  4   -73.72529078089       -2.93       -1.77    5.9    3.49s
  5   -73.72544030760       -3.83       -2.28    5.0    2.82s
  6   -73.72545722101       -4.77       -3.09    5.6    3.32s
  7   -73.72545725737       -7.44       -3.57    4.6    2.91s
  8   -73.72545726402       -8.18       -4.03    5.1    3.11s
  9   -73.72545726357   +   -9.35       -4.52    5.4    3.16s
 10   -73.72545726428       -9.15       -4.81    5.5    3.35s
 11   -73.72545726432      -10.35       -5.50    5.0    3.14s
 12   -73.72545726433      -11.76       -6.27    4.9    3.18s
 13   -73.72545726433      -12.94       -6.45    4.7    2.82s
 14   -73.72545726433   +  -12.64       -7.00    5.3    3.12s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.38e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.01e+01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.36e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 7.00e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 8.32e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 7.23e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 8.03e-08
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}(Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.1775113762560864e-8,1.4159754567256318e-7),Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(1.415975454370918e-7,3.7311840116866063e-6))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Computing cross-derivative ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.177511347999523e-8,0.0,0.0)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.177511347999523e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70579077676                   -0.85    9.7    5.32s
  2   -73.71748154728       -1.93       -1.05    5.3    3.05s
  3   -73.72411659006       -2.18       -1.39    6.8    3.94s
  4   -73.72529118120       -2.93       -1.77    5.8    3.16s
  5   -73.72544007287       -3.83       -2.28    4.9    3.23s
  6   -73.72545721990       -4.77       -3.09    5.5    3.37s
  7   -73.72545725727       -7.43       -3.57    4.7    2.90s
  8   -73.72545726401       -8.17       -4.03    5.1    3.13s
  9   -73.72545726358   +   -9.36       -4.52    5.3    3.20s
 10   -73.72545726428       -9.15       -4.80    5.6    3.07s
 11   -73.72545726432      -10.39       -5.49    5.0    3.26s
 12   -73.72545726433      -11.81       -6.24    4.8    4.09s
 13   -73.72545726433      -12.89       -6.42    4.8    2.87s
 14   -73.72545726433   +  -12.73       -7.00    5.2    4.18s
 15   -73.72545726433   +  -13.00       -7.81    5.1    3.20s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.48e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 8.11e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.61e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.07e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 9.79e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 8.64e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.40e-09
└ * number of operations = 8
[ Info: GMRES linsolve starts with norm of residual = 4.90e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.41e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.25e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 8.68e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.34e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.12e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 2.34e-09
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}, KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.1775113762560864e-8,0.0,0.0),Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(1.4159754538999754e-7,0.0,0.0))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
V: 779.594220 seconds (614.32 M allocations: 868.825 GiB, 7.23% gc time, 0.00% compilation time)
     4     9.417132e-05     1.754743e-04
 * Current step size: 1.0
 * time: 13230.95471906662
 * g(x): (κ = 0.000175474342686857, μ = -0.00015591909836025985)
 * ~inv(H): [18.126619207792935 10.3176523222899; 10.31765232228991 55.24386953723995]
 * x: (κ = 0.6407822403492742, μ = 0.17893837811972343)
┌ Info: 2025-05-20T15:32:10.399
└   θ = ComponentVector{Float64}(κ = 0.6392102028059379, μ = 0.18574146918857637)
┌ Info: 2025-05-20T15:32:10.399
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.296609290515747)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.445717322532                   -0.96    7.1    1.34s
  2   -8.447643933364       -2.72       -1.75    2.2    643ms
  3   -8.447710919562       -4.17       -2.84    3.8    928ms
  4   -8.447711692561       -6.11       -3.84    4.3    1.01s
  5   -8.447711701963       -8.03       -4.55    4.6    1.19s
  6   -8.447711702327       -9.44       -5.35    4.7    1.02s
  7   -8.447711702333      -11.18       -6.18    3.8    1.11s
  8   -8.447711702334      -12.80       -7.54    3.7    889ms
Iter     Function value   Gradient norm 
     0    -8.447712e+00     3.535369e-04
 * time: 3.2901763916015625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.445707108572                   -0.96    7.0    1.49s
  2   -8.447645068707       -2.71       -1.75    2.1    677ms
  3   -8.447710900043       -4.18       -2.84    3.7    1.11s
  4   -8.447711813500       -6.04       -3.81    4.3    964ms
  5   -8.447711822469       -8.05       -4.58    4.5    1.04s
  6   -8.447711822802       -9.48       -5.40    4.6    1.12s
  7   -8.447711822807      -11.29       -6.23    3.9    897ms
  8   -8.447711822807      -12.92       -7.45    3.6    970ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.445716694155                   -0.96    6.9    1.53s
  2   -8.447644669578       -2.71       -1.75    2.2    681ms
  3   -8.447711087166       -4.18       -2.84    3.8    1.22s
  4   -8.447711812145       -6.14       -3.83    4.3    939ms
  5   -8.447711822412       -7.99       -4.53    4.4    1.04s
  6   -8.447711822800       -9.41       -5.34    4.6    1.13s
  7   -8.447711822807      -11.14       -6.19    3.8    901ms
  8   -8.447711822807      -12.83       -7.56    3.7    971ms
     1    -8.447712e+00     3.279952e-04
 * time: 27.85730791091919
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.445736953821                   -0.96    7.1    1.50s
  2   -8.447651688823       -2.72       -1.75    2.3    653ms
  3   -8.447711699174       -4.22       -2.84    3.7    984ms
  4   -8.447712558978       -6.07       -3.79    4.3    1.17s
  5   -8.447712568244       -8.03       -4.63    4.4    971ms
  6   -8.447712568517       -9.56       -5.50    4.7    1.13s
  7   -8.447712568519      -11.65       -6.38    3.6    1.06s
  8   -8.447712568519      -13.21       -7.42    3.8    888ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.445729725288                   -0.96    7.0    1.28s
  2   -8.447647808365       -2.72       -1.75    2.1    829ms
  3   -8.447711762853       -4.19       -2.85    3.9    924ms
  4   -8.447712558284       -6.10       -3.81    4.2    1.00s
  5   -8.447712568201       -8.00       -4.60    4.6    1.14s
  6   -8.447712568515       -9.50       -5.42    4.8    950ms
  7   -8.447712568519      -11.37       -6.29    3.7    875ms
  8   -8.447712568519      -12.99       -7.50    3.8    1.03s
     2    -8.447713e+00     7.442893e-07
 * time: 54.4274468421936
 * Status: success

 * Candidate solution
    Final objective value:     -8.447713e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 4.54e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.41e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 7.46e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 8.83e-08 ≰ 0.0e+00
    |g(x)|                 = 7.44e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   54  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Si: 70.424337 seconds (141.21 M allocations: 40.612 GiB, 11.44% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T15:33:20.824
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.620577133076107)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13070458102                   -1.18    9.3    8.43s
  2   -62.13462880294       -2.41       -1.24    4.1    3.99s
  3   -62.13833104547       -2.43       -2.09    5.5    5.07s
  4   -62.13835469619       -4.63       -2.88    4.4    4.74s
  5   -62.13835531287       -6.21       -3.60    4.1    4.75s
  6   -62.13835533368       -7.68       -4.46    5.3    5.38s
  7   -62.13835533389       -9.68       -5.04    4.5    4.97s
  8   -62.13835533390      -10.86       -6.61    4.2    4.79s
  9   -62.13835533390      -13.25       -7.35    5.9    6.26s
Iter     Function value   Gradient norm 
     0    -6.213836e+01     1.251008e-04
 * time: 4.482269287109375e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13070735664                   -1.18    9.0    7.57s
  2   -62.13462807607       -2.41       -1.24    3.6    4.00s
  3   -62.13833063524       -2.43       -2.09    5.6    5.15s
  4   -62.13835475494       -4.62       -2.89    4.4    4.75s
  5   -62.13835532780       -6.24       -3.59    4.1    4.74s
  6   -62.13835534916       -7.67       -4.43    5.2    4.93s
  7   -62.13835534937       -9.67       -4.98    4.3    5.52s
  8   -62.13835534939      -10.77       -6.52    3.8    4.55s
  9   -62.13835534939      -13.25       -7.26    5.9    5.73s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13070550882                   -1.18    9.0    7.80s
  2   -62.13463634489       -2.41       -1.24    3.7    3.90s
  3   -62.13833041094       -2.43       -2.09    5.4    5.20s
  4   -62.13835470283       -4.61       -2.87    4.5    4.68s
  5   -62.13835532678       -6.20       -3.58    4.0    4.76s
  6   -62.13835534912       -7.65       -4.41    5.2    6.87s
  7   -62.13835534937       -9.60       -5.01    4.5    5.05s
  8   -62.13835534939      -10.77       -6.67    4.1    4.98s
  9   -62.13835534939      -13.19       -7.51    6.1    5.75s
     1    -6.213836e+01     1.224788e-04
 * time: 123.09794783592224
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13069031227                   -1.18    9.7    8.42s
  2   -62.13462625156       -2.40       -1.24    3.7    3.85s
  3   -62.13833104290       -2.43       -2.09    5.4    4.94s
  4   -62.13835496767       -4.62       -2.85    4.5    4.70s
  5   -62.13835568128       -6.15       -3.56    4.3    4.69s
  6   -62.13835570395       -7.64       -4.41    5.2    5.18s
  7   -62.13835570422       -9.57       -5.08    4.5    5.01s
  8   -62.13835570424      -10.86       -6.61    4.5    6.46s
  9   -62.13835570424   +  -13.85       -7.21    5.9    7.33s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13069441643                   -1.18    9.5    7.99s
  2   -62.13461235372       -2.41       -1.24    3.7    3.84s
  3   -62.13833127188       -2.43       -2.09    5.5    5.06s
  4   -62.13835507716       -4.62       -2.89    4.5    4.68s
  5   -62.13835568368       -6.22       -3.61    4.3    4.78s
  6   -62.13835570403       -7.69       -4.48    5.5    5.42s
  7   -62.13835570423       -9.72       -5.09    4.6    5.98s
  8   -62.13835570424      -10.95       -6.58    4.3    4.96s
  9   -62.13835570424      -13.45       -7.38    5.8    5.63s
     2    -6.213836e+01     8.964840e-07
 * time: 251.74149990081787
 * Status: success

 * Candidate solution
    Final objective value:     -6.213836e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 5.84e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 5.50e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 3.55e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 5.71e-09 ≰ 0.0e+00
    |g(x)|                 = 8.96e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   252  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

NaCl: 321.536934 seconds (542.60 M allocations: 186.731 GiB, 7.00% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T15:38:42.362
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.601100458744493)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315274437774                   -1.45    5.5    1.21s
  2   -2.315362413463       -4.06       -1.83    1.4    578ms
  3   -2.315383932984       -4.67       -3.55    3.4    892ms
  4   -2.315384126929       -6.71       -4.16    4.5    1.07s
  5   -2.315384127267       -9.47       -4.68    2.6    707ms
  6   -2.315384127304      -10.43       -5.52    3.0    665ms
  7   -2.315384127305      -11.93       -6.05    3.2    949ms
  8   -2.315384127305      -13.89       -6.67    2.3    552ms
  9   -2.315384127305      -14.57       -7.46    2.6    623ms
Iter     Function value   Gradient norm 
     0    -2.315384e+00     2.066407e-04
 * time: 2.9087066650390625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315275285224                   -1.45    5.5    1.01s
  2   -2.315362062891       -4.06       -1.83    1.4    714ms
  3   -2.315383960857       -4.66       -3.53    3.5    729ms
  4   -2.315384168655       -6.68       -4.13    4.6    947ms
  5   -2.315384169041       -9.41       -4.66    2.7    860ms
  6   -2.315384169085      -10.36       -5.47    3.0    654ms
  7   -2.315384169086      -11.91       -6.02    3.1    667ms
  8   -2.315384169086      -13.78       -6.72    2.3    856ms
  9   -2.315384169086      -14.65       -7.59    2.7    654ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315274071199                   -1.45    5.6    1.02s
  2   -2.315362539174       -4.05       -1.83    1.5    720ms
  3   -2.315383916457       -4.67       -3.56    3.4    926ms
  4   -2.315384168726       -6.60       -4.16    4.6    916ms
  5   -2.315384169048       -9.49       -4.68    2.7    623ms
  6   -2.315384169086      -10.42       -5.55    3.1    1.08s
  7   -2.315384169086      -12.07       -6.07    3.2    683ms
  8   -2.315384169086      -13.95       -6.69    2.2    658ms
  9   -2.315384169086      -14.75       -7.45    2.5    824ms
     1    -2.315384e+00     1.977491e-04
 * time: 40.734283208847046
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315273780151                   -1.45    5.4    1.12s
  2   -2.315362872087       -4.05       -1.83    1.4    567ms
  3   -2.315384400315       -4.67       -3.55    3.4    918ms
  4   -2.315384626048       -6.65       -4.14    4.5    1.07s
  5   -2.315384626405       -9.45       -4.67    2.5    643ms
  6   -2.315384626446      -10.39       -5.54    2.9    657ms
  7   -2.315384626447      -11.94       -6.00    3.3    1.04s
  8   -2.315384626447      -13.88       -6.66    2.2    635ms
  9   -2.315384626447      -14.45       -7.41    2.7    612ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315273508447                   -1.45    5.4    1.13s
  2   -2.315362675020       -4.05       -1.83    1.4    425ms
  3   -2.315384413671       -4.66       -3.54    3.3    979ms
  4   -2.315384626022       -6.67       -4.12    4.5    904ms
  5   -2.315384626402       -9.42       -4.65    2.6    656ms
  6   -2.315384626445      -10.36       -5.50    2.8    818ms
  7   -2.315384626447      -11.86       -5.98    3.3    1.23s
  8   -2.315384626447      -13.78       -6.67    2.1    738ms
  9   -2.315384626447      -14.75       -7.51    2.7    753ms
     2    -2.315385e+00     1.884923e-06
 * time: 82.44189214706421
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315276073002                   -1.45    5.4    1.15s
  2   -2.315362924363       -4.06       -1.83    1.4    555ms
  3   -2.315384399979       -4.67       -3.54    3.4    953ms
  4   -2.315384626026       -6.65       -4.11    4.5    1.18s
  5   -2.315384626438       -9.39       -4.63    2.5    879ms
  6   -2.315384626487      -10.30       -5.44    2.9    976ms
  7   -2.315384626489      -11.81       -5.95    3.2    1.27s
  8   -2.315384626489      -13.63       -6.66    2.3    757ms
  9   -2.315384626489      -14.35       -7.54    2.7    604ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315275271745                   -1.45    5.4    1.17s
  2   -2.315362794382       -4.06       -1.83    1.4    494ms
  3   -2.315384433999       -4.66       -3.53    3.3    735ms
  4   -2.315384626057       -6.72       -4.12    4.5    1.06s
  5   -2.315384626444       -9.41       -4.65    2.7    606ms
  6   -2.315384626488      -10.36       -5.52    2.9    656ms
  7   -2.315384626489      -11.92       -5.97    3.2    987ms
  8   -2.315384626489      -13.78       -6.61    2.2    527ms
  9   -2.315384626489      -14.18       -7.45    2.6    734ms
     3    -2.315385e+00     1.616872e-08
 * time: 124.0874400138855
 * Status: success

 * Candidate solution
    Final objective value:     -2.315385e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 4.42e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 5.81e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 4.20e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.81e-11 ≰ 0.0e+00
    |g(x)|                 = 1.62e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   124  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Al: 149.636324 seconds (138.46 M allocations: 38.914 GiB, 5.29% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T15:41:12
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.623561158323459)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.177511347999523e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71824020154                   -0.86    9.7    5.61s
  2   -73.72959577864       -1.94       -1.06    5.3    3.09s
  3   -73.73608551431       -2.19       -1.39    6.7    3.88s
  4   -73.73723192001       -2.94       -1.78    5.9    3.60s
  5   -73.73737648437       -3.84       -2.28    4.9    3.32s
  6   -73.73739322124       -4.78       -3.09    5.6    3.51s
  7   -73.73739326193       -7.39       -3.56    4.8    3.08s
  8   -73.73739326877       -8.16       -4.02    5.2    3.01s
  9   -73.73739326844   +   -9.48       -4.52    5.2    3.04s
 10   -73.73739326907       -9.20       -4.79    5.5    3.18s
 11   -73.73739326911      -10.36       -5.48    4.9    2.99s
 12   -73.73739326911      -12.85       -6.22    4.8    3.02s
 13   -73.73739326912      -12.70       -6.42    4.0    2.74s
 14   -73.73739326911   +  -12.28       -7.02    5.2    3.16s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.177511347999523e-8,1.41597545408816e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.373739e+01     6.696406e-04
 * time: 3.600120544433594e-5
┌ Warning: Negative ρcore detected: -3.167945975538225e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71823496148                   -0.86    9.6    5.34s
  2   -73.72958701715       -1.94       -1.06    5.3    3.03s
  3   -73.73608371418       -2.19       -1.39    6.7    3.90s
  4   -73.73723273564       -2.94       -1.78    5.8    3.25s
  5   -73.73737699216       -3.84       -2.28    5.0    3.07s
  6   -73.73739363552       -4.78       -3.09    5.6    3.74s
  7   -73.73739367236       -7.43       -3.57    4.5    2.94s
  8   -73.73739368021       -8.11       -4.04    5.1    2.95s
  9   -73.73739367970   +   -9.30       -4.50    5.5    3.17s
 10   -73.73739368050       -9.10       -4.79    5.6    3.25s
 11   -73.73739368054      -10.34       -5.47    5.0    3.02s
 12   -73.73739368054      -12.20       -6.26    4.8    3.42s
 13   -73.73739368054      -12.67       -6.45    3.9    3.00s
 14   -73.73739368054   +  -12.37       -7.00    5.3    3.13s
┌ Warning: Negative ρcore detected: -3.167945975538225e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71823388768                   -0.86    9.7    5.79s
  2   -73.72959823245       -1.94       -1.06    5.2    3.20s
  3   -73.73608302636       -2.19       -1.39    6.7    4.09s
  4   -73.73723237466       -2.94       -1.78    5.8    3.38s
  5   -73.73737698495       -3.84       -2.28    5.0    3.06s
  6   -73.73739363822       -4.78       -3.09    5.5    3.30s
  7   -73.73739367231       -7.47       -3.57    4.5    2.97s
  8   -73.73739368021       -8.10       -4.03    5.2    3.17s
  9   -73.73739367977   +   -9.35       -4.51    5.4    3.16s
 10   -73.73739368050       -9.13       -4.80    5.6    3.28s
 11   -73.73739368054      -10.36       -5.48    5.0    3.36s
 12   -73.73739368054      -12.36       -6.23    4.8    3.42s
 13   -73.73739368054      -12.62       -6.42    4.0    3.37s
 14   -73.73739368054   +  -12.29       -7.00    5.2    3.04s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.167945975538225e-8,1.4408739286739372e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     1    -7.373739e+01     5.585816e-04
 * time: 150.5307068824768
┌ Warning: Negative ρcore detected: -3.117340312404654e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71814499959                   -0.86   10.0    5.67s
  2   -73.72957293581       -1.94       -1.06    5.5    3.16s
  3   -73.73608323546       -2.19       -1.39    7.0    4.00s
  4   -73.73723031597       -2.94       -1.78    6.1    3.25s
  5   -73.73737759994       -3.83       -2.28    5.1    3.04s
  6   -73.73739457754       -4.77       -3.09    5.6    3.37s
  7   -73.73739461652       -7.41       -3.57    4.7    3.03s
  8   -73.73739462364       -8.15       -4.03    5.4    3.11s
  9   -73.73739462320   +   -9.36       -4.51    5.5    3.24s
 10   -73.73739462392       -9.14       -4.80    5.6    3.29s
 11   -73.73739462396      -10.40       -5.49    5.0    3.07s
 12   -73.73739462396      -12.15       -6.25    4.8    3.06s
 13   -73.73739462396      -12.70       -6.43    4.3    2.88s
 14   -73.73739462396   +  -12.40       -7.00    5.2    3.04s
┌ Warning: Negative ρcore detected: -3.117340312404654e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71814791739                   -0.86   10.1    6.00s
  2   -73.72956187088       -1.94       -1.06    5.5    3.20s
  3   -73.73608459301       -2.19       -1.39    7.0    4.31s
  4   -73.73723045173       -2.94       -1.78    6.0    3.42s
  5   -73.73737769776       -3.83       -2.28    5.1    3.19s
  6   -73.73739458117       -4.77       -3.09    5.7    3.41s
  7   -73.73739461631       -7.45       -3.57    4.7    3.02s
  8   -73.73739462363       -8.14       -4.04    5.2    3.15s
  9   -73.73739462317   +   -9.34       -4.51    5.5    3.29s
 10   -73.73739462392       -9.13       -4.80    5.7    3.34s
 11   -73.73739462396      -10.37       -5.48    5.1    3.10s
 12   -73.73739462396      -11.96       -6.26    4.9    3.12s
 13   -73.73739462396      -12.81       -6.44    4.4    2.93s
 14   -73.73739462396   +  -12.45       -6.99    5.2    3.54s
 15   -73.73739462396   +  -13.00       -7.82    5.2    3.78s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.117340312404654e-8,1.5634640024504077e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     2    -7.373739e+01     1.701551e-06
 * time: 306.23778796195984
┌ Warning: Negative ρcore detected: -3.117179361538033e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71814448805                   -0.86   10.1    6.24s
  2   -73.72957096348       -1.94       -1.06    5.5    3.41s
  3   -73.73608333226       -2.19       -1.39    6.9    4.34s
  4   -73.73723057685       -2.94       -1.78    5.9    3.45s
  5   -73.73737750214       -3.83       -2.28    5.2    3.13s
  6   -73.73739457758       -4.77       -3.09    5.6    3.48s
  7   -73.73739461642       -7.41       -3.57    4.7    3.08s
  8   -73.73739462367       -8.14       -4.04    5.3    3.06s
  9   -73.73739462320   +   -9.33       -4.51    5.4    3.36s
 10   -73.73739462393       -9.14       -4.82    5.6    3.39s
 11   -73.73739462397      -10.37       -5.51    5.0    3.17s
 12   -73.73739462397      -12.27       -6.25    4.8    3.11s
 13   -73.73739462397      -12.77       -6.42    4.5    3.71s
 14   -73.73739462397   +  -12.43       -7.01    5.2    3.12s
┌ Warning: Negative ρcore detected: -3.117179361538033e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71814866985                   -0.86   10.1    5.80s
  2   -73.72956488990       -1.94       -1.06    5.4    3.16s
  3   -73.73608400628       -2.19       -1.39    6.9    3.84s
  4   -73.73723033674       -2.94       -1.78    6.0    3.28s
  5   -73.73737779497       -3.83       -2.28    5.1    2.92s
  6   -73.73739458005       -4.78       -3.09    5.6    3.34s
  7   -73.73739461684       -7.43       -3.58    4.7    3.06s
  8   -73.73739462367       -8.17       -4.04    5.2    3.16s
  9   -73.73739462316   +   -9.30       -4.50    5.4    3.32s
 10   -73.73739462393       -9.12       -4.80    5.7    3.38s
 11   -73.73739462397      -10.38       -5.50    5.1    3.17s
 12   -73.73739462397      -12.15       -6.27    4.8    3.12s
 13   -73.73739462397      -12.70       -6.44    4.2    2.86s
 14   -73.73739462397   +  -12.55       -7.01    5.2    3.18s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.117179361538033e-8,1.563831831503562e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     3    -7.373739e+01     1.652867e-07
 * time: 458.9841899871826
 * Status: success

 * Candidate solution
    Final objective value:     -7.373739e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.03e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.83e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 9.39e-12 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.27e-13 ≰ 0.0e+00
    |g(x)|                 = 1.65e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   459  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

V: 545.024765 seconds (478.79 M allocations: 277.256 GiB, 7.82% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T15:50:17.027
└   θ = ComponentVector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}(κ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.6392102028059379,1.0,0.0), μ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.18574146918857637,0.0,1.0))
┌ Info: 2025-05-20T15:50:17.033
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.301502788702209)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.445734934932                   -0.96    7.1    1.56s
  2   -8.447648035399       -2.72       -1.75    2.0    980ms
  3   -8.447711771018       -4.20       -2.85    3.8    1.05s
  4   -8.447712558465       -6.10       -3.81    4.3    1.31s
  5   -8.447712568201       -8.01       -4.60    4.4    1.39s
  6   -8.447712568515       -9.50       -5.42    4.6    1.20s
  7   -8.447712568519      -11.35       -6.29    3.7    943ms
  8   -8.447712568519      -12.99       -7.49    3.7    1.08s
Iter     Function value   Gradient norm 
     0    -8.447713e+00     7.443837e-07
 * time: 3.504753112792969e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.447713e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 7.44e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.445729562434                   -0.96    7.1    1.46s
  2   -8.447644594178       -2.72       -1.75    1.9    619ms
  3   -8.447711799922       -4.17       -2.85    3.8    921ms
  4   -8.447712557811       -6.12       -3.81    4.4    1.13s
  5   -8.447712568168       -7.98       -4.57    4.5    943ms
  6   -8.447712568513       -9.46       -5.36    4.7    954ms
  7   -8.447712568519      -11.21       -6.19    3.9    1.18s
  8   -8.447712568519      -12.83       -7.50    3.8    875ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.14e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.50e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.42e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 8.13e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.71e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 6.57e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.65e-09
└ * number of operations = 8
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.445726551936                   -0.96    7.1    1.52s
  2   -8.447650376184       -2.72       -1.75    2.0    660ms
  3   -8.447711724461       -4.21       -2.85    3.8    986ms
  4   -8.447712559038       -6.08       -3.80    4.1    1.13s
  5   -8.447712568222       -8.04       -4.63    4.5    962ms
  6   -8.447712568517       -9.53       -5.51    4.8    1.05s
  7   -8.447712568519      -11.59       -6.41    3.7    1.11s
  8   -8.447712568519      -13.29       -7.44    3.6    867ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 7.38e-02
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.12e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.02e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.68e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 6.61e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 1.25e-08
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 1.01e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 5.13e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.40e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.07e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.39e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.31e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.30e-09
└ * number of operations = 8
Si: 170.378789 seconds (249.37 M allocations: 206.928 GiB, 9.94% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T15:53:07.413
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.626545881179531)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13069210326                   -1.18    9.8    7.94s
  2   -62.13461513832       -2.41       -1.24    3.7    3.77s
  3   -62.13833130624       -2.43       -2.09    5.3    4.95s
  4   -62.13835504609       -4.62       -2.88    4.6    4.74s
  5   -62.13835568329       -6.20       -3.60    4.1    4.71s
  6   -62.13835570402       -7.68       -4.47    5.2    4.85s
  7   -62.13835570422       -9.69       -5.07    4.7    4.99s
  8   -62.13835570424      -10.90       -6.57    4.2    4.73s
  9   -62.13835570424      -13.07       -7.38    5.9    5.63s
Iter     Function value   Gradient norm 
     0    -6.213836e+01     8.942231e-07
 * time: 4.100799560546875e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.213836e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 8.94e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13069208967                   -1.18    9.6    7.72s
  2   -62.13461924530       -2.41       -1.24    4.0    4.00s
  3   -62.13833120103       -2.43       -2.09    5.4    5.04s
  4   -62.13835506987       -4.62       -2.88    4.4    4.71s
  5   -62.13835568339       -6.21       -3.60    4.2    4.68s
  6   -62.13835570402       -7.69       -4.47    5.5    4.91s
  7   -62.13835570423       -9.69       -5.10    4.4    4.93s
  8   -62.13835570424      -10.94       -6.62    4.5    4.99s
  9   -62.13835570424      -13.67       -7.36    5.9    5.53s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.10e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.00e+00
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.98e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.09e-02
[ Info: GMRES linsolve in iteration 1; step 4: normres = 3.29e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 2.33e-05
[ Info: GMRES linsolve in iteration 1; step 6: normres = 6.28e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 2.79e-08
└ * number of operations = 9
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13069183291                   -1.18    9.7    8.13s
  2   -62.13462568854       -2.41       -1.24    3.7    3.93s
  3   -62.13833125812       -2.43       -2.09    5.4    5.09s
  4   -62.13835501360       -4.62       -2.86    4.6    4.67s
  5   -62.13835568252       -6.17       -3.58    4.2    4.73s
  6   -62.13835570400       -7.67       -4.43    5.4    5.06s
  7   -62.13835570422       -9.65       -5.09    4.5    4.73s
  8   -62.13835570424      -10.92       -6.64    4.3    4.90s
  9   -62.13835570424      -13.15       -7.33    5.9    5.66s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 7.46e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.70e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.31e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.23e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.06e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 6.29e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 2.82e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 8.42e-09
└ * number of operations = 9
[ Info: GMRES linsolve starts with norm of residual = 2.76e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.87e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.04e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.45e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.65e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.72e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 2.08e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 6.74e-09
└ * number of operations = 9
NaCl: 1242.394506 seconds (970.47 M allocations: 1.299 TiB, 4.64% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T16:13:49.809
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.605946971808965)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315274315834                   -1.45    5.4    989ms
  2   -2.315362916466       -4.05       -1.83    1.4    554ms
  3   -2.315384408066       -4.67       -3.54    3.4    734ms
  4   -2.315384626087       -6.66       -4.13    4.5    915ms
  5   -2.315384626447       -9.44       -4.66    2.6    769ms
  6   -2.315384626487      -10.39       -5.53    3.0    878ms
  7   -2.315384626489      -11.90       -6.01    3.2    913ms
  8   -2.315384626489      -13.88       -6.65    2.1    938ms
  9   -2.315384626489      -14.35       -7.50    2.7    633ms
Iter     Function value   Gradient norm 
     0    -2.315385e+00     1.726511e-08
 * time: 3.1948089599609375e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.315385e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.73e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315272667355                   -1.45    5.4    1.21s
  2   -2.315363000247       -4.04       -1.83    1.3    460ms
  3   -2.315384408464       -4.67       -3.55    3.4    771ms
  4   -2.315384626097       -6.66       -4.14    4.4    1.10s
  5   -2.315384626447       -9.46       -4.67    2.6    626ms
  6   -2.315384626488      -10.40       -5.53    2.9    671ms
  7   -2.315384626489      -11.97       -5.99    3.2    695ms
  8   -2.315384626489      -13.83       -6.66    2.2    757ms
  9   -2.315384626489      -14.51       -7.40    2.9    632ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.96e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.65e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.90e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.30e-06
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 1.96e-08
└ * number of operations = 6
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315272903367                   -1.45    5.4    1.00s
  2   -2.315362661440       -4.05       -1.83    1.4    623ms
  3   -2.315384396555       -4.66       -3.55    3.3    704ms
  4   -2.315384626104       -6.64       -4.14    4.6    924ms
  5   -2.315384626451       -9.46       -4.68    2.7    630ms
  6   -2.315384626488      -10.44       -5.55    3.0    840ms
  7   -2.315384626489      -11.93       -6.01    3.2    667ms
  8   -2.315384626489      -14.10       -6.64    2.2    562ms
  9   -2.315384626489      -14.45       -7.39    2.7    706ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.78e-03
[ Info: GMRES linsolve in iteration 1; step 1: normres = 5.10e-05
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.75e-06
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.61e-08
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 2.87e-10
└ * number of operations = 6
[ Info: GMRES linsolve starts with norm of residual = 2.29e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.90e-03
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.45e-05
[ Info: GMRES linsolve in iteration 1; step 3: normres = 6.88e-07
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 5.96e-09
└ * number of operations = 6
Al: 145.359302 seconds (152.86 M allocations: 84.145 GiB, 6.81% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T16:16:15.169
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.627609106908538)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.117179361538033e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71814541090                   -0.86   10.2    6.15s
  2   -73.72957529807       -1.94       -1.06    5.5    3.29s
  3   -73.73608280310       -2.19       -1.39    7.0    4.24s
  4   -73.73723078208       -2.94       -1.78    5.9    3.39s
  5   -73.73737757033       -3.83       -2.28    5.1    3.08s
  6   -73.73739457922       -4.77       -3.09    5.7    3.37s
  7   -73.73739461579       -7.44       -3.57    4.7    3.01s
  8   -73.73739462365       -8.10       -4.04    5.3    3.12s
  9   -73.73739462314   +   -9.29       -4.50    5.6    3.29s
 10   -73.73739462393       -9.10       -4.80    5.7    3.36s
 11   -73.73739462397      -10.41       -5.49    5.0    3.23s
 12   -73.73739462397      -12.10       -6.23    4.8    3.09s
 13   -73.73739462397      -12.64       -6.42    4.5    2.99s
 14   -73.73739462397   +  -12.42       -6.99    5.3    3.15s
 15   -73.73739462397   +  -12.94       -7.81    5.1    3.22s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.117179361538033e-8,1.563831831503562e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.373739e+01     4.299411e-09
 * time: 4.00543212890625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.373739e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 4.30e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.117179361538033e-8,1.563831831503562e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.117179361538033e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71814848465                   -0.86   10.0    6.07s
  2   -73.72957451583       -1.94       -1.06    5.5    3.22s
  3   -73.73608275862       -2.19       -1.39    6.9    4.13s
  4   -73.73723041227       -2.94       -1.78    5.9    3.54s
  5   -73.73737780000       -3.83       -2.28    5.1    2.96s
  6   -73.73739458024       -4.78       -3.09    5.7    3.47s
  7   -73.73739461583       -7.45       -3.58    4.6    3.04s
  8   -73.73739462366       -8.11       -4.04    5.3    3.24s
  9   -73.73739462313   +   -9.28       -4.50    5.5    3.12s
 10   -73.73739462393       -9.10       -4.81    5.7    3.44s
 11   -73.73739462397      -10.40       -5.50    5.1    3.22s
 12   -73.73739462397      -12.12       -6.25    4.8    3.23s
 13   -73.73739462397      -12.77       -6.43    4.5    2.83s
 14   -73.73739462397   +  -12.57       -7.00    5.2    3.20s
 15   -73.73739462397   +  -12.81       -7.86    5.2    3.47s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.38e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.01e+01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.33e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 6.57e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 7.73e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 7.60e-07
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.95e-08
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 1.17e-08
└ * number of operations = 9
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}(Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.117179362029927e-8,1.5638318316454958e-7),Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(1.5638318314402602e-7,3.574100099022732e-6))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Computing cross-derivative ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.117179361538033e-8,0.0,0.0)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.117179361538033e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71814911247                   -0.86   10.0    5.79s
  2   -73.72957018147       -1.94       -1.06    5.5    3.03s
  3   -73.73608213733       -2.19       -1.39    6.9    4.14s
  4   -73.73723066540       -2.94       -1.78    5.9    3.42s
  5   -73.73737771028       -3.83       -2.28    5.2    2.79s
  6   -73.73739457992       -4.77       -3.09    5.7    3.44s
  7   -73.73739461649       -7.44       -3.57    4.6    3.05s
  8   -73.73739462366       -8.14       -4.04    5.3    3.13s
  9   -73.73739462316   +   -9.30       -4.50    5.5    3.52s
 10   -73.73739462393       -9.11       -4.80    5.7    3.51s
 11   -73.73739462397      -10.38       -5.49    5.0    3.06s
 12   -73.73739462397      -12.07       -6.27    4.8    3.24s
 13   -73.73739462397      -12.73       -6.43    4.4    3.17s
 14   -73.73739462397   +  -12.40       -7.00    5.3    2.98s
 15   -73.73739462397   +  -13.00       -7.84    5.2    3.36s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.77e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 8.58e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.76e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.22e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 9.65e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 8.76e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.37e-09
└ * number of operations = 8
[ Info: GMRES linsolve starts with norm of residual = 4.82e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.46e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.39e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 9.22e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.20e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.17e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 2.14e-09
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}, KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.117179362029927e-8,0.0,0.0),Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(1.563831831593018e-7,0.0,0.0))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
V: 818.469832 seconds (636.72 M allocations: 918.784 GiB, 7.29% gc time, 0.00% compilation time)
     5     9.315270e-05     2.038296e-04
 * Current step size: 1.0
 * time: 16694.19810605049
 * g(x): (κ = 0.00020382955410245442, μ = -6.0200339287639053e-5)
 * ~inv(H): [33.85663302149016 -26.453012502595776; -26.45301250259577 78.91004756144997]
 * x: (κ = 0.6392102028059379, μ = 0.18574146918857637)
┌ Info: 2025-05-20T16:29:53.642
└   θ = ComponentVector{Float64}(κ = 0.6307167400659207, μ = 0.19588378656805014)
┌ Info: 2025-05-20T16:29:53.642
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.301502788702209)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.449562730137                   -0.96    7.0    1.24s
  2   -8.451484421999       -2.72       -1.75    2.2    621ms
  3   -8.451547369201       -4.20       -2.84    3.6    876ms
  4   -8.451548174783       -6.09       -3.80    4.4    945ms
  5   -8.451548184519       -8.01       -4.62    4.6    1.12s
  6   -8.451548184790       -9.57       -5.49    4.8    956ms
  7   -8.451548184792      -11.54       -6.33    3.7    905ms
  8   -8.451548184793      -13.12       -7.42    3.8    1.05s
Iter     Function value   Gradient norm 
     0    -8.451548e+00     4.876637e-04
 * time: 3.0994415283203125e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.449573865515                   -0.96    7.2    1.55s
  2   -8.451487447592       -2.72       -1.75    2.2    659ms
  3   -8.451547623434       -4.22       -2.84    3.8    1.16s
  4   -8.451548404969       -6.11       -3.82    4.3    950ms
  5   -8.451548413779       -8.06       -4.62    4.5    1.02s
  6   -8.451548414044       -9.58       -5.51    4.7    1.16s
  7   -8.451548414047      -11.57       -6.31    3.9    909ms
  8   -8.451548414047      -13.09       -7.51    3.8    939ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.449572617405                   -0.96    7.2    1.51s
  2   -8.451481750377       -2.72       -1.75    2.0    648ms
  3   -8.451547605214       -4.18       -2.84    3.8    1.16s
  4   -8.451548404563       -6.10       -3.83    4.3    932ms
  5   -8.451548413728       -8.04       -4.58    4.5    1.03s
  6   -8.451548414042       -9.50       -5.37    4.7    1.15s
  7   -8.451548414047      -11.26       -6.24    3.8    881ms
  8   -8.451548414047      -12.91       -7.50    3.8    941ms
     1    -8.451548e+00     4.525507e-04
 * time: 27.974313974380493
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.449575926462                   -0.96    7.2    1.39s
  2   -8.451485833574       -2.72       -1.75    2.2    840ms
  3   -8.451549155593       -4.20       -2.84    4.0    926ms
  4   -8.451549830029       -6.17       -3.80    4.4    1.07s
  5   -8.451549839142       -8.04       -4.66    4.6    1.10s
  6   -8.451549839390       -9.61       -5.53    4.9    1.05s
  7   -8.451549839391      -11.71       -6.46    3.9    1.26s
  8   -8.451549839392      -13.35       -7.53    3.9    918ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.449589960480                   -0.96    7.2    1.61s
  2   -8.451485935242       -2.72       -1.75    2.2    740ms
  3   -8.451549140395       -4.20       -2.84    3.9    1.14s
  4   -8.451549830455       -6.16       -3.82    4.3    978ms
  5   -8.451549839101       -8.06       -4.61    4.6    1.07s
  6   -8.451549839388       -9.54       -5.44    4.9    1.16s
  7   -8.451549839391      -11.41       -6.29    3.8    922ms
  8   -8.451549839392      -13.03       -7.56    3.8    1.11s
     2    -8.451550e+00     1.447656e-06
 * time: 56.32075595855713
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.449581393097                   -0.96    7.2    1.60s
  2   -8.451485158702       -2.72       -1.75    2.0    659ms
  3   -8.451549148828       -4.19       -2.84    3.8    1.16s
  4   -8.451549830021       -6.17       -3.81    4.4    967ms
  5   -8.451549839110       -8.04       -4.62    4.7    1.06s
  6   -8.451549839403       -9.53       -5.49    4.8    1.18s
  7   -8.451549839406      -11.57       -6.38    3.8    898ms
  8   -8.451549839406      -13.18       -7.53    3.9    968ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.449589024914                   -0.96    7.2    1.51s
  2   -8.451486312038       -2.72       -1.75    2.1    651ms
  3   -8.451549105889       -4.20       -2.84    3.9    1.27s
  4   -8.451549829770       -6.14       -3.80    4.4    941ms
  5   -8.451549839139       -8.03       -4.64    4.6    1.05s
  6   -8.451549839403       -9.58       -5.47    4.9    1.22s
  7   -8.451549839406      -11.52       -6.32    3.9    912ms
  8   -8.451549839406      -13.05       -7.49    3.9    994ms
     3    -8.451550e+00     4.714397e-09
 * time: 84.9967839717865
 * Status: success

 * Candidate solution
    Final objective value:     -8.451550e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.02e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.96e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.47e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.74e-12 ≰ 0.0e+00
    |g(x)|                 = 4.71e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   85  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 100.304253 seconds (197.24 M allocations: 57.075 GiB, 11.20% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T16:31:33.948
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.626545881179531)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.15279300799                   -1.17    9.7    7.60s
  2   -62.15675794369       -2.40       -1.24    3.6    3.73s
  3   -62.16056171916       -2.42       -2.09    5.6    5.00s
  4   -62.16058600904       -4.61       -2.89    4.3    4.67s
  5   -62.16058659370       -6.23       -3.62    4.1    5.45s
  6   -62.16058661070       -7.77       -4.47    5.2    5.17s
  7   -62.16058661091       -9.69       -5.10    4.5    5.13s
  8   -62.16058661092      -10.92       -6.50    4.4    4.95s
  9   -62.16058661092      -12.92       -7.48    5.3    5.52s
Iter     Function value   Gradient norm 
     0    -6.216059e+01     7.060703e-05
 * time: 4.506111145019531e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.15278887942                   -1.17    9.8    8.42s
  2   -62.15675333176       -2.40       -1.24    3.8    4.41s
  3   -62.16056145739       -2.42       -2.09    5.6    5.77s
  4   -62.16058604717       -4.61       -2.90    4.3    4.71s
  5   -62.16058659853       -6.26       -3.62    4.1    4.72s
  6   -62.16058661565       -7.77       -4.47    5.5    5.49s
  7   -62.16058661584       -9.72       -5.06    4.4    4.95s
  8   -62.16058661586      -10.87       -6.57    4.2    4.75s
  9   -62.16058661586      -13.19       -7.51    5.7    5.56s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.15279532360                   -1.17    9.8    7.87s
  2   -62.15674933851       -2.40       -1.24    4.1    3.92s
  3   -62.16056185039       -2.42       -2.09    5.8    5.11s
  4   -62.16058609989       -4.62       -2.93    4.6    4.68s
  5   -62.16058660007       -6.30       -3.66    4.2    4.67s
  6   -62.16058661568       -7.81       -4.53    5.4    5.02s
  7   -62.16058661584       -9.78       -5.07    4.7    4.95s
  8   -62.16058661586      -10.88       -6.52    3.9    4.61s
  9   -62.16058661586      -13.03       -7.55    5.4    5.33s
     1    -6.216059e+01     6.911286e-05
 * time: 125.11368012428284
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.15277542733                   -1.17    9.2    7.91s
  2   -62.15674802716       -2.40       -1.24    4.0    4.00s
  3   -62.16056144780       -2.42       -2.09    5.6    5.19s
  4   -62.16058612112       -4.61       -2.88    4.4    4.74s
  5   -62.16058671028       -6.23       -3.59    4.2    4.96s
  6   -62.16058672843       -7.74       -4.42    5.3    5.13s
  7   -62.16058672867       -9.62       -5.06    4.3    4.88s
  8   -62.16058672868      -10.86       -6.55    4.4    4.97s
  9   -62.16058672868      -13.03       -7.48    5.5    5.51s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.15277727452                   -1.17    9.3    7.61s
  2   -62.15674841930       -2.40       -1.24    3.9    3.79s
  3   -62.16056143196       -2.42       -2.09    5.7    4.97s
  4   -62.16058610723       -4.61       -2.88    4.5    4.61s
  5   -62.16058671008       -6.22       -3.59    4.1    4.59s
  6   -62.16058672841       -7.74       -4.42    5.4    4.91s
  7   -62.16058672867       -9.59       -5.07    4.5    4.85s
  8   -62.16058672868      -10.85       -6.52    4.4    4.70s
  9   -62.16058672868   +  -14.15       -7.43    5.4    5.25s
     2    -6.216059e+01     1.293909e-08
 * time: 246.46208691596985
 * Status: success

 * Candidate solution
    Final objective value:     -6.216059e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.27e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.07e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.13e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.82e-09 ≰ 0.0e+00
    |g(x)|                 = 1.29e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   246  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

NaCl: 318.582940 seconds (548.49 M allocations: 188.267 GiB, 7.01% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T16:36:52.532
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.605946971808965)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315841527972                   -1.45    5.4    1.29s
  2   -2.315923970069       -4.08       -1.84    1.4    472ms
  3   -2.315943458121       -4.71       -3.56    3.3    798ms
  4   -2.315943703526       -6.61       -4.13    4.5    1.15s
  5   -2.315943703935       -9.39       -4.56    2.6    608ms
  6   -2.315943704007      -10.14       -5.21    2.8    678ms
  7   -2.315943704009      -11.58       -5.87    2.8    869ms
  8   -2.315943704009      -13.24       -6.49    2.6    585ms
  9   -2.315943704009      -14.27       -7.17    2.5    565ms
Iter     Function value   Gradient norm 
     0    -2.315944e+00     3.063726e-04
 * time: 2.9087066650390625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315840968162                   -1.45    5.3    1.13s
  2   -2.315923487315       -4.08       -1.84    1.4    707ms
  3   -2.315943598326       -4.70       -3.55    3.4    758ms
  4   -2.315943795372       -6.71       -4.11    4.5    1.07s
  5   -2.315943795825       -9.34       -4.55    2.6    864ms
  6   -2.315943795902      -10.11       -5.18    2.9    641ms
  7   -2.315943795905      -11.50       -5.85    2.8    639ms
  8   -2.315943795905      -13.18       -6.51    2.5    618ms
  9   -2.315943795905      -14.35       -7.25    2.7    803ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315837227087                   -1.45    5.3    1.09s
  2   -2.315923062087       -4.07       -1.84    1.4    649ms
  3   -2.315943593427       -4.69       -3.54    3.3    708ms
  4   -2.315943795337       -6.69       -4.10    4.5    946ms
  5   -2.315943795820       -9.32       -4.53    2.5    686ms
  6   -2.315943795902      -10.09       -5.16    2.8    787ms
  7   -2.315943795905      -11.51       -5.83    2.8    638ms
  8   -2.315943795905      -13.11       -6.53    2.6    644ms
  9   -2.315943795905      -14.35       -7.25    2.7    845ms
     1    -2.315944e+00     2.935250e-04
 * time: 40.240899085998535
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315845173620                   -1.45    5.5    1.27s
  2   -2.315925064851       -4.10       -1.84    1.4    471ms
  3   -2.315944595268       -4.71       -3.54    3.3    773ms
  4   -2.315944831035       -6.63       -4.06    4.5    1.10s
  5   -2.315944831572       -9.27       -4.49    2.6    639ms
  6   -2.315944831670      -10.01       -5.11    2.8    687ms
  7   -2.315944831674      -11.39       -5.76    2.8    913ms
  8   -2.315944831674      -13.00       -6.46    2.6    599ms
  9   -2.315944831674      -14.21       -7.23    2.7    654ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315845378891                   -1.45    5.4    1.24s
  2   -2.315925740793       -4.09       -1.84    1.4    487ms
  3   -2.315944634792       -4.72       -3.57    3.4    793ms
  4   -2.315944831112       -6.71       -4.10    4.5    1.15s
  5   -2.315944831580       -9.33       -4.51    2.6    617ms
  6   -2.315944831670      -10.05       -5.12    2.8    670ms
  7   -2.315944831674      -11.39       -5.77    2.8    840ms
  8   -2.315944831674      -13.03       -6.44    2.6    627ms
  9   -2.315944831674      -14.05       -7.25    2.8    754ms
     2    -2.315945e+00     3.473752e-06
 * time: 80.4344871044159
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315841739414                   -1.45    5.7    1.21s
  2   -2.315925162815       -4.08       -1.84    1.5    646ms
  3   -2.315944648934       -4.71       -3.57    3.4    752ms
  4   -2.315944831312       -6.74       -4.12    4.6    1.02s
  5   -2.315944831740       -9.37       -4.54    2.7    866ms
  6   -2.315944831817      -10.11       -5.17    2.9    676ms
  7   -2.315944831821      -11.46       -5.79    3.0    657ms
  8   -2.315944831821      -13.14       -6.37    2.7    892ms
  9   -2.315944831821      -13.94       -7.11    2.7    706ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315844269260                   -1.45    5.5    1.14s
  2   -2.315925134178       -4.09       -1.84    1.4    693ms
  3   -2.315944624045       -4.71       -3.55    3.4    805ms
  4   -2.315944831213       -6.68       -4.08    4.6    1.06s
  5   -2.315944831722       -9.29       -4.50    2.7    783ms
  6   -2.315944831817      -10.02       -5.12    3.0    858ms
  7   -2.315944831821      -11.42       -5.74    2.9    642ms
  8   -2.315944831821      -12.98       -6.32    2.8    654ms
  9   -2.315944831821      -13.89       -7.10    2.7    927ms
     3    -2.315945e+00     3.346701e-08
 * time: 120.86151719093323
 * Status: success

 * Candidate solution
    Final objective value:     -2.315945e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 8.38e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.10e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.47e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 6.35e-11 ≰ 0.0e+00
    |g(x)|                 = 3.35e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   121  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Al: 146.383040 seconds (139.00 M allocations: 38.947 GiB, 6.84% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T16:39:18.917
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.627609106908538)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.117179361538033e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73603996336                   -0.86   10.0    6.69s
  2   -73.74700461370       -1.96       -1.07    5.5    4.30s
  3   -73.75330654819       -2.20       -1.40    6.9    4.43s
  4   -73.75441782056       -2.95       -1.79    5.9    3.24s
  5   -73.75455921868       -3.85       -2.29    5.1    2.93s
  6   -73.75457521627       -4.80       -3.09    5.7    3.21s
  7   -73.75457525817       -7.38       -3.58    4.7    2.88s
  8   -73.75457526698       -8.06       -4.05    5.4    3.08s
  9   -73.75457526628   +   -9.16       -4.48    5.5    3.28s
 10   -73.75457526722       -9.03       -4.80    5.6    3.16s
 11   -73.75457526726      -10.33       -5.47    5.0    3.00s
 12   -73.75457526727      -11.49       -6.21    4.8    2.93s
 13   -73.75457526727      -13.00       -6.41    4.0    2.66s
 14   -73.75457526727   +  -12.89       -6.99    5.2    2.98s
 15   -73.75457526727   +  -13.37       -7.85    5.2    3.17s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.117179361538033e-8,1.563831831503562e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.375458e+01     8.276956e-04
 * time: 3.814697265625e-5
┌ Warning: Negative ρcore detected: -3.104113540179272e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73602250260                   -0.86    9.9    5.71s
  2   -73.74698989949       -1.96       -1.06    5.3    3.11s
  3   -73.75330740756       -2.20       -1.40    6.8    4.02s
  4   -73.75441822475       -2.95       -1.79    5.9    3.29s
  5   -73.75455917127       -3.85       -2.28    5.0    3.11s
  6   -73.75457584384       -4.78       -3.09    5.6    4.13s
  7   -73.75457588626       -7.37       -3.57    4.6    3.48s
  8   -73.75457589539       -8.04       -4.04    5.3    3.13s
  9   -73.75457589481   +   -9.23       -4.49    5.5    3.25s
 10   -73.75457589567       -9.06       -4.79    5.6    3.38s
 11   -73.75457589571      -10.34       -5.46    5.1    3.14s
 12   -73.75457589572      -11.44       -6.20    4.8    3.12s
 13   -73.75457589572   +  -13.25       -6.39    4.3    2.87s
 14   -73.75457589572      -13.55       -6.97    5.1    3.22s
 15   -73.75457589572   +  -13.07       -7.83    5.1    3.21s
┌ Warning: Negative ρcore detected: -3.104113540179272e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73601581345                   -0.86    9.8    5.88s
  2   -73.74698951052       -1.96       -1.06    5.3    3.04s
  3   -73.75330761938       -2.20       -1.40    6.8    4.08s
  4   -73.75441870309       -2.95       -1.79    5.9    3.16s
  5   -73.75455952847       -3.85       -2.29    5.1    2.87s
  6   -73.75457584704       -4.79       -3.09    5.5    3.20s
  7   -73.75457588643       -7.40       -3.58    4.6    2.83s
  8   -73.75457589540       -8.05       -4.05    5.3    2.99s
  9   -73.75457589474   +   -9.18       -4.48    5.5    3.15s
 10   -73.75457589567       -9.03       -4.79    5.7    3.13s
 11   -73.75457589571      -10.34       -5.46    5.0    2.95s
 12   -73.75457589572      -11.43       -6.21    4.9    2.92s
 13   -73.75457589572      -13.55       -6.41    3.9    2.77s
 14   -73.75457589572   +  -12.94       -7.00    5.2    2.97s
 15   -73.75457589572   +    -Inf       -7.85    5.1    3.05s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.104113540179272e-8,1.593281686741689e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     1    -7.375458e+01     6.908816e-04
 * time: 155.20316910743713
┌ Warning: Negative ρcore detected: -3.049059811334357e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73590958984                   -0.86   10.0    7.04s
  2   -73.74696602793       -1.96       -1.06    5.5    3.19s
  3   -73.75330478221       -2.20       -1.40    6.9    4.04s
  4   -73.75441779443       -2.95       -1.78    6.0    3.35s
  5   -73.75456040264       -3.85       -2.28    5.1    3.07s
  6   -73.75457729325       -4.77       -3.09    5.6    3.36s
  7   -73.75457733477       -7.38       -3.57    4.7    3.00s
  8   -73.75457734271       -8.10       -4.03    5.3    3.09s
  9   -73.75457734211   +   -9.23       -4.50    5.5    3.21s
 10   -73.75457734296       -9.07       -4.80    5.7    3.34s
 11   -73.75457734300      -10.38       -5.48    5.0    3.06s
 12   -73.75457734300      -11.52       -6.23    4.8    3.04s
 13   -73.75457734300      -12.94       -6.40    4.3    2.96s
 14   -73.75457734300   +  -13.37       -6.99    5.2    3.16s
 15   -73.75457734300   +  -13.25       -7.83    5.1    3.31s
┌ Warning: Negative ρcore detected: -3.049059811334357e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73591553780                   -0.86   10.0    5.73s
  2   -73.74696490204       -1.96       -1.06    5.6    3.25s
  3   -73.75330451957       -2.20       -1.40    6.8    4.10s
  4   -73.75441789578       -2.95       -1.78    5.9    3.37s
  5   -73.75456011342       -3.85       -2.28    5.1    3.05s
  6   -73.75457729440       -4.76       -3.09    5.6    3.37s
  7   -73.75457733423       -7.40       -3.57    4.7    2.99s
  8   -73.75457734268       -8.07       -4.03    5.3    3.16s
  9   -73.75457734209   +   -9.22       -4.49    5.5    3.26s
 10   -73.75457734296       -9.06       -4.79    5.7    3.35s
 11   -73.75457734300      -10.39       -5.47    5.1    3.22s
 12   -73.75457734300      -11.47       -6.22    4.9    3.15s
 13   -73.75457734300      -12.81       -6.39    4.2    2.92s
 14   -73.75457734300   +  -13.00       -6.98    5.2    3.19s
 15   -73.75457734300   +  -13.25       -7.81    5.1    3.29s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.049059811334357e-8,-9.310738626045773e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     2    -7.375458e+01     2.356477e-06
 * time: 312.9268870353699
┌ Warning: Negative ρcore detected: -3.0491929534399995e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73591694629                   -0.86   10.0    5.88s
  2   -73.74696273717       -1.96       -1.06    5.5    3.38s
  3   -73.75330482754       -2.20       -1.40    6.9    4.18s
  4   -73.75441791307       -2.95       -1.78    6.0    3.43s
  5   -73.75455989471       -3.85       -2.28    5.2    3.16s
  6   -73.75457729064       -4.76       -3.09    5.7    3.51s
  7   -73.75457733524       -7.35       -3.56    4.8    3.16s
  8   -73.75457734272       -8.13       -4.03    5.3    3.31s
  9   -73.75457734219   +   -9.27       -4.50    5.5    3.36s
 10   -73.75457734297       -9.11       -4.80    5.8    3.51s
 11   -73.75457734302      -10.37       -5.48    5.1    3.25s
 12   -73.75457734302      -11.50       -6.24    4.8    3.36s
 13   -73.75457734302   +  -13.15       -6.40    4.0    2.85s
 14   -73.75457734302      -13.85       -6.99    5.2    3.18s
 15   -73.75457734302      -13.85       -7.85    5.1    3.30s
┌ Warning: Negative ρcore detected: -3.0491929534399995e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73591127640                   -0.86    9.9    6.00s
  2   -73.74697406857       -1.96       -1.06    5.6    3.27s
  3   -73.75330469657       -2.20       -1.40    6.9    4.20s
  4   -73.75441761664       -2.95       -1.78    6.0    3.36s
  5   -73.75455992376       -3.85       -2.28    5.1    3.07s
  6   -73.75457729191       -4.76       -3.09    5.7    3.42s
  7   -73.75457733405       -7.38       -3.57    4.8    3.07s
  8   -73.75457734272       -8.06       -4.04    5.4    3.85s
  9   -73.75457734211   +   -9.21       -4.49    5.5    3.40s
 10   -73.75457734297       -9.06       -4.80    5.6    3.23s
 11   -73.75457734302      -10.38       -5.49    5.1    3.05s
 12   -73.75457734302      -11.51       -6.22    4.9    3.08s
 13   -73.75457734302      -13.00       -6.39    4.2    2.83s
 14   -73.75457734302   +  -13.00       -6.99    5.2    3.09s
 15   -73.75457734302   +  -13.55       -7.84    5.1    3.34s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0491929534399995e-8,-9.303938366304927e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     3    -7.375458e+01     5.171059e-09
 * time: 473.01854610443115
 * Status: success

 * Candidate solution
    Final objective value:     -7.375458e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.43e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.54e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.60e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.17e-13 ≰ 0.0e+00
    |g(x)|                 = 5.17e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   473  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

V: 562.468095 seconds (501.04 M allocations: 292.988 GiB, 8.32% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T16:48:41.388
└   θ = ComponentVector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}(κ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.6307167400659207,1.0,0.0), μ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.19588378656805014,0.0,1.0))
┌ Info: 2025-05-20T16:48:41.394
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.308295832424598)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.449578302161                   -0.96    7.2    1.37s
  2   -8.451486259963       -2.72       -1.75    2.2    884ms
  3   -8.451549072596       -4.20       -2.84    3.8    923ms
  4   -8.451549830312       -6.12       -3.80    4.5    1.06s
  5   -8.451549839158       -8.05       -4.66    4.6    1.20s
  6   -8.451549839404       -9.61       -5.53    4.6    981ms
  7   -8.451549839406      -11.71       -6.48    3.7    965ms
  8   -8.451549839406      -13.34       -7.46    4.0    1.13s
Iter     Function value   Gradient norm 
     0    -8.451550e+00     4.847366e-09
 * time: 3.886222839355469e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.451550e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 4.85e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.449585659994                   -0.96    7.2    1.52s
  2   -8.451491049980       -2.72       -1.75    2.1    683ms
  3   -8.451549136542       -4.24       -2.84    3.8    994ms
  4   -8.451549830564       -6.16       -3.81    4.3    1.16s
  5   -8.451549839153       -8.07       -4.65    4.6    976ms
  6   -8.451549839404       -9.60       -5.54    4.8    1.03s
  7   -8.451549839406      -11.71       -6.47    3.8    1.08s
  8   -8.451549839406      -13.41       -7.48    3.8    891ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.14e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.51e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.38e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 7.94e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.59e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 6.56e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.43e-09
└ * number of operations = 8
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.449574576623                   -0.96    7.1    1.51s
  2   -8.451488149379       -2.72       -1.75    2.3    710ms
  3   -8.451549095341       -4.22       -2.84    3.7    958ms
  4   -8.451549830492       -6.13       -3.81    4.4    1.14s
  5   -8.451549839146       -8.06       -4.64    4.6    987ms
  6   -8.451549839404       -9.59       -5.51    4.8    1.04s
  7   -8.451549839406      -11.65       -6.40    3.7    1.08s
  8   -8.451549839406      -13.21       -7.51    4.0    900ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 8.25e-02
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.23e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.41e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.86e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 6.49e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 1.18e-08
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 9.82e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.87e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.93e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 8.99e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.05e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 4.83e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.04e-09
└ * number of operations = 8
Si: 174.404317 seconds (253.46 M allocations: 209.284 GiB, 10.02% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T16:51:35.799
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.629882432886417)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.15277592872                   -1.17    9.3    7.84s
  2   -62.15675049728       -2.40       -1.24    3.9    4.05s
  3   -62.16056130603       -2.42       -2.09    5.4    5.18s
  4   -62.16058612491       -4.61       -2.88    4.5    4.90s
  5   -62.16058671036       -6.23       -3.59    4.1    5.94s
  6   -62.16058672843       -7.74       -4.43    5.1    5.09s
  7   -62.16058672867       -9.63       -5.06    4.5    5.10s
  8   -62.16058672868      -10.86       -6.67    4.4    5.02s
  9   -62.16058672868      -13.00       -7.46    5.8    5.76s
Iter     Function value   Gradient norm 
     0    -6.216059e+01     8.713457e-09
 * time: 3.600120544433594e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.216059e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 8.71e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.15277490876                   -1.17    9.1    7.41s
  2   -62.15674639787       -2.40       -1.24    3.9    3.94s
  3   -62.16056141986       -2.42       -2.09    5.7    5.27s
  4   -62.16058612385       -4.61       -2.89    4.5    4.71s
  5   -62.16058671044       -6.23       -3.60    4.1    4.75s
  6   -62.16058672843       -7.75       -4.43    5.1    5.18s
  7   -62.16058672867       -9.62       -5.04    4.4    4.73s
  8   -62.16058672868      -10.84       -6.58    4.3    4.90s
  9   -62.16058672868      -13.37       -7.30    5.6    5.53s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.10e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.01e+00
[ Info: GMRES linsolve in iteration 1; step 2: normres = 6.02e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.07e-02
[ Info: GMRES linsolve in iteration 1; step 4: normres = 3.07e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.89e-05
[ Info: GMRES linsolve in iteration 1; step 6: normres = 6.02e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 2.75e-08
└ * number of operations = 9
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.15277891063                   -1.17    9.4    7.71s
  2   -62.15673729389       -2.40       -1.24    4.0    3.80s
  3   -62.16056173064       -2.42       -2.09    5.3    4.82s
  4   -62.16058617815       -4.61       -2.91    4.4    4.41s
  5   -62.16058671214       -6.27       -3.64    4.1    4.59s
  6   -62.16058672848       -7.79       -4.50    5.6    4.98s
  7   -62.16058672867       -9.73       -5.06    4.5    4.82s
  8   -62.16058672868      -10.84       -6.46    4.0    4.69s
  9   -62.16058672868      -13.19       -7.52    5.2    5.42s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 7.97e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.81e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.62e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.25e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.07e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 6.26e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 2.61e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 7.64e-09
└ * number of operations = 9
[ Info: GMRES linsolve starts with norm of residual = 2.60e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.60e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 9.98e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.24e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.24e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.09e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.90e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 1.74e-08
└ * number of operations = 9
NaCl: 1256.479657 seconds (966.49 M allocations: 1.312 TiB, 4.60% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T17:12:32.280
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.613336746100116)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315845618607                   -1.45    5.6    1.10s
  2   -2.315926028483       -4.09       -1.84    1.5    441ms
  3   -2.315944617887       -4.73       -3.58    3.3    739ms
  4   -2.315944831330       -6.67       -4.13    4.7    977ms
  5   -2.315944831739       -9.39       -4.54    2.6    646ms
  6   -2.315944831818      -10.11       -5.16    2.9    696ms
  7   -2.315944831821      -11.48       -5.80    2.8    641ms
  8   -2.315944831821      -13.17       -6.41    2.6    653ms
  9   -2.315944831821      -13.99       -7.13    2.7    932ms
Iter     Function value   Gradient norm 
     0    -2.315945e+00     3.514044e-08
 * time: 3.504753112792969e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.315945e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.51e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315844192190                   -1.45    5.7    1.30s
  2   -2.315925485547       -4.09       -1.84    1.5    454ms
  3   -2.315944574966       -4.72       -3.57    3.3    732ms
  4   -2.315944831284       -6.59       -4.11    4.6    985ms
  5   -2.315944831732       -9.35       -4.52    2.6    849ms
  6   -2.315944831817      -10.07       -5.16    2.9    618ms
  7   -2.315944831821      -11.43       -5.76    3.0    651ms
  8   -2.315944831821      -13.01       -6.40    2.6    615ms
  9   -2.315944831821      -14.03       -7.04    2.7    810ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 6.02e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.71e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.69e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.07e-06
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 2.59e-08
└ * number of operations = 6
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315840169824                   -1.45    5.6    1.18s
  2   -2.315924560808       -4.07       -1.84    1.5    681ms
  3   -2.315944661612       -4.70       -3.56    3.4    744ms
  4   -2.315944831265       -6.77       -4.10    4.6    1.01s
  5   -2.315944831734       -9.33       -4.53    2.7    677ms
  6   -2.315944831817      -10.08       -5.15    2.9    842ms
  7   -2.315944831821      -11.45       -5.76    3.0    754ms
  8   -2.315944831821      -13.04       -6.34    2.8    649ms
  9   -2.315944831821      -13.92       -7.03    2.6    740ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 3.15e-03
[ Info: GMRES linsolve in iteration 1; step 1: normres = 5.31e-05
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.99e-06
┌ Info: GMRES linsolve converged at iteration 1, step 3:
│ * norm of residual = 7.05e-08
└ * number of operations = 5
[ Info: GMRES linsolve starts with norm of residual = 2.36e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.13e-03
[ Info: GMRES linsolve in iteration 1; step 2: normres = 7.30e-05
[ Info: GMRES linsolve in iteration 1; step 3: normres = 8.01e-07
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 7.81e-09
└ * number of operations = 6
Al: 148.763000 seconds (147.62 M allocations: 80.364 GiB, 6.85% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T17:15:01.045
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.632630794535123)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.0491929534399995e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73591682426                   -0.86    9.9    5.97s
  2   -73.74697089146       -1.96       -1.06    5.5    3.19s
  3   -73.75330326746       -2.20       -1.40    6.8    4.19s
  4   -73.75441784011       -2.95       -1.78    5.9    3.43s
  5   -73.75456023495       -3.85       -2.28    5.1    3.15s
  6   -73.75457729220       -4.77       -3.09    5.6    3.52s
  7   -73.75457733492       -7.37       -3.58    4.7    3.14s
  8   -73.75457734274       -8.11       -4.04    5.3    3.33s
  9   -73.75457734209   +   -9.18       -4.49    5.6    3.44s
 10   -73.75457734297       -9.05       -4.80    5.7    3.39s
 11   -73.75457734302      -10.37       -5.49    5.1    3.10s
 12   -73.75457734302      -11.52       -6.23    4.8    3.14s
 13   -73.75457734302   +    -Inf       -6.40    4.1    2.88s
 14   -73.75457734302   +    -Inf       -7.00    5.3    3.19s
 15   -73.75457734302   +  -13.55       -7.83    5.1    3.43s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0491929534399995e-8,-9.303938366304927e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.375458e+01     5.702068e-09
 * time: 3.1948089599609375e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.375458e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 5.70e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.0491929534399995e-8,-9.303938366304927e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.0491929534399995e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73591186593                   -0.86   10.0    6.14s
  2   -73.74696720172       -1.96       -1.06    5.5    3.16s
  3   -73.75330550733       -2.20       -1.40    6.9    4.21s
  4   -73.75441716134       -2.95       -1.78    6.0    3.53s
  5   -73.75455969691       -3.85       -2.27    5.0    2.88s
  6   -73.75457729263       -4.75       -3.09    5.6    3.38s
  7   -73.75457733439       -7.38       -3.56    4.7    2.99s
  8   -73.75457734271       -8.08       -4.03    5.3    3.11s
  9   -73.75457734217   +   -9.27       -4.50    5.5    3.22s
 10   -73.75457734298       -9.09       -4.80    5.7    3.37s
 11   -73.75457734302      -10.39       -5.48    5.1    3.11s
 12   -73.75457734302      -11.48       -6.21    4.9    3.15s
 13   -73.75457734302   +    -Inf       -6.39    4.3    2.77s
 14   -73.75457734302   +  -13.55       -7.00    5.2    3.17s
 15   -73.75457734302      -13.15       -7.81    5.1    3.29s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.38e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.01e+01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.31e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.98e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 6.87e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 7.65e-07
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.74e-08
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 1.11e-08
└ * number of operations = 9
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}(Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.049192959470072e-8,-9.303938367964607e-8),Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-9.303938366777332e-8,4.753536454927902e-6))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Computing cross-derivative ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.0491929534399995e-8,0.0,0.0)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.0491929534399995e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73591654217                   -0.86   10.0    5.57s
  2   -73.74697080148       -1.96       -1.06    5.4    3.12s
  3   -73.75330406484       -2.20       -1.40    6.9    4.05s
  4   -73.75441738408       -2.95       -1.78    6.0    3.18s
  5   -73.75456044846       -3.84       -2.28    5.1    3.06s
  6   -73.75457729308       -4.77       -3.09    5.7    3.39s
  7   -73.75457733435       -7.38       -3.57    4.7    3.00s
  8   -73.75457734272       -8.08       -4.04    5.3    3.20s
  9   -73.75457734210   +   -9.21       -4.49    5.5    3.31s
 10   -73.75457734297       -9.06       -4.80    5.6    3.23s
 11   -73.75457734302      -10.37       -5.48    5.1    3.23s
 12   -73.75457734302      -11.49       -6.22    4.8    3.14s
 13   -73.75457734302   +  -13.37       -6.40    4.0    2.71s
 14   -73.75457734302      -13.55       -6.99    5.2    3.19s
 15   -73.75457734302   +  -13.25       -7.85    5.1    3.55s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.28e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 9.41e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.03e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.46e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 9.42e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 8.90e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.33e-09
└ * number of operations = 8
[ Info: GMRES linsolve starts with norm of residual = 4.67e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.56e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.64e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.01e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 9.15e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.42e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 2.66e-09
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}, KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.049192959470072e-8,0.0,0.0),Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-9.30393836444393e-8,0.0,0.0))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
V: 816.811166 seconds (636.35 M allocations: 920.037 GiB, 7.42% gc time, 0.00% compilation time)
     6     9.120290e-05     2.303939e-04
 * Current step size: 1.0
 * time: 20218.41506409645
 * g(x): (κ = 0.00023039388016555477, μ = 4.15068825086938e-5)
 * ~inv(H): [163.05377883265277 -126.09602602684451; -126.09602602684453 132.6550179212399]
 * x: (κ = 0.6307167400659207, μ = 0.19588378656805014)
┌ Info: 2025-05-20T17:28:37.859
└   θ = ComponentVector{Float64}(κ = 0.598384000222119, μ = 0.21942944303478606)
┌ Info: 2025-05-20T17:28:37.859
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.308295832424598)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458122621960                   -0.96    7.2    1.30s
  2   -8.460045604109       -2.72       -1.74    2.1    635ms
  3   -8.460104567739       -4.23       -2.83    3.9    941ms
  4   -8.460105303572       -6.13       -3.84    4.2    962ms
  5   -8.460105309858       -8.20       -4.67    4.7    1.19s
  6   -8.460105310031       -9.76       -5.56    4.7    986ms
  7   -8.460105310033      -11.70       -6.41    3.8    1.08s
  8   -8.460105310033      -13.22       -7.58    4.0    1.09s
Iter     Function value   Gradient norm 
     0    -8.460105e+00     9.784343e-04
 * time: 3.814697265625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458130119166                   -0.96    7.1    1.52s
  2   -8.460046379843       -2.72       -1.74    2.3    688ms
  3   -8.460105553964       -4.23       -2.83    3.8    1.18s
  4   -8.460106226594       -6.17       -3.85    4.4    962ms
  5   -8.460106232835       -8.20       -4.66    4.6    1.09s
  6   -8.460106233016       -9.74       -5.54    4.7    1.20s
  7   -8.460106233018      -11.61       -6.38    3.9    896ms
  8   -8.460106233018      -13.23       -7.54    3.9    979ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458121903429                   -0.96    7.1    1.51s
  2   -8.460051200093       -2.71       -1.74    2.3    662ms
  3   -8.460105490164       -4.27       -2.82    3.8    994ms
  4   -8.460106226420       -6.13       -3.85    4.3    1.16s
  5   -8.460106232834       -8.19       -4.65    4.7    1.02s
  6   -8.460106233016       -9.74       -5.56    4.7    1.03s
  7   -8.460106233018      -11.64       -6.37    4.0    1.11s
  8   -8.460106233018      -13.30       -7.63    3.8    918ms
     1    -8.460106e+00     9.082309e-04
 * time: 27.859786987304688
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458146312994                   -0.96    6.9    1.29s
  2   -8.460047361065       -2.72       -1.74    2.2    882ms
  3   -8.460111218096       -4.19       -2.83    3.6    878ms
  4   -8.460111999754       -6.11       -3.87    4.2    1.05s
  5   -8.460112006705       -8.16       -4.57    4.5    1.26s
  6   -8.460112006962       -9.59       -5.37    4.5    929ms
  7   -8.460112006968      -11.20       -6.21    3.9    1.03s
  8   -8.460112006968      -12.87       -7.69    3.8    1.11s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458145271201                   -0.96    7.0    1.49s
  2   -8.460047557900       -2.72       -1.74    2.2    674ms
  3   -8.460111284666       -4.20       -2.83    3.7    1.12s
  4   -8.460111999953       -6.15       -3.87    4.3    920ms
  5   -8.460112006723       -8.17       -4.59    4.6    1.01s
  6   -8.460112006963       -9.62       -5.41    4.6    1.07s
  7   -8.460112006968      -11.29       -6.26    3.8    885ms
  8   -8.460112006968      -12.99       -7.66    3.8    888ms
     2    -8.460112e+00     5.860987e-06
 * time: 55.70048117637634
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458149658811                   -0.96    7.0    1.42s
  2   -8.460047323607       -2.72       -1.74    2.0    608ms
  3   -8.460111167013       -4.19       -2.83    3.7    913ms
  4   -8.460112000400       -6.08       -3.86    4.3    1.11s
  5   -8.460112006963       -8.18       -4.60    4.4    931ms
  6   -8.460112007205       -9.62       -5.41    4.5    938ms
  7   -8.460112007210      -11.30       -6.28    3.7    1.02s
  8   -8.460112007211      -13.03       -7.59    3.8    875ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458159855236                   -0.96    7.2    1.24s
  2   -8.460052458085       -2.72       -1.74    1.8    776ms
  3   -8.460111399206       -4.23       -2.82    3.8    889ms
  4   -8.460112000442       -6.22       -3.87    4.3    1.00s
  5   -8.460112006955       -8.19       -4.59    4.6    1.20s
  6   -8.460112007206       -9.60       -5.45    4.5    903ms
  7   -8.460112007210      -11.36       -6.29    3.9    904ms
  8   -8.460112007211      -13.08       -7.73    3.9    960ms
     3    -8.460112e+00     3.576623e-08
 * time: 82.95684099197388
 * Status: success

 * Candidate solution
    Final objective value:     -8.460112e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 8.22e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 7.97e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.43e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.87e-11 ≰ 0.0e+00
    |g(x)|                 = 3.58e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   83  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 99.282339 seconds (198.23 M allocations: 56.966 GiB, 10.36% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T17:30:17.143
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.629882432886417)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19867054667                   -1.17    9.3    7.97s
  2   -62.20267242944       -2.40       -1.23    4.1    4.18s
  3   -62.20666958212       -2.40       -2.08    5.6    5.19s
  4   -62.20669507292       -4.59       -2.90    4.2    4.72s
  5   -62.20669562498       -6.26       -3.62    4.1    4.84s
  6   -62.20669563642       -7.94       -4.43    5.1    5.06s
  7   -62.20669563669       -9.57       -5.18    4.4    4.88s
  8   -62.20669563670      -10.97       -6.63    4.3    4.90s
  9   -62.20669563670      -13.25       -7.74    5.3    5.36s
Iter     Function value   Gradient norm 
     0    -6.220670e+01     1.717653e-04
 * time: 3.600120544433594e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19867223223                   -1.17    9.5    10.4s
  2   -62.20267081058       -2.40       -1.23    4.0    4.47s
  3   -62.20666959649       -2.40       -2.08    5.6    5.29s
  4   -62.20669512682       -4.59       -2.91    4.2    4.67s
  5   -62.20669565469       -6.28       -3.63    4.1    4.75s
  6   -62.20669566563       -7.96       -4.44    5.1    5.02s
  7   -62.20669566587       -9.62       -5.12    4.5    5.77s
  8   -62.20669566589      -10.91       -6.79    4.2    4.86s
  9   -62.20669566589      -13.55       -7.78    5.8    5.65s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19867001182                   -1.17    9.5    8.10s
  2   -62.20266309627       -2.40       -1.23    3.9    4.02s
  3   -62.20666973824       -2.40       -2.08    5.9    5.31s
  4   -62.20669513800       -4.60       -2.92    4.4    4.89s
  5   -62.20669565521       -6.29       -3.64    4.2    6.05s
  6   -62.20669566565       -7.98       -4.47    5.2    5.14s
  7   -62.20669566587       -9.65       -5.10    4.5    4.96s
  8   -62.20669566589      -10.83       -6.78    4.1    4.74s
  9   -62.20669566589   +  -13.67       -7.74    5.8    5.50s
     1    -6.220670e+01     1.681031e-04
 * time: 128.50810194015503
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19869006970                   -1.17    9.1    7.88s
  2   -62.20270535351       -2.40       -1.23    3.8    3.90s
  3   -62.20667015089       -2.40       -2.08    5.6    5.15s
  4   -62.20669581707       -4.59       -2.92    4.3    4.73s
  5   -62.20669631555       -6.30       -3.63    4.0    4.75s
  6   -62.20669632622       -7.97       -4.45    5.0    4.98s
  7   -62.20669632643       -9.67       -5.21    4.1    5.01s
  8   -62.20669632644      -11.11       -6.57    4.3    4.94s
  9   -62.20669632644      -13.67       -7.66    5.1    5.27s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19869307157                   -1.17    9.1    7.89s
  2   -62.20269528480       -2.40       -1.23    3.9    4.10s
  3   -62.20667040433       -2.40       -2.08    5.8    5.24s
  4   -62.20669577947       -4.60       -2.90    4.2    4.72s
  5   -62.20669631488       -6.27       -3.62    4.0    4.71s
  6   -62.20669632616       -7.95       -4.43    5.2    5.17s
  7   -62.20669632643       -9.57       -5.14    4.1    4.79s
  8   -62.20669632644      -10.91       -6.81    4.1    4.83s
  9   -62.20669632644   +  -13.85       -7.78    5.7    5.62s
     2    -6.220670e+01     7.764077e-07
 * time: 249.38426685333252
 * Status: success

 * Candidate solution
    Final objective value:     -6.220670e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 7.88e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 7.42e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 6.61e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.06e-08 ≰ 0.0e+00
    |g(x)|                 = 7.76e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   249  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

NaCl: 319.651274 seconds (543.41 M allocations: 186.614 GiB, 6.76% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T17:35:36.796
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.613336746100116)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317135140545                   -1.46    5.6    1.29s
  2   -2.317208917633       -4.13       -1.84    1.5    622ms
  3   -2.317225667536       -4.78       -3.56    3.3    798ms
  4   -2.317225879777       -6.67       -4.00    4.5    1.18s
  5   -2.317225880449       -9.17       -4.27    2.4    742ms
  6   -2.317225880662       -9.67       -4.95    2.9    691ms
  7   -2.317225880668      -11.20       -5.62    2.4    874ms
  8   -2.317225880668      -12.58       -6.26    2.8    788ms
  9   -2.317225880668      -14.01       -6.84    2.4    639ms
 10   -2.317225880668   +  -15.35       -7.23    2.4    611ms
Iter     Function value   Gradient norm 
     0    -2.317226e+00     7.030796e-04
 * time: 2.8133392333984375e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317137175564                   -1.46    5.4    1.65s
  2   -2.317209784509       -4.14       -1.84    1.4    635ms
  3   -2.317226155613       -4.79       -3.56    3.3    787ms
  4   -2.317226364050       -6.68       -3.99    4.5    1.45s
  5   -2.317226364726       -9.17       -4.27    2.3    816ms
  6   -2.317226364948       -9.65       -4.94    2.7    960ms
  7   -2.317226364954      -11.25       -5.60    2.4    876ms
  8   -2.317226364954      -12.57       -6.00    2.7    609ms
  9   -2.317226364954      -13.65       -6.94    1.8    471ms
 10   -2.317226364954   +  -15.35       -7.30    3.1    699ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317134918789                   -1.46    5.4    1.02s
  2   -2.317209557993       -4.13       -1.84    1.4    426ms
  3   -2.317226136535       -4.78       -3.57    3.3    957ms
  4   -2.317226364125       -6.64       -4.01    4.5    981ms
  5   -2.317226364741       -9.21       -4.28    2.3    573ms
  6   -2.317226364949       -9.68       -4.96    2.7    815ms
  7   -2.317226364954      -11.29       -5.62    2.4    567ms
  8   -2.317226364954      -12.59       -6.22    2.7    631ms
  9   -2.317226364954      -13.92       -6.88    2.2    570ms
 10   -2.317226364954      -14.75       -7.38    2.5    776ms
     1    -2.317226e+00     6.745458e-04
 * time: 43.561583042144775
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317138607159                   -1.46    5.5    1.36s
  2   -2.317214544226       -4.12       -1.84    1.3    497ms
  3   -2.317231818570       -4.76       -3.57    3.3    781ms
  4   -2.317232008076       -6.72       -4.01    4.5    1.12s
  5   -2.317232008695       -9.21       -4.28    2.3    576ms
  6   -2.317232008893       -9.70       -4.96    2.7    710ms
  7   -2.317232008899      -11.25       -5.67    2.5    846ms
  8   -2.317232008899      -12.62       -6.18    2.8    660ms
  9   -2.317232008899      -13.94       -6.83    2.1    560ms
 10   -2.317232008899      -15.35       -7.38    2.5    830ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317136705244                   -1.46    5.5    1.12s
  2   -2.317214037484       -4.11       -1.84    1.3    673ms
  3   -2.317231798330       -4.75       -3.55    3.2    738ms
  4   -2.317232008021       -6.68       -3.99    4.6    965ms
  5   -2.317232008687       -9.18       -4.27    2.3    644ms
  6   -2.317232008893       -9.69       -4.94    2.8    802ms
  7   -2.317232008899      -11.25       -5.67    2.4    584ms
  8   -2.317232008899      -12.62       -6.44    2.5    638ms
  9   -2.317232008899      -14.18       -6.84    2.8    906ms
 10   -2.317232008899      -15.05       -7.31    2.1    565ms
     2    -2.317232e+00     5.330160e-06
 * time: 86.26167893409729
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317139829122                   -1.46    5.6    1.19s
  2   -2.317214968992       -4.12       -1.84    1.5    514ms
  3   -2.317231767406       -4.77       -3.57    3.3    941ms
  4   -2.317232008448       -6.62       -4.01    4.6    975ms
  5   -2.317232009044       -9.23       -4.28    2.3    622ms
  6   -2.317232009245       -9.70       -4.96    2.8    846ms
  7   -2.317232009251      -11.24       -5.68    2.5    606ms
  8   -2.317232009251      -12.59       -6.27    2.8    663ms
  9   -2.317232009251      -14.12       -6.82    2.3    621ms
 10   -2.317232009251      -15.05       -7.14    2.4    746ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317132446694                   -1.46    5.6    1.22s
  2   -2.317214526238       -4.09       -1.84    1.4    669ms
  3   -2.317231795252       -4.76       -3.59    3.3    698ms
  4   -2.317232008531       -6.67       -4.04    4.6    955ms
  5   -2.317232009064       -9.27       -4.30    2.4    624ms
  6   -2.317232009246       -9.74       -4.99    2.7    756ms
  7   -2.317232009251      -11.30       -5.68    2.6    619ms
  8   -2.317232009251      -12.68       -6.00    2.8    683ms
  9   -2.317232009251      -13.56       -6.80    1.8    716ms
 10   -2.317232009251      -15.35       -7.23    2.9    641ms
     3    -2.317232e+00     1.996317e-09
 * time: 127.80748200416565
 * Status: success

 * Candidate solution
    Final objective value:     -2.317232e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.32e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.73e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 3.52e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.52e-10 ≰ 0.0e+00
    |g(x)|                 = 2.00e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   128  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Al: 153.930690 seconds (148.01 M allocations: 41.243 GiB, 6.78% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T17:38:10.728
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.632630794535123)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.0491929534399995e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77480132448                   -0.88    9.9    5.67s
  2   -73.78500752585       -1.99       -1.08    5.4    3.05s
  3   -73.79091449395       -2.23       -1.42    6.9    3.94s
  4   -73.79195918982       -2.98       -1.80    6.0    3.29s
  5   -73.79208986884       -3.88       -2.31    5.0    3.03s
  6   -73.79210483840       -4.82       -3.10    5.6    3.56s
  7   -73.79210485904       -7.69       -3.55    4.3    2.92s
  8   -73.79210488685       -7.56       -3.98    5.4    3.16s
  9   -73.79210488660   +   -9.61       -4.31    5.6    3.32s
 10   -73.79210488902       -8.62       -4.83    5.5    3.27s
 11   -73.79210488906      -10.38       -5.35    5.1    3.86s
 12   -73.79210488908      -10.88       -6.12    5.1    3.17s
 13   -73.79210488908      -12.45       -6.47    5.4    3.28s
 14   -73.79210488908   +  -13.85       -6.94    4.9    2.95s
 15   -73.79210488908      -13.55       -7.76    5.1    3.11s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0491929534399995e-8,-9.303938366304927e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.379210e+01     1.323229e-03
 * time: 3.910064697265625e-5
┌ Warning: Negative ρcore detected: -3.06108930908926e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77479841248                   -0.88    9.6    5.78s
  2   -73.78498712214       -1.99       -1.08    5.2    3.11s
  3   -73.79091324829       -2.23       -1.42    6.6    4.33s
  4   -73.79196067471       -2.98       -1.80    5.9    3.40s
  5   -73.79209148950       -3.88       -2.31    5.0    3.02s
  6   -73.79210644768       -4.83       -3.10    5.6    3.33s
  7   -73.79210646827       -7.69       -3.55    4.2    2.72s
  8   -73.79210649336       -7.60       -3.97    5.3    3.62s
  9   -73.79210649307   +   -9.55       -4.31    5.5    3.31s
 10   -73.79210649549       -8.62       -4.81    5.5    3.32s
 11   -73.79210649554      -10.34       -5.34    5.0    3.30s
 12   -73.79210649555      -10.86       -6.13    5.0    3.22s
 13   -73.79210649555      -12.55       -6.48    5.3    3.34s
 14   -73.79210649555      -13.25       -6.92    5.0    3.04s
 15   -73.79210649555      -13.85       -7.79    5.0    3.17s
┌ Warning: Negative ρcore detected: -3.06108930908926e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77480722984                   -0.88    9.6    5.79s
  2   -73.78498516444       -1.99       -1.08    5.2    3.01s
  3   -73.79091394719       -2.23       -1.42    6.7    4.06s
  4   -73.79196011182       -2.98       -1.80    5.8    3.45s
  5   -73.79209180249       -3.88       -2.31    4.9    3.13s
  6   -73.79210645432       -4.83       -3.10    5.5    3.54s
  7   -73.79210646496       -7.97       -3.55    4.6    3.07s
  8   -73.79210649283       -7.55       -3.97    5.2    3.29s
  9   -73.79210649297       -9.86       -4.30    5.6    3.52s
 10   -73.79210649549       -8.60       -4.81    5.5    3.41s
 11   -73.79210649554      -10.34       -5.33    5.0    3.36s
 12   -73.79210649555      -10.81       -6.11    5.0    3.19s
 13   -73.79210649555      -12.45       -6.48    5.3    3.39s
 14   -73.79210649555      -13.15       -6.90    4.8    3.10s
 15   -73.79210649555   +  -13.55       -7.78    5.1    3.40s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.06108930908926e-8,-8.677772453919332e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     1    -7.379211e+01     1.105031e-03
 * time: 159.8179681301117
┌ Warning: Negative ρcore detected: -3.1088272820834014e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77467794919                   -0.88    9.6    6.14s
  2   -73.78493988212       -1.99       -1.08    5.2    3.13s
  3   -73.79091019521       -2.22       -1.42    6.7    4.10s
  4   -73.79196147325       -2.98       -1.80    5.8    3.45s
  5   -73.79209372547       -3.88       -2.29    4.9    3.05s
  6   -73.79211016724       -4.78       -3.10    5.5    3.43s
  7   -73.79211018309       -7.80       -3.54    4.3    2.89s
  8   -73.79211021065       -7.56       -3.96    5.2    3.29s
  9   -73.79211021087       -9.67       -4.31    5.5    3.47s
 10   -73.79211021333       -8.61       -4.81    5.4    3.13s
 11   -73.79211021337      -10.33       -5.34    5.0    3.21s
 12   -73.79211021339      -10.88       -6.12    5.0    3.09s
 13   -73.79211021339      -12.42       -6.41    5.3    3.18s
 14   -73.79211021339      -13.55       -6.90    5.1    3.08s
 15   -73.79211021339   +  -13.15       -7.74    5.1    3.23s
┌ Warning: Negative ρcore detected: -3.1088272820834014e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77468507915                   -0.88    9.6    5.71s
  2   -73.78491725117       -1.99       -1.08    5.2    2.93s
  3   -73.79091440157       -2.22       -1.42    6.7    3.96s
  4   -73.79196066902       -2.98       -1.80    5.8    3.34s
  5   -73.79209391534       -3.88       -2.29    4.9    3.02s
  6   -73.79211015569       -4.79       -3.09    5.5    3.27s
  7   -73.79211020157       -7.34       -3.57    4.6    2.86s
  8   -73.79211021305       -7.94       -4.05    5.3    3.15s
  9   -73.79211021230   +   -9.13       -4.47    5.4    3.41s
 10   -73.79211021333       -8.99       -4.79    5.4    3.37s
 11   -73.79211021338      -10.29       -5.45    4.9    2.98s
 12   -73.79211021339      -11.28       -6.17    4.8    2.92s
 13   -73.79211021339      -13.07       -6.36    4.4    2.81s
 14   -73.79211021339      -13.00       -6.96    5.1    3.04s
 15   -73.79211021339      -13.25       -7.94    5.1    3.11s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1088272820834014e-8,-5.5940308622671756e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     2    -7.379211e+01     6.417382e-06
 * time: 317.7711169719696
┌ Warning: Negative ρcore detected: -3.109045896468087e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77467409503                   -0.88    9.6    5.53s
  2   -73.78494479009       -1.99       -1.08    5.1    3.05s
  3   -73.79090908297       -2.22       -1.42    6.6    3.86s
  4   -73.79196124643       -2.98       -1.80    5.8    3.25s
  5   -73.79209386628       -3.88       -2.29    4.9    3.13s
  6   -73.79211016783       -4.79       -3.10    5.5    3.36s
  7   -73.79211018443       -7.78       -3.54    4.3    2.81s
  8   -73.79211021087       -7.58       -3.96    5.3    3.17s
  9   -73.79211021095      -10.08       -4.30    5.5    3.34s
 10   -73.79211021345       -8.60       -4.81    5.4    3.27s
 11   -73.79211021350      -10.31       -5.34    5.1    3.15s
 12   -73.79211021351      -10.88       -6.11    4.9    3.02s
 13   -73.79211021351      -12.43       -6.42    5.2    3.23s
 14   -73.79211021351      -13.37       -6.90    5.0    3.03s
 15   -73.79211021351      -13.85       -7.74    5.0    3.13s
┌ Warning: Negative ρcore detected: -3.109045896468087e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77467418592                   -0.88    9.5    5.77s
  2   -73.78493846200       -1.99       -1.08    5.2    3.07s
  3   -73.79091001845       -2.22       -1.42    6.6    4.07s
  4   -73.79196131285       -2.98       -1.80    5.8    3.18s
  5   -73.79209373360       -3.88       -2.29    4.9    2.99s
  6   -73.79211016283       -4.78       -3.09    5.5    3.37s
  7   -73.79211018546       -7.65       -3.54    4.1    2.75s
  8   -73.79211021133       -7.59       -3.96    5.3    3.20s
  9   -73.79211021111   +   -9.65       -4.32    5.5    3.39s
 10   -73.79211021345       -8.63       -4.81    5.5    3.31s
 11   -73.79211021350      -10.27       -5.38    5.1    3.24s
 12   -73.79211021351      -10.97       -6.14    4.9    3.14s
 13   -73.79211021351      -12.67       -6.37    5.2    3.31s
 14   -73.79211021351      -13.37       -6.91    5.0    3.06s
 15   -73.79211021351   +  -13.55       -7.71    5.1    3.25s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.109045896468087e-8,-5.5764475702355675e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     3    -7.379211e+01     4.396148e-08
 * time: 475.61105012893677
 * Status: success

 * Candidate solution
    Final objective value:     -7.379211e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.91e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 6.94e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.25e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.69e-12 ≰ 0.0e+00
    |g(x)|                 = 4.40e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   476  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

V: 564.931199 seconds (501.49 M allocations: 291.990 GiB, 8.49% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T17:47:35.663
└   θ = ComponentVector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}(κ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.598384000222119,1.0,0.0), μ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.21942944303478606,0.0,1.0))
┌ Info: 2025-05-20T17:47:35.681
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.322014619028234)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458152564325                   -0.96    7.1    1.31s
  2   -8.460048098812       -2.72       -1.74    2.1    861ms
  3   -8.460111184292       -4.20       -2.83    3.7    879ms
  4   -8.460112000414       -6.09       -3.85    4.3    1.03s
  5   -8.460112006980       -8.18       -4.60    4.4    1.18s
  6   -8.460112007206       -9.65       -5.42    4.6    916ms
  7   -8.460112007210      -11.32       -6.24    3.8    953ms
  8   -8.460112007211      -12.98       -7.58    3.7    1.07s
Iter     Function value   Gradient norm 
     0    -8.460112e+00     3.495758e-08
 * time: 3.3855438232421875e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.460112e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.50e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458139725856                   -0.96    7.1    1.50s
  2   -8.460046370718       -2.72       -1.74    2.0    658ms
  3   -8.460111204468       -4.19       -2.83    3.8    964ms
  4   -8.460112000174       -6.10       -3.86    4.4    1.17s
  5   -8.460112006970       -8.17       -4.60    4.5    983ms
  6   -8.460112007206       -9.63       -5.46    4.6    994ms
  7   -8.460112007210      -11.39       -6.29    3.9    1.12s
  8   -8.460112007211      -13.08       -7.63    3.7    876ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.14e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.53e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.31e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 7.15e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.16e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.06e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 8.97e-10
└ * number of operations = 8
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458150173157                   -0.96    7.0    1.38s
  2   -8.460048190167       -2.72       -1.74    2.0    612ms
  3   -8.460111321383       -4.20       -2.83    3.7    899ms
  4   -8.460112000137       -6.17       -3.87    4.3    1.12s
  5   -8.460112006945       -8.17       -4.58    4.5    971ms
  6   -8.460112007205       -9.58       -5.40    4.5    916ms
  7   -8.460112007210      -11.25       -6.24    3.8    1.06s
  8   -8.460112007211      -12.88       -7.64    3.8    894ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.08e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.54e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.38e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.04e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 5.31e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 8.42e-09
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 9.11e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.40e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.72e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.96e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.35e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 3.19e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 5.58e-10
└ * number of operations = 8
Si: 177.595372 seconds (254.86 M allocations: 211.482 GiB, 9.93% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T17:50:33.278
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.621826154322857)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19869217475                   -1.17    9.2    7.75s
  2   -62.20269866947       -2.40       -1.23    4.0    3.93s
  3   -62.20667033706       -2.40       -2.08    5.5    5.06s
  4   -62.20669578979       -4.59       -2.91    4.1    5.37s
  5   -62.20669631565       -6.28       -3.64    4.0    4.83s
  6   -62.20669632623       -7.98       -4.48    5.1    5.02s
  7   -62.20669632643       -9.69       -5.22    4.2    4.82s
  8   -62.20669632644      -11.10       -6.65    4.3    4.87s
  9   -62.20669632644      -13.30       -7.74    5.2    5.21s
Iter     Function value   Gradient norm 
     0    -6.220670e+01     7.739165e-07
 * time: 3.1948089599609375e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.220670e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 7.74e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19869046492                   -1.17    9.1    7.81s
  2   -62.20270141447       -2.40       -1.23    3.8    4.09s
  3   -62.20667019003       -2.40       -2.08    5.2    4.98s
  4   -62.20669579430       -4.59       -2.91    4.4    4.73s
  5   -62.20669631504       -6.28       -3.62    4.0    4.63s
  6   -62.20669632620       -7.95       -4.43    5.1    5.07s
  7   -62.20669632643       -9.63       -5.16    4.1    5.09s
  8   -62.20669632644      -11.03       -6.74    4.3    4.79s
  9   -62.20669632644      -12.89       -7.73    5.5    5.50s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.10e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.03e+00
[ Info: GMRES linsolve in iteration 1; step 2: normres = 6.12e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.03e-02
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.69e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.01e-05
[ Info: GMRES linsolve in iteration 1; step 6: normres = 5.15e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 1.56e-08
└ * number of operations = 9
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19869297935                   -1.17    9.0    7.76s
  2   -62.20269734691       -2.40       -1.23    3.9    3.95s
  3   -62.20667038901       -2.40       -2.08    5.5    5.10s
  4   -62.20669580988       -4.59       -2.92    4.4    4.75s
  5   -62.20669631568       -6.30       -3.64    4.1    4.57s
  6   -62.20669632622       -7.98       -4.46    5.1    4.95s
  7   -62.20669632643       -9.67       -5.19    4.3    4.75s
  8   -62.20669632644      -11.03       -6.60    4.4    4.59s
  9   -62.20669632644   +  -14.15       -7.74    5.1    5.29s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 9.31e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.09e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 6.41e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.25e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.08e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.76e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.96e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 5.67e-09
└ * number of operations = 9
[ Info: GMRES linsolve starts with norm of residual = 2.26e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.04e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 9.05e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.31e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.21e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.73e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 4.11e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 9.39e-09
└ * number of operations = 9
NaCl: 1276.129230 seconds (954.92 M allocations: 1.341 TiB, 4.52% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T18:11:49.408
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.630793189772731)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317140533161                   -1.46    5.6    1.06s
  2   -2.317215290966       -4.13       -1.84    1.4    442ms
  3   -2.317231830684       -4.78       -3.58    3.3    726ms
  4   -2.317232008472       -6.75       -4.02    4.6    941ms
  5   -2.317232009046       -9.24       -4.28    2.3    615ms
  6   -2.317232009245       -9.70       -4.98    2.7    640ms
  7   -2.317232009251      -11.24       -5.68    2.6    644ms
  8   -2.317232009251      -12.64       -6.14    2.7    627ms
  9   -2.317232009251      -13.95       -6.89    2.0    550ms
 10   -2.317232009251      -14.88       -7.39    2.6    651ms
Iter     Function value   Gradient norm 
     0    -2.317232e+00     5.344684e-09
 * time: 3.910064697265625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.317232e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 5.34e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317136184744                   -1.46    5.6    1.15s
  2   -2.317214874917       -4.10       -1.84    1.4    454ms
  3   -2.317231802494       -4.77       -3.58    3.2    882ms
  4   -2.317232008534       -6.69       -4.04    4.7    980ms
  5   -2.317232009066       -9.27       -4.30    2.3    591ms
  6   -2.317232009246       -9.74       -4.99    2.7    938ms
  7   -2.317232009251      -11.34       -5.70    2.5    694ms
  8   -2.317232009251      -12.62       -6.24    2.7    652ms
  9   -2.317232009251      -14.05       -6.95    2.1    555ms
 10   -2.317232009251   +    -Inf       -7.41    2.6    913ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.97e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.72e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.94e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.04e-06
[ Info: GMRES linsolve in iteration 1; step 4: normres = 3.92e-08
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 5.48e-10
└ * number of operations = 7
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317135654430                   -1.46    5.6    1.04s
  2   -2.317214487356       -4.10       -1.84    1.4    634ms
  3   -2.317231831379       -4.76       -3.58    3.3    737ms
  4   -2.317232008479       -6.75       -4.02    4.6    958ms
  5   -2.317232009056       -9.24       -4.29    2.4    672ms
  6   -2.317232009246       -9.72       -4.98    2.8    893ms
  7   -2.317232009251      -11.31       -5.68    2.5    587ms
  8   -2.317232009251      -12.66       -6.17    2.7    646ms
  9   -2.317232009251      -13.95       -6.79    2.0    598ms
 10   -2.317232009251      -15.35       -7.35    2.5    860ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.19e-03
[ Info: GMRES linsolve in iteration 1; step 1: normres = 5.42e-05
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.29e-06
[ Info: GMRES linsolve in iteration 1; step 3: normres = 9.70e-08
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 1.01e-09
└ * number of operations = 6
[ Info: GMRES linsolve starts with norm of residual = 2.44e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.87e-03
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.36e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 8.29e-07
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 1.10e-08
└ * number of operations = 6
Al: 162.953859 seconds (157.16 M allocations: 86.818 GiB, 7.07% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T18:14:32.364
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.640694441143135)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.109045896468087e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77468533794                   -0.88    9.6    5.80s
  2   -73.78493115712       -1.99       -1.08    5.2    3.04s
  3   -73.79091081528       -2.22       -1.42    6.7    3.97s
  4   -73.79196108444       -2.98       -1.80    5.8    3.31s
  5   -73.79209417959       -3.88       -2.30    4.9    3.01s
  6   -73.79211016972       -4.80       -3.10    5.5    3.33s
  7   -73.79211018701       -7.76       -3.55    4.2    2.79s
  8   -73.79211021116       -7.62       -3.97    5.2    3.22s
  9   -73.79211021110   +  -10.18       -4.32    5.5    3.41s
 10   -73.79211021345       -8.63       -4.80    5.5    3.16s
 11   -73.79211021350      -10.34       -5.34    5.0    3.17s
 12   -73.79211021351      -10.85       -6.14    5.0    3.20s
 13   -73.79211021351      -12.47       -6.47    5.2    3.29s
 14   -73.79211021351      -13.25       -6.90    5.0    3.10s
 15   -73.79211021351   +  -13.25       -7.77    5.0    3.21s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.109045896468087e-8,-5.5764475702355675e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.379211e+01     3.855886e-08
 * time: 3.695487976074219e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.379211e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.86e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.109045896468087e-8,-5.5764475702355675e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.109045896468087e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77467378343                   -0.88    9.5    5.83s
  2   -73.78493345340       -1.99       -1.08    5.2    3.04s
  3   -73.79091133890       -2.22       -1.42    6.6    3.97s
  4   -73.79196091597       -2.98       -1.80    5.9    3.17s
  5   -73.79209395065       -3.88       -2.29    5.0    2.71s
  6   -73.79211016599       -4.79       -3.09    5.5    3.31s
  7   -73.79211018747       -7.67       -3.54    4.0    2.76s
  8   -73.79211021138       -7.62       -3.96    5.2    3.27s
  9   -73.79211021114   +   -9.62       -4.32    5.5    3.24s
 10   -73.79211021345       -8.64       -4.81    5.5    3.38s
 11   -73.79211021350      -10.29       -5.36    5.1    3.27s
 12   -73.79211021351      -10.91       -6.14    4.9    3.28s
 13   -73.79211021351      -12.64       -6.41    5.2    3.04s
 14   -73.79211021351      -13.15       -6.92    5.1    3.12s
 15   -73.79211021351      -13.37       -7.74    5.1    3.32s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.37e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.01e+01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.24e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.76e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 5.06e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.32e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.55e-08
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}(Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.1090458939225075e-8,-5.5764475788618814e-8),Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-5.576447567434913e-8,4.491258466670949e-6))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Computing cross-derivative ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.109045896468087e-8,0.0,0.0)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.109045896468087e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77467294792                   -0.88    9.5    5.31s
  2   -73.78493574095       -1.99       -1.08    5.2    3.11s
  3   -73.79091241549       -2.22       -1.42    6.6    4.01s
  4   -73.79196053638       -2.98       -1.80    5.8    3.24s
  5   -73.79209371230       -3.88       -2.29    4.9    3.06s
  6   -73.79211015295       -4.78       -3.09    5.5    3.39s
  7   -73.79211019949       -7.33       -3.56    4.5    2.77s
  8   -73.79211021309       -7.87       -4.05    5.4    3.08s
  9   -73.79211021237   +   -9.14       -4.46    5.4    3.26s
 10   -73.79211021346       -8.96       -4.79    5.4    3.15s
 11   -73.79211021351      -10.35       -5.45    5.0    3.10s
 12   -73.79211021351      -11.31       -6.16    4.7    2.98s
 13   -73.79211021351      -13.55       -6.34    4.7    2.83s
 14   -73.79211021351      -12.89       -6.93    5.0    2.97s
 15   -73.79211021351   +  -13.55       -8.07    4.9    3.10s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 6.75e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.17e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.62e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.00e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 8.54e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 8.79e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.03e-09
└ * number of operations = 8
[ Info: GMRES linsolve starts with norm of residual = 4.29e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.88e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.28e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.23e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 7.76e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.05e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.13e-09
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}, KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.1090458939225075e-8,0.0,0.0),Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-5.576447568020912e-8,0.0,0.0))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
V: 804.494965 seconds (631.97 M allocations: 904.988 GiB, 7.24% gc time, 0.00% compilation time)
     7     8.623608e-05     2.384298e-04
 * Current step size: 1.0
 * time: 23777.41818499565
 * g(x): (κ = 0.00023842982511802245, μ = 0.00018213218069035178)
 * ~inv(H): [421.3749231637771 -254.00042519060014; -254.00042519060014 181.95012015845316]
 * x: (κ = 0.598384000222119, μ = 0.21942944303478606)
┌ Info: 2025-05-20T18:27:56.863
└   θ = ComponentVector{Float64}(κ = 0.5441773023193001, μ = 0.2468517478315536)
┌ Info: 2025-05-20T18:27:56.863
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.322014619028234)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.467237691471                   -0.96    7.1    1.32s
  2   -8.469216533621       -2.70       -1.73    2.0    594ms
  3   -8.469273869106       -4.24       -2.80    3.7    883ms
  4   -8.469274640730       -6.11       -3.92    4.1    949ms
  5   -8.469274644316       -8.45       -4.64    4.3    1.20s
  6   -8.469274644443       -9.90       -5.58    4.3    869ms
  7   -8.469274644446      -11.54       -6.35    4.0    965ms
  8   -8.469274644446      -13.22       -7.79    3.8    1.10s
Iter     Function value   Gradient norm 
     0    -8.469275e+00     8.262526e-04
 * time: 3.719329833984375e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.467254686881                   -0.96    7.5    1.56s
  2   -8.469219976265       -2.71       -1.73    2.4    717ms
  3   -8.469274597001       -4.26       -2.80    3.7    1.15s
  4   -8.469275299477       -6.15       -3.92    4.1    910ms
  5   -8.469275302751       -8.48       -4.66    4.5    1.07s
  6   -8.469275302866       -9.94       -5.62    4.5    1.14s
  7   -8.469275302869      -11.65       -6.37    4.1    914ms
  8   -8.469275302869      -13.22       -7.79    3.9    902ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.467259465363                   -0.96    7.5    1.44s
  2   -8.469219850431       -2.71       -1.73    2.4    628ms
  3   -8.469274616539       -4.26       -2.80    3.8    931ms
  4   -8.469275299176       -6.17       -3.94    4.2    1.10s
  5   -8.469275302723       -8.45       -4.63    4.7    1.00s
  6   -8.469275302866       -9.85       -5.57    4.3    953ms
  7   -8.469275302869      -11.50       -6.34    4.1    1.12s
  8   -8.469275302869      -13.17       -7.84    3.9    920ms
     1    -8.469275e+00     7.675071e-04
 * time: 27.113083124160767
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.467253335684                   -0.96    7.3    1.39s
  2   -8.469222844421       -2.71       -1.73    2.1    866ms
  3   -8.469278714157       -4.25       -2.80    3.7    869ms
  4   -8.469279457614       -6.13       -3.92    4.1    990ms
  5   -8.469279461101       -8.46       -4.67    4.6    1.20s
  6   -8.469279461205       -9.98       -5.63    4.5    908ms
  7   -8.469279461207      -11.68       -6.40    4.1    998ms
  8   -8.469279461207      -13.37       -7.72    3.9    1.07s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.467252469507                   -0.96    7.3    1.58s
  2   -8.469224379923       -2.71       -1.73    2.2    675ms
  3   -8.469278824960       -4.26       -2.80    3.8    1.17s
  4   -8.469279457565       -6.20       -3.92    4.1    1.22s
  5   -8.469279461094       -8.45       -4.66    4.4    1.05s
  6   -8.469279461205       -9.95       -5.65    4.5    1.13s
  7   -8.469279461207      -11.67       -6.39    4.2    947ms
  8   -8.469279461207      -13.34       -7.78    3.9    976ms
     2    -8.469279e+00     4.217606e-06
 * time: 55.11649417877197
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.467250268965                   -0.96    7.3    1.52s
  2   -8.469222433056       -2.71       -1.73    2.2    632ms
  3   -8.469278707421       -4.25       -2.80    3.7    973ms
  4   -8.469279457251       -6.13       -3.92    4.2    1.19s
  5   -8.469279461194       -8.40       -4.63    4.5    955ms
  6   -8.469279461331       -9.86       -5.58    4.4    1.01s
  7   -8.469279461334      -11.54       -6.34    4.1    1.11s
  8   -8.469279461334      -13.17       -7.70    3.8    927ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.467254216830                   -0.96    7.3    1.37s
  2   -8.469223318592       -2.71       -1.73    2.2    914ms
  3   -8.469278727068       -4.26       -2.80    3.8    892ms
  4   -8.469279457881       -6.14       -3.93    4.1    1.01s
  5   -8.469279461215       -8.48       -4.65    4.6    1.19s
  6   -8.469279461332       -9.93       -5.62    4.4    931ms
  7   -8.469279461334      -11.62       -6.36    4.1    1.21s
  8   -8.469279461334      -13.27       -7.75    3.9    874ms
     3    -8.469279e+00     2.142042e-08
 * time: 83.13549208641052
 * Status: success

 * Candidate solution
    Final objective value:     -8.469279e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 5.96e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 5.77e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.27e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.50e-11 ≰ 0.0e+00
    |g(x)|                 = 2.14e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   83  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 99.490350 seconds (197.34 M allocations: 57.054 GiB, 10.87% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T18:29:36.355
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.621826154322857)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.24124886800                   -1.18    9.1    8.41s
  2   -62.24515570925       -2.41       -1.23    4.1    4.17s
  3   -62.24930406847       -2.38       -2.08    5.8    5.31s
  4   -62.24932978332       -4.59       -2.92    4.1    4.95s
  5   -62.24933036425       -6.24       -3.66    4.0    4.78s
  6   -62.24933037090       -8.18       -4.48    5.0    5.01s
  7   -62.24933037117       -9.57       -5.31    4.4    4.89s
  8   -62.24933037118      -11.09       -6.89    4.2    4.89s
  9   -62.24933037118      -13.25       -7.96    5.5    5.56s
Iter     Function value   Gradient norm 
     0    -6.224933e+01     7.623842e-04
 * time: 3.600120544433594e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.24125284904                   -1.18    8.8    7.76s
  2   -62.24515696811       -2.41       -1.23    4.1    4.04s
  3   -62.24930445167       -2.38       -2.08    5.9    5.26s
  4   -62.24933037400       -4.59       -2.92    4.0    4.76s
  5   -62.24933093904       -6.25       -3.66    3.9    4.80s
  6   -62.24933094588       -8.16       -4.46    4.8    4.84s
  7   -62.24933094615       -9.56       -5.23    4.4    4.85s
  8   -62.24933094616      -10.97       -6.90    4.2    4.74s
  9   -62.24933094616   +  -14.15       -8.00    5.2    5.37s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.24125117225                   -1.18    8.8    7.44s
  2   -62.24515307573       -2.41       -1.23    3.8    3.88s
  3   -62.24930422749       -2.38       -2.08    5.7    5.11s
  4   -62.24933037261       -4.58       -2.91    4.0    4.73s
  5   -62.24933093905       -6.25       -3.65    4.0    4.66s
  6   -62.24933094589       -8.16       -4.45    4.9    4.95s
  7   -62.24933094615       -9.59       -5.16    4.2    4.78s
  8   -62.24933094616      -10.89       -6.81    4.0    4.63s
  9   -62.24933094616      -13.37       -7.93    4.9    5.27s
     1    -6.224933e+01     7.459973e-04
 * time: 120.07723307609558
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.24136393515                   -1.18    9.0    7.58s
  2   -62.24526807636       -2.41       -1.23    4.0    4.14s
  3   -62.24931836850       -2.39       -2.09    5.6    4.86s
  4   -62.24934322763       -4.60       -2.94    4.2    4.42s
  5   -62.24934372264       -6.31       -3.68    4.0    4.53s
  6   -62.24934372835       -8.24       -4.50    5.2    4.58s
  7   -62.24934372858       -9.64       -5.23    4.4    4.57s
  8   -62.24934372859      -10.96       -6.74    4.1    4.50s
  9   -62.24934372859      -13.03       -7.92    5.0    5.08s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.24136584201                   -1.18    9.0    7.43s
  2   -62.24526845200       -2.41       -1.23    4.2    3.86s
  3   -62.24931840000       -2.39       -2.09    5.8    4.91s
  4   -62.24934322694       -4.61       -2.94    4.0    4.57s
  5   -62.24934372256       -6.30       -3.68    4.1    4.65s
  6   -62.24934372834       -8.24       -4.50    5.2    4.82s
  7   -62.24934372858       -9.62       -5.24    4.4    4.77s
  8   -62.24934372859      -10.98       -6.71    4.1    4.62s
  9   -62.24934372859      -13.19       -7.98    5.0    5.09s
     2    -6.224934e+01     1.398975e-05
 * time: 237.15001106262207
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.24136604607                   -1.18    9.3    7.84s
  2   -62.24525548653       -2.41       -1.23    4.0    4.01s
  3   -62.24931859416       -2.39       -2.09    5.8    5.06s
  4   -62.24934328211       -4.61       -2.97    4.2    4.67s
  5   -62.24934372819       -6.35       -3.73    4.1    4.73s
  6   -62.24934373277       -8.34       -4.57    5.7    4.92s
  7   -62.24934373296       -9.71       -5.15    4.6    4.93s
  8   -62.24934373298      -10.70       -6.89    4.1    4.92s
  9   -62.24934373298   +  -13.85       -7.95    5.4    6.73s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.24136081348                   -1.18    9.1    9.94s
  2   -62.24526310674       -2.41       -1.23    4.1    4.00s
  3   -62.24931845779       -2.39       -2.09    5.8    5.33s
  4   -62.24934326200       -4.61       -2.96    4.3    4.97s
  5   -62.24934372780       -6.33       -3.71    4.1    5.71s
  6   -62.24934373277       -8.30       -4.55    5.2    4.80s
  7   -62.24934373297       -9.70       -5.19    4.6    6.60s
  8   -62.24934373298      -10.82       -6.77    4.1    4.58s
  9   -62.24934373298      -13.25       -7.97    5.3    5.36s
     3    -6.224934e+01     2.500338e-07
 * time: 367.4256670475006
 * Status: success

 * Candidate solution
    Final objective value:     -6.224934e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 6.39e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 6.03e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 4.39e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 7.05e-11 ≰ 0.0e+00
    |g(x)|                 = 2.50e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   367  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

NaCl: 437.010837 seconds (756.24 M allocations: 257.904 GiB, 7.37% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T18:36:53.367
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.630793189772731)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318602308339                   -1.47    5.7    1.29s
  2   -2.318671033782       -4.16       -1.84    1.4    592ms
  3   -2.318685405312       -4.84       -3.53    3.3    767ms
  4   -2.318685624164       -6.66       -3.90    4.5    1.40s
  5   -2.318685624841       -9.17       -4.10    2.0    612ms
  6   -2.318685625139       -9.52       -4.97    2.7    744ms
  7   -2.318685625154      -10.83       -5.63    3.0    987ms
  8   -2.318685625154      -12.43       -5.93    2.5    723ms
  9   -2.318685625155      -13.04       -6.46    2.4    693ms
 10   -2.318685625155      -14.35       -7.22    2.7    1.06s
Iter     Function value   Gradient norm 
     0    -2.318686e+00     7.808532e-04
 * time: 2.7894973754882812e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318598973873                   -1.47    5.6    1.65s
  2   -2.318671002312       -4.14       -1.84    1.3    629ms
  3   -2.318686011878       -4.82       -3.54    3.2    1.01s
  4   -2.318686221485       -6.68       -3.90    4.4    1.11s
  5   -2.318686222150       -9.18       -4.10    2.1    529ms
  6   -2.318686222450       -9.52       -4.96    2.6    609ms
  7   -2.318686222465      -10.83       -5.63    3.1    877ms
  8   -2.318686222465      -12.39       -5.90    2.5    587ms
  9   -2.318686222465      -13.01       -6.48    2.3    572ms
 10   -2.318686222465      -14.24       -7.18    2.8    680ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318602644264                   -1.47    5.5    1.08s
  2   -2.318671458232       -4.16       -1.84    1.3    514ms
  3   -2.318685971867       -4.84       -3.54    3.2    1.02s
  4   -2.318686221462       -6.60       -3.89    4.4    894ms
  5   -2.318686222155       -9.16       -4.10    2.1    522ms
  6   -2.318686222450       -9.53       -4.96    2.6    867ms
  7   -2.318686222465      -10.84       -5.65    3.0    658ms
  8   -2.318686222465      -12.39       -5.85    2.4    566ms
  9   -2.318686222465      -12.95       -6.47    2.0    670ms
 10   -2.318686222465      -14.45       -7.17    3.0    958ms
     1    -2.318686e+00     7.490384e-04
 * time: 42.068126916885376
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318607922690                   -1.47    5.6    1.08s
  2   -2.318678012006       -4.15       -1.84    1.4    550ms
  3   -2.318692814716       -4.83       -3.56    3.3    925ms
  4   -2.318693015838       -6.70       -3.96    4.5    1.09s
  5   -2.318693016330       -9.31       -4.18    2.2    625ms
  6   -2.318693016518       -9.72       -5.10    2.6    1.10s
  7   -2.318693016528      -11.01       -5.89    3.2    1.02s
  8   -2.318693016528      -12.75       -6.38    3.0   1000ms
  9   -2.318693016528      -13.88       -6.90    2.9    1.02s
 10   -2.318693016528      -14.88       -7.83    2.7    995ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318604870924                   -1.47    5.6    1.37s
  2   -2.318677386873       -4.14       -1.84    1.4    649ms
  3   -2.318692804489       -4.81       -3.55    3.3    691ms
  4   -2.318693015842       -6.67       -3.96    4.4    913ms
  5   -2.318693016339       -9.30       -4.19    2.2    590ms
  6   -2.318693016519       -9.75       -5.10    2.5    733ms
  7   -2.318693016528      -11.03       -5.90    3.3    714ms
  8   -2.318693016528      -12.88       -6.30    2.8    669ms
  9   -2.318693016528      -13.76       -6.80    2.7    822ms
 10   -2.318693016528      -14.88       -7.76    2.7    591ms
     2    -2.318693e+00     1.524952e-05
 * time: 85.37507581710815
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318606336641                   -1.47    5.5    1.11s
  2   -2.318677914069       -4.15       -1.84    1.3    556ms
  3   -2.318692798494       -4.83       -3.56    3.3    1.15s
  4   -2.318693018602       -6.66       -3.97    4.6    990ms
  5   -2.318693019071       -9.33       -4.19    2.1    548ms
  6   -2.318693019256       -9.73       -5.11    2.5    702ms
  7   -2.318693019265      -11.05       -5.89    3.1    572ms
  8   -2.318693019266      -12.77       -6.15    2.7    536ms
  9   -2.318693019266      -13.55       -6.77    2.2    515ms
 10   -2.318693019266      -15.05       -7.73    2.9    697ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318604334190                   -1.47    5.5    1.24s
  2   -2.318677652138       -4.13       -1.84    1.3    664ms
  3   -2.318692838770       -4.82       -3.55    3.2    666ms
  4   -2.318693018557       -6.75       -3.96    4.4    930ms
  5   -2.318693019067       -9.29       -4.19    2.1    555ms
  6   -2.318693019255       -9.73       -5.08    2.6    779ms
  7   -2.318693019265      -10.99       -5.88    3.2    691ms
  8   -2.318693019266      -12.75       -6.35    2.8    787ms
  9   -2.318693019266      -13.82       -6.88    2.8    911ms
 10   -2.318693019266      -14.75       -7.89    2.7    584ms
     3    -2.318693e+00     3.235823e-07
 * time: 126.50860500335693
 * Status: success

 * Candidate solution
    Final objective value:     -2.318693e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.67e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.80e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.74e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.18e-09 ≰ 0.0e+00
    |g(x)|                 = 3.24e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   127  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Al: 153.129898 seconds (149.45 M allocations: 41.825 GiB, 6.30% gc time, 0.11% compilation time)
┌ Info: 2025-05-20T18:39:26.498
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.640694441143135)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.109045896468087e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.81431101815                   -0.89    9.5    7.59s
  2   -73.82396038132       -2.02       -1.09    5.1    2.92s
  3   -73.82960438897       -2.25       -1.43    6.5    3.90s
  4   -73.83059187911       -3.01       -1.82    5.7    3.39s
  5   -73.83071452603       -3.91       -2.33    4.9    2.93s
  6   -73.83072777671       -4.88       -3.12    5.5    3.25s
  7   -73.83072777951       -8.55       -3.55    4.6    2.87s
  8   -73.83072781626       -7.43       -4.00    5.2    3.08s
  9   -73.83072781673       -9.33       -4.32    5.5    3.26s
 10   -73.83072781916       -8.61       -4.90    5.5    3.32s
 11   -73.83072781917      -10.83       -5.36    4.5    2.82s
 12   -73.83072781919      -10.85       -6.03    5.0    3.05s
 13   -73.83072781919      -12.08       -6.50    5.3    3.23s
 14   -73.83072781919   +  -13.85       -6.98    4.7    2.92s
 15   -73.83072781919      -13.15       -7.95    5.2    3.12s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.109045896468087e-8,-5.5764475702355675e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.383073e+01     3.749576e-04
 * time: 3.719329833984375e-5
┌ Warning: Negative ρcore detected: -3.111105296328395e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.81432162703                   -0.89    9.7    5.42s
  2   -73.82395135897       -2.02       -1.09    5.0    2.91s
  3   -73.82960303885       -2.25       -1.43    6.5    3.74s
  4   -73.83059189790       -3.00       -1.82    5.7    3.23s
  5   -73.83071512252       -3.91       -2.34    4.9    3.07s
  6   -73.83072790901       -4.89       -3.12    5.5    4.16s
  7   -73.83072790907      -10.23       -3.55    4.7    3.00s
  8   -73.83072794549       -7.44       -4.00    5.3    3.25s
  9   -73.83072794569       -9.69       -4.31    5.5    3.39s
 10   -73.83072794822       -8.60       -4.89    5.5    3.21s
 11   -73.83072794824      -10.74       -5.35    4.6    2.99s
 12   -73.83072794826      -10.83       -6.02    5.0    3.12s
 13   -73.83072794826      -12.09       -6.46    5.3    3.26s
 14   -73.83072794826      -13.37       -7.02    4.8    3.09s
┌ Warning: Negative ρcore detected: -3.111105296328395e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.81431475311                   -0.89    9.5    5.59s
  2   -73.82395474822       -2.02       -1.09    5.1    3.03s
  3   -73.82960378055       -2.25       -1.43    6.5    3.89s
  4   -73.83059152580       -3.01       -1.82    5.8    3.33s
  5   -73.83071483694       -3.91       -2.33    5.0    2.94s
  6   -73.83072790495       -4.88       -3.12    5.5    3.31s
  7   -73.83072790994       -8.30       -3.55    4.5    2.96s
  8   -73.83072794553       -7.45       -4.00    5.3    3.16s
  9   -73.83072794571       -9.74       -4.31    5.6    3.18s
 10   -73.83072794823       -8.60       -4.89    5.5    3.20s
 11   -73.83072794824      -10.79       -5.35    4.5    2.91s
 12   -73.83072794826      -10.83       -6.03    5.0    3.08s
 13   -73.83072794826      -12.08       -6.47    5.3    3.25s
 14   -73.83072794826   +  -13.55       -6.96    4.6    2.92s
 15   -73.83072794826   +    -Inf       -7.95    5.1    3.10s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.111105296328395e-8,-5.408274028726758e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     1    -7.383073e+01     3.135219e-04
 * time: 152.00622701644897
┌ Warning: Negative ρcore detected: -3.120637862562892e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.81429560741                   -0.89    9.5    5.73s
  2   -73.82392514381       -2.02       -1.09    5.1    3.03s
  3   -73.82960236206       -2.25       -1.43    6.5    3.96s
  4   -73.83059108575       -3.00       -1.82    5.6    3.24s
  5   -73.83071508142       -3.91       -2.33    4.9    3.05s
  6   -73.83072820815       -4.88       -3.12    5.4    3.45s
  7   -73.83072821300       -8.31       -3.55    4.6    3.01s
  8   -73.83072824598       -7.48       -4.00    5.2    3.35s
  9   -73.83072824610       -9.93       -4.32    5.5    3.36s
 10   -73.83072824854       -8.61       -4.88    5.5    3.21s
 11   -73.83072824856      -10.68       -5.35    4.8    3.00s
 12   -73.83072824858      -10.82       -6.04    4.9    3.08s
 13   -73.83072824858      -12.14       -6.45    5.3    3.24s
 14   -73.83072824858   +  -13.85       -6.90    4.7    2.91s
 15   -73.83072824858      -13.37       -7.91    5.1    3.15s
┌ Warning: Negative ρcore detected: -3.120637862562892e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.81429274676                   -0.89    9.4    5.34s
  2   -73.82393423950       -2.02       -1.09    5.0    2.88s
  3   -73.82960087244       -2.25       -1.43    6.5    3.85s
  4   -73.83059123569       -3.00       -1.82    5.7    3.33s
  5   -73.83071495861       -3.91       -2.33    4.9    3.03s
  6   -73.83072820644       -4.88       -3.12    5.5    3.35s
  7   -73.83072821109       -8.33       -3.55    4.5    3.04s
  8   -73.83072824587       -7.46       -4.00    5.2    3.20s
  9   -73.83072824607       -9.69       -4.31    5.5    3.38s
 10   -73.83072824855       -8.61       -4.89    5.5    3.35s
 11   -73.83072824856      -10.79       -5.35    4.6    2.96s
 12   -73.83072824858      -10.84       -6.04    5.0    3.12s
 13   -73.83072824858      -12.19       -6.49    5.3    3.50s
 14   -73.83072824858      -12.89       -6.99    4.6    4.04s
 15   -73.83072824858   +    -Inf       -7.94    5.2    3.25s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.120637862562892e-8,-4.5571980284072616e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     2    -7.383073e+01     5.532225e-07
 * time: 308.8126962184906
 * Status: success

 * Candidate solution
    Final objective value:     -7.383073e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.91e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.39e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 3.00e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 4.07e-09 ≰ 0.0e+00
    |g(x)|                 = 5.53e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   309  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

V: 398.137236 seconds (358.52 M allocations: 206.413 GiB, 8.45% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T18:46:04.639
└   θ = ComponentVector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}(κ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.5441773023193001,1.0,0.0), μ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.2468517478315536,0.0,1.0))
┌ Info: 2025-05-20T18:46:04.645
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.33369546703284)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.467263005030                   -0.96    7.3    1.36s
  2   -8.469227007919       -2.71       -1.73    2.2    783ms
  3   -8.469278662324       -4.29       -2.80    3.7    835ms
  4   -8.469279457837       -6.10       -3.89    4.2    952ms
  5   -8.469279461247       -8.47       -4.68    4.4    1.10s
  6   -8.469279461332      -10.07       -5.70    4.4    871ms
  7   -8.469279461334      -11.81       -6.41    4.2    970ms
  8   -8.469279461334      -13.35       -7.64    3.8    997ms
Iter     Function value   Gradient norm 
     0    -8.469279e+00     2.094588e-08
 * time: 3.910064697265625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.469279e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 2.09e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.467257702573                   -0.96    7.3    1.50s
  2   -8.469223567269       -2.71       -1.73    2.1    655ms
  3   -8.469278758781       -4.26       -2.80    3.9    969ms
  4   -8.469279457713       -6.16       -3.92    4.1    1.12s
  5   -8.469279461223       -8.45       -4.67    4.4    943ms
  6   -8.469279461332       -9.96       -5.60    4.6    969ms
  7   -8.469279461334      -11.62       -6.35    4.2    1.31s
  8   -8.469279461334      -13.17       -7.73    3.9    1.29s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.13e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.57e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.19e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.58e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.43e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 2.03e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 4.38e-10
└ * number of operations = 8
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.467241025035                   -0.96    7.3    1.52s
  2   -8.469218723611       -2.70       -1.73    2.1    649ms
  3   -8.469278606673       -4.22       -2.80    3.8    953ms
  4   -8.469279457877       -6.07       -3.91    4.2    1.15s
  5   -8.469279461225       -8.48       -4.68    4.5    1.35s
  6   -8.469279461332       -9.97       -5.60    4.4    983ms
  7   -8.469279461334      -11.64       -6.41    4.1    1.19s
  8   -8.469279461334      -13.26       -7.68    4.0    1.17s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.49e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.99e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 6.60e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.64e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.75e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 3.62e-09
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 8.18e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.25e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 9.28e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.89e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 9.20e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 1.41e-08
└ * number of operations = 7
Si: 171.078881 seconds (249.70 M allocations: 207.839 GiB, 9.87% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T18:48:55.725
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.58699587233021)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.24136660314                   -1.18    9.3    7.42s
  2   -62.24526274102       -2.41       -1.23    4.0    4.15s
  3   -62.24931850180       -2.39       -2.09    5.7    5.05s
  4   -62.24934324753       -4.61       -2.95    4.3    4.73s
  5   -62.24934372757       -6.32       -3.71    4.1    6.23s
  6   -62.24934373274       -8.29       -4.55    5.5    6.52s
  7   -62.24934373297       -9.65       -5.32    4.6    4.85s
  8   -62.24934373298      -10.96       -6.65    4.3    4.67s
  9   -62.24934373298   +    -Inf       -7.96    4.8    5.05s
Iter     Function value   Gradient norm 
     0    -6.224934e+01     2.475752e-07
 * time: 4.38690185546875e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.224934e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 2.48e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.24136495709                   -1.18    9.1    7.22s
  2   -62.24526655336       -2.41       -1.23    4.2    3.95s
  3   -62.24931844343       -2.39       -2.09    5.8    4.97s
  4   -62.24934324985       -4.61       -2.95    4.2    4.56s
  5   -62.24934372751       -6.32       -3.70    4.1    4.58s
  6   -62.24934373275       -8.28       -4.54    5.4    4.57s
  7   -62.24934373297       -9.66       -5.32    4.6    5.47s
  8   -62.24934373298      -11.01       -6.76    4.5    4.71s
  9   -62.24934373298      -13.45       -7.99    5.0    5.27s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.12e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.07e+00
[ Info: GMRES linsolve in iteration 1; step 2: normres = 6.28e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 9.83e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.45e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 9.15e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.94e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 5.21e-09
└ * number of operations = 9
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.24136428019                   -1.18    9.2    7.48s
  2   -62.24526095220       -2.41       -1.23    3.9    4.12s
  3   -62.24931849492       -2.39       -2.09    5.8    5.83s
  4   -62.24934327413       -4.61       -2.96    4.4    4.99s
  5   -62.24934372787       -6.34       -3.72    4.2    5.14s
  6   -62.24934373276       -8.31       -4.55    5.7    4.88s
  7   -62.24934373296       -9.70       -5.18    4.7    4.72s
  8   -62.24934373298      -10.79       -6.72    4.2    4.58s
  9   -62.24934373298      -13.37       -7.96    5.1    5.21s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.12e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.47e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 7.43e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.20e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.07e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 4.56e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.17e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 3.14e-09
└ * number of operations = 9
[ Info: GMRES linsolve starts with norm of residual = 1.90e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.51e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 7.63e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.70e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.36e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 7.78e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 2.31e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 3.63e-09
└ * number of operations = 9
NaCl: 1296.702456 seconds (979.67 M allocations: 1.374 TiB, 4.84% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T19:10:32.429
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.649591410460032)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318606249324                   -1.47    5.5    1.21s
  2   -2.318677542544       -4.15       -1.84    1.3    586ms
  3   -2.318692832443       -4.82       -3.55    3.2    668ms
  4   -2.318693018571       -6.73       -3.96    4.5    870ms
  5   -2.318693019069       -9.30       -4.19    2.1    501ms
  6   -2.318693019255       -9.73       -5.09    2.5    611ms
  7   -2.318693019265      -11.00       -5.90    3.2    877ms
  8   -2.318693019266      -12.71       -6.30    2.7    642ms
  9   -2.318693019266      -13.74       -6.84    2.7    627ms
 10   -2.318693019266      -14.88       -7.85    2.7    628ms
Iter     Function value   Gradient norm 
     0    -2.318693e+00     3.236064e-07
 * time: 3.600120544433594e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.318693e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.24e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318605148430                   -1.47    5.5    1.27s
  2   -2.318678136839       -4.14       -1.84    1.3    419ms
  3   -2.318692812361       -4.83       -3.56    3.2    749ms
  4   -2.318693018555       -6.69       -3.96    4.4    1.12s
  5   -2.318693019062       -9.30       -4.18    2.1    537ms
  6   -2.318693019255       -9.71       -5.08    2.5    620ms
  7   -2.318693019265      -10.98       -5.88    3.2    1.03s
  8   -2.318693019266      -12.75       -6.33    2.8    1.06s
  9   -2.318693019266      -13.82       -6.86    2.7    844ms
 10   -2.318693019266      -14.57       -7.79    2.7    880ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.69e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.55e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.93e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.37e-06
[ Info: GMRES linsolve in iteration 1; step 4: normres = 4.66e-08
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 8.13e-10
└ * number of operations = 7
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318604917035                   -1.47    5.5    1.29s
  2   -2.318678037030       -4.14       -1.84    1.3    456ms
  3   -2.318692806691       -4.83       -3.56    3.3    802ms
  4   -2.318693018579       -6.67       -3.96    4.5    1.19s
  5   -2.318693019061       -9.32       -4.18    2.1    539ms
  6   -2.318693019256       -9.71       -5.09    2.6    629ms
  7   -2.318693019265      -11.02       -5.87    3.2    734ms
  8   -2.318693019266      -12.64       -6.34    2.8    817ms
  9   -2.318693019266      -13.75       -6.84    2.8    638ms
 10   -2.318693019266      -15.05       -7.79    2.8    630ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.75e-03
[ Info: GMRES linsolve in iteration 1; step 1: normres = 5.08e-05
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.89e-06
[ Info: GMRES linsolve in iteration 1; step 3: normres = 7.32e-08
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 1.19e-09
└ * number of operations = 6
[ Info: GMRES linsolve starts with norm of residual = 2.36e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.73e-03
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.79e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 8.17e-07
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 1.32e-08
└ * number of operations = 6
Al: 154.525846 seconds (160.27 M allocations: 89.138 GiB, 7.11% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T19:13:06.957
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.64298290131008)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.120637862562892e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.81429304259                   -0.89    9.5    6.78s
  2   -73.82393497123       -2.02       -1.09    5.1    4.15s
  3   -73.82960105560       -2.25       -1.43    6.4    3.91s
  4   -73.83059116727       -3.00       -1.82    5.7    3.27s
  5   -73.83071463070       -3.91       -2.32    4.9    3.03s
  6   -73.83072820733       -4.87       -3.12    5.5    3.91s
  7   -73.83072820949       -8.67       -3.55    4.7    2.98s
  8   -73.83072824550       -7.44       -3.99    5.2    3.06s
  9   -73.83072824605       -9.26       -4.31    5.5    3.42s
 10   -73.83072824854       -8.60       -4.88    5.5    3.36s
 11   -73.83072824856      -10.72       -5.34    4.7    3.08s
 12   -73.83072824858      -10.83       -6.03    4.9    3.16s
 13   -73.83072824858      -12.09       -6.48    5.3    3.31s
 14   -73.83072824858   +  -13.85       -6.94    4.7    2.92s
 15   -73.83072824858   +  -13.85       -7.95    5.1    2.99s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.120637862562892e-8,-4.5571980284072616e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.383073e+01     5.528981e-07
 * time: 3.910064697265625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.383073e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 5.53e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.120637862562892e-8,-4.5571980284072616e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.120637862562892e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.81429331779                   -0.89    9.3    5.06s
  2   -73.82393711629       -2.02       -1.09    5.1    2.81s
  3   -73.82960075949       -2.25       -1.43    6.5    3.84s
  4   -73.83059118890       -3.00       -1.82    5.7    3.30s
  5   -73.83071501051       -3.91       -2.33    4.8    2.80s
  6   -73.83072820454       -4.88       -3.12    5.5    3.34s
  7   -73.83072821159       -8.15       -3.55    4.5    2.88s
  8   -73.83072824590       -7.46       -4.00    5.2    3.18s
  9   -73.83072824600      -10.00       -4.31    5.6    3.19s
 10   -73.83072824854       -8.59       -4.88    5.5    3.31s
 11   -73.83072824856      -10.74       -5.34    4.5    2.98s
 12   -73.83072824858      -10.83       -6.05    5.0    3.25s
 13   -73.83072824858      -12.11       -6.45    5.3    2.97s
 14   -73.83072824858   +  -13.55       -6.91    4.7    3.00s
 15   -73.83072824858      -13.55       -7.89    5.1    3.21s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.37e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.00e+01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.13e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.69e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 3.70e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 3.83e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.00e-08
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}(Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.1206378583504927e-8,-4.557198020603027e-8),Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-4.5571980303635225e-8,4.416450851863186e-6))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Computing cross-derivative ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.120637862562892e-8,0.0,0.0)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.120637862562892e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.81430018890                   -0.89    9.5    7.38s
  2   -73.82392903507       -2.02       -1.09    5.0    3.01s
  3   -73.82960126315       -2.25       -1.43    6.5    3.86s
  4   -73.83059144070       -3.00       -1.82    5.7    3.01s
  5   -73.83071514951       -3.91       -2.33    4.9    2.92s
  6   -73.83072820899       -4.88       -3.12    5.5    3.19s
  7   -73.83072821285       -8.41       -3.55    4.7    2.70s
  8   -73.83072824583       -7.48       -4.00    5.3    3.07s
  9   -73.83072824605       -9.66       -4.31    5.5    3.26s
 10   -73.83072824855       -8.60       -4.88    5.5    4.53s
 11   -73.83072824856      -10.79       -5.34    4.4    2.89s
 12   -73.83072824858      -10.81       -6.04    5.1    3.07s
 13   -73.83072824858      -12.14       -6.48    5.3    3.04s
 14   -73.83072824858   +    -Inf       -6.89    4.7    2.88s
 15   -73.83072824858      -13.00       -7.87    5.2    3.08s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 9.05e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.49e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.96e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.33e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 7.68e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 8.30e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 7.19e-10
└ * number of operations = 8
[ Info: GMRES linsolve starts with norm of residual = 3.74e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.30e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.93e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.43e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.56e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.71e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 2.23e-09
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}, KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.1206378583504927e-8,0.0,0.0),Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-4.557198030050328e-8,0.0,0.0))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
V: 794.494836 seconds (631.89 M allocations: 899.991 GiB, 7.33% gc time, 0.00% compilation time)
     8     8.176182e-05     2.414951e-04
 * Current step size: 1.0
 * time: 27282.011276960373
 * g(x): (κ = 0.000126523723235941, μ = 0.00024149507954525368)
 * ~inv(H): [387.64424408918285 -182.3856624023066; -182.38566240230656 118.12489641524746]
 * x: (κ = 0.5441773023193001, μ = 0.2468517478315536)
┌ Info: 2025-05-20T19:26:21.456
└   θ = ComponentVector{Float64}(κ = 0.5391763493159135, μ = 0.24140127964747177)
┌ Info: 2025-05-20T19:26:21.456
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.33369546703284)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465177045251                   -0.96    7.3    1.84s
  2   -8.467139208281       -2.71       -1.73    2.2    855ms
  3   -8.467197218146       -4.24       -2.81    3.9    1.27s
  4   -8.467197869758       -6.19       -3.93    4.2    1.32s
  5   -8.467197873309       -8.45       -4.64    4.5    1.54s
  6   -8.467197873443       -9.87       -5.55    4.4    1.30s
  7   -8.467197873446      -11.51       -6.31    4.2    1.55s
  8   -8.467197873446      -13.08       -7.73    3.9    910ms
Iter     Function value   Gradient norm 
     0    -8.467198e+00     2.592287e-04
 * time: 3.814697265625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465169612053                   -0.96    7.4    1.55s
  2   -8.467139117699       -2.71       -1.73    2.2    665ms
  3   -8.467197272548       -4.24       -2.81    3.8    1.11s
  4   -8.467197934852       -6.18       -3.92    4.2    980ms
  5   -8.467197938166       -8.48       -4.67    4.6    1.04s
  6   -8.467197938280       -9.94       -5.62    4.6    1.11s
  7   -8.467197938283      -11.63       -6.41    4.2    968ms
  8   -8.467197938283      -13.27       -7.76    4.0    1.61s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465164761778                   -0.96    7.4    1.53s
  2   -8.467138957576       -2.70       -1.73    2.2    652ms
  3   -8.467197173349       -4.23       -2.81    3.7    1.15s
  4   -8.467197934524       -6.12       -3.92    4.3    921ms
  5   -8.467197938169       -8.44       -4.66    4.5    1.44s
  6   -8.467197938280       -9.95       -5.62    4.6    1.13s
  7   -8.467197938283      -11.62       -6.39    4.2    968ms
  8   -8.467197938283      -13.30       -7.71    3.8    1.29s
     1    -8.467198e+00     2.410035e-04
 * time: 29.21941900253296
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465176516939                   -0.96    7.2    1.54s
  2   -8.467141108878       -2.71       -1.73    2.0    629ms
  3   -8.467197740049       -4.25       -2.81    3.7    972ms
  4   -8.467198346592       -6.22       -3.95    4.1    1.13s
  5   -8.467198350661       -8.39       -4.60    4.5   1000ms
  6   -8.467198350829       -9.77       -5.54    4.1    931ms
  7   -8.467198350833      -11.43       -6.29    4.3    1.13s
  8   -8.467198350833      -13.01       -7.81    3.8    923ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465164783904                   -0.96    7.3    1.32s
  2   -8.467137570374       -2.70       -1.73    2.1    853ms
  3   -8.467197695440       -4.22       -2.81    3.8    898ms
  4   -8.467198346561       -6.19       -3.93    4.1    993ms
  5   -8.467198350646       -8.39       -4.59    4.6    1.18s
  6   -8.467198350829       -9.74       -5.48    4.2    921ms
  7   -8.467198350833      -11.34       -6.30    4.2    1.18s
  8   -8.467198350833      -13.07       -7.80    3.9    898ms
     2    -8.467198e+00     4.295745e-07
 * time: 56.54717707633972
 * Status: success

 * Candidate solution
    Final objective value:     -8.467198e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.43e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.32e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 4.13e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 4.87e-08 ≰ 0.0e+00
    |g(x)|                 = 4.30e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   57  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Si: 75.000869 seconds (142.61 M allocations: 41.193 GiB, 10.99% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T19:27:36.458
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.58699587233021)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.22906855002                   -1.18    9.3    9.07s
  2   -62.23292939946       -2.41       -1.23    4.2    5.50s
  3   -62.23694395985       -2.40       -2.09    5.8    5.11s
  4   -62.23696821027       -4.62       -2.95    4.2    6.06s
  5   -62.23696871475       -6.30       -3.71    4.1    4.72s
  6   -62.23696871981       -8.30       -4.57    5.5    4.96s
  7   -62.23696872000       -9.73       -5.20    4.7    5.13s
  8   -62.23696872001      -10.83       -6.88    4.3    4.62s
  9   -62.23696872001      -13.37       -7.95    5.6    8.05s
Iter     Function value   Gradient norm 
     0    -6.223697e+01     1.285197e-04
 * time: 4.38690185546875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.22907292974                   -1.18    9.3    9.15s
  2   -62.23292424220       -2.41       -1.23    4.2    3.99s
  3   -62.23694405752       -2.40       -2.09    5.8    5.65s
  4   -62.23696826482       -4.62       -2.97    4.4    4.79s
  5   -62.23696873175       -6.33       -3.74    4.3    4.87s
  6   -62.23696873616       -8.36       -4.61    5.7    5.63s
  7   -62.23696873633       -9.79       -5.19    4.7    7.18s
  8   -62.23696873634      -10.77       -7.04    4.3    4.94s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.22907609127                   -1.18    9.3    10.6s
  2   -62.23293357515       -2.41       -1.23    4.1    3.89s
  3   -62.23694402530       -2.40       -2.09    6.0    5.14s
  4   -62.23696822351       -4.62       -2.95    4.3    4.71s
  5   -62.23696873109       -6.29       -3.71    4.1    4.62s
  6   -62.23696873614       -8.30       -4.57    5.3    4.95s
  7   -62.23696873633       -9.73       -5.20    4.6    4.98s
  8   -62.23696873634      -10.83       -6.91    4.2    4.62s
  9   -62.23696873634      -13.55       -7.97    5.5    5.46s
     1    -6.223697e+01     1.256676e-04
 * time: 122.35486102104187
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.22908248899                   -1.18    9.1    7.42s
  2   -62.23295644768       -2.41       -1.23    4.2    4.11s
  3   -62.23694425499       -2.40       -2.09    5.8    5.05s
  4   -62.23696850533       -4.62       -2.91    4.1    4.51s
  5   -62.23696908461       -6.24       -3.65    4.0    5.79s
  6   -62.23696909128       -8.18       -4.48    4.9    4.82s
  7   -62.23696909153       -9.61       -5.29    4.2    4.91s
  8   -62.23696909154      -11.07       -6.67    4.1    4.62s
  9   -62.23696909154   +  -13.85       -7.95    4.6    6.11s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.22908315868                   -1.18    9.2    7.64s
  2   -62.23296332760       -2.41       -1.23    4.2    3.88s
  3   -62.23694412775       -2.40       -2.09    5.7    5.02s
  4   -62.23696851583       -4.61       -2.91    4.2    4.68s
  5   -62.23696908470       -6.24       -3.65    4.0    4.84s
  6   -62.23696909129       -8.18       -4.48    5.0    5.01s
  7   -62.23696909153       -9.61       -5.38    4.3    4.76s
  8   -62.23696909154      -11.23       -6.67    4.5    4.90s
  9   -62.23696909154   +    -Inf       -7.94    4.6    5.00s
     2    -6.223697e+01     3.389484e-07
 * time: 243.2711329460144
 * Status: success

 * Candidate solution
    Final objective value:     -6.223697e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 5.66e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 5.35e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 3.55e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 5.71e-09 ≰ 0.0e+00
    |g(x)|                 = 3.39e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   243  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

NaCl: 321.663447 seconds (538.29 M allocations: 182.933 GiB, 7.29% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T19:32:58.124
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.649591410460032)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318294389363                   -1.47    5.5    1.28s
  2   -2.318367332520       -4.14       -1.84    1.3    559ms
  3   -2.318383358170       -4.80       -3.55    3.3    797ms
  4   -2.318383543817       -6.73       -3.98    4.5    1.11s
  5   -2.318383544320       -9.30       -4.21    2.2    649ms
  6   -2.318383544493       -9.76       -5.09    2.6    641ms
  7   -2.318383544500      -11.11       -5.91    3.0    990ms
  8   -2.318383544501      -12.78       -6.51    2.9    774ms
  9   -2.318383544501      -14.21       -6.91    3.0    692ms
 10   -2.318383544501      -15.35       -7.83    2.6    647ms
Iter     Function value   Gradient norm 
     0    -2.318384e+00     1.654765e-04
 * time: 3.504753112792969e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318294157459                   -1.47    5.5    1.29s
  2   -2.318367898552       -4.13       -1.84    1.3    459ms
  3   -2.318383371604       -4.81       -3.56    3.2    781ms
  4   -2.318383570624       -6.70       -3.98    4.6    1.15s
  5   -2.318383571120       -9.30       -4.21    2.2    553ms
  6   -2.318383571295       -9.76       -5.09    2.6    627ms
  7   -2.318383571303      -11.09       -5.90    3.0    922ms
  8   -2.318383571303      -12.78       -6.48    2.9    630ms
  9   -2.318383571303      -14.24       -6.92    3.0    786ms
 10   -2.318383571303      -14.75       -7.64    2.6    668ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318298931237                   -1.47    5.5    1.12s
  2   -2.318368590883       -4.16       -1.84    1.3    562ms
  3   -2.318383383076       -4.83       -3.56    3.3    922ms
  4   -2.318383570629       -6.73       -3.98    4.6    941ms
  5   -2.318383571121       -9.31       -4.21    2.2    596ms
  6   -2.318383571295       -9.76       -5.10    2.6    842ms
  7   -2.318383571303      -11.10       -5.88    3.2    666ms
  8   -2.318383571303      -12.80       -6.38    2.9    797ms
  9   -2.318383571303      -13.91       -6.81    2.8    682ms
 10   -2.318383571303      -15.05       -7.75    2.7    898ms
     1    -2.318384e+00     1.584698e-04
 * time: 41.61973690986633
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318296382317                   -1.47    5.7    1.28s
  2   -2.318368676930       -4.14       -1.84    1.3    468ms
  3   -2.318383665321       -4.82       -3.56    3.3    767ms
  4   -2.318383868079       -6.69       -3.97    4.6    1.13s
  5   -2.318383868608       -9.28       -4.20    2.2    560ms
  6   -2.318383868810       -9.69       -5.03    2.6    612ms
  7   -2.318383868819      -11.04       -5.83    3.1    868ms
  8   -2.318383868819      -12.67       -6.47    3.0    638ms
  9   -2.318383868819      -14.12       -6.81    3.0    652ms
 10   -2.318383868819      -14.88       -7.45    2.5    577ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318293507731                   -1.47    5.6    1.02s
  2   -2.318367961500       -4.13       -1.84    1.4    608ms
  3   -2.318383660957       -4.80       -3.54    3.4    700ms
  4   -2.318383868045       -6.68       -3.96    4.5    913ms
  5   -2.318383868606       -9.25       -4.19    2.3    585ms
  6   -2.318383868809       -9.69       -5.02    2.7    760ms
  7   -2.318383868819      -10.99       -5.82    3.1    658ms
  8   -2.318383868819      -12.64       -6.31    2.8    635ms
  9   -2.318383868819      -13.77       -6.76    2.9    826ms
 10   -2.318383868819      -15.05       -7.55    2.6    575ms
     2    -2.318384e+00     7.564526e-07
 * time: 82.7110698223114
 * Status: success

 * Candidate solution
    Final objective value:     -2.318384e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.74e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.90e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.98e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.28e-07 ≰ 0.0e+00
    |g(x)|                 = 7.56e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   83  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Al: 108.886404 seconds (108.06 M allocations: 30.345 GiB, 6.92% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T19:34:47.012
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.64298290131008)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.120637862562892e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80467862676                   -0.88    9.5    5.54s
  2   -73.81451543909       -2.01       -1.08    5.1    3.05s
  3   -73.82028819777       -2.24       -1.42    6.6    3.94s
  4   -73.82130349752       -2.99       -1.81    5.7    3.37s
  5   -73.82142990196       -3.90       -2.32    4.9    2.91s
  6   -73.82144395066       -4.85       -3.11    5.5    3.39s
  7   -73.82144395391       -8.49       -3.54    4.6    2.95s
  8   -73.82144398865       -7.46       -3.98    5.3    3.22s
  9   -73.82144398912       -9.32       -4.30    5.5    3.37s
 10   -73.82144399176       -8.58       -4.86    5.4    3.34s
 11   -73.82144399179      -10.52       -5.34    5.0    3.22s
 12   -73.82144399181      -10.82       -6.06    5.0    3.18s
 13   -73.82144399181      -12.18       -6.44    5.3    3.34s
 14   -73.82144399181      -13.15       -6.89    4.8    3.03s
 15   -73.82144399181   +  -13.55       -7.85    5.1    3.91s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.120637862562892e-8,-4.5571980284072616e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.382144e+01     4.881420e-04
 * time: 3.695487976074219e-5
┌ Warning: Negative ρcore detected: -3.118360616144376e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80470125837                   -0.88    9.7    5.81s
  2   -73.81451986842       -2.01       -1.08    5.1    3.03s
  3   -73.82028835405       -2.24       -1.42    6.6    4.00s
  4   -73.82130393703       -2.99       -1.81    5.7    3.35s
  5   -73.82143082098       -3.90       -2.33    5.0    3.08s
  6   -73.82144417184       -4.87       -3.11    5.5    4.70s
  7   -73.82144417265       -9.09       -3.55    4.8    3.08s
  8   -73.82144420763       -7.46       -3.99    5.3    3.21s
  9   -73.82144420798       -9.45       -4.30    5.6    3.43s
 10   -73.82144421063       -8.58       -4.86    5.6    3.37s
 11   -73.82144421066      -10.59       -5.34    4.9    3.13s
 12   -73.82144421067      -10.80       -6.06    5.0    3.17s
 13   -73.82144421067      -12.15       -6.48    5.3    3.34s
 14   -73.82144421067   +  -13.55       -6.91    4.7    3.03s
 15   -73.82144421067      -12.94       -7.87    5.2    3.15s
┌ Warning: Negative ρcore detected: -3.118360616144376e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80469566442                   -0.88    9.6    6.61s
  2   -73.81453155933       -2.01       -1.08    5.1    3.71s
  3   -73.82028772548       -2.24       -1.42    6.6    5.41s
  4   -73.82130376218       -2.99       -1.81    5.9    4.34s
  5   -73.82143054297       -3.90       -2.33    4.9    3.03s
  6   -73.82144416547       -4.87       -3.11    5.5    3.37s
  7   -73.82144417418       -8.06       -3.55    4.6    3.52s
  8   -73.82144420785       -7.47       -3.99    5.3    3.21s
  9   -73.82144420798       -9.90       -4.30    5.5    3.38s
 10   -73.82144421064       -8.58       -4.86    5.5    4.37s
 11   -73.82144421066      -10.64       -5.34    4.8    3.98s
 12   -73.82144421067      -10.81       -6.07    5.0    3.31s
 13   -73.82144421067      -12.14       -6.48    5.4    3.38s
 14   -73.82144421067   +  -13.25       -6.91    4.6    2.97s
 15   -73.82144421067      -13.55       -7.82    5.2    3.24s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.118360616144376e-8,-4.7731733027588635e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     1    -7.382144e+01     4.085406e-04
 * time: 164.4363079071045
┌ Warning: Negative ρcore detected: -3.1050027426616855e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80472685636                   -0.88    9.4    5.66s
  2   -73.81453494061       -2.01       -1.08    5.1    3.04s
  3   -73.82029492238       -2.24       -1.42    6.5    3.97s
  4   -73.82130529535       -3.00       -1.81    5.7    3.28s
  5   -73.82143151683       -3.90       -2.33    4.9    3.05s
  6   -73.82144468390       -4.88       -3.11    5.5    3.37s
  7   -73.82144468604       -8.67       -3.55    4.6    3.06s
  8   -73.82144471854       -7.49       -3.99    5.2    4.33s
  9   -73.82144471904       -9.30       -4.31    5.4    3.39s
 10   -73.82144472160       -8.59       -4.85    5.4    3.36s
 11   -73.82144472163      -10.57       -5.33    4.9    4.15s
 12   -73.82144472164      -10.80       -6.05    4.9    3.20s
 13   -73.82144472164      -12.18       -6.50    5.2    3.32s
 14   -73.82144472164      -13.15       -6.89    4.6    2.99s
 15   -73.82144472165      -13.55       -7.85    5.2    3.23s
┌ Warning: Negative ρcore detected: -3.1050027426616855e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80474033864                   -0.88    9.4    6.45s
  2   -73.81453771290       -2.01       -1.08    5.1    2.94s
  3   -73.82029290751       -2.24       -1.42    6.4    3.78s
  4   -73.82130574004       -2.99       -1.81    5.7    3.23s
  5   -73.82143154611       -3.90       -2.33    4.9    3.03s
  6   -73.82144468009       -4.88       -3.11    5.4    3.33s
  7   -73.82144468729       -8.14       -3.55    4.5    2.91s
  8   -73.82144471905       -7.50       -3.99    5.1    4.04s
  9   -73.82144471905   +  -11.44       -4.31    5.5    3.42s
 10   -73.82144472161       -8.59       -4.86    5.5    3.30s
 11   -73.82144472163      -10.67       -5.33    4.7    3.04s
 12   -73.82144472164      -10.81       -6.07    4.9    3.12s
 13   -73.82144472164      -12.21       -6.46    5.2    3.28s
 14   -73.82144472165      -13.00       -6.88    4.7    4.04s
 15   -73.82144472164   +  -13.25       -7.85    5.2    3.58s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1050027426616855e-8,-5.8938878525445464e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     2    -7.382144e+01     9.308931e-07
 * time: 324.8217670917511
 * Status: success

 * Candidate solution
    Final objective value:     -7.382144e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.51e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.44e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 5.11e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 6.92e-09 ≰ 0.0e+00
    |g(x)|                 = 9.31e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   325  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

V: 414.833902 seconds (360.69 M allocations: 208.993 GiB, 9.25% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T19:41:41.849
└   θ = ComponentVector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}(κ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.5391763493159135,1.0,0.0), μ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.24140127964747177,0.0,1.0))
┌ Info: 2025-05-20T19:41:41.855
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.330008301451118)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465174087753                   -0.96    7.2    1.44s
  2   -8.467139144472       -2.71       -1.73    2.4    859ms
  3   -8.467197604940       -4.23       -2.81    3.8    875ms
  4   -8.467198347259       -6.13       -3.93    4.2    1.00s
  5   -8.467198350696       -8.46       -4.64    4.4    1.19s
  6   -8.467198350830       -9.87       -5.55    4.4    862ms
  7   -8.467198350833      -11.50       -6.35    4.1    963ms
  8   -8.467198350833      -13.16       -7.75    3.8    1.05s
Iter     Function value   Gradient norm 
     0    -8.467198e+00     4.288173e-07
 * time: 3.910064697265625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.467198e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 4.29e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465175827556                   -0.96    7.3    1.50s
  2   -8.467139992079       -2.71       -1.73    2.2    668ms
  3   -8.467197810774       -4.24       -2.81    3.7    960ms
  4   -8.467198346283       -6.27       -3.95    4.1    1.11s
  5   -8.467198350641       -8.36       -4.59    4.5    972ms
  6   -8.467198350829       -9.73       -5.53    4.2    945ms
  7   -8.467198350833      -11.41       -6.26    4.2    1.11s
  8   -8.467198350833      -12.99       -7.71    3.8    859ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.13e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.57e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.21e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.63e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.47e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 2.19e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 4.52e-10
└ * number of operations = 8
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465155790625                   -0.96    7.4    1.46s
  2   -8.467137083445       -2.70       -1.73    1.9    623ms
  3   -8.467197603369       -4.22       -2.81    3.9    952ms
  4   -8.467198347033       -6.13       -3.92    4.2    1.16s
  5   -8.467198350707       -8.43       -4.66    4.4    978ms
  6   -8.467198350831       -9.91       -5.59    4.5    973ms
  7   -8.467198350833      -11.57       -6.36    4.2    1.15s
  8   -8.467198350833      -13.17       -7.74    3.9    861ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.46e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.96e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 6.48e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.71e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.98e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 3.93e-09
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 8.25e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.22e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 9.27e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.18e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 9.50e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 1.48e-08
└ * number of operations = 7
Si: 169.368154 seconds (249.52 M allocations: 208.056 GiB, 10.67% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T19:44:31.225
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.581204749828295)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.22908607882                   -1.18    9.1    7.64s
  2   -62.23295958309       -2.41       -1.23    4.0    3.87s
  3   -62.23694413968       -2.40       -2.09    5.7    5.00s
  4   -62.23696849989       -4.61       -2.91    4.2    6.67s
  5   -62.23696908425       -6.23       -3.64    3.9    6.85s
  6   -62.23696909126       -8.15       -4.46    4.9    6.08s
  7   -62.23696909153       -9.57       -5.38    4.1    6.67s
  8   -62.23696909154      -11.24       -6.67    4.5    5.47s
  9   -62.23696909154   +  -13.37       -7.98    4.6    4.90s
Iter     Function value   Gradient norm 
     0    -6.223697e+01     3.397464e-07
 * time: 4.410743713378906e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.223697e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.40e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.22908425448                   -1.18    9.1    7.45s
  2   -62.23295993082       -2.41       -1.23    4.0    3.88s
  3   -62.23694418529       -2.40       -2.09    5.7    5.11s
  4   -62.23696853990       -4.61       -2.93    4.1    4.62s
  5   -62.23696908549       -6.26       -3.68    4.0    4.62s
  6   -62.23696909132       -8.23       -4.52    5.1    4.74s
  7   -62.23696909153       -9.68       -5.39    4.3    4.87s
  8   -62.23696909154      -11.24       -6.90    4.4    4.74s
  9   -62.23696909154   +  -14.15       -7.97    5.2    5.35s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.13e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.06e+00
[ Info: GMRES linsolve in iteration 1; step 2: normres = 6.26e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 9.90e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.51e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 8.59e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.95e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 6.12e-09
└ * number of operations = 9
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.22908566871                   -1.18    9.2    7.58s
  2   -62.23297003231       -2.41       -1.23    4.2    3.84s
  3   -62.23694393779       -2.40       -2.09    5.7    4.80s
  4   -62.23696850895       -4.61       -2.91    4.1    4.54s
  5   -62.23696908411       -6.24       -3.63    4.0    4.69s
  6   -62.23696909127       -8.14       -4.44    5.0    4.85s
  7   -62.23696909153       -9.59       -5.50    4.0    4.45s
  8   -62.23696909154      -11.47       -6.62    5.0    4.92s
  9   -62.23696909154      -13.85       -7.86    4.3    4.83s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.11e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.44e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 7.38e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.22e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.07e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 4.70e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.23e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 3.29e-09
└ * number of operations = 9
[ Info: GMRES linsolve starts with norm of residual = 1.92e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.55e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 7.77e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.65e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.42e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 7.70e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 2.42e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 3.70e-09
└ * number of operations = 9
NaCl: 1270.875998 seconds (962.30 M allocations: 1.358 TiB, 4.86% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T20:05:42.103
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.64568333996435)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318294505310                   -1.47    5.6    1.31s
  2   -2.318368137119       -4.13       -1.84    1.4    510ms
  3   -2.318383684025       -4.81       -3.55    3.2    975ms
  4   -2.318383868042       -6.74       -3.96    4.5    1.34s
  5   -2.318383868601       -9.25       -4.19    2.2    795ms
  6   -2.318383868809       -9.68       -5.02    2.8    918ms
  7   -2.318383868819      -10.98       -5.82    3.0    965ms
  8   -2.318383868819      -12.69       -6.22    2.8    963ms
  9   -2.318383868819      -13.66       -6.79    2.6    880ms
 10   -2.318383868819      -15.05       -7.49    2.9    938ms
Iter     Function value   Gradient norm 
     0    -2.318384e+00     7.563539e-07
 * time: 3.600120544433594e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.318384e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 7.56e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318294905452                   -1.47    5.6    1.65s
  2   -2.318368239345       -4.13       -1.84    1.4    873ms
  3   -2.318383703772       -4.81       -3.55    3.3    1.03s
  4   -2.318383868061       -6.78       -3.96    4.5    1.42s
  5   -2.318383868608       -9.26       -4.19    2.2    854ms
  6   -2.318383868809       -9.70       -5.05    2.6    1.11s
  7   -2.318383868819      -11.00       -5.82    3.2    986ms
  8   -2.318383868819      -12.68       -6.33    2.7    947ms
  9   -2.318383868819      -13.81       -6.77    3.1    1.01s
 10   -2.318383868819      -15.05       -7.69    2.5    1.08s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.75e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.59e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.11e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.64e-06
[ Info: GMRES linsolve in iteration 1; step 4: normres = 4.53e-08
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 7.60e-10
└ * number of operations = 7
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318293545065                   -1.47    5.6    1.88s
  2   -2.318368192579       -4.13       -1.84    1.4    623ms
  3   -2.318383692443       -4.81       -3.56    3.3    1.12s
  4   -2.318383868075       -6.76       -3.97    4.5    1.00s
  5   -2.318383868609       -9.27       -4.20    2.2    858ms
  6   -2.318383868810       -9.70       -5.04    2.7    809ms
  7   -2.318383868819      -11.04       -5.82    3.1    702ms
  8   -2.318383868819      -12.65       -6.34    2.8    681ms
  9   -2.318383868819      -13.86       -6.80    2.9    966ms
 10   -2.318383868819      -14.88       -7.58    2.6    784ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.69e-03
[ Info: GMRES linsolve in iteration 1; step 1: normres = 5.35e-05
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.25e-06
[ Info: GMRES linsolve in iteration 1; step 3: normres = 8.70e-08
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 1.50e-09
└ * number of operations = 6
[ Info: GMRES linsolve starts with norm of residual = 2.38e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.52e-03
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.71e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 7.82e-07
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 1.20e-08
└ * number of operations = 6
Al: 168.412810 seconds (160.60 M allocations: 88.642 GiB, 7.33% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T20:08:30.517
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.639989451947831)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.1050027426616855e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80473626316                   -0.88    9.4    7.34s
  2   -73.81452909913       -2.01       -1.08    5.1    2.90s
  3   -73.82029465239       -2.24       -1.42    6.4    3.75s
  4   -73.82130531662       -3.00       -1.81    5.8    3.29s
  5   -73.82143134274       -3.90       -2.33    4.9    3.02s
  6   -73.82144468419       -4.87       -3.11    5.4    3.37s
  7   -73.82144468554       -8.87       -3.55    4.7    3.05s
  8   -73.82144471866       -7.48       -3.99    5.2    3.20s
  9   -73.82144471913       -9.33       -4.31    5.4    3.16s
 10   -73.82144472160       -8.61       -4.86    5.4    3.19s
 11   -73.82144472163      -10.55       -5.34    4.9    3.96s
 12   -73.82144472164      -10.82       -6.05    5.0    3.23s
 13   -73.82144472164      -12.17       -6.49    5.2    3.34s
 14   -73.82144472164      -13.55       -6.90    4.7    3.02s
 15   -73.82144472164   +  -13.37       -7.91    5.1    3.23s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1050027426616855e-8,-5.8938878525445464e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.382144e+01     9.274858e-07
 * time: 3.600120544433594e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.382144e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 9.27e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.1050027426616855e-8,-5.8938878525445464e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.1050027426616855e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80473083182                   -0.88    9.3    5.65s
  2   -73.81454157860       -2.01       -1.08    5.0    2.94s
  3   -73.82029383002       -2.24       -1.42    6.4    3.82s
  4   -73.82130491678       -3.00       -1.81    5.8    3.41s
  5   -73.82143133466       -3.90       -2.33    4.9    2.81s
  6   -73.82144468285       -4.87       -3.11    5.5    3.40s
  7   -73.82144468426       -8.85       -3.55    4.7    2.99s
  8   -73.82144471867       -7.46       -3.99    5.2    3.23s
  9   -73.82144471905       -9.42       -4.31    5.5    3.28s
 10   -73.82144472160       -8.59       -4.87    5.5    3.32s
 11   -73.82144472163      -10.57       -5.34    4.9    3.16s
 12   -73.82144472164      -10.82       -6.03    4.9    3.28s
 13   -73.82144472164      -12.10       -6.50    5.3    3.16s
 14   -73.82144472164      -13.37       -6.91    4.6    3.00s
 15   -73.82144472164   +  -13.85       -7.88    5.2    3.21s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.37e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.01e+01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.15e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.95e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 3.89e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 3.00e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 7.43e-09
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}(Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.1050027609775666e-8,-5.8938878447427516e-8),Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-5.893887845035805e-8,4.5142749093813584e-6))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Computing cross-derivative ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.1050027426616855e-8,0.0,0.0)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.1050027426616855e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80473545863                   -0.88    9.4    5.50s
  2   -73.81453437204       -2.01       -1.08    5.1    2.87s
  3   -73.82029326783       -2.24       -1.42    6.5    3.72s
  4   -73.82130535756       -2.99       -1.81    5.7    3.00s
  5   -73.82143140852       -3.90       -2.33    4.9    3.02s
  6   -73.82144468342       -4.88       -3.11    5.4    3.35s
  7   -73.82144468502       -8.80       -3.55    4.6    2.72s
  8   -73.82144471850       -7.48       -3.99    5.3    3.09s
  9   -73.82144471901       -9.29       -4.30    5.5    3.25s
 10   -73.82144472160       -8.59       -4.85    5.5    3.03s
 11   -73.82144472163      -10.49       -5.33    4.9    3.05s
 12   -73.82144472164      -10.80       -6.05    4.9    3.37s
 13   -73.82144472164      -12.17       -6.48    5.2    3.32s
 14   -73.82144472164      -13.55       -6.88    4.7    2.91s
 15   -73.82144472164   +  -13.85       -7.85    5.1    3.06s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 8.89e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.47e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 6.08e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.39e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 8.07e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 8.44e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 7.20e-10
└ * number of operations = 8
[ Info: GMRES linsolve starts with norm of residual = 3.77e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.26e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.89e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.42e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.47e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.30e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.36e-09
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}, KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.1050027609775666e-8,0.0,0.0),Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-5.893887844596224e-8,0.0,0.0))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
V: 788.281173 seconds (628.10 M allocations: 896.020 GiB, 7.48% gc time, 0.00% compilation time)
     9     8.003966e-05     1.905209e-04
 * Current step size: 1.0
 * time: 30599.35808300972
 * g(x): (κ = 9.245807417330475e-5, μ = 0.00019052093248924783)
 * ~inv(H): [371.5843300730512 -150.2194509236943; -150.2194509236943 207.31668682988195]
 * x: (κ = 0.5391763493159135, μ = 0.24140127964747177)
┌ Info: 2025-05-20T20:21:38.803
└   θ = ComponentVector{Float64}(κ = 0.5334403276323866, μ = 0.21579211228783735)
┌ Info: 2025-05-20T20:21:38.803
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.330008301451118)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.455712987515                   -0.96    7.2    1.31s
  2   -8.457655533719       -2.71       -1.74    2.1    625ms
  3   -8.457717836736       -4.21       -2.83    3.8    921ms
  4   -8.457718443576       -6.22       -3.90    4.2    948ms
  5   -8.457718447836       -8.37       -4.61    4.5    1.17s
  6   -8.457718448011       -9.76       -5.48    4.5    953ms
  7   -8.457718448015      -11.40       -6.26    4.1    1.01s
  8   -8.457718448015      -12.97       -7.70    3.8    1.10s
Iter     Function value   Gradient norm 
     0    -8.457718e+00     1.121852e-03
 * time: 4.100799560546875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.455710883992                   -0.96    7.4    1.55s
  2   -8.457660604822       -2.71       -1.74    2.2    690ms
  3   -8.457719027547       -4.23       -2.83    4.0    1.13s
  4   -8.457719657331       -6.20       -3.91    4.4    925ms
  5   -8.457719662129       -8.32       -4.62    4.5    967ms
  6   -8.457719662287       -9.80       -5.53    4.6    1.07s
  7   -8.457719662290      -11.47       -6.29    4.2    925ms
  8   -8.457719662291      -13.03       -7.79    4.0    917ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.455717957774                   -0.96    7.5    1.48s
  2   -8.457665145304       -2.71       -1.74    2.1    652ms
  3   -8.457719136344       -4.27       -2.82    3.9    1.01s
  4   -8.457719658162       -6.28       -3.90    4.3    1.15s
  5   -8.457719662146       -8.40       -4.64    4.4    1.01s
  6   -8.457719662288       -9.85       -5.64    4.5    1.02s
  7   -8.457719662291      -11.66       -6.35    4.2    1.10s
  8   -8.457719662291      -13.26       -7.83    3.8    921ms
     1    -8.457720e+00     1.042908e-03
 * time: 27.158813953399658
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.455690539524                   -0.96    7.0    1.28s
  2   -8.457664372682       -2.70       -1.74    2.2    862ms
  3   -8.457726699137       -4.21       -2.84    3.8    881ms
  4   -8.457727345007       -6.19       -3.90    4.3    1.04s
  5   -8.457727349733       -8.33       -4.65    4.5    1.19s
  6   -8.457727349888       -9.81       -5.49    4.6    923ms
  7   -8.457727349892      -11.45       -6.33    3.9    974ms
  8   -8.457727349892      -13.08       -7.72    3.7    1.06s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.455693596954                   -0.96    7.0    1.49s
  2   -8.457665994726       -2.71       -1.74    1.9    680ms
  3   -8.457726568066       -4.22       -2.83    3.8    1.12s
  4   -8.457727345725       -6.11       -3.87    4.2    925ms
  5   -8.457727349742       -8.40       -4.65    4.3    998ms
  6   -8.457727349889       -9.83       -5.53    4.8    1.38s
  7   -8.457727349892      -11.53       -6.32    3.8    901ms
  8   -8.457727349892      -13.12       -7.57    3.8    926ms
     2    -8.457727e+00     7.939403e-06
 * time: 54.79475402832031
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.455689518552                   -0.96    7.1    1.46s
  2   -8.457665012158       -2.70       -1.74    2.2    628ms
  3   -8.457726676694       -4.21       -2.83    3.7    945ms
  4   -8.457727345265       -6.17       -3.90    4.1    1.15s
  5   -8.457727350139       -8.31       -4.59    4.5    989ms
  6   -8.457727350328       -9.72       -5.44    4.3    943ms
  7   -8.457727350333      -11.29       -6.18    3.9    1.07s
  8   -8.457727350334      -12.83       -7.74    3.8    886ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.455696390452                   -0.96    7.0    1.20s
  2   -8.457668214541       -2.71       -1.74    2.1    844ms
  3   -8.457726615708       -4.23       -2.83    3.7    907ms
  4   -8.457727345731       -6.14       -3.88    4.1    1.34s
  5   -8.457727350189       -8.35       -4.64    4.4    1.49s
  6   -8.457727350331       -9.85       -5.54    4.4    1.29s
  7   -8.457727350333      -11.55       -6.30    3.9    1.18s
  8   -8.457727350334      -13.13       -7.63    3.8    829ms
     3    -8.457727e+00     5.570174e-08
 * time: 82.6227650642395
 * Status: success

 * Candidate solution
    Final objective value:     -8.457727e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.12e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.09e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 4.42e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 5.22e-11 ≰ 0.0e+00
    |g(x)|                 = 5.57e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   83  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 98.589267 seconds (197.35 M allocations: 56.859 GiB, 11.39% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T20:23:17.394
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.581204749828295)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.17547471161                   -1.18    9.2    7.28s
  2   -62.17925148956       -2.42       -1.24    4.0    3.90s
  3   -62.18303943802       -2.42       -2.10    5.5    4.90s
  4   -62.18306181498       -4.65       -2.87    4.3    4.57s
  5   -62.18306256157       -6.13       -3.62    4.0    4.56s
  6   -62.18306257051       -8.05       -4.47    5.0    4.89s
  7   -62.18306257072       -9.67       -5.26    4.2    4.75s
  8   -62.18306257073      -11.14       -6.72    4.5    4.86s
  9   -62.18306257073      -13.45       -7.82    5.1    5.23s
Iter     Function value   Gradient norm 
     0    -6.218306e+01     2.967201e-04
 * time: 3.814697265625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.17548481898                   -1.18    9.1    7.72s
  2   -62.17926156964       -2.42       -1.24    3.7    3.79s
  3   -62.18303948512       -2.42       -2.10    5.5    4.99s
  4   -62.18306193448       -4.65       -2.88    4.1    4.69s
  5   -62.18306264897       -6.15       -3.62    4.0    4.65s
  6   -62.18306265761       -8.06       -4.48    4.9    5.00s
  7   -62.18306265780       -9.73       -5.35    4.2    4.68s
  8   -62.18306265780      -11.33       -6.81    5.0    4.98s
  9   -62.18306265780      -14.15       -7.80    5.3    7.46s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.17548089782                   -1.18    9.1    8.25s
  2   -62.17925645315       -2.42       -1.24    3.7    3.78s
  3   -62.18303944007       -2.42       -2.10    5.7    5.09s
  4   -62.18306195390       -4.65       -2.88    4.1    4.76s
  5   -62.18306264909       -6.16       -3.63    4.0    4.61s
  6   -62.18306265760       -8.07       -4.48    4.8    4.98s
  7   -62.18306265780       -9.71       -5.27    4.1    6.72s
  8   -62.18306265780      -11.19       -6.70    4.3    4.80s
  9   -62.18306265780      -13.55       -7.84    5.1    7.66s
     1    -6.218306e+01     2.901966e-04
 * time: 127.72707009315491
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.17552309809                   -1.18    9.3    7.74s
  2   -62.17927378552       -2.43       -1.24    3.8    4.08s
  3   -62.18304209362       -2.42       -2.10    5.7    5.18s
  4   -62.18306391352       -4.66       -2.91    4.4    4.81s
  5   -62.18306455728       -6.19       -3.68    4.1    4.72s
  6   -62.18306456442       -8.15       -4.56    5.2    5.12s
  7   -62.18306456458       -9.80       -5.16    4.6    4.95s
  8   -62.18306456459      -10.89       -6.88    4.0    5.00s
  9   -62.18306456459      -14.15       -7.83    5.5    7.29s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.17552241036                   -1.18    9.3    9.67s
  2   -62.17927519469       -2.43       -1.24    4.1    4.60s
  3   -62.18304211587       -2.42       -2.10    5.7    5.06s
  4   -62.18306391054       -4.66       -2.91    4.4    4.74s
  5   -62.18306455727       -6.19       -3.67    4.2    4.87s
  6   -62.18306456442       -8.15       -4.57    5.0    4.97s
  7   -62.18306456458       -9.81       -5.18    4.6    4.90s
  8   -62.18306456459      -10.93       -6.90    4.0    4.59s
  9   -62.18306456459   +  -13.85       -7.81    5.6    7.63s
     2    -6.218306e+01     1.941077e-06
 * time: 256.79751801490784
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.17552249129                   -1.18    9.1    9.35s
  2   -62.17929163307       -2.42       -1.24    4.0    4.03s
  3   -62.18304169293       -2.43       -2.10    5.5    5.05s
  4   -62.18306389023       -4.65       -2.89    4.2    4.70s
  5   -62.18306455630       -6.18       -3.64    4.0    4.66s
  6   -62.18306456448       -8.09       -4.49    5.0    5.06s
  7   -62.18306456467       -9.74       -5.25    4.3    6.89s
  8   -62.18306456467      -11.16       -6.79    4.3    6.30s
  9   -62.18306456467      -13.55       -7.78    5.3    5.17s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.17552240119                   -1.18    9.2    7.52s
  2   -62.17929404299       -2.42       -1.24    4.1    3.65s
  3   -62.18304179529       -2.43       -2.10    5.8    4.93s
  4   -62.18306385044       -4.66       -2.88    4.3    4.66s
  5   -62.18306455601       -6.15       -3.63    3.9    4.53s
  6   -62.18306456447       -8.07       -4.48    5.0    4.99s
  7   -62.18306456467       -9.71       -5.32    4.3    5.23s
  8   -62.18306456467      -11.25       -6.68    4.5    6.64s
  9   -62.18306456467      -13.85       -7.85    5.1    7.12s
     3    -6.218306e+01     1.449217e-08
 * time: 386.4528670310974
 * Status: success

 * Candidate solution
    Final objective value:     -6.218306e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 8.77e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 8.30e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 8.46e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.36e-12 ≰ 0.0e+00
    |g(x)|                 = 1.45e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   386  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

NaCl: 453.401316 seconds (757.01 M allocations: 257.929 GiB, 7.28% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T20:30:50.797
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.64568333996435)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316856749877                   -1.46    5.6    1.30s
  2   -2.316936320653       -4.10       -1.84    1.4    574ms
  3   -2.316954368742       -4.74       -3.58    3.4    861ms
  4   -2.316954559025       -6.72       -4.09    4.5    1.57s
  5   -2.316954559475       -9.35       -4.38    2.6    872ms
  6   -2.316954559598       -9.91       -5.05    2.8    895ms
  7   -2.316954559602      -11.44       -5.91    2.6    1.11s
  8   -2.316954559602      -12.98       -6.34    2.9    791ms
  9   -2.316954559602      -14.35       -7.13    2.0    641ms
Iter     Function value   Gradient norm 
     0    -2.316955e+00     7.684007e-04
 * time: 2.8133392333984375e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316854344828                   -1.46    5.4    1.46s
  2   -2.316935633117       -4.09       -1.84    1.3    783ms
  3   -2.316954918556       -4.71       -3.56    3.2    1.05s
  4   -2.316955137162       -6.66       -4.06    4.5    1.43s
  5   -2.316955137675       -9.29       -4.36    2.5    1.07s
  6   -2.316955137812       -9.86       -5.02    2.7    866ms
  7   -2.316955137816      -11.42       -5.90    2.6    889ms
  8   -2.316955137816      -12.97       -6.49    2.9    1.19s
  9   -2.316955137816      -14.65       -7.10    2.2    753ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316854904862                   -1.46    5.5    1.47s
  2   -2.316936524046       -4.09       -1.84    1.4    544ms
  3   -2.316954967155       -4.73       -3.57    3.3    1.09s
  4   -2.316955137142       -6.77       -4.06    4.5    1.55s
  5   -2.316955137666       -9.28       -4.35    2.4    837ms
  6   -2.316955137811       -9.84       -5.03    2.8    947ms
  7   -2.316955137816      -11.37       -5.88    2.6    1.09s
  8   -2.316955137816      -12.88       -6.33    2.9    620ms
  9   -2.316955137816      -14.31       -7.07    1.9    480ms
     1    -2.316955e+00     7.365855e-04
 * time: 44.289754152297974
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316858428913                   -1.46    5.4    1.10s
  2   -2.316943175247       -4.07       -1.84    1.4    719ms
  3   -2.316961540252       -4.74       -3.57    3.3    711ms
  4   -2.316961775300       -6.63       -4.02    4.5    1.18s
  5   -2.316961775912       -9.21       -4.30    2.3    870ms
  6   -2.316961776103       -9.72       -4.96    2.7    1.04s
  7   -2.316961776109      -11.23       -5.68    2.6    851ms
  8   -2.316961776109      -12.61       -6.23    2.6    931ms
  9   -2.316961776109      -14.03       -7.01    2.2    947ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316862711462                   -1.46    5.5    1.09s
  2   -2.316943116910       -4.09       -1.84    1.4    650ms
  3   -2.316961543512       -4.73       -3.56    3.3    696ms
  4   -2.316961775254       -6.63       -4.01    4.5    959ms
  5   -2.316961775898       -9.19       -4.29    2.3    600ms
  6   -2.316961776103       -9.69       -4.95    2.6    910ms
  7   -2.316961776109      -11.26       -5.68    2.4    676ms
  8   -2.316961776109      -12.69       -6.41    2.7    657ms
  9   -2.316961776109      -14.18       -6.88    2.5    834ms
 10   -2.316961776109      -15.35       -7.44    2.0    632ms
     2    -2.316962e+00     1.316668e-05
 * time: 86.27735614776611
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316860692996                   -1.46    5.3    1.07s
  2   -2.316943270826       -4.08       -1.84    1.4    471ms
  3   -2.316961564884       -4.74       -3.56    3.3    873ms
  4   -2.316961777451       -6.67       -4.03    4.4    875ms
  5   -2.316961778064       -9.21       -4.31    2.3    583ms
  6   -2.316961778259       -9.71       -4.97    2.7    613ms
  7   -2.316961778264      -11.24       -5.65    2.5    786ms
  8   -2.316961778265      -12.67       -6.01    2.7    632ms
  9   -2.316961778265      -13.76       -7.09    1.8    495ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316858404654                   -1.46    5.4    1.04s
  2   -2.316942620816       -4.07       -1.84    1.3    444ms
  3   -2.316961579994       -4.72       -3.56    3.3    952ms
  4   -2.316961777393       -6.70       -4.01    4.4    911ms
  5   -2.316961778058       -9.18       -4.30    2.3    597ms
  6   -2.316961778259       -9.70       -4.95    2.7    852ms
  7   -2.316961778264      -11.27       -5.64    2.4    559ms
  8   -2.316961778265      -12.63       -6.08    2.7    619ms
  9   -2.316961778265      -13.75       -6.93    2.0    545ms
 10   -2.316961778265      -15.35       -7.49    2.9    903ms
     3    -2.316962e+00     1.446298e-07
 * time: 126.32978510856628
 * Status: success

 * Candidate solution
    Final objective value:     -2.316962e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.24e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.25e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.16e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 9.30e-10 ≰ 0.0e+00
    |g(x)|                 = 1.45e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   126  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Al: 153.117655 seconds (142.81 M allocations: 39.393 GiB, 6.67% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T20:33:23.916
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.639989451947831)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.1050027426616855e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76132675188                   -0.87    9.5    5.78s
  2   -73.77206402118       -1.97       -1.07    5.1    3.07s
  3   -73.77830348112       -2.20       -1.40    6.5    3.96s
  4   -73.77941030308       -2.96       -1.79    5.7    3.42s
  5   -73.77954808124       -3.86       -2.29    4.9    3.03s
  6   -73.77956419946       -4.79       -3.09    5.5    3.38s
  7   -73.77956424136       -7.38       -3.57    4.4    2.92s
  8   -73.77956425389       -7.90       -4.05    5.3    3.22s
  9   -73.77956425313   +   -9.12       -4.45    5.4    3.33s
 10   -73.77956425427       -8.95       -4.78    5.4    3.32s
 11   -73.77956425432      -10.27       -5.44    5.0    3.18s
 12   -73.77956425433      -11.22       -6.17    4.7    3.12s
 13   -73.77956425433      -13.85       -6.38    3.8    2.76s
 14   -73.77956425433      -13.25       -6.97    5.1    3.20s
 15   -73.77956425433   +  -13.85       -7.89    4.9    3.24s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1050027426616855e-8,-5.8938878525445464e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.377956e+01     1.847165e-03
 * time: 3.886222839355469e-5
┌ Warning: Negative ρcore detected: -3.093342221942482e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76135354638                   -0.87    9.9    5.93s
  2   -73.77211176595       -1.97       -1.07    5.4    3.13s
  3   -73.77830466426       -2.21       -1.40    6.8    4.05s
  4   -73.77941477103       -2.95       -1.79    5.8    3.37s
  5   -73.77955130524       -3.86       -2.30    5.0    3.08s
  6   -73.77956734067       -4.79       -3.09    5.6    3.45s
  7   -73.77956735856       -7.75       -3.55    4.3    2.89s
  8   -73.77956738624       -7.56       -3.97    5.3    3.24s
  9   -73.77956738627      -10.59       -4.31    5.6    3.42s
 10   -73.77956738871       -8.61       -4.82    5.5    3.52s
 11   -73.77956738877      -10.27       -5.37    5.2    3.29s
 12   -73.77956738878      -10.94       -6.14    5.0    3.20s
 13   -73.77956738878      -12.67       -6.43    5.3    3.30s
 14   -73.77956738878      -13.55       -6.94    5.0    3.05s
 15   -73.77956738878      -13.25       -7.76    5.1    3.27s
┌ Warning: Negative ρcore detected: -3.093342221942482e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76135178564                   -0.87    9.8    5.88s
  2   -73.77210691342       -1.97       -1.07    5.3    3.15s
  3   -73.77830519605       -2.21       -1.40    6.8    4.05s
  4   -73.77941484006       -2.95       -1.79    5.9    3.38s
  5   -73.77955151731       -3.86       -2.30    5.0    3.02s
  6   -73.77956734218       -4.80       -3.09    5.6    3.39s
  7   -73.77956735893       -7.78       -3.55    4.4    2.95s
  8   -73.77956738626       -7.56       -3.97    5.4    3.24s
  9   -73.77956738622   +  -10.43       -4.31    5.5    3.44s
 10   -73.77956738872       -8.60       -4.82    5.5    3.36s
 11   -73.77956738877      -10.32       -5.36    5.2    3.27s
 12   -73.77956738878      -10.90       -6.16    5.1    3.25s
 13   -73.77956738878      -12.57       -6.43    5.2    3.36s
 14   -73.77956738878   +  -13.85       -6.92    5.2    3.16s
 15   -73.77956738878      -13.55       -7.76    5.2    3.24s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.093342221942482e-8,-6.733313872260215e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     1    -7.377957e+01     1.546400e-03
 * time: 157.52854299545288
┌ Warning: Negative ρcore detected: -3.100788792613565e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76154531170                   -0.87    9.9    6.08s
  2   -73.77220118087       -1.97       -1.07    5.4    3.14s
  3   -73.77832542128       -2.21       -1.41    6.9    4.10s
  4   -73.77942512632       -2.96       -1.80    6.0    3.39s
  5   -73.77956004346       -3.87       -2.31    5.1    3.17s
  6   -73.77957464111       -4.84       -3.10    5.6    3.48s
  7   -73.77957465709       -7.80       -3.55    4.3    2.90s
  8   -73.77957468670       -7.53       -3.98    5.3    3.31s
  9   -73.77957468668   +  -10.66       -4.31    5.6    3.48s
 10   -73.77957468916       -8.61       -4.83    5.5    3.39s
 11   -73.77957468921      -10.30       -5.35    5.2    3.30s
 12   -73.77957468922      -10.89       -6.12    5.1    3.23s
 13   -73.77957468922      -12.45       -6.47    5.4    3.38s
 14   -73.77957468922      -13.85       -6.96    5.0    3.17s
 15   -73.77957468922      -13.55       -7.78    5.2    3.31s
┌ Warning: Negative ρcore detected: -3.100788792613565e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76155114517                   -0.87    9.9    6.05s
  2   -73.77219549599       -1.97       -1.07    5.3    3.23s
  3   -73.77832592271       -2.21       -1.41    6.8    4.69s
  4   -73.77942539777       -2.96       -1.80    6.0    3.40s
  5   -73.77956038387       -3.87       -2.31    5.1    3.08s
  6   -73.77957464783       -4.85       -3.10    5.6    3.42s
  7   -73.77957465570       -8.10       -3.55    4.7    3.00s
  8   -73.77957468614       -7.52       -3.98    5.3    3.91s
  9   -73.77957468660       -9.34       -4.30    5.6    3.60s
 10   -73.77957468915       -8.59       -4.82    5.6    3.36s
 11   -73.77957468920      -10.26       -5.34    5.2    3.27s
 12   -73.77957468922      -10.84       -6.09    5.1    3.21s
 13   -73.77957468922      -12.25       -6.60    5.4    3.35s
 14   -73.77957468922   +  -13.85       -7.26    5.3    3.25s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.100788792613565e-8,1.600647401863302e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     2    -7.377957e+01     1.265127e-05
 * time: 314.0954508781433
┌ Warning: Negative ρcore detected: -3.099554192208838e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76155157438                   -0.87    9.8    5.64s
  2   -73.77220069947       -1.97       -1.07    5.4    2.92s
  3   -73.77832459445       -2.21       -1.41    6.8    3.79s
  4   -73.77942530024       -2.96       -1.80    5.8    3.16s
  5   -73.77956015191       -3.87       -2.31    5.0    2.93s
  6   -73.77957464558       -4.84       -3.10    5.6    3.29s
  7   -73.77957465530       -8.01       -3.55    4.6    2.82s
  8   -73.77957468672       -7.50       -3.97    5.3    3.09s
  9   -73.77957468709       -9.44       -4.30    5.6    3.29s
 10   -73.77957468964       -8.59       -4.83    5.5    3.20s
 11   -73.77957468969      -10.27       -5.35    5.3    3.19s
 12   -73.77957468970      -10.86       -6.10    5.1    3.07s
 13   -73.77957468970      -12.42       -6.52    5.4    3.26s
 14   -73.77957468970   +  -13.15       -6.95    4.9    3.00s
 15   -73.77957468970      -13.00       -7.83    5.1    3.10s
┌ Warning: Negative ρcore detected: -3.099554192208838e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76155204621                   -0.87    9.7    6.63s
  2   -73.77219485778       -1.97       -1.07    5.3    3.08s
  3   -73.77832663076       -2.21       -1.41    6.8    4.09s
  4   -73.77942502784       -2.96       -1.80    5.8    3.33s
  5   -73.77956025861       -3.87       -2.31    5.0    3.07s
  6   -73.77957464556       -4.84       -3.10    5.6    3.39s
  7   -73.77957465591       -7.99       -3.55    4.5    3.01s
  8   -73.77957468690       -7.51       -3.98    5.3    3.24s
  9   -73.77957468720       -9.53       -4.31    5.6    3.43s
 10   -73.77957468963       -8.61       -4.83    5.6    3.38s
 11   -73.77957468969      -10.24       -5.36    5.2    3.30s
 12   -73.77957468970      -10.88       -6.11    5.1    3.10s
 13   -73.77957468970      -12.47       -6.50    5.5    3.37s
 14   -73.77957468970      -13.15       -6.98    5.0    3.09s
 15   -73.77957468970   +  -13.00       -7.82    5.1    3.25s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.099554192208838e-8,1.6033697856428656e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     3    -7.377957e+01     3.865521e-08
 * time: 469.01521396636963
 * Status: success

 * Candidate solution
    Final objective value:     -7.377957e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 7.71e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.37e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 4.85e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 6.57e-12 ≰ 0.0e+00
    |g(x)|                 = 3.87e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   469  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

V: 557.943566 seconds (495.32 M allocations: 291.375 GiB, 9.34% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T20:42:41.864
└   θ = ComponentVector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}(κ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.5334403276323866,1.0,0.0), μ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.21579211228783735,0.0,1.0))
┌ Info: 2025-05-20T20:42:41.870
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.314177954613584)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.455701892687                   -0.96    7.0    1.31s
  2   -8.457666606629       -2.71       -1.74    2.3    874ms
  3   -8.457726744956       -4.22       -2.83    3.6    865ms
  4   -8.457727344966       -6.22       -3.91    4.2    1.00s
  5   -8.457727350121       -8.29       -4.58    4.4    1.16s
  6   -8.457727350329       -9.68       -5.44    4.4    903ms
  7   -8.457727350333      -11.31       -6.26    4.0    965ms
  8   -8.457727350334      -12.97       -7.78    3.8    1.06s
Iter     Function value   Gradient norm 
     0    -8.457727e+00     5.463279e-08
 * time: 4.00543212890625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.457727e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 5.46e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.455692698578                   -0.96    7.0    1.47s
  2   -8.457662079110       -2.71       -1.74    2.1    657ms
  3   -8.457726659025       -4.19       -2.84    3.7    956ms
  4   -8.457727345281       -6.16       -3.91    4.2    1.15s
  5   -8.457727350123       -8.32       -4.58    4.5    936ms
  6   -8.457727350327       -9.69       -5.39    4.4    915ms
  7   -8.457727350333      -11.21       -6.20    3.8    1.06s
  8   -8.457727350334      -12.83       -7.76    3.8    874ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.14e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.55e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.31e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 6.12e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.70e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 3.47e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 5.32e-10
└ * number of operations = 8
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.455686110874                   -0.96    7.0    1.73s
  2   -8.457663097777       -2.70       -1.74    2.1    623ms
  3   -8.457726647704       -4.20       -2.83    3.7    1.19s
  4   -8.457727345173       -6.16       -3.90    4.3    983ms
  5   -8.457727350132       -8.30       -4.60    4.4    1.00s
  6   -8.457727350328       -9.71       -5.43    4.3    1.14s
  7   -8.457727350333      -11.29       -6.28    3.9    840ms
  8   -8.457727350334      -13.06       -7.73    3.8    909ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.25e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.73e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.72e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.95e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 4.35e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 6.08e-09
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 8.74e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.19e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.22e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.71e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.01e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 2.07e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 2.94e-10
└ * number of operations = 8
Si: 172.843092 seconds (253.37 M allocations: 212.717 GiB, 9.96% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T20:45:34.715
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.567796228072922)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.17552154558                   -1.18    9.2    7.41s
  2   -62.17928092021       -2.42       -1.24    4.1    3.97s
  3   -62.18304198820       -2.42       -2.10    5.7    4.94s
  4   -62.18306392544       -4.66       -2.91    4.4    4.75s
  5   -62.18306455745       -6.20       -3.68    4.1    4.64s
  6   -62.18306456452       -8.15       -4.56    5.1    4.94s
  7   -62.18306456466       -9.83       -5.23    4.6    4.94s
  8   -62.18306456467      -11.04       -6.88    4.0    4.49s
  9   -62.18306456467      -12.94       -7.88    5.5    5.27s
Iter     Function value   Gradient norm 
     0    -6.218306e+01     1.271909e-08
 * time: 3.981590270996094e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.218306e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.27e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.17551992719                   -1.18    9.1    7.29s
  2   -62.17928878175       -2.42       -1.24    4.2    3.99s
  3   -62.18304174250       -2.43       -2.10    5.8    4.85s
  4   -62.18306387838       -4.65       -2.89    4.5    4.57s
  5   -62.18306455597       -6.17       -3.63    4.1    4.49s
  6   -62.18306456446       -8.07       -4.48    5.0    4.65s
  7   -62.18306456467       -9.69       -5.26    4.3    4.72s
  8   -62.18306456467      -11.14       -6.72    4.5    4.80s
  9   -62.18306456467      -13.85       -7.79    5.0    5.04s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.13e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.05e+00
[ Info: GMRES linsolve in iteration 1; step 2: normres = 6.19e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.03e-02
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.81e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 7.95e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 3.89e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 1.16e-08
└ * number of operations = 9
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.17552047573                   -1.18    9.2    7.36s
  2   -62.17928648891       -2.42       -1.24    4.2    3.87s
  3   -62.18304187780       -2.43       -2.10    5.7    5.08s
  4   -62.18306389954       -4.66       -2.90    4.3    4.61s
  5   -62.18306455682       -6.18       -3.65    4.0    4.37s
  6   -62.18306456450       -8.11       -4.52    4.9    4.90s
  7   -62.18306456466       -9.78       -5.19    4.3    4.71s
  8   -62.18306456467      -11.03       -6.86    4.2    4.53s
  9   -62.18306456467      -13.19       -7.87    5.4    6.48s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.02e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.27e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 6.93e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.28e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.09e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.41e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.60e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 4.37e-09
└ * number of operations = 9
[ Info: GMRES linsolve starts with norm of residual = 2.11e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.83e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 8.57e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.35e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.86e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 6.42e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 3.18e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 5.20e-09
└ * number of operations = 9
NaCl: 1259.924475 seconds (966.34 M allocations: 1.347 TiB, 4.94% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T21:06:34.641
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.626801142638421)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316862333483                   -1.46    5.4    1.22s
  2   -2.316943503273       -4.09       -1.84    1.3    585ms
  3   -2.316961554011       -4.74       -3.57    3.2    843ms
  4   -2.316961777433       -6.65       -4.02    4.5    1.15s
  5   -2.316961778063       -9.20       -4.30    2.4    597ms
  6   -2.316961778259       -9.71       -4.95    2.7    763ms
  7   -2.316961778264      -11.25       -5.66    2.5    682ms
  8   -2.316961778265      -12.69       -6.25    2.7    793ms
  9   -2.316961778265      -13.99       -6.98    2.2    552ms
 10   -2.316961778265   +    -Inf       -7.44    2.6    621ms
Iter     Function value   Gradient norm 
     0    -2.316962e+00     1.438913e-07
 * time: 3.0994415283203125e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.316962e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.44e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316866464423                   -1.46    5.4    1.05s
  2   -2.316943308006       -4.11       -1.84    1.3    458ms
  3   -2.316961591738       -4.74       -3.55    3.3    781ms
  4   -2.316961777349       -6.73       -4.00    4.5    1.37s
  5   -2.316961778051       -9.15       -4.29    2.3    710ms
  6   -2.316961778258       -9.68       -4.94    2.8    671ms
  7   -2.316961778264      -11.23       -5.65    2.4    640ms
  8   -2.316961778265      -12.68       -6.19    2.6    938ms
  9   -2.316961778265      -13.97       -7.07    2.1    636ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 6.01e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.75e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.06e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.92e-06
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 3.43e-08
└ * number of operations = 6
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316863544431                   -1.46    5.4    1.19s
  2   -2.316943347279       -4.10       -1.84    1.3    840ms
  3   -2.316961575682       -4.74       -3.56    3.3   1000ms
  4   -2.316961777416       -6.70       -4.01    4.5    1.38s
  5   -2.316961778059       -9.19       -4.29    2.3    865ms
  6   -2.316961778259       -9.70       -4.95    2.7    1.11s
  7   -2.316961778264      -11.24       -5.68    2.4    698ms
  8   -2.316961778265      -12.67       -6.18    2.6    891ms
  9   -2.316961778265      -14.01       -7.02    2.0    782ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.99e-03
[ Info: GMRES linsolve in iteration 1; step 1: normres = 6.67e-05
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.06e-06
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.19e-07
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 1.09e-09
└ * number of operations = 6
[ Info: GMRES linsolve starts with norm of residual = 2.44e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.56e-03
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.23e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 7.34e-07
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 9.38e-09
└ * number of operations = 6
Al: 155.468713 seconds (152.97 M allocations: 83.161 GiB, 7.82% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T21:09:10.112
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.628722060600744)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.099554192208838e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76154548900                   -0.87    9.8    5.81s
  2   -73.77219412941       -1.97       -1.07    5.3    3.00s
  3   -73.77832503684       -2.21       -1.41    6.7    3.88s
  4   -73.77942586132       -2.96       -1.80    5.9    3.23s
  5   -73.77956024218       -3.87       -2.31    5.0    2.94s
  6   -73.77957464642       -4.84       -3.10    5.6    3.38s
  7   -73.77957465652       -8.00       -3.55    4.6    3.22s
  8   -73.77957468680       -7.52       -3.97    5.2    3.21s
  9   -73.77957468709       -9.54       -4.30    5.6    3.48s
 10   -73.77957468964       -8.59       -4.82    5.6    3.39s
 11   -73.77957468969      -10.28       -5.35    5.2    3.76s
 12   -73.77957468970      -10.87       -6.11    5.0    4.49s
 13   -73.77957468970      -12.36       -6.52    5.4    3.75s
 14   -73.77957468970      -13.55       -6.94    4.9    3.08s
 15   -73.77957468970   +  -13.15       -7.80    5.1    3.22s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.099554192208838e-8,1.6033697856428656e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.377957e+01     3.868440e-08
 * time: 3.3855438232421875e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.377957e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.87e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.099554192208838e-8,1.6033697856428656e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.099554192208838e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76153786305                   -0.87    9.8    5.80s
  2   -73.77219245660       -1.97       -1.07    5.3    3.03s
  3   -73.77832771640       -2.21       -1.41    6.7    5.05s
  4   -73.77942519545       -2.96       -1.80    5.9    3.57s
  5   -73.77956022413       -3.87       -2.31    5.0    2.82s
  6   -73.77957464277       -4.84       -3.10    5.6    3.31s
  7   -73.77957465972       -7.77       -3.55    4.2    2.70s
  8   -73.77957468726       -7.56       -3.98    5.3    3.18s
  9   -73.77957468723   +  -10.52       -4.31    5.5    3.11s
 10   -73.77957468964       -8.62       -4.82    5.5    3.32s
 11   -73.77957468969      -10.28       -5.35    5.2    3.23s
 12   -73.77957468970      -10.87       -6.12    5.0    3.08s
 13   -73.77957468970      -12.42       -6.52    5.3    3.07s
 14   -73.77957468970   +  -13.85       -6.95    5.0    2.93s
 15   -73.77957468970   +  -13.85       -7.78    5.2    3.10s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.38e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.01e+01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.29e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.31e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 5.33e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 6.40e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.62e-08
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}(Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.0995541863397555e-8,1.6033697858372954e-7),Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(1.6033697845827814e-7,3.530952585395166e-6))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Computing cross-derivative ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.099554192208838e-8,0.0,0.0)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.099554192208838e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76153794855                   -0.87    9.8    5.42s
  2   -73.77219510837       -1.97       -1.07    5.3    3.09s
  3   -73.77832632394       -2.21       -1.41    6.8    4.16s
  4   -73.77942557537       -2.96       -1.80    5.9    3.24s
  5   -73.77955959418       -3.87       -2.30    5.0    3.12s
  6   -73.77957464111       -4.82       -3.10    5.6    3.39s
  7   -73.77957465735       -7.79       -3.55    4.4    2.71s
  8   -73.77957468703       -7.53       -3.97    5.3    3.19s
  9   -73.77957468724       -9.68       -4.31    5.6    3.40s
 10   -73.77957468964       -8.62       -4.83    5.4    3.19s
 11   -73.77957468969      -10.27       -5.35    5.2    3.30s
 12   -73.77957468970      -10.89       -6.10    5.1    3.19s
 13   -73.77957468970      -12.47       -6.49    5.4    3.16s
 14   -73.77957468970      -13.55       -6.95    4.9    3.02s
 15   -73.77957468970   +  -13.85       -7.80    5.0    3.23s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 7.72e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.31e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 6.35e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.37e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.05e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 9.50e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.28e-09
└ * number of operations = 8
[ Info: GMRES linsolve starts with norm of residual = 4.04e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.02e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.56e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.34e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.19e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 2.14e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.40e-09
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}, KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.0995541863397555e-8,0.0,0.0),Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(1.603369784969881e-7,0.0,0.0))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
V: 785.564468 seconds (623.25 M allocations: 893.719 GiB, 7.53% gc time, 0.00% compilation time)
    10     7.783327e-05     5.685246e-05
 * Current step size: 1.0
 * time: 34236.23607993126
 * g(x): (κ = 6.9569851681831895e-6, μ = -5.6852455301487515e-5)
 * ~inv(H): [391.8536214824853 -112.25091725435095; -112.25091725435094 142.32227379482]
 * x: (κ = 0.5334403276323866, μ = 0.21579211228783735)
┌ Info: 2025-05-20T21:22:15.681
└   θ = ComponentVector{Float64}(κ = 0.5243324675438801, μ = 0.2246644109636169)
┌ Info: 2025-05-20T21:22:15.681
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.314177954613584)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458761048554                   -0.96    7.0    1.24s
  2   -8.460751875551       -2.70       -1.74    2.0    589ms
  3   -8.460813780244       -4.21       -2.83    3.6    861ms
  4   -8.460814350952       -6.24       -3.93    4.1    886ms
  5   -8.460814356017       -8.30       -4.58    4.4    1.30s
  6   -8.460814356223       -9.69       -5.42    4.2    877ms
  7   -8.460814356229      -11.25       -6.31    3.8    901ms
  8   -8.460814356229      -13.09       -7.82    3.7    1.05s
Iter     Function value   Gradient norm 
     0    -8.460814e+00     3.205859e-04
 * time: 3.790855407714844e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458753675396                   -0.96    7.0    1.97s
  2   -8.460758742166       -2.70       -1.74    2.0    658ms
  3   -8.460813785397       -4.26       -2.82    3.6    1.14s
  4   -8.460814451595       -6.18       -3.91    4.0    914ms
  5   -8.460814455213       -8.44       -4.66    4.3    1.00s
  6   -8.460814455329       -9.93       -5.61    4.5    1.12s
  7   -8.460814455331      -11.65       -6.35    4.0    933ms
  8   -8.460814455331      -13.15       -7.75    3.8    951ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458760262000                   -0.96    7.0    1.53s
  2   -8.460754750561       -2.70       -1.74    2.0    677ms
  3   -8.460813823583       -4.23       -2.82    3.6    974ms
  4   -8.460814450913       -6.20       -3.91    4.0    1.06s
  5   -8.460814455170       -8.37       -4.62    4.5    1.38s
  6   -8.460814455328       -9.80       -5.52    4.4    1.12s
  7   -8.460814455331      -11.45       -6.29    3.9    907ms
  8   -8.460814455331      -13.06       -7.74    3.8    943ms
     1    -8.460814e+00     2.976720e-04
 * time: 28.032487869262695
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458791581426                   -0.96    7.2    1.35s
  2   -8.460756590284       -2.71       -1.74    2.2    877ms
  3   -8.460814391802       -4.24       -2.83    3.7    873ms
  4   -8.460815072401       -6.17       -3.89    4.1    993ms
  5   -8.460815076059       -8.44       -4.71    4.5    1.17s
  6   -8.460815076154      -10.02       -5.65    4.6    957ms
  7   -8.460815076156      -11.81       -6.39    4.0    989ms
  8   -8.460815076156      -13.22       -7.65    3.9    1.08s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458779045254                   -0.96    7.2    1.50s
  2   -8.460753275053       -2.70       -1.74    2.4    677ms
  3   -8.460814450696       -4.21       -2.82    3.7    1.14s
  4   -8.460815071230       -6.21       -3.92    4.2    900ms
  5   -8.460815075968       -8.32       -4.60    4.4    1.02s
  6   -8.460815076151       -9.74       -5.46    4.4    1.12s
  7   -8.460815076156      -11.34       -6.30    4.0    905ms
  8   -8.460815076156      -13.04       -7.79    3.8    946ms
     2    -8.460815e+00     6.547579e-07
 * time: 55.13741993904114
 * Status: success

 * Candidate solution
    Final objective value:     -8.460815e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 4.16e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.04e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 6.21e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 7.34e-08 ≰ 0.0e+00
    |g(x)|                 = 6.55e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   55  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Si: 70.598947 seconds (141.16 M allocations: 40.475 GiB, 11.22% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T21:23:26.282
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.567796228072922)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19129071591                   -1.18    9.3    10.4s
  2   -62.19504472874       -2.43       -1.24    4.1    3.91s
  3   -62.19886690929       -2.42       -2.10    5.8    5.08s
  4   -62.19888912180       -4.65       -2.92    4.2    4.56s
  5   -62.19888974709       -6.20       -3.69    4.1    4.60s
  6   -62.19888975298       -8.23       -4.57    5.4    5.03s
  7   -62.19888975315       -9.78       -5.25    4.6    4.89s
  8   -62.19888975316      -10.98       -6.78    4.2    5.50s
  9   -62.19888975316      -13.45       -7.90    5.2    7.47s
Iter     Function value   Gradient norm 
     0    -6.219889e+01     9.849484e-05
 * time: 4.1961669921875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19129137788                   -1.18    9.3    7.63s
  2   -62.19504497773       -2.43       -1.24    4.3    3.89s
  3   -62.19886687952       -2.42       -2.10    5.8    5.13s
  4   -62.19888914556       -4.65       -2.92    4.2    4.74s
  5   -62.19888975674       -6.21       -3.69    4.1    5.48s
  6   -62.19888976258       -8.23       -4.57    5.4    5.24s
  7   -62.19888976274       -9.80       -5.21    4.6    6.07s
  8   -62.19888976275      -10.95       -7.00    4.0    4.62s
  9   -62.19888976275   +  -14.15       -7.93    5.8    5.68s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19129107852                   -1.18    9.3    7.81s
  2   -62.19504494915       -2.43       -1.24    4.2    4.04s
  3   -62.19886687068       -2.42       -2.10    5.8    6.98s
  4   -62.19888912543       -4.65       -2.91    4.3    5.95s
  5   -62.19888975637       -6.20       -3.68    4.1    4.86s
  6   -62.19888976256       -8.21       -4.55    5.1    4.93s
  7   -62.19888976274       -9.75       -5.24    4.5    4.69s
  8   -62.19888976275      -10.96       -6.71    4.4    4.73s
  9   -62.19888976275   +  -13.37       -7.90    4.9    5.15s
     1    -6.219889e+01     9.629520e-05
 * time: 123.81255888938904
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19130038793                   -1.18    9.6    8.28s
  2   -62.19505752490       -2.43       -1.24    4.4    4.05s
  3   -62.19886710468       -2.42       -2.10    5.9    5.25s
  4   -62.19888931122       -4.65       -2.90    4.3    4.75s
  5   -62.19888996328       -6.19       -3.66    4.2    4.83s
  6   -62.19888996985       -8.18       -4.52    5.2    5.08s
  7   -62.19888997004       -9.71       -5.23    4.5    4.99s
  8   -62.19888997005      -10.98       -6.76    4.3    4.87s
  9   -62.19888997005      -14.15       -7.92    5.3    5.46s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19129949557                   -1.18    9.5    7.98s
  2   -62.19506757745       -2.42       -1.24    4.3    4.05s
  3   -62.19886691040       -2.42       -2.10    5.9    5.34s
  4   -62.19888930879       -4.65       -2.90    4.4    4.81s
  5   -62.19888996299       -6.18       -3.65    4.1    4.72s
  6   -62.19888996984       -8.16       -4.51    5.1    4.98s
  7   -62.19888997004       -9.70       -5.30    4.6    4.88s
  8   -62.19888997005      -11.15       -6.86    4.3    7.01s
  9   -62.19888997005      -13.03       -7.90    5.3    7.94s
     2    -6.219889e+01     2.149420e-07
 * time: 251.0277030467987
 * Status: success

 * Candidate solution
    Final objective value:     -6.219889e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 4.31e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.08e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.07e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.33e-09 ≰ 0.0e+00
    |g(x)|                 = 2.15e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   251  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

NaCl: 325.735311 seconds (540.99 M allocations: 187.157 GiB, 7.30% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T21:28:52.019
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.626801142638421)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317344262101                   -1.46    5.4    1.23s
  2   -2.317421147057       -4.11       -1.84    1.3    588ms
  3   -2.317438504811       -4.76       -3.55    3.3    1.09s
  4   -2.317438707424       -6.69       -3.96    4.4    1.32s
  5   -2.317438708139       -9.15       -4.21    2.2    611ms
  6   -2.317438708389       -9.60       -4.94    2.6    620ms
  7   -2.317438708397      -11.10       -5.66    2.5    897ms
  8   -2.317438708397      -12.47       -6.43    2.7    720ms
  9   -2.317438708397      -14.01       -6.85    2.8    787ms
 10   -2.317438708397   +    -Inf       -7.36    1.8    734ms
Iter     Function value   Gradient norm 
     0    -2.317439e+00     2.590595e-04
 * time: 3.504753112792969e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317342384668                   -1.46    5.5    1.66s
  2   -2.317421431529       -4.10       -1.84    1.4    684ms
  3   -2.317438560207       -4.77       -3.58    3.3    1.09s
  4   -2.317438773316       -6.67       -4.00    4.5    1.56s
  5   -2.317438773924       -9.22       -4.24    2.3    796ms
  6   -2.317438774150       -9.65       -4.95    2.6    891ms
  7   -2.317438774156      -11.18       -5.62    2.6    947ms
  8   -2.317438774157      -12.48       -6.01    2.7    759ms
  9   -2.317438774157      -13.61       -6.65    1.9    694ms
 10   -2.317438774157      -15.35       -7.32    2.5    767ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317339230496                   -1.46    5.5    1.09s
  2   -2.317420516846       -4.09       -1.84    1.4    584ms
  3   -2.317438558134       -4.74       -3.56    3.3    1.08s
  4   -2.317438773263       -6.67       -3.98    4.6    932ms
  5   -2.317438773915       -9.19       -4.23    2.3    605ms
  6   -2.317438774148       -9.63       -4.96    2.6    836ms
  7   -2.317438774156      -11.09       -5.67    2.8    720ms
  8   -2.317438774157      -12.46       -6.46    2.6    619ms
  9   -2.317438774157      -14.12       -6.80    2.8    675ms
 10   -2.317438774157   +  -15.35       -7.40    1.9    724ms
     1    -2.317439e+00     2.486247e-04
 * time: 43.82042598724365
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317341654568                   -1.46    5.6    1.26s
  2   -2.317422180208       -4.09       -1.84    1.4    554ms
  3   -2.317439345185       -4.77       -3.57    3.3    726ms
  4   -2.317439539211       -6.71       -4.00    4.6    1.27s
  5   -2.317439539809       -9.22       -4.26    2.2    626ms
  6   -2.317439540013       -9.69       -4.99    2.7    615ms
  7   -2.317439540020      -11.20       -5.73    2.6    819ms
  8   -2.317439540020      -12.63       -6.46    2.7    728ms
  9   -2.317439540020      -14.15       -6.87    2.7    741ms
 10   -2.317439540020      -15.35       -7.38    2.0    660ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317346360965                   -1.46    5.5    1.00s
  2   -2.317422578557       -4.12       -1.84    1.4    460ms
  3   -2.317439296936       -4.78       -3.57    3.3    1.05s
  4   -2.317439539150       -6.62       -3.98    4.6    902ms
  5   -2.317439539792       -9.19       -4.23    2.3    560ms
  6   -2.317439540013       -9.66       -4.96    2.7    802ms
  7   -2.317439540020      -11.18       -5.68    2.6    720ms
  8   -2.317439540020      -12.57       -6.08    2.9    624ms
  9   -2.317439540020      -13.77       -6.69    2.0    560ms
 10   -2.317439540020      -15.35       -7.22    2.3    823ms
     2    -2.317440e+00     7.428928e-07
 * time: 85.51269698143005
 * Status: success

 * Candidate solution
    Final objective value:     -2.317440e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 6.17e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 8.09e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 7.66e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.30e-07 ≰ 0.0e+00
    |g(x)|                 = 7.43e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   86  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Al: 112.206089 seconds (107.75 M allocations: 29.753 GiB, 6.44% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T21:30:44.227
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.628722060600744)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.099554192208838e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77527708465                   -0.87    9.8    5.86s
  2   -73.78566593558       -1.98       -1.07    5.3    3.92s
  3   -73.79167573728       -2.22       -1.41    6.7    4.42s
  4   -73.79274747233       -2.97       -1.80    5.9    3.81s
  5   -73.79287843735       -3.88       -2.32    5.0    3.04s
  6   -73.79289217725       -4.86       -3.10    5.6    3.47s
  7   -73.79289218354       -8.20       -3.55    4.6    2.78s
  8   -73.79289221566       -7.49       -3.99    5.4    3.11s
  9   -73.79289221590       -9.62       -4.31    5.6    3.28s
 10   -73.79289221833       -8.61       -4.85    5.6    3.24s
 11   -73.79289221837      -10.38       -5.36    5.2    3.18s
 12   -73.79289221838      -10.87       -6.09    5.1    3.40s
 13   -73.79289221838      -12.34       -6.51    5.4    3.27s
 14   -73.79289221838   +  -13.15       -6.97    4.8    2.94s
 15   -73.79289221838      -13.25       -7.86    5.2    3.12s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.099554192208838e-8,1.6033697856428656e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.379289e+01     3.399622e-04
 * time: 3.910064697265625e-5
┌ Warning: Negative ρcore detected: -3.094082948925507e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77528516224                   -0.87    9.9    5.76s
  2   -73.78568948760       -1.98       -1.07    5.4    3.16s
  3   -73.79166942242       -2.22       -1.41    6.8    3.90s
  4   -73.79274780193       -2.97       -1.80    5.9    4.34s
  5   -73.79287854230       -3.88       -2.32    5.0    4.29s
  6   -73.79289228471       -4.86       -3.11    5.7    4.82s
  7   -73.79289228522       -9.29       -3.55    4.8    3.67s
  8   -73.79289232098       -7.45       -3.99    5.4    3.19s
  9   -73.79289232165       -9.17       -4.30    5.6    3.38s
 10   -73.79289232432       -8.57       -4.86    5.6    4.17s
 11   -73.79289232436      -10.40       -5.34    5.3    3.81s
 12   -73.79289232437      -10.84       -6.05    5.2    3.25s
 13   -73.79289232437      -12.22       -6.59    5.5    3.38s
 14   -73.79289232437   +  -13.37       -6.95    4.7    3.01s
 15   -73.79289232437   +  -13.37       -7.87    5.3    3.21s
┌ Warning: Negative ρcore detected: -3.094082948925507e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77528182082                   -0.87    9.8    5.51s
  2   -73.78568544599       -1.98       -1.07    5.4    3.04s
  3   -73.79167061167       -2.22       -1.41    6.8    3.90s
  4   -73.79274782903       -2.97       -1.80    5.9    3.26s
  5   -73.79287838882       -3.88       -2.32    5.1    2.99s
  6   -73.79289228064       -4.86       -3.10    5.8    3.36s
  7   -73.79289228952       -8.05       -3.55    4.6    4.04s
  8   -73.79289232156       -7.49       -3.99    5.4    3.17s
  9   -73.79289232177       -9.68       -4.31    5.8    3.39s
 10   -73.79289232432       -8.59       -4.86    5.7    3.29s
 11   -73.79289232436      -10.43       -5.35    5.2    3.78s
 12   -73.79289232437      -10.85       -6.08    5.2    3.19s
 13   -73.79289232437      -12.38       -6.55    5.5    3.78s
 14   -73.79289232437      -13.00       -6.95    4.7    2.94s
 15   -73.79289232437      -13.55       -7.86    5.1    3.18s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.094082948925507e-8,1.615351297947533e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     1    -7.379289e+01     2.836712e-04
 * time: 163.0041720867157
┌ Warning: Negative ρcore detected: -3.0658958870177934e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77525323487                   -0.87    9.7    5.89s
  2   -73.78566681012       -1.98       -1.07    5.4    3.15s
  3   -73.79166830250       -2.22       -1.41    6.9    4.08s
  4   -73.79274737995       -2.97       -1.80    5.9    3.36s
  5   -73.79287852446       -3.88       -2.32    5.1    3.09s
  6   -73.79289252451       -4.85       -3.10    5.5    3.77s
  7   -73.79289253307       -8.07       -3.55    4.6    2.95s
  8   -73.79289256462       -7.50       -3.99    5.3    3.22s
  9   -73.79289256492       -9.52       -4.30    5.7    3.47s
 10   -73.79289256753       -8.58       -4.85    5.6    3.35s
 11   -73.79289256757      -10.38       -5.34    5.2    4.10s
 12   -73.79289256758      -10.84       -6.07    5.0    3.24s
 13   -73.79289256759      -12.34       -6.53    5.4    3.38s
 14   -73.79289256758   +  -13.55       -6.94    4.8    3.60s
 15   -73.79289256758   +    -Inf       -7.86    5.2    3.82s
┌ Warning: Negative ρcore detected: -3.0658958870177934e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77524893894                   -0.87    9.8    5.84s
  2   -73.78566483651       -1.98       -1.07    5.4    3.19s
  3   -73.79167037084       -2.22       -1.41    6.7    4.01s
  4   -73.79274703776       -2.97       -1.80    5.9    3.13s
  5   -73.79287880067       -3.88       -2.32    5.1    2.89s
  6   -73.79289252642       -4.86       -3.10    5.5    3.24s
  7   -73.79289253372       -8.14       -3.56    4.7    2.99s
  8   -73.79289256478       -7.51       -3.99    5.3    3.22s
  9   -73.79289256503       -9.61       -4.31    5.6    4.44s
 10   -73.79289256754       -8.60       -4.86    5.5    3.36s
 11   -73.79289256757      -10.47       -5.35    5.2    3.24s
 12   -73.79289256758      -10.84       -6.10    5.1    3.21s
 13   -73.79289256759      -12.30       -6.53    5.5    3.36s
 14   -73.79289256758   +  -13.25       -6.98    4.8    3.01s
 15   -73.79289256758   +  -13.25       -7.86    5.2    3.20s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0658958870177934e-8,1.675049082232514e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     2    -7.379289e+01     4.438965e-07
 * time: 322.6654119491577
 * Status: success

 * Candidate solution
    Final objective value:     -7.379289e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.71e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.04e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.43e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.30e-09 ≰ 0.0e+00
    |g(x)|                 = 4.44e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   323  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

V: 412.422265 seconds (358.16 M allocations: 211.579 GiB, 8.44% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T21:37:36.654
└   θ = ComponentVector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}(κ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.5243324675438801,1.0,0.0), μ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.2246644109636169,0.0,1.0))
┌ Info: 2025-05-20T21:37:36.659
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.31866324590895)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458780874501                   -0.96    7.2    1.35s
  2   -8.460754257771       -2.70       -1.74    2.4    889ms
  3   -8.460814417545       -4.22       -2.82    3.6    864ms
  4   -8.460815071773       -6.18       -3.93    4.2    1.00s
  5   -8.460815075977       -8.38       -4.61    4.4    1.18s
  6   -8.460815076151       -9.76       -5.48    4.5    913ms
  7   -8.460815076156      -11.36       -6.25    4.0    958ms
  8   -8.460815076156      -12.93       -7.80    3.9    1.07s
Iter     Function value   Gradient norm 
     0    -8.460815e+00     6.544550e-07
 * time: 3.695487976074219e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.460815e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 6.54e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458788368055                   -0.96    7.3    1.99s
  2   -8.460755518964       -2.71       -1.74    2.3    708ms
  3   -8.460814278863       -4.23       -2.82    3.7    933ms
  4   -8.460815072029       -6.10       -3.89    4.3    1.16s
  5   -8.460815076018       -8.40       -4.64    4.3    943ms
  6   -8.460815076153       -9.87       -5.55    4.6    944ms
  7   -8.460815076156      -11.49       -6.33    4.0    1.17s
  8   -8.460815076156      -13.26       -7.67    3.7    1.05s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.14e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.56e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.27e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.76e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.54e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 2.78e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 4.47e-10
└ * number of operations = 8
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458778975490                   -0.96    7.2    1.48s
  2   -8.460755323198       -2.70       -1.74    2.3    676ms
  3   -8.460814333059       -4.23       -2.82    3.7    941ms
  4   -8.460815072217       -6.13       -3.89    4.2    1.15s
  5   -8.460815076022       -8.42       -4.65    4.2    937ms
  6   -8.460815076153       -9.88       -5.54    4.6    1.34s
  7   -8.460815076156      -11.54       -6.34    4.1    1.16s
  8   -8.460815076156      -13.18       -7.66    3.7    841ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.36e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.85e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 6.08e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.87e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 3.69e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 4.93e-09
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 8.49e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.16e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.00e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.02e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 9.64e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 1.72e-08
└ * number of operations = 7
Si: 172.311493 seconds (248.58 M allocations: 206.658 GiB, 10.49% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T21:40:28.973
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.563385869384192)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19130041788                   -1.18    9.6    8.22s
  2   -62.19505697865       -2.43       -1.24    4.4    4.14s
  3   -62.19886700770       -2.42       -2.10    6.1    5.39s
  4   -62.19888935834       -4.65       -2.92    4.3    4.78s
  5   -62.19888996379       -6.22       -3.68    4.1    4.82s
  6   -62.19888996987       -8.22       -4.54    5.0    5.66s
  7   -62.19888997004       -9.77       -5.18    4.5    4.93s
  8   -62.19888997005      -10.92       -6.90    4.0    4.63s
  9   -62.19888997005   +  -13.19       -7.86    5.5    5.47s
Iter     Function value   Gradient norm 
     0    -6.219889e+01     2.158720e-07
 * time: 3.814697265625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.219889e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 2.16e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19130138058                   -1.18    9.6    7.68s
  2   -62.19505893518       -2.43       -1.24    4.2    4.10s
  3   -62.19886704246       -2.42       -2.10    6.1    5.43s
  4   -62.19888933632       -4.65       -2.91    4.4    4.84s
  5   -62.19888996358       -6.20       -3.67    4.1    4.70s
  6   -62.19888996986       -8.20       -4.54    5.4    4.93s
  7   -62.19888997004       -9.75       -5.23    4.6    4.93s
  8   -62.19888997005      -11.00       -6.85    4.2    4.83s
  9   -62.19888997005   +  -13.25       -7.92    5.4    7.12s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.14e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.06e+00
[ Info: GMRES linsolve in iteration 1; step 2: normres = 6.23e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.01e-02
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.72e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 7.48e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 2.73e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 9.59e-09
└ * number of operations = 9
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19129947895                   -1.18    9.6    8.21s
  2   -62.19505707738       -2.43       -1.24    4.3    4.07s
  3   -62.19886712931       -2.42       -2.10    5.8    5.07s
  4   -62.19888932903       -4.65       -2.91    4.3    4.47s
  5   -62.19888996375       -6.20       -3.68    4.1    4.62s
  6   -62.19888996987       -8.21       -4.56    5.3    5.00s
  7   -62.19888997004       -9.77       -5.24    4.7    4.60s
  8   -62.19888997005      -10.99       -6.86    4.2    4.68s
  9   -62.19888997005   +  -14.15       -7.95    5.5    5.38s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.08e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.37e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 7.20e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.26e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.09e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.11e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.41e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 3.80e-09
└ * number of operations = 9
[ Info: GMRES linsolve starts with norm of residual = 2.01e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.68e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 8.18e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.47e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.63e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 7.15e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 2.75e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 4.15e-09
└ * number of operations = 9
NaCl: 1272.584020 seconds (962.49 M allocations: 1.361 TiB, 4.98% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T22:01:41.559
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.633232675242288)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317345135523                   -1.46    5.5    979ms
  2   -2.317422352992       -4.11       -1.84    1.3    424ms
  3   -2.317439264724       -4.77       -3.57    3.3    712ms
  4   -2.317439539156       -6.56       -3.98    4.5    911ms
  5   -2.317439539797       -9.19       -4.24    2.3    597ms
  6   -2.317439540013       -9.67       -4.96    2.7    619ms
  7   -2.317439540020      -11.16       -5.73    2.6    618ms
  8   -2.317439540020      -12.53       -6.55    2.8    642ms
  9   -2.317439540020      -14.12       -7.03    3.2    744ms
Iter     Function value   Gradient norm 
     0    -2.317440e+00     7.421668e-07
 * time: 3.1948089599609375e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.317440e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 7.42e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317344366947                   -1.46    5.6    1.32s
  2   -2.317422642166       -4.11       -1.84    1.4    464ms
  3   -2.317439311329       -4.78       -3.58    3.3    776ms
  4   -2.317439539179       -6.64       -3.99    4.7    1.20s
  5   -2.317439539800       -9.21       -4.24    2.4    551ms
  6   -2.317439540013       -9.67       -4.96    2.7    617ms
  7   -2.317439540020      -11.17       -5.67    2.5    647ms
  8   -2.317439540020      -12.57       -6.07    2.9    885ms
  9   -2.317439540020      -13.80       -6.72    1.9    501ms
 10   -2.317439540020      -14.88       -7.33    2.3    574ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.94e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.71e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.73e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.00e-06
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 3.83e-08
└ * number of operations = 6
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317348426137                   -1.46    5.6    1.13s
  2   -2.317423095777       -4.13       -1.84    1.4    739ms
  3   -2.317439284156       -4.79       -3.59    3.3    845ms
  4   -2.317439539242       -6.59       -4.00    4.6    977ms
  5   -2.317439539810       -9.25       -4.25    2.3    776ms
┌ Warning: Eigensolver not converged
│   n_iter =
│    195-element Vector{Int64}:
│     3
│     3
│     3
│     5
│     ⋮
│     2
│     2
│     3
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/scf/self_consistent_field.jl:76
  6   -2.317439540014       -9.69       -4.98    2.7    1.01s
  7   -2.317439540020      -11.26       -5.69    2.6    783ms
  8   -2.317439540020      -12.63       -6.14    2.6    788ms
  9   -2.317439540020      -13.95       -6.64    2.1    585ms
 10   -2.317439540020      -14.88       -7.12    2.2    898ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.45e-03
[ Info: GMRES linsolve in iteration 1; step 1: normres = 6.45e-05
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.01e-06
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.23e-07
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 1.39e-09
└ * number of operations = 6
[ Info: GMRES linsolve starts with norm of residual = 2.43e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.86e-03
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.43e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 7.19e-07
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 9.87e-09
└ * number of operations = 6
Al: 162.784899 seconds (156.08 M allocations: 84.395 GiB, 7.06% gc time, 0.04% compilation time)
┌ Info: 2025-05-20T22:04:24.346
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.630775216095436)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.0658958870177934e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77525340785                   -0.87    9.8    6.35s
  2   -73.78565744633       -1.98       -1.07    5.3    3.28s
  3   -73.79167111007       -2.22       -1.41    6.8    4.13s
  4   -73.79274664882       -2.97       -1.80    5.9    3.59s
  5   -73.79287835876       -3.88       -2.32    5.0    3.24s
  6   -73.79289252396       -4.85       -3.10    5.6    3.37s
  7   -73.79289253487       -7.96       -3.55    4.5    3.75s
  8   -73.79289256477       -7.52       -3.98    5.4    3.52s
  9   -73.79289256500       -9.64       -4.31    5.7    3.50s
 10   -73.79289256753       -8.60       -4.84    5.5    3.78s
 11   -73.79289256757      -10.35       -5.34    5.2    4.59s
 12   -73.79289256758      -10.84       -6.08    5.2    3.29s
 13   -73.79289256759      -12.38       -6.50    5.4    3.38s
 14   -73.79289256759   +  -13.85       -6.95    4.9    3.07s
 15   -73.79289256758   +  -13.15       -7.84    5.1    3.24s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0658958870177934e-8,1.675049082232514e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.379289e+01     4.444677e-07
 * time: 3.910064697265625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.379289e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 4.44e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.0658958870177934e-8,1.675049082232514e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.0658958870177934e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77524828150                   -0.87    9.8    5.83s
  2   -73.78565845055       -1.98       -1.07    5.3    3.05s
  3   -73.79167021716       -2.22       -1.41    6.8    3.97s
  4   -73.79274697419       -2.97       -1.80    5.9    3.45s
  5   -73.79287880983       -3.88       -2.32    5.1    2.85s
  6   -73.79289252604       -4.86       -3.10    5.7    3.92s
  7   -73.79289253460       -8.07       -3.55    4.6    3.88s
  8   -73.79289256485       -7.52       -3.99    5.4    4.04s
  9   -73.79289256494      -10.05       -4.30    5.6    3.26s
 10   -73.79289256753       -8.59       -4.85    5.5    3.32s
 11   -73.79289256757      -10.41       -5.34    5.2    3.19s
 12   -73.79289256758      -10.84       -6.10    5.1    3.23s
 13   -73.79289256758      -12.43       -6.50    5.4    3.25s
 14   -73.79289256759      -13.15       -6.95    4.9    3.07s
 15   -73.79289256758   +  -13.07       -7.84    5.2    3.25s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.38e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.01e+01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.25e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.87e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 4.79e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.49e-07
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.57e-08
┌ Info: GMRES linsolve converged at iteration 2, step 1:
│ * norm of residual = 6.09e-09
└ * number of operations = 9
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}(Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.065895873034133e-8,1.675049083975528e-7),Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(1.6750490834513512e-7,3.451415981295938e-6))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Computing cross-derivative ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.0658958870177934e-8,0.0,0.0)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.0658958870177934e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77525223272                   -0.87    9.8    5.29s
  2   -73.78565876716       -1.98       -1.07    5.4    3.11s
  3   -73.79166960039       -2.22       -1.41    6.8    3.93s
  4   -73.79274696532       -2.97       -1.80    5.9    3.29s
  5   -73.79287865878       -3.88       -2.32    5.1    2.90s
  6   -73.79289252589       -4.86       -3.11    5.7    3.47s
  7   -73.79289253377       -8.10       -3.55    4.6    2.93s
  8   -73.79289256460       -7.51       -3.98    5.4    3.03s
  9   -73.79289256485       -9.59       -4.30    5.6    3.44s
 10   -73.79289256752       -8.57       -4.83    5.6    3.29s
 11   -73.79289256757      -10.33       -5.33    5.2    3.08s
 12   -73.79289256758      -10.83       -6.07    5.1    3.24s
 13   -73.79289256759      -12.32       -6.49    5.4    3.28s
 14   -73.79289256759      -13.25       -6.91    4.9    2.86s
 15   -73.79289256759   +  -13.25       -7.81    5.2    3.20s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 8.36e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.40e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 6.41e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.48e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 9.85e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 9.29e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.13e-09
└ * number of operations = 8
[ Info: GMRES linsolve starts with norm of residual = 3.89e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.14e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.75e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.40e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.33e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.99e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.67e-09
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}, KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.065895873034133e-8,0.0,0.0),Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(1.6750490837939103e-7,0.0,0.0))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
V: 824.951278 seconds (642.77 M allocations: 944.513 GiB, 7.76% gc time, 0.00% compilation time)
    11     7.765083e-05     1.361799e-05
 * Current step size: 1.0
 * time: 37589.857134103775
 * g(x): (κ = -7.757935332103002e-6, μ = 1.3617986340161187e-5)
 * ~inv(H): [320.4042432685949 -62.340138908088846; -62.34013890808879 112.88376094224395]
 * x: (κ = 0.5243324675438801, μ = 0.2246644109636169)
┌ Info: 2025-05-20T22:18:09.302
└   θ = ComponentVector{Float64}(κ = 0.5276670901033833, μ = 0.22264353068283613)
┌ Info: 2025-05-20T22:18:09.302
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.31866324590895)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458121167280                   -0.96    7.3    1.35s
  2   -8.460077138636       -2.71       -1.74    2.3    634ms
  3   -8.460138788711       -4.21       -2.83    3.8    904ms
  4   -8.460139485317       -6.16       -3.89    4.3    957ms
  5   -8.460139489918       -8.34       -4.62    4.4    1.17s
  6   -8.460139490090       -9.76       -5.47    4.5    936ms
  7   -8.460139490094      -11.35       -6.31    3.9    974ms
  8   -8.460139490094      -13.15       -7.62    3.9    1.09s
Iter     Function value   Gradient norm 
     0    -8.460139e+00     6.188572e-05
 * time: 3.886222839355469e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458130493982                   -0.96    7.2    1.57s
  2   -8.460081110612       -2.71       -1.74    2.2    659ms
  3   -8.460138819754       -4.24       -2.83    3.8    1.15s
  4   -8.460139489237       -6.17       -3.91    4.1    938ms
  5   -8.460139493612       -8.36       -4.61    4.5    1.04s
  6   -8.460139493783       -9.77       -5.48    4.4    1.10s
  7   -8.460139493788      -11.37       -6.24    4.1    962ms
  8   -8.460139493788      -12.93       -7.82    3.8    957ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458130403949                   -0.96    7.2    1.45s
  2   -8.460078075055       -2.71       -1.74    2.3    631ms
  3   -8.460138726381       -4.22       -2.83    3.7    952ms
  4   -8.460139489745       -6.12       -3.88    4.1    1.14s
  5   -8.460139493642       -8.41       -4.64    4.5    982ms
  6   -8.460139493784       -9.85       -5.52    4.5    983ms
  7   -8.460139493788      -11.50       -6.29    4.0    1.08s
  8   -8.460139493788      -13.07       -7.66    3.8    890ms
     1    -8.460139e+00     5.748102e-05
 * time: 27.217201948165894
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458119690137                   -0.96    7.3    1.29s
  2   -8.460082910635       -2.71       -1.74    2.4    904ms
  3   -8.460138965691       -4.25       -2.82    3.8    861ms
  4   -8.460139512524       -6.26       -3.93    4.3    1.00s
  5   -8.460139516808       -8.37       -4.61    4.6    1.18s
  6   -8.460139516990       -9.74       -5.48    4.2    896ms
  7   -8.460139516995      -11.36       -6.24    3.9    966ms
  8   -8.460139516995      -12.91       -7.89    3.8    1.07s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458110272873                   -0.96    7.3    1.52s
  2   -8.460084048304       -2.70       -1.74    2.3    674ms
  3   -8.460138878160       -4.26       -2.82    3.7    1.13s
  4   -8.460139512844       -6.20       -3.91    4.2    945ms
  5   -8.460139516867       -8.40       -4.66    4.5    1.05s
  6   -8.460139516993       -9.90       -5.62    4.5    1.13s
  7   -8.460139516995      -11.69       -6.37    4.0    920ms
  8   -8.460139516995      -13.25       -7.76    3.7    955ms
     2    -8.460140e+00     1.115959e-08
 * time: 54.82942199707031
 * Status: success

 * Candidate solution
    Final objective value:     -8.460140e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 8.08e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 7.83e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.32e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.74e-09 ≰ 0.0e+00
    |g(x)|                 = 1.12e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   55  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Si: 70.582602 seconds (141.80 M allocations: 40.937 GiB, 11.58% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T22:19:19.887
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.563385869384192)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18810287510                   -1.18    9.5    7.84s
  2   -62.19186666437       -2.42       -1.24    4.2    4.00s
  3   -62.19566509893       -2.42       -2.10    5.8    5.18s
  4   -62.19568732096       -4.65       -2.91    4.3    4.75s
  5   -62.19568794722       -6.20       -3.67    4.1    6.49s
  6   -62.19568795377       -8.18       -4.54    5.5    5.09s
  7   -62.19568795394       -9.79       -5.20    4.6    4.88s
  8   -62.19568795395      -10.97       -6.79    4.1    4.66s
  9   -62.19568795395   +    -Inf       -7.89    5.2    6.35s
Iter     Function value   Gradient norm 
     0    -6.219569e+01     4.866581e-05
 * time: 3.814697265625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18810278628                   -1.18    9.5    7.83s
  2   -62.19186546860       -2.42       -1.24    4.0    4.30s
  3   -62.19566513033       -2.42       -2.10    5.8    6.97s
  4   -62.19568733577       -4.65       -2.92    4.4    6.96s
  5   -62.19568794980       -6.21       -3.68    4.2    4.98s
  6   -62.19568795611       -8.20       -4.55    5.3    5.04s
  7   -62.19568795628       -9.77       -5.20    4.5    4.82s
  8   -62.19568795629      -10.93       -6.84    4.1    4.60s
  9   -62.19568795629   +  -14.15       -7.95    5.5    5.30s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18810219920                   -1.18    9.4    7.74s
  2   -62.19186874960       -2.42       -1.24    4.2    4.08s
  3   -62.19566496417       -2.42       -2.10    5.7    5.18s
  4   -62.19568733009       -4.65       -2.91    4.4    4.88s
  5   -62.19568794962       -6.21       -3.67    4.2    4.91s
  6   -62.19568795612       -8.19       -4.54    5.1    5.01s
  7   -62.19568795628       -9.79       -5.19    4.5    4.97s
  8   -62.19568795629      -10.97       -6.88    4.0    4.91s
  9   -62.19568795629      -13.85       -7.88    5.4    5.57s
     1    -6.219569e+01     4.757343e-05
 * time: 126.95356822013855
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18809909558                   -1.18    9.5    7.91s
  2   -62.19186076257       -2.42       -1.24    4.0    4.64s
  3   -62.19566506612       -2.42       -2.10    5.9    7.78s
  4   -62.19568742094       -4.65       -2.92    4.3    7.03s
  5   -62.19568800057       -6.24       -3.68    4.2    7.07s
  6   -62.19568800661       -8.22       -4.56    5.3    7.00s
  7   -62.19568800676       -9.81       -5.20    4.5    4.90s
  8   -62.19568800677      -10.97       -6.89    4.0    4.63s
  9   -62.19568800677   +    -Inf       -7.86    5.3    5.43s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18810043525                   -1.18    9.5    9.58s
  2   -62.19185987519       -2.42       -1.24    4.2    4.13s
  3   -62.19566508979       -2.42       -2.10    5.8    5.28s
  4   -62.19568735818       -4.65       -2.90    4.4    4.84s
  5   -62.19568799972       -6.19       -3.66    4.2    4.84s
  6   -62.19568800658       -8.16       -4.53    5.4    5.09s
  7   -62.19568800676       -9.75       -5.16    4.5    4.90s
  8   -62.19568800677      -10.90       -6.95    4.1    4.77s
  9   -62.19568800677      -14.15       -7.87    5.8    5.66s
     2    -6.219569e+01     8.617679e-08
 * time: 263.4305901527405
 * Status: success

 * Candidate solution
    Final objective value:     -6.219569e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.12e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.01e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 5.05e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 8.12e-10 ≰ 0.0e+00
    |g(x)|                 = 8.62e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   263  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

NaCl: 335.188340 seconds (547.72 M allocations: 188.814 GiB, 7.36% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T22:24:55.077
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.633232675242288)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317240066255                   -1.46    5.5    1.36s
  2   -2.317315113718       -4.12       -1.84    1.4    571ms
  3   -2.317332221459       -4.77       -3.56    3.2    708ms
  4   -2.317332404182       -6.74       -3.98    4.5    1.06s
  5   -2.317332404823       -9.19       -4.25    2.3    622ms
  6   -2.317332405035       -9.67       -4.97    2.7    608ms
  7   -2.317332405042      -11.22       -5.73    2.6    822ms
  8   -2.317332405042      -12.67       -6.49    2.6    713ms
  9   -2.317332405042      -14.15       -6.86    2.7    750ms
 10   -2.317332405042   +    -Inf       -7.43    2.0    640ms
Iter     Function value   Gradient norm 
     0    -2.317332e+00     5.824309e-05
 * time: 3.1948089599609375e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317238921942                   -1.46    5.5    1.79s
  2   -2.317315210044       -4.12       -1.84    1.4    663ms
  3   -2.317332223037       -4.77       -3.57    3.3    1.15s
  4   -2.317332407529       -6.73       -3.99    4.6    1.61s
  5   -2.317332408155       -9.20       -4.26    2.4    818ms
  6   -2.317332408359       -9.69       -4.97    2.7    948ms
  7   -2.317332408365      -11.20       -5.72    2.6    1.14s
  8   -2.317332408365      -12.64       -6.53    2.6    853ms
  9   -2.317332408365      -14.21       -6.96    3.0    974ms
 10   -2.317332408365      -15.05       -7.46    2.2    862ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317239477419                   -1.46    5.5    982ms
  2   -2.317315062484       -4.12       -1.84    1.4    435ms
  3   -2.317332168459       -4.77       -3.57    3.3    871ms
  4   -2.317332407528       -6.62       -3.99    4.6    892ms
  5   -2.317332408155       -9.20       -4.25    2.3    561ms
  6   -2.317332408359       -9.69       -4.97    2.8    884ms
  7   -2.317332408365      -11.24       -5.74    2.6    616ms
  8   -2.317332408365      -12.65       -6.54    2.6    732ms
  9   -2.317332408365      -14.31       -6.95    3.1    701ms
 10   -2.317332408365      -14.75       -7.48    2.2    785ms
     1    -2.317332e+00     5.588455e-05
 * time: 44.079939126968384
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317239220698                   -1.46    5.5    1.88s
  2   -2.317315081636       -4.12       -1.84    1.3    694ms
  3   -2.317332217947       -4.77       -3.55    3.3    1.24s
  4   -2.317332446006       -6.64       -3.98    4.5    1.76s
  5   -2.317332446696       -9.16       -4.24    2.4    925ms
  6   -2.317332446924       -9.64       -4.94    2.8    1.05s
  7   -2.317332446930      -11.17       -5.68    2.5    1.09s
  8   -2.317332446931      -12.49       -6.39    2.7    713ms
  9   -2.317332446931      -14.15       -6.86    2.6    839ms
 10   -2.317332446931      -14.88       -7.23    1.9    688ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317238562625                   -1.46    5.5    1.05s
  2   -2.317315399712       -4.11       -1.84    1.4    469ms
  3   -2.317332217879       -4.77       -3.57    3.2    1.03s
  4   -2.317332446105       -6.64       -4.00    4.6    911ms
  5   -2.317332446722       -9.21       -4.26    2.3    548ms
  6   -2.317332446924       -9.69       -4.97    2.7    838ms
  7   -2.317332446930      -11.21       -5.71    2.5    706ms
  8   -2.317332446931      -12.67       -6.49    2.6    742ms
  9   -2.317332446931      -14.10       -6.93    2.9    676ms
 10   -2.317332446931   +    -Inf       -7.43    2.3    824ms
     2    -2.317332e+00     2.062273e-08
 * time: 88.46790194511414
 * Status: success

 * Candidate solution
    Final objective value:     -2.317332e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.38e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.81e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 3.86e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.66e-08 ≰ 0.0e+00
    |g(x)|                 = 2.06e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   88  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Al: 114.498024 seconds (107.01 M allocations: 29.842 GiB, 6.37% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T22:26:49.577
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.630775216095436)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.0658958870177934e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77231554988                   -0.87    9.8    5.59s
  2   -73.78277153004       -1.98       -1.07    5.4    3.02s
  3   -73.78880406655       -2.22       -1.41    6.9    4.99s
  4   -73.78988753468       -2.97       -1.80    6.0    4.52s
  5   -73.79002000995       -3.88       -2.32    5.1    4.35s
  6   -73.79003373676       -4.86       -3.10    5.6    4.49s
  7   -73.79003374379       -8.15       -3.55    4.6    4.08s
  8   -73.79003377570       -7.50       -3.98    5.4    3.15s
  9   -73.79003377595       -9.60       -4.30    5.6    3.31s
 10   -73.79003377862       -8.57       -4.83    5.6    3.26s
 11   -73.79003377866      -10.37       -5.34    5.1    4.00s
 12   -73.79003377868      -10.84       -6.09    5.1    3.94s
 13   -73.79003377868      -12.32       -6.54    5.4    3.38s
 14   -73.79003377868   +    -Inf       -6.92    4.8    3.00s
 15   -73.79003377868   +  -13.07       -7.81    5.2    3.21s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0658958870177934e-8,1.675049082232514e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.379003e+01     3.418605e-05
 * time: 3.695487976074219e-5
┌ Warning: Negative ρcore detected: -3.066468320722365e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77231305670                   -0.87    9.9    5.97s
  2   -73.78277945093       -1.98       -1.07    5.4    3.14s
  3   -73.78880368831       -2.22       -1.41    6.8    4.29s
  4   -73.78988744344       -2.97       -1.80    5.9    3.40s
  5   -73.79001972188       -3.88       -2.32    5.0    3.11s
  6   -73.79003373517       -4.85       -3.10    5.7    3.45s
  7   -73.79003374352       -8.08       -3.55    4.6    3.01s
  8   -73.79003377678       -7.48       -3.98    5.4    3.32s
  9   -73.79003377703       -9.60       -4.30    5.6    3.51s
 10   -73.79003377969       -8.57       -4.85    5.6    3.44s
 11   -73.79003377974      -10.39       -5.34    5.2    3.39s
 12   -73.79003377975      -10.84       -6.08    5.1    3.36s
 13   -73.79003377975      -12.40       -6.58    5.4    4.40s
 14   -73.79003377975   +    -Inf       -6.93    4.7    4.15s
 15   -73.79003377975      -13.85       -7.83    5.2    3.22s
┌ Warning: Negative ρcore detected: -3.066468320722365e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77231295046                   -0.87    9.9    6.11s
  2   -73.78277041876       -1.98       -1.07    5.4    3.14s
  3   -73.78880473979       -2.22       -1.41    6.8    4.01s
  4   -73.78988781203       -2.97       -1.80    6.0    3.39s
  5   -73.79001980210       -3.88       -2.32    5.0    3.11s
  6   -73.79003373527       -4.86       -3.10    5.6    3.49s
  7   -73.79003374486       -8.02       -3.55    4.6    2.98s
  8   -73.79003377692       -7.49       -3.98    5.3    3.31s
  9   -73.79003377711       -9.71       -4.30    5.6    3.48s
 10   -73.79003377969       -8.59       -4.84    5.5    3.34s
 11   -73.79003377974      -10.38       -5.34    5.2    3.24s
 12   -73.79003377975      -10.85       -6.09    5.1    3.19s
 13   -73.79003377975      -12.34       -6.52    5.4    3.30s
 14   -73.79003377975      -13.37       -6.94    4.9    3.01s
 15   -73.79003377975   +    -Inf       -7.84    5.2    3.19s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.066468320722365e-8,1.673868955288488e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     1    -7.379003e+01     2.854492e-05
 * time: 161.08546495437622
┌ Warning: Negative ρcore detected: -3.069358657041756e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77231217889                   -0.87    9.8    5.94s
  2   -73.78276314064       -1.98       -1.07    5.3    3.06s
  3   -73.78880786280       -2.22       -1.41    6.7    3.97s
  4   -73.78988709717       -2.97       -1.80    5.9    3.33s
  5   -73.79001970702       -3.88       -2.32    5.0    3.05s
  6   -73.79003373291       -4.85       -3.10    5.6    3.40s
  7   -73.79003375139       -7.73       -3.55    4.1    2.77s
  8   -73.79003377997       -7.54       -3.98    5.3    3.21s
  9   -73.79003377972   +   -9.60       -4.31    5.5    3.44s
 10   -73.79003378216       -8.61       -4.83    5.5    3.42s
 11   -73.79003378221      -10.31       -5.36    5.2    3.19s
 12   -73.79003378222      -10.89       -6.13    5.0    3.11s
 13   -73.79003378222      -12.42       -6.47    5.4    3.25s
 14   -73.79003378222   +  -13.55       -6.95    5.0    2.99s
 15   -73.79003378222      -13.85       -7.78    5.2    3.17s
┌ Warning: Negative ρcore detected: -3.069358657041756e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77231972129                   -0.87    9.8    7.67s
  2   -73.78276702683       -1.98       -1.07    5.3    3.13s
  3   -73.78880683225       -2.22       -1.41    6.7    3.89s
  4   -73.78988716518       -2.97       -1.80    6.0    3.34s
  5   -73.79001946988       -3.88       -2.31    5.0    3.03s
  6   -73.79003373664       -4.85       -3.10    5.6    3.39s
  7   -73.79003374927       -7.90       -3.55    4.5    2.82s
  8   -73.79003377949       -7.52       -3.98    5.3    3.20s
  9   -73.79003377969       -9.68       -4.31    5.6    3.24s
 10   -73.79003378216       -8.61       -4.83    5.5    3.19s
 11   -73.79003378221      -10.34       -5.34    5.1    3.15s
 12   -73.79003378222      -10.86       -6.10    5.0    3.09s
 13   -73.79003378222      -12.38       -6.50    5.3    3.31s
 14   -73.79003378222   +    -Inf       -6.95    4.9    3.05s
 15   -73.79003378222   +  -13.85       -7.80    5.2    3.23s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.069358657041756e-8,1.6678903926984948e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     2    -7.379003e+01     1.298776e-08
 * time: 317.6163959503174
 * Status: success

 * Candidate solution
    Final objective value:     -7.379003e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.73e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.07e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.47e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.35e-11 ≰ 0.0e+00
    |g(x)|                 = 1.30e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   318  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

V: 413.121112 seconds (358.88 M allocations: 211.109 GiB, 9.07% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T22:33:42.703
└   θ = ComponentVector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}(κ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.5276670901033833,1.0,0.0), μ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.22264353068283613,0.0,1.0))
┌ Info: 2025-05-20T22:33:42.709
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.317793756890973)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458103230070                   -0.96    7.3    1.35s
  2   -8.460076694368       -2.70       -1.74    2.2    852ms
  3   -8.460138844636       -4.21       -2.82    3.9    900ms
  4   -8.460139512180       -6.18       -3.92    4.2    1.01s
  5   -8.460139516800       -8.34       -4.59    4.5    1.19s
  6   -8.460139516990       -9.72       -5.47    4.3    896ms
  7   -8.460139516995      -11.34       -6.26    3.9    983ms
  8   -8.460139516995      -13.00       -7.84    3.7    1.07s
Iter     Function value   Gradient norm 
     0    -8.460140e+00     1.243010e-08
 * time: 3.695487976074219e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.460140e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.24e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458122188721                   -0.96    7.3    1.67s
  2   -8.460080537054       -2.71       -1.74    2.2    669ms
  3   -8.460138793552       -4.23       -2.82    3.8    943ms
  4   -8.460139512864       -6.14       -3.88    4.2    1.12s
  5   -8.460139516878       -8.40       -4.67    4.4    920ms
  6   -8.460139516993       -9.94       -5.60    4.7    975ms
  7   -8.460139516995      -11.66       -6.34    4.0    1.11s
  8   -8.460139516995      -13.17       -7.61    3.8    852ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.14e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.56e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.28e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.87e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.59e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 2.97e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 4.73e-10
└ * number of operations = 8
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458111969320                   -0.96    7.3    1.48s
  2   -8.460079566051       -2.71       -1.74    2.3    642ms
  3   -8.460138912049       -4.23       -2.82    3.7    1.06s
  4   -8.460139511889       -6.22       -3.92    4.3    883ms
  5   -8.460139516796       -8.31       -4.58    4.5    975ms
  6   -8.460139516990       -9.71       -5.46    4.3    1.08s
  7   -8.460139516995      -11.31       -6.23    4.0    848ms
  8   -8.460139516995      -12.93       -7.81    3.7    1.17s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.33e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.82e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.99e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.89e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 3.87e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 5.23e-09
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 8.55e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.16e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.05e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.23e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 9.80e-07
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.82e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 2.66e-10
└ * number of operations = 8
Si: 174.059542 seconds (253.90 M allocations: 213.456 GiB, 10.09% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T22:36:36.770
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.565553959197517)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18810210510                   -1.18    9.5    7.80s
  2   -62.19186609117       -2.42       -1.24    4.1    3.86s
  3   -62.19566500541       -2.42       -2.10    5.8    4.99s
  4   -62.19568738971       -4.65       -2.91    4.2    4.58s
  5   -62.19568800000       -6.21       -3.67    4.2    4.82s
  6   -62.19568800660       -8.18       -4.53    5.0    4.89s
  7   -62.19568800677       -9.78       -5.22    4.3    4.84s
  8   -62.19568800677      -11.04       -6.87    4.1    6.37s
  9   -62.19568800677   +  -13.15       -7.90    5.4    5.31s
Iter     Function value   Gradient norm 
     0    -6.219569e+01     8.370647e-08
 * time: 4.1961669921875e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.219569e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 8.37e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18810086575                   -1.18    9.5    11.1s
  2   -62.19185764881       -2.43       -1.24    4.0    5.66s
  3   -62.19566518118       -2.42       -2.10    6.0    5.14s
  4   -62.19568741891       -4.65       -2.93    4.2    4.61s
  5   -62.19568800066       -6.24       -3.69    4.1    4.61s
  6   -62.19568800661       -8.23       -4.57    5.3    4.73s
  7   -62.19568800676       -9.81       -5.16    4.6    4.80s
  8   -62.19568800677      -10.87       -6.88    4.0    4.46s
  9   -62.19568800677      -14.15       -7.89    5.6    5.35s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.13e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.05e+00
[ Info: GMRES linsolve in iteration 1; step 2: normres = 6.22e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.01e-02
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.74e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 7.50e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 3.03e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 1.04e-08
└ * number of operations = 9
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18810287372                   -1.18    9.3    7.62s
  2   -62.19186202188       -2.42       -1.24    4.1    3.86s
  3   -62.19566517080       -2.42       -2.10    5.9    5.01s
  4   -62.19568739208       -4.65       -2.92    4.1    4.40s
  5   -62.19568800024       -6.22       -3.68    4.2    4.66s
  6   -62.19568800660       -8.20       -4.55    5.2    4.79s
  7   -62.19568800676       -9.79       -5.20    4.5    4.61s
  8   -62.19568800677      -10.96       -6.85    4.0    4.53s
  9   -62.19568800677   +  -14.15       -7.88    5.2    5.22s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.06e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.34e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 7.13e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.27e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.09e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.19e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.46e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 3.94e-09
└ * number of operations = 9
[ Info: GMRES linsolve starts with norm of residual = 2.03e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.72e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 8.29e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.44e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.69e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 6.99e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 2.87e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 4.36e-09
└ * number of operations = 9
NaCl: 1276.429964 seconds (976.49 M allocations: 1.356 TiB, 4.83% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T22:57:53.202
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.63179438659167)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317238113615                   -1.46    5.5    1.29s
  2   -2.317314878299       -4.11       -1.84    1.4    503ms
  3   -2.317332242402       -4.76       -3.56    3.3    699ms
  4   -2.317332446035       -6.69       -3.98    4.6    895ms
  5   -2.317332446699       -9.18       -4.24    2.2    720ms
  6   -2.317332446923       -9.65       -4.96    2.7    737ms
  7   -2.317332446930      -11.15       -5.70    2.6    759ms
  8   -2.317332446931      -12.59       -6.26    2.7    612ms
  9   -2.317332446931      -14.15       -6.90    2.1    632ms
 10   -2.317332446931   +    -Inf       -7.38    2.4    740ms
Iter     Function value   Gradient norm 
     0    -2.317332e+00     2.137521e-08
 * time: 2.7894973754882812e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.317332e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 2.14e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317232954266                   -1.46    5.5    1.32s
  2   -2.317314531687       -4.09       -1.84    1.3    451ms
  3   -2.317332184671       -4.75       -3.56    3.2    773ms
  4   -2.317332446031       -6.58       -3.98    4.5    1.28s
  5   -2.317332446701       -9.17       -4.25    2.3    588ms
  6   -2.317332446924       -9.65       -4.94    2.8    661ms
  7   -2.317332446930      -11.17       -5.69    2.5    624ms
  8   -2.317332446931      -12.59       -6.41    2.8    845ms
  9   -2.317332446931      -14.21       -6.84    2.6    611ms
 10   -2.317332446931      -15.35       -7.21    2.1    552ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.96e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.73e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.81e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.00e-06
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 3.75e-08
└ * number of operations = 6
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317237583714                   -1.46    5.5    1.46s
  2   -2.317315525413       -4.11       -1.84    1.4    847ms
  3   -2.317332206315       -4.78       -3.58    3.2    992ms
  4   -2.317332446101       -6.62       -4.00    4.6    1.05s
  5   -2.317332446717       -9.21       -4.26    2.3    633ms
  6   -2.317332446924       -9.68       -4.97    2.7    797ms
  7   -2.317332446930      -11.19       -5.70    2.5    755ms
  8   -2.317332446931      -12.58       -6.48    2.7    788ms
  9   -2.317332446931      -14.15       -6.77    2.8    689ms
 10   -2.317332446931      -15.05       -7.26    1.9    786ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.32e-03
[ Info: GMRES linsolve in iteration 1; step 1: normres = 6.49e-05
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.02e-06
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.22e-07
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 1.32e-09
└ * number of operations = 6
[ Info: GMRES linsolve starts with norm of residual = 2.44e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.80e-03
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.39e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 7.23e-07
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 9.81e-09
└ * number of operations = 6
Al: 165.601959 seconds (154.38 M allocations: 84.210 GiB, 7.08% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T23:00:38.806
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.630568043755428)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.069358657041756e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77231365164                   -0.87    9.7    5.90s
  2   -73.78277843496       -1.98       -1.07    5.3    3.15s
  3   -73.78880395817       -2.22       -1.41    6.9    4.11s
  4   -73.78988760104       -2.97       -1.80    5.8    3.40s
  5   -73.79002002458       -3.88       -2.32    5.0    3.10s
  6   -73.79003373992       -4.86       -3.10    5.6    3.56s
  7   -73.79003374751       -8.12       -3.56    4.8    4.29s
  8   -73.79003377931       -7.50       -3.99    5.3    4.02s
  9   -73.79003377955       -9.62       -4.30    5.6    4.91s
 10   -73.79003378217       -8.58       -4.84    5.5    3.41s
 11   -73.79003378221      -10.39       -5.34    5.2    3.32s
 12   -73.79003378222      -10.84       -6.09    5.1    3.23s
 13   -73.79003378222      -12.32       -6.59    5.3    3.45s
 14   -73.79003378222      -13.37       -7.23    5.1    3.18s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.069358657041756e-8,1.6678903926984948e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.379003e+01     4.935035e-08
 * time: 3.910064697265625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.379003e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 4.94e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.069358657041756e-8,1.6678903926984948e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.069358657041756e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77231759551                   -0.87    9.8    5.39s
  2   -73.78277297706       -1.98       -1.07    5.4    2.95s
  3   -73.78880587938       -2.22       -1.41    6.8    3.77s
  4   -73.78988719905       -2.97       -1.80    5.9    3.21s
  5   -73.79002001061       -3.88       -2.32    5.0    2.83s
  6   -73.79003373915       -4.86       -3.10    5.6    3.28s
  7   -73.79003374665       -8.12       -3.55    4.7    2.99s
  8   -73.79003377936       -7.49       -3.98    5.3    3.32s
  9   -73.79003377956       -9.72       -4.30    5.6    3.23s
 10   -73.79003378217       -8.58       -4.84    5.6    3.48s
 11   -73.79003378221      -10.38       -5.34    5.2    3.13s
 12   -73.79003378222      -10.84       -6.11    5.2    3.11s
 13   -73.79003378222      -12.30       -6.51    5.4    3.09s
 14   -73.79003378222   +  -13.00       -6.93    4.9    3.05s
 15   -73.79003378222      -13.55       -7.83    5.2    3.17s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.38e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.01e+01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.26e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.96e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 4.91e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.71e-07
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.65e-08
┌ Info: GMRES linsolve converged at iteration 2, step 1:
│ * norm of residual = 6.19e-09
└ * number of operations = 9
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}(Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.0693586444299185e-8,1.6678903933551495e-7),Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(1.6678903926060386e-7,3.459437640086752e-6))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Computing cross-derivative ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.069358657041756e-8,0.0,0.0)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.069358657041756e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77231659023                   -0.87    9.8    5.60s
  2   -73.78278045342       -1.98       -1.07    5.2    3.80s
  3   -73.78880461862       -2.22       -1.41    6.9    4.84s
  4   -73.78988720596       -2.97       -1.80    5.9    4.52s
  5   -73.79001995281       -3.88       -2.32    5.0    3.07s
  6   -73.79003373656       -4.86       -3.10    5.7    3.36s
  7   -73.79003374726       -7.97       -3.55    4.5    2.78s
  8   -73.79003377948       -7.49       -3.99    5.4    3.20s
  9   -73.79003377954      -10.28       -4.30    5.6    3.37s
 10   -73.79003378216       -8.58       -4.84    5.5    3.21s
 11   -73.79003378221      -10.34       -5.35    5.2    3.31s
 12   -73.79003378222      -10.85       -6.10    5.2    3.21s
 13   -73.79003378222      -12.38       -6.49    5.4    3.22s
 14   -73.79003378222   +  -13.85       -6.96    4.9    3.07s
 15   -73.79003378222   +  -13.55       -7.81    5.2    3.22s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 8.19e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.38e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 6.39e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.45e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 9.95e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 9.32e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.18e-09
└ * number of operations = 8
[ Info: GMRES linsolve starts with norm of residual = 3.93e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.11e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.70e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.38e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.29e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 2.02e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.62e-09
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}, KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.0693586444299185e-8,0.0,0.0),Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(1.6678903927799667e-7,0.0,0.0))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
V: 818.936664 seconds (638.32 M allocations: 942.206 GiB, 7.44% gc time, 0.00% compilation time)
    12     7.761996e-05     1.269275e-06
 * Current step size: 1.0
 * time: 40958.303407907486
 * g(x): (κ = 1.1241462001640066e-6, μ = 1.2692748650385303e-6)
 * ~inv(H): [292.0030298634706 -60.00851522685355; -60.00851522685349 120.48866465971037]
 * x: (κ = 0.5276670901033833, μ = 0.22264353068283613)
┌ Info: 2025-05-20T23:14:17.748
└   θ = ComponentVector{Float64}(κ = 0.5274150033069916, μ = 0.22255805579363125)
┌ Info: 2025-05-20T23:14:17.748
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.317793756890973)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458077042673                   -0.96    7.3    1.31s
  2   -8.460043947279       -2.71       -1.74    2.3    671ms
  3   -8.460102886648       -4.23       -2.82    3.8    925ms
  4   -8.460103583389       -6.16       -3.92    4.3    1.17s
  5   -8.460103588112       -8.33       -4.62    4.5    1.01s
  6   -8.460103588267       -9.81       -5.51    4.5    1.00s
  7   -8.460103588271      -11.42       -6.29    4.0    1.14s
  8   -8.460103588271      -13.05       -7.80    3.7    881ms
Iter     Function value   Gradient norm 
     0    -8.460104e+00     5.380783e-06
 * time: 3.790855407714844e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458064245939                   -0.96    7.3    1.47s
  2   -8.460039678409       -2.70       -1.74    2.2    645ms
  3   -8.460102792416       -4.20       -2.83    3.7    1.06s
  4   -8.460103583692       -6.10       -3.91    4.3    931ms
  5   -8.460103588130       -8.35       -4.62    4.5    986ms
  6   -8.460103588295       -9.78       -5.48    4.5    1.05s
  7   -8.460103588299      -11.40       -6.26    4.0    948ms
  8   -8.460103588299      -12.96       -7.70    3.8    1.10s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458071127633                   -0.96    7.4    1.52s
  2   -8.460043596713       -2.70       -1.74    2.3    683ms
  3   -8.460102886848       -4.23       -2.83    3.7    1.18s
  4   -8.460103584047       -6.16       -3.92    4.1    889ms
  5   -8.460103588119       -8.39       -4.60    4.6    1.07s
  6   -8.460103588295       -9.76       -5.49    4.3    1.11s
  7   -8.460103588299      -11.37       -6.26    3.9    903ms
  8   -8.460103588299      -12.97       -7.77    3.8    985ms
     1    -8.460104e+00     4.997570e-06
 * time: 26.724896907806396
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458069955260                   -0.96    7.0    1.43s
  2   -8.460041334169       -2.71       -1.74    2.1    768ms
  3   -8.460102889271       -4.21       -2.83    3.6    805ms
  4   -8.460103584036       -6.16       -3.90    4.1    970ms
  5   -8.460103588312       -8.37       -4.63    4.3    1.12s
  6   -8.460103588470       -9.80       -5.50    4.4    933ms
  7   -8.460103588474      -11.42       -6.28    3.8    1.09s
  8   -8.460103588474      -13.02       -7.72    3.7    870ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458080145511                   -0.96    6.9    1.41s
  2   -8.460044609957       -2.71       -1.74    2.0    645ms
  3   -8.460102925649       -4.23       -2.82    3.7    1.08s
  4   -8.460103584040       -6.18       -3.92    4.1    924ms
  5   -8.460103588302       -8.37       -4.61    4.5    1.04s
  6   -8.460103588469       -9.78       -5.47    4.2    1.06s
  7   -8.460103588474      -11.34       -6.30    3.9    900ms
  8   -8.460103588474      -13.11       -7.82    3.7    1.11s
     2    -8.460104e+00     4.582315e-10
 * time: 53.3529999256134
 * Status: success

 * Candidate solution
    Final objective value:     -8.460104e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 7.02e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 6.80e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.75e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.07e-11 ≰ 0.0e+00
    |g(x)|                 = 4.58e-10 ≤ 1.0e-06

 * Work counters
    Seconds run:   53  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Si: 69.545252 seconds (141.14 M allocations: 40.556 GiB, 11.45% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T23:15:27.296
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.565553959197517)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18785974794                   -1.18    9.4    8.65s
  2   -62.19161243447       -2.43       -1.24    3.8    4.11s
  3   -62.19542051807       -2.42       -2.10    5.9    5.40s
  4   -62.19544269150       -4.65       -2.92    4.3    5.03s
  5   -62.19544328964       -6.22       -3.69    4.1    4.70s
  6   -62.19544329577       -8.21       -4.56    5.1    4.98s
  7   -62.19544329593       -9.80       -5.17    4.7    4.97s
  8   -62.19544329595      -10.88       -6.82    4.0    4.58s
  9   -62.19544329595   +  -13.55       -7.88    5.5    5.50s
Iter     Function value   Gradient norm 
     0    -6.219544e+01     5.391257e-06
 * time: 4.1961669921875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18786166852                   -1.18    9.4    7.65s
  2   -62.19161407469       -2.43       -1.24    4.1    4.11s
  3   -62.19542055495       -2.42       -2.10    5.9    5.24s
  4   -62.19544269347       -4.65       -2.92    4.2    4.71s
  5   -62.19544328981       -6.22       -3.69    4.2    4.69s
  6   -62.19544329580       -8.22       -4.56    5.0    4.86s
  7   -62.19544329596       -9.79       -5.19    4.8    4.97s
  8   -62.19544329597      -10.89       -6.85    4.0    4.60s
  9   -62.19544329597   +  -13.45       -7.88    5.5    5.41s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18785872418                   -1.18    9.5    7.73s
  2   -62.19161051964       -2.43       -1.24    4.1    3.94s
  3   -62.19542054083       -2.42       -2.10    5.5    5.08s
  4   -62.19544269987       -4.65       -2.93    4.5    4.82s
  5   -62.19544328982       -6.23       -3.69    4.2    4.67s
  6   -62.19544329581       -8.22       -4.57    5.4    5.01s
  7   -62.19544329596       -9.81       -5.16    4.8    4.94s
  8   -62.19544329597      -10.84       -6.94    4.1    4.58s
  9   -62.19544329597      -13.37       -7.91    5.8    7.39s
     1    -6.219544e+01     5.271950e-06
 * time: 119.93800687789917
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18785521710                   -1.18    8.9    7.26s
  2   -62.19162077845       -2.42       -1.24    3.8    4.95s
  3   -62.19542028117       -2.42       -2.10    5.5    5.93s
  4   -62.19544268548       -4.65       -2.91    4.1    4.58s
  5   -62.19544328991       -6.22       -3.67    4.0    4.45s
  6   -62.19544329642       -8.19       -4.53    5.0    4.84s
  7   -62.19544329659       -9.79       -5.20    4.1    5.57s
  8   -62.19544329660      -11.01       -6.81    3.9    6.74s
  9   -62.19544329660   +  -13.45       -7.92    5.1    7.49s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18785273423                   -1.18    8.9    9.58s
  2   -62.19162186097       -2.42       -1.24    3.7    3.73s
  3   -62.19542024722       -2.42       -2.10    5.7    5.05s
  4   -62.19544266380       -4.65       -2.91    4.2    4.55s
  5   -62.19544328962       -6.20       -3.66    3.9    4.47s
  6   -62.19544329641       -8.17       -4.52    5.0    4.98s
  7   -62.19544329659       -9.75       -5.21    4.2    4.71s
  8   -62.19544329660      -11.02       -6.97    4.0    4.66s
  9   -62.19544329660   +  -13.67       -7.91    5.6    5.57s
     2    -6.219544e+01     6.048991e-08
 * time: 247.22723698616028
 * Status: success

 * Candidate solution
    Final objective value:     -6.219544e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.38e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.25e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 6.21e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 9.98e-12 ≰ 0.0e+00
    |g(x)|                 = 6.05e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   247  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

NaCl: 320.098139 seconds (542.77 M allocations: 185.651 GiB, 7.37% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T23:20:47.396
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.63179438659167)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317224156712                   -1.46    5.6    1.28s
  2   -2.317309545955       -4.07       -1.84    1.4    496ms
  3   -2.317327183328       -4.75       -3.58    3.2    754ms
  4   -2.317327419531       -6.63       -4.01    4.6    1.13s
  5   -2.317327420104       -9.24       -4.27    2.3    659ms
  6   -2.317327420299       -9.71       -4.98    2.7    640ms
  7   -2.317327420304      -11.25       -5.72    2.5    859ms
  8   -2.317327420304      -12.61       -6.34    2.8    758ms
  9   -2.317327420304      -14.18       -6.73    2.4    583ms
 10   -2.317327420304      -15.05       -7.19    2.0    511ms
Iter     Function value   Gradient norm 
     0    -2.317327e+00     2.817671e-06
 * time: 3.218650817871094e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317228074847                   -1.46    5.5    1.28s
  2   -2.317310233802       -4.09       -1.84    1.4    470ms
  3   -2.317327171643       -4.77       -3.58    3.2    775ms
  4   -2.317327419516       -6.61       -4.01    4.6    1.12s
  5   -2.317327420103       -9.23       -4.26    2.2    556ms
  6   -2.317327420306       -9.69       -4.98    2.8    657ms
  7   -2.317327420312      -11.25       -5.71    2.5    835ms
  8   -2.317327420312      -12.58       -6.44    2.7    610ms
  9   -2.317327420312      -14.27       -6.81    2.6    602ms
 10   -2.317327420312      -14.65       -7.20    1.9    545ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317229796724                   -1.46    5.5    1.06s
  2   -2.317309960904       -4.10       -1.84    1.4    468ms
  3   -2.317327234033       -4.76       -3.58    3.3    952ms
  4   -2.317327419572       -6.73       -4.02    4.6    915ms
  5   -2.317327420120       -9.26       -4.28    2.3    604ms
  6   -2.317327420307       -9.73       -5.00    2.7    865ms
  7   -2.317327420312      -11.30       -5.72    2.5    577ms
  8   -2.317327420312      -12.61       -6.29    2.6    611ms
  9   -2.317327420312      -13.97       -6.86    2.1    546ms
 10   -2.317327420312   +  -14.65       -7.29    2.4    805ms
     1    -2.317327e+00     2.704131e-06
 * time: 40.81170105934143
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317233534468                   -1.46    5.5    1.25s
  2   -2.317310192987       -4.12       -1.84    1.4    460ms
  3   -2.317327179301       -4.77       -3.57    3.2    763ms
  4   -2.317327419557       -6.62       -3.99    4.7    1.14s
  5   -2.317327420189       -9.20       -4.25    2.4    585ms
  6   -2.317327420397       -9.68       -4.97    2.7    669ms
  7   -2.317327420403      -11.22       -5.72    2.6    836ms
  8   -2.317327420403      -12.69       -6.45    2.6    583ms
  9   -2.317327420403      -14.10       -6.92    2.9    683ms
 10   -2.317327420403      -15.35       -7.37    2.2    579ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317232507432                   -1.46    5.6    1.10s
  2   -2.317310511974       -4.11       -1.84    1.4    467ms
  3   -2.317327200834       -4.78       -3.58    3.3    940ms
  4   -2.317327419611       -6.66       -4.01    4.6    1.13s
  5   -2.317327420197       -9.23       -4.27    2.3    558ms
  6   -2.317327420397       -9.70       -4.99    2.8    806ms
  7   -2.317327420403      -11.26       -5.72    2.5    558ms
  8   -2.317327420403      -12.64       -6.49    2.7    613ms
  9   -2.317327420403      -14.12       -6.93    2.9    634ms
 10   -2.317327420403   +  -15.05       -7.32    2.2    726ms
     2    -2.317327e+00     7.000978e-09
 * time: 81.42149305343628
 * Status: success

 * Candidate solution
    Final objective value:     -2.317327e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 6.71e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 8.79e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 9.06e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.91e-11 ≰ 0.0e+00
    |g(x)|                 = 7.00e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   81  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Al: 106.936298 seconds (106.16 M allocations: 29.631 GiB, 6.87% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T23:22:34.335
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.630568043755428)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.069358657041756e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77214867906                   -0.87    9.8    5.89s
  2   -73.78260482660       -1.98       -1.07    5.3    3.11s
  3   -73.78863711109       -2.22       -1.41    6.8    4.50s
  4   -73.78971992043       -2.97       -1.80    5.9    3.38s
  5   -73.78985285842       -3.88       -2.32    5.0    3.11s
  6   -73.78986661424       -4.86       -3.10    5.6    4.48s
  7   -73.78986661721       -8.53       -3.55    4.9    3.05s
  8   -73.78986665111       -7.47       -3.98    5.3    3.13s
  9   -73.78986665155       -9.35       -4.30    5.7    3.32s
 10   -73.78986665417       -8.58       -4.85    5.6    3.23s
 11   -73.78986665421      -10.39       -5.34    5.2    4.30s
 12   -73.78986665423      -10.82       -6.08    5.1    4.49s
 13   -73.78986665423      -12.29       -6.54    5.5    4.69s
 14   -73.78986665423   +  -13.55       -6.93    4.9    3.08s
 15   -73.78986665423   +  -13.85       -7.81    5.2    3.57s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.069358657041756e-8,1.6678903926984948e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.378987e+01     1.310235e-05
 * time: 3.910064697265625e-5
┌ Warning: Negative ρcore detected: -3.069577211411628e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77214261526                   -0.87    9.9    5.96s
  2   -73.78261567088       -1.98       -1.07    5.4    3.15s
  3   -73.78863590990       -2.22       -1.41    6.8    4.07s
  4   -73.78972024144       -2.96       -1.80    6.0    3.44s
  5   -73.78985263037       -3.88       -2.32    5.0    3.08s
  6   -73.78986660892       -4.85       -3.10    5.7    3.50s
  7   -73.78986661812       -8.04       -3.55    4.5    2.95s
  8   -73.78986665144       -7.48       -3.98    5.4    3.29s
  9   -73.78986665163       -9.72       -4.29    5.6    3.48s
 10   -73.78986665433       -8.57       -4.85    5.5    3.36s
 11   -73.78986665437      -10.40       -5.34    5.0    3.27s
 12   -73.78986665438      -10.84       -6.08    5.1    3.24s
 13   -73.78986665439      -12.33       -6.54    5.4    3.40s
 14   -73.78986665439      -13.37       -6.93    4.9    3.11s
 15   -73.78986665439   +  -13.37       -7.82    5.2    3.26s
┌ Warning: Negative ρcore detected: -3.069577211411628e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77214402925                   -0.87    9.8    5.77s
  2   -73.78260810195       -1.98       -1.07    5.3    3.16s
  3   -73.78863642962       -2.22       -1.41    6.8    4.05s
  4   -73.78972039472       -2.96       -1.80    5.9    3.34s
  5   -73.78985289272       -3.88       -2.32    5.0    3.08s
  6   -73.78986661483       -4.86       -3.10    5.7    3.44s
  7   -73.78986661595       -8.95       -3.55    4.8    3.08s
  8   -73.78986665096       -7.46       -3.98    5.4    3.25s
  9   -73.78986665167       -9.15       -4.30    5.7    3.47s
 10   -73.78986665432       -8.58       -4.84    5.6    3.37s
 11   -73.78986665437      -10.34       -5.34    5.2    3.30s
 12   -73.78986665438      -10.82       -6.07    5.1    3.20s
 13   -73.78986665439      -12.25       -6.57    5.4    3.40s
 14   -73.78986665439   +  -13.37       -6.94    4.7    3.04s
 15   -73.78986665439      -13.85       -7.83    5.3    3.56s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.069577211411628e-8,1.6674370931317088e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     1    -7.378987e+01     1.094007e-05
 * time: 158.40082788467407
┌ Warning: Negative ρcore detected: -3.070681827445074e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77214762449                   -0.87    9.6    6.01s
  2   -73.78260487184       -1.98       -1.07    5.3    3.05s
  3   -73.78863712345       -2.22       -1.41    6.8    3.94s
  4   -73.78972050251       -2.97       -1.80    5.9    3.38s
  5   -73.78985226498       -3.88       -2.31    5.0    3.14s
  6   -73.78986660881       -4.84       -3.10    5.5    4.05s
  7   -73.78986661935       -7.98       -3.55    4.6    2.93s
  8   -73.78986665188       -7.49       -3.98    5.3    3.27s
  9   -73.78986665215       -9.58       -4.31    5.5    3.43s
 10   -73.78986665469       -8.60       -4.84    5.6    3.36s
 11   -73.78986665474      -10.31       -5.35    5.2    3.28s
 12   -73.78986665475      -10.86       -6.08    5.1    3.26s
 13   -73.78986665475      -12.25       -6.49    5.4    3.34s
 14   -73.78986665475   +  -13.85       -6.93    4.9    3.08s
 15   -73.78986665475   +  -13.37       -7.81    5.1    3.21s
┌ Warning: Negative ρcore detected: -3.070681827445074e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77214763826                   -0.87    9.6    5.76s
  2   -73.78261142287       -1.98       -1.07    5.2    3.05s
  3   -73.78863720671       -2.22       -1.41    6.6    3.95s
  4   -73.78972018902       -2.97       -1.80    5.8    3.19s
  5   -73.78985231768       -3.88       -2.31    5.0    2.92s
  6   -73.78986660709       -4.84       -3.10    5.6    3.31s
  7   -73.78986661940       -7.91       -3.55    4.4    2.75s
  8   -73.78986665200       -7.49       -3.98    5.3    3.09s
  9   -73.78986665212       -9.92       -4.30    5.6    3.31s
 10   -73.78986665469       -8.59       -4.85    5.5    3.21s
 11   -73.78986665474      -10.39       -5.35    5.2    3.13s
 12   -73.78986665475      -10.87       -6.09    5.0    3.04s
 13   -73.78986665475      -12.29       -6.50    5.3    3.19s
 14   -73.78986665475   +  -13.85       -6.93    4.9    2.90s
 15   -73.78986665475   +  -13.07       -7.82    5.1    3.07s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.070681827445074e-8,1.6651425907800905e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     2    -7.378987e+01     5.760673e-09
 * time: 313.7802999019623
 * Status: success

 * Candidate solution
    Final objective value:     -7.378987e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 6.63e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.18e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 3.65e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 4.94e-12 ≰ 0.0e+00
    |g(x)|                 = 5.76e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   314  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

V: 407.892189 seconds (358.34 M allocations: 210.923 GiB, 9.09% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T23:29:22.232
└   θ = ComponentVector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}(κ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.5274150033069916,1.0,0.0), μ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.22255805579363125,0.0,1.0))
┌ Info: 2025-05-20T23:29:22.237
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.317718204075542)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458075698766                   -0.96    6.9    1.34s
  2   -8.460039603630       -2.71       -1.74    2.1    910ms
  3   -8.460102772972       -4.20       -2.82    3.6    852ms
  4   -8.460103583193       -6.09       -3.90    4.1    988ms
  5   -8.460103588260       -8.30       -4.57    4.5    1.17s
  6   -8.460103588468       -9.68       -5.42    4.3    894ms
  7   -8.460103588474      -11.25       -6.22    3.9    972ms
  8   -8.460103588474      -12.92       -7.73    3.7    1.04s
Iter     Function value   Gradient norm 
     0    -8.460104e+00     3.508983e-10
 * time: 3.910064697265625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.460104e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.51e-10 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458066063988                   -0.96    7.0    1.47s
  2   -8.460039125734       -2.70       -1.74    2.1    662ms
  3   -8.460102835898       -4.20       -2.83    3.7    969ms
  4   -8.460103583680       -6.13       -3.92    4.2    1.13s
  5   -8.460103588251       -8.34       -4.57    4.4    1.35s
  6   -8.460103588467       -9.66       -5.40    4.2    936ms
  7   -8.460103588474      -11.18       -6.25    3.9    1.09s
  8   -8.460103588474      -12.94       -7.73    3.9    886ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.14e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.56e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.28e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.87e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.59e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 2.97e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 4.75e-10
└ * number of operations = 8
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458071596133                   -0.96    7.0    1.50s
  2   -8.460043676557       -2.71       -1.74    2.1    659ms
  3   -8.460102894064       -4.23       -2.82    3.6    1.13s
  4   -8.460103583658       -6.16       -3.92    4.2    883ms
  5   -8.460103588298       -8.33       -4.60    4.3    958ms
  6   -8.460103588470       -9.76       -5.50    4.4    957ms
  7   -8.460103588474      -11.41       -6.26    3.9    1.08s
  8   -8.460103588474      -12.97       -7.82    3.7    861ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.33e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.82e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.98e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.89e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 3.87e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 5.23e-09
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 8.55e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.16e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.05e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.23e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 9.79e-07
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.82e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 2.72e-10
└ * number of operations = 8
Si: 173.898362 seconds (252.63 M allocations: 213.202 GiB, 10.41% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T23:32:16.138
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.565310337416772)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18785074201                   -1.18    8.9    7.15s
  2   -62.19162698757       -2.42       -1.24    3.4    3.59s
  3   -62.19542015360       -2.42       -2.10    5.6    6.92s
  4   -62.19544266229       -4.65       -2.90    4.1    6.89s
  5   -62.19544328921       -6.20       -3.65    3.9    6.78s
  6   -62.19544329639       -8.14       -4.49    4.8    7.02s
  7   -62.19544329659       -9.71       -5.24    4.3    6.34s
  8   -62.19544329660      -11.12       -6.85    4.1    4.67s
  9   -62.19544329660   +  -13.19       -7.90    5.2    5.22s
Iter     Function value   Gradient norm 
     0    -6.219544e+01     6.146456e-08
 * time: 3.719329833984375e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.219544e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 6.15e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18785454266                   -1.18    8.8    7.19s
  2   -62.19162293231       -2.42       -1.24    4.0    3.83s
  3   -62.19542027138       -2.42       -2.10    5.7    5.02s
  4   -62.19544267506       -4.65       -2.91    4.2    4.67s
  5   -62.19544328966       -6.21       -3.66    4.0    6.89s
  6   -62.19544329641       -8.17       -4.52    4.9    6.70s
  7   -62.19544329659       -9.75       -5.23    4.2    6.82s
  8   -62.19544329660      -11.05       -6.86    4.1    6.41s
  9   -62.19544329660      -13.55       -7.89    5.3    5.32s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.13e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.05e+00
[ Info: GMRES linsolve in iteration 1; step 2: normres = 6.22e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.01e-02
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.74e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 7.50e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 3.03e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 1.06e-08
└ * number of operations = 9
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18785221615                   -1.18    8.9    7.61s
  2   -62.19161521644       -2.42       -1.24    3.7    4.76s
  3   -62.19542031804       -2.42       -2.10    5.5    6.83s
  4   -62.19544268937       -4.65       -2.92    4.1    4.71s
  5   -62.19544329014       -6.22       -3.68    4.0    4.74s
  6   -62.19544329643       -8.20       -4.55    4.9    4.68s
  7   -62.19544329658       -9.80       -5.15    4.4    4.50s
  8   -62.19544329660      -10.90       -6.93    3.9    4.45s
  9   -62.19544329660   +  -13.85       -7.88    5.6    5.42s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.06e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.34e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 7.13e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.27e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.09e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.19e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.46e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 3.95e-09
└ * number of operations = 9
[ Info: GMRES linsolve starts with norm of residual = 2.03e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.72e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 8.29e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.44e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.69e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 6.98e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 2.87e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 4.36e-09
└ * number of operations = 9
NaCl: 1277.395193 seconds (963.23 M allocations: 1.349 TiB, 4.78% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T23:53:33.535
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.631724461681042)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317232081364                   -1.46    5.5    1.26s
  2   -2.317309536880       -4.11       -1.84    1.4    478ms
  3   -2.317327183999       -4.75       -3.56    3.3    789ms
  4   -2.317327419508       -6.63       -3.98    4.5    1.12s
  5   -2.317327420175       -9.18       -4.24    2.3    586ms
  6   -2.317327420396       -9.65       -4.95    2.7    628ms
  7   -2.317327420403      -11.21       -5.70    2.6    856ms
  8   -2.317327420403      -12.65       -6.39    2.8    613ms
  9   -2.317327420403      -14.10       -6.83    2.5    575ms
 10   -2.317327420403   +  -15.35       -7.22    2.0    530ms
Iter     Function value   Gradient norm 
     0    -2.317327e+00     9.485570e-09
 * time: 3.314018249511719e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.317327e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 9.49e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317234194264                   -1.46    5.6    1.13s
  2   -2.317310585957       -4.12       -1.84    1.4    466ms
  3   -2.317327180848       -4.78       -3.57    3.2    929ms
  4   -2.317327419577       -6.62       -4.00    4.6    927ms
  5   -2.317327420186       -9.22       -4.26    2.2    590ms
  6   -2.317327420396       -9.68       -4.96    2.8    671ms
  7   -2.317327420403      -11.22       -5.70    2.5    764ms
  8   -2.317327420403      -12.58       -6.34    2.7    596ms
  9   -2.317327420403      -14.07       -6.82    2.4    576ms
 10   -2.317327420403   +  -15.35       -7.20    2.1    554ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.96e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.73e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.81e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.00e-06
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 3.75e-08
└ * number of operations = 6
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317231962594                   -1.46    5.6    1.16s
  2   -2.317310052592       -4.11       -1.84    1.4    497ms
  3   -2.317327157177       -4.77       -3.57    3.3    977ms
  4   -2.317327419568       -6.58       -4.00    4.5    973ms
  5   -2.317327420186       -9.21       -4.26    2.3    598ms
  6   -2.317327420397       -9.68       -4.96    2.7    854ms
  7   -2.317327420403      -11.23       -5.71    2.5    580ms
  8   -2.317327420403      -12.60       -6.49    2.7    660ms
  9   -2.317327420403      -14.18       -6.85    2.8    670ms
 10   -2.317327420403      -15.35       -7.13    1.8    714ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.32e-03
[ Info: GMRES linsolve in iteration 1; step 1: normres = 6.50e-05
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.02e-06
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.22e-07
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 1.32e-09
└ * number of operations = 6
[ Info: GMRES linsolve starts with norm of residual = 2.44e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.79e-03
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.38e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 7.23e-07
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 9.80e-09
└ * number of operations = 6
Al: 145.946426 seconds (154.07 M allocations: 83.938 GiB, 8.35% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T23:55:59.484
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.630488649857997)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.070681827445074e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77214802635                   -0.87    9.6    5.78s
  2   -73.78259920352       -1.98       -1.07    5.3    3.07s
  3   -73.78863801031       -2.22       -1.41    6.6    3.96s
  4   -73.78972027427       -2.97       -1.80    5.8    3.33s
  5   -73.78985248620       -3.88       -2.32    5.0    3.06s
  6   -73.78986660976       -4.85       -3.10    5.6    3.43s
  7   -73.78986662096       -7.95       -3.55    4.5    2.80s
  8   -73.78986665192       -7.51       -3.98    5.2    3.22s
  9   -73.78986665214       -9.67       -4.30    5.7    3.46s
 10   -73.78986665469       -8.59       -4.83    5.5    3.36s
 11   -73.78986665473      -10.32       -5.34    5.2    3.28s
 12   -73.78986665475      -10.84       -6.09    5.0    3.21s
 13   -73.78986665475      -12.30       -6.50    5.3    3.34s
 14   -73.78986665475   +  -13.85       -6.92    4.9    3.07s
 15   -73.78986665475   +  -13.25       -7.81    5.1    3.21s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.070681827445074e-8,1.6651425907800905e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.378987e+01     6.416351e-09
 * time: 4.100799560546875e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.378987e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 6.42e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.070681827445074e-8,1.6651425907800905e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.070681827445074e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77214698885                   -0.87    9.6    5.57s
  2   -73.78260034201       -1.98       -1.07    5.3    2.89s
  3   -73.78863811838       -2.22       -1.41    6.7    3.63s
  4   -73.78971992430       -2.97       -1.80    5.9    3.35s
  5   -73.78985287687       -3.88       -2.32    5.1    2.90s
  6   -73.78986661213       -4.86       -3.10    5.5    3.36s
  7   -73.78986661977       -8.12       -3.55    4.6    2.85s
  8   -73.78986665197       -7.49       -3.98    5.3    3.17s
  9   -73.78986665215       -9.74       -4.31    5.5    3.16s
 10   -73.78986665469       -8.59       -4.85    5.5    3.22s
 11   -73.78986665474      -10.39       -5.35    5.2    3.17s
 12   -73.78986665475      -10.85       -6.11    5.1    3.05s
 13   -73.78986665475      -12.40       -6.51    5.4    3.10s
 14   -73.78986665475      -13.37       -6.95    4.8    2.94s
 15   -73.78986665475      -13.55       -7.84    5.2    3.10s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.38e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.01e+01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.26e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.97e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 4.91e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.72e-07
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.60e-08
┌ Info: GMRES linsolve converged at iteration 2, step 1:
│ * norm of residual = 6.11e-09
└ * number of operations = 9
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}(Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.070681819135012e-8,1.6651425908709835e-7),Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(1.6651425902982156e-7,3.4625119966268994e-6))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Computing cross-derivative ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.070681827445074e-8,0.0,0.0)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.070681827445074e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77213110471                   -0.87    9.6    5.12s
  2   -73.78260961972       -1.98       -1.07    5.2    2.97s
  3   -73.78863728542       -2.22       -1.41    6.7    3.86s
  4   -73.78972041161       -2.97       -1.80    5.8    3.05s
  5   -73.78985257170       -3.88       -2.32    5.0    3.85s
  6   -73.78986661073       -4.85       -3.10    5.5    3.21s
  7   -73.78986661797       -8.14       -3.55    4.5    2.64s
  8   -73.78986665168       -7.47       -3.98    5.3    3.06s
  9   -73.78986665204       -9.44       -4.30    5.6    3.24s
 10   -73.78986665469       -8.58       -4.84    5.5    3.83s
 11   -73.78986665473      -10.36       -5.34    5.2    3.21s
 12   -73.78986665475      -10.84       -6.08    5.1    3.80s
 13   -73.78986665475      -12.32       -6.53    5.3    3.71s
 14   -73.78986665475      -13.55       -6.94    4.8    4.07s
 15   -73.78986665475   +  -13.00       -7.82    5.1    4.38s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 8.19e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.38e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 6.39e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.45e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 9.97e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 9.33e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.19e-09
└ * number of operations = 8
[ Info: GMRES linsolve starts with norm of residual = 3.93e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.11e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.70e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.38e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.29e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 2.03e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.63e-09
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}, KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.070681819135012e-8,0.0,0.0),Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(1.6651425902201096e-7,0.0,0.0))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
V: 823.062092 seconds (643.50 M allocations: 944.541 GiB, 7.43% gc time, 0.00% compilation time)
    13     7.761981e-05     1.818643e-07
 * Current step size: 1.0
 * time: 44283.10640692711
 * g(x): (κ = -8.240957456666213e-8, μ = -1.8186431494516663e-7)
 * ~inv(H): [290.5522541420074 -67.86440960507178; -67.86440960507173 115.32807246954924]
 * x: (κ = 0.5274150033069916, μ = 0.22255805579363125)
┌ Info: 2025-05-21T00:09:42.551
└   θ = ComponentVector{Float64}(κ = 0.5274266054802829, μ = 0.2225734371774011)
┌ Info: 2025-05-21T00:09:42.552
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.317718204075542)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458072638788                   -0.96    6.9    1.25s
  2   -8.460050213153       -2.70       -1.74    2.2    639ms
  3   -8.460108608953       -4.23       -2.83    3.6    866ms
  4   -8.460109424526       -6.09       -3.87    4.2    950ms
  5   -8.460109428775       -8.37       -4.66    4.3    1.13s
  6   -8.460109428910       -9.87       -5.57    4.4    1.29s
  7   -8.460109428912      -11.60       -6.35    3.9    989ms
  8   -8.460109428912      -13.21       -7.65    3.7    1.05s
Iter     Function value   Gradient norm 
     0    -8.460109e+00     7.363997e-07
 * time: 3.790855407714844e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.460109e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 7.36e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Si: 15.989916 seconds (31.02 M allocations: 8.777 GiB, 9.50% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T00:09:58.544
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.565310337416772)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18789018483                   -1.18    8.8    7.56s
  2   -62.19166253034       -2.42       -1.24    3.7    3.81s
  3   -62.19545484117       -2.42       -2.10    5.3    4.95s
  4   -62.19547738532       -4.65       -2.90    4.2    4.68s
  5   -62.19547802157       -6.20       -3.65    4.0    4.88s
  6   -62.19547802874       -8.14       -4.50    4.9    6.79s
  7   -62.19547802891       -9.75       -5.24    4.2    5.42s
  8   -62.19547802892      -11.12       -6.77    4.1    5.83s
  9   -62.19547802892      -13.30       -7.88    5.0    4.99s
Iter     Function value   Gradient norm 
     0    -6.219548e+01     4.018541e-07
 * time: 4.00543212890625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.219548e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 4.02e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

NaCl: 71.145603 seconds (121.94 M allocations: 39.326 GiB, 7.44% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T00:11:09.691
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.631724461681042)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317234662609                   -1.46    5.5    1.26s
  2   -2.317311474404       -4.11       -1.84    1.3    449ms
  3   -2.317328065088       -4.78       -3.57    3.3    763ms
  4   -2.317328281748       -6.66       -4.01    4.6    1.13s
  5   -2.317328282336       -9.23       -4.27    2.3    566ms
  6   -2.317328282535       -9.70       -4.98    2.7    639ms
  7   -2.317328282541      -11.24       -5.72    2.6    848ms
  8   -2.317328282541      -12.68       -6.37    2.7    579ms
  9   -2.317328282541      -14.15       -6.83    2.4    545ms
 10   -2.317328282541      -15.35       -7.21    2.1    532ms
Iter     Function value   Gradient norm 
     0    -2.317328e+00     4.827106e-07
 * time: 3.0040740966796875e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.317328e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 4.83e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Al: 24.939677 seconds (23.42 M allocations: 6.418 GiB, 6.15% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T00:11:34.633
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.630488649857997)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.070681827445074e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77217611346                   -0.87    9.7    5.28s
  2   -73.78262814816       -1.98       -1.07    5.3    3.09s
  3   -73.78866463850       -2.22       -1.41    6.7    4.03s
  4   -73.78974621760       -2.97       -1.80    5.8    3.32s
  5   -73.78987888276       -3.88       -2.32    5.0    3.00s
  6   -73.78989275864       -4.86       -3.10    5.5    3.36s
  7   -73.78989276793       -8.03       -3.55    4.5    2.85s
  8   -73.78989279963       -7.50       -3.98    5.3    3.16s
  9   -73.78989279987       -9.62       -4.30    5.6    3.38s
 10   -73.78989280242       -8.59       -4.84    5.6    3.37s
 11   -73.78989280247      -10.37       -5.34    5.2    3.74s
 12   -73.78989280248      -10.84       -6.10    5.1    4.42s
 13   -73.78989280248      -12.47       -6.52    5.4    3.42s
 14   -73.78989280248      -13.07       -6.94    4.8    4.11s
 15   -73.78989280248   +  -13.07       -7.80    5.2    4.20s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.070681827445074e-8,1.6651425907800905e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.378989e+01     1.374005e-06
 * time: 3.910064697265625e-5
┌ Warning: Negative ρcore detected: -3.0706589278593996e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77217835421                   -0.87    9.7    5.93s
  2   -73.78263159352       -1.98       -1.07    5.2    3.02s
  3   -73.78866360651       -2.22       -1.41    6.8    3.99s
  4   -73.78974625119       -2.97       -1.80    5.9    3.38s
  5   -73.78987879877       -3.88       -2.32    5.0    3.09s
  6   -73.78989275852       -4.86       -3.10    5.7    3.46s
  7   -73.78989276726       -8.06       -3.55    4.6    2.97s
  8   -73.78989279960       -7.49       -3.98    5.3    3.23s
  9   -73.78989279987       -9.56       -4.31    5.5    3.42s
 10   -73.78989280242       -8.59       -4.84    5.5    3.39s
 11   -73.78989280247      -10.34       -5.35    5.2    3.31s
 12   -73.78989280248      -10.85       -6.09    5.1    3.27s
 13   -73.78989280248      -12.36       -6.52    5.4    3.38s
 14   -73.78989280248      -13.55       -6.95    4.8    3.31s
 15   -73.78989280248   +  -13.37       -7.81    5.2    4.48s
┌ Warning: Negative ρcore detected: -3.0706589278593996e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77217162335                   -0.87    9.6    5.82s
  2   -73.78261245087       -1.98       -1.07    5.3    3.08s
  3   -73.78866579176       -2.22       -1.41    6.7    3.99s
  4   -73.78974666869       -2.97       -1.80    5.9    3.38s
  5   -73.78987850171       -3.88       -2.31    5.0    3.05s
  6   -73.78989275723       -4.85       -3.10    5.5    3.42s
  7   -73.78989277030       -7.88       -3.55    4.3    2.85s
  8   -73.78989279983       -7.53       -3.98    5.3    3.27s
  9   -73.78989279999       -9.81       -4.31    5.6    3.47s
 10   -73.78989280242       -8.61       -4.83    5.5    3.37s
 11   -73.78989280247      -10.32       -5.35    5.2    4.25s
 12   -73.78989280248      -10.87       -6.11    5.1    4.17s
 13   -73.78989280248      -12.40       -6.47    5.4    3.95s
 14   -73.78989280248      -13.25       -6.94    4.9    3.82s
 15   -73.78989280248   +    -Inf       -7.79    5.2    4.27s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0706589278593996e-8,1.665190166743141e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     1    -7.378989e+01     1.148006e-06
 * time: 163.1061511039734
┌ Warning: Negative ρcore detected: -3.070542659579206e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77216874608                   -0.87    9.7    5.86s
  2   -73.78262966769       -1.98       -1.07    5.3    3.08s
  3   -73.78866442273       -2.22       -1.41    6.7    3.99s
  4   -73.78974647427       -2.97       -1.80    5.8    3.31s
  5   -73.78987874704       -3.88       -2.32    4.9    3.04s
  6   -73.78989275754       -4.85       -3.10    5.6    3.41s
  7   -73.78989276908       -7.94       -3.56    4.4    2.89s
  8   -73.78989279983       -7.51       -3.99    5.3    3.26s
  9   -73.78989279991      -10.08       -4.31    5.6    3.49s
 10   -73.78989280243       -8.60       -4.84    5.5    3.42s
 11   -73.78989280247      -10.38       -5.34    5.2    3.28s
 12   -73.78989280249      -10.85       -6.10    5.1    3.34s
 13   -73.78989280249      -12.47       -6.52    5.4    3.32s
 14   -73.78989280249   +  -13.37       -6.95    4.8    3.26s
 15   -73.78989280249      -13.37       -7.84    5.1    4.15s
┌ Warning: Negative ρcore detected: -3.070542659579206e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77216674970                   -0.87    9.6    5.80s
  2   -73.78263231014       -1.98       -1.07    5.2    3.09s
  3   -73.78866428104       -2.22       -1.41    6.8    3.97s
  4   -73.78974629610       -2.97       -1.80    5.9    3.30s
  5   -73.78987864643       -3.88       -2.32    5.0    2.93s
  6   -73.78989275781       -4.85       -3.10    5.5    3.24s
  7   -73.78989276719       -8.03       -3.55    4.5    2.79s
  8   -73.78989279951       -7.49       -3.98    5.3    3.25s
  9   -73.78989279980       -9.53       -4.30    5.6    3.42s
 10   -73.78989280242       -8.58       -4.83    5.5    3.43s
 11   -73.78989280247      -10.33       -5.34    5.1    3.39s
 12   -73.78989280249      -10.84       -6.08    5.1    3.12s
 13   -73.78989280249      -12.33       -6.56    5.4    3.41s
 14   -73.78989280249   +  -13.55       -6.94    4.8    3.08s
 15   -73.78989280249   +  -13.37       -7.84    5.1    3.20s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.070542659579206e-8,1.6654318181874856e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     2    -7.378989e+01     7.780046e-09
 * time: 321.35760498046875
 * Status: success

 * Candidate solution
    Final objective value:     -7.378989e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 6.98e-06 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.24e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 3.75e-12 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 5.08e-14 ≰ 0.0e+00
    |g(x)|                 = 7.78e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   321  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

V: 413.222596 seconds (359.97 M allocations: 210.332 GiB, 9.05% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T00:18:27.861
└   θ = ComponentVector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}(κ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.5274266054802829,1.0,0.0), μ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.2225734371774011,0.0,1.0))
┌ Info: 2025-05-21T00:18:27.867
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.317718204075542)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458071055221                   -0.96    7.0    1.31s
  2   -8.460043885506       -2.70       -1.74    2.1    856ms
  3   -8.460108694156       -4.19       -2.82    3.7    879ms
  4   -8.460109423997       -6.14       -3.93    4.2    990ms
  5   -8.460109428693       -8.33       -4.57    4.4    1.19s
  6   -8.460109428906       -9.67       -5.42    4.2    900ms
  7   -8.460109428912      -11.23       -6.19    3.9    984ms
  8   -8.460109428912      -12.84       -7.75    3.7    1.07s
Iter     Function value   Gradient norm 
     0    -8.460109e+00     7.370934e-07
 * time: 3.719329833984375e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.460109e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 7.37e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458073342202                   -0.96    7.0    1.45s
  2   -8.460046056430       -2.70       -1.74    2.1    660ms
  3   -8.460108770117       -4.20       -2.83    3.7    940ms
  4   -8.460109423814       -6.18       -3.92    4.0    1.13s
  5   -8.460109428688       -8.31       -4.57    4.4    956ms
  6   -8.460109428906       -9.66       -5.40    4.4    955ms
  7   -8.460109428912      -11.21       -6.20    3.9    1.09s
  8   -8.460109428912      -12.84       -7.76    3.7    849ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.14e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.56e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.28e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.87e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.59e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 2.97e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 4.70e-10
└ * number of operations = 8
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458070999976                   -0.96    7.0    1.46s
  2   -8.460044213387       -2.70       -1.74    2.2    669ms
  3   -8.460108633760       -4.19       -2.83    3.6    937ms
  4   -8.460109423591       -6.10       -3.91    4.2    1.11s
  5   -8.460109428689       -8.29       -4.56    4.3    993ms
  6   -8.460109428905       -9.66       -5.38    4.2    928ms
  7   -8.460109428912      -11.17       -6.24    3.9    1.08s
  8   -8.460109428912      -12.96       -7.65    3.6    851ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.33e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.82e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.98e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.89e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 3.86e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 5.23e-09
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 8.55e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.16e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.05e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.23e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 9.79e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 1.82e-08
└ * number of operations = 7
Si: 168.787704 seconds (247.90 M allocations: 206.179 GiB, 10.48% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T00:21:16.657
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.565310337416772)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18788446508                   -1.18    8.9    7.71s
  2   -62.19165854894       -2.42       -1.24    3.7    3.90s
  3   -62.19545498814       -2.42       -2.10    5.3    4.88s
  4   -62.19547739067       -4.65       -2.91    4.1    4.59s
  5   -62.19547802214       -6.20       -3.67    4.1    4.59s
  6   -62.19547802875       -8.18       -4.53    5.0    4.78s
  7   -62.19547802891       -9.77       -5.26    4.3    4.68s
  8   -62.19547802892      -11.11       -6.82    4.0    4.66s
  9   -62.19547802892   +  -13.85       -7.87    5.2    5.24s
Iter     Function value   Gradient norm 
     0    -6.219548e+01     4.012564e-07
 * time: 4.00543212890625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.219548e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 4.01e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18788633813                   -1.18    8.9    7.25s
  2   -62.19165360098       -2.42       -1.24    3.9    5.56s
  3   -62.19545499113       -2.42       -2.10    5.7    7.00s
  4   -62.19547739985       -4.65       -2.91    4.2    5.61s
  5   -62.19547802199       -6.21       -3.66    4.0    4.66s
  6   -62.19547802873       -8.17       -4.52    4.9    4.70s
  7   -62.19547802891       -9.76       -5.14    4.3    6.87s
  8   -62.19547802892      -10.91       -6.88    4.0    5.21s
  9   -62.19547802892      -13.55       -7.88    5.2    7.71s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.13e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.05e+00
[ Info: GMRES linsolve in iteration 1; step 2: normres = 6.22e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.01e-02
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.74e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 7.50e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 3.03e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 1.04e-08
└ * number of operations = 9
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18788534374                   -1.18    8.9    7.21s
  2   -62.19165329112       -2.42       -1.24    3.6    3.76s
  3   -62.19545485004       -2.42       -2.10    5.5    4.98s
  4   -62.19547741449       -4.65       -2.91    4.2    4.54s
  5   -62.19547802198       -6.22       -3.66    3.9    4.59s
  6   -62.19547802874       -8.17       -4.51    4.8    6.68s
  7   -62.19547802891       -9.76       -5.17    4.1    4.77s
  8   -62.19547802892      -10.97       -6.81    3.9    4.38s
  9   -62.19547802892      -13.19       -7.88    5.2    6.54s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.06e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.34e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 7.13e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.27e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.09e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.19e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.46e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 3.94e-09
└ * number of operations = 9
[ Info: GMRES linsolve starts with norm of residual = 2.03e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.72e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 8.29e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.44e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.69e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 6.98e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 2.87e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 4.36e-09
└ * number of operations = 9
NaCl: 1266.726440 seconds (963.17 M allocations: 1.348 TiB, 4.79% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T00:42:23.386
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.631724461681042)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317236953464                   -1.46    5.6    994ms
  2   -2.317311203277       -4.13       -1.84    1.4    532ms
  3   -2.317328085255       -4.77       -3.56    3.2    699ms
  4   -2.317328281696       -6.71       -3.99    4.6    899ms
  5   -2.317328282328       -9.20       -4.26    2.3    675ms
  6   -2.317328282535       -9.69       -4.97    2.8    747ms
  7   -2.317328282541      -11.24       -5.70    2.5    741ms
  8   -2.317328282541      -12.59       -6.41    2.6    630ms
  9   -2.317328282541      -14.21       -6.82    2.6    591ms
 10   -2.317328282541   +  -15.35       -7.38    1.9    511ms
Iter     Function value   Gradient norm 
     0    -2.317328e+00     4.816370e-07
 * time: 2.8848648071289062e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.317328e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 4.82e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317229109131                   -1.46    5.6    1.31s
  2   -2.317310596626       -4.09       -1.84    1.4    465ms
  3   -2.317328062801       -4.76       -3.58    3.2    768ms
  4   -2.317328281759       -6.66       -4.01    4.6    1.15s
  5   -2.317328282337       -9.24       -4.27    2.3    558ms
┌ Warning: Eigensolver not converged
│   n_iter =
│    195-element Vector{Int64}:
│     3
│     2
│     7
│     4
│     ⋮
│     1
│     3
│     3
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/scf/self_consistent_field.jl:76
  6   -2.317328282535       -9.70       -4.99    2.7    631ms
  7   -2.317328282541      -11.23       -5.70    2.5    627ms
  8   -2.317328282541      -12.61       -6.50    2.7    849ms
  9   -2.317328282541      -14.05       -6.97    3.0    650ms
 10   -2.317328282541   +    -Inf       -7.40    2.3    561ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.96e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.73e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.81e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.00e-06
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 3.75e-08
└ * number of operations = 6
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317233236499                   -1.46    5.5    1.11s
  2   -2.317311089010       -4.11       -1.84    1.4    668ms
  3   -2.317328086880       -4.77       -3.57    3.2    683ms
  4   -2.317328281719       -6.71       -4.00    4.6    961ms
  5   -2.317328282330       -9.21       -4.26    2.3    597ms
  6   -2.317328282535       -9.69       -4.98    2.7    830ms
  7   -2.317328282541      -11.24       -5.72    2.5    569ms
  8   -2.317328282541      -12.62       -6.50    2.7    619ms
  9   -2.317328282541      -14.10       -6.84    2.8    666ms
 10   -2.317328282541      -14.65       -7.36    2.0    744ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.32e-03
[ Info: GMRES linsolve in iteration 1; step 1: normres = 6.50e-05
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.02e-06
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.22e-07
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 1.32e-09
└ * number of operations = 6
[ Info: GMRES linsolve starts with norm of residual = 2.44e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.79e-03
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.39e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 7.23e-07
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 9.80e-09
└ * number of operations = 6
Al: 142.382724 seconds (154.55 M allocations: 84.682 GiB, 7.15% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T00:44:45.771
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.6304970033650905)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.070542659579206e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77216405845                   -0.87    9.6    5.71s
  2   -73.78263441378       -1.98       -1.07    5.2    3.03s
  3   -73.78866305621       -2.22       -1.41    6.7    3.94s
  4   -73.78974643085       -2.97       -1.80    5.9    3.35s
  5   -73.78987894564       -3.88       -2.32    5.0    3.03s
  6   -73.78989275985       -4.86       -3.10    5.6    3.45s
  7   -73.78989276498       -8.29       -3.55    4.7    3.02s
  8   -73.78989279935       -7.46       -3.98    5.3    3.69s
  9   -73.78989279972       -9.43       -4.29    5.6    3.85s
 10   -73.78989280242       -8.57       -4.84    5.6    3.37s
 11   -73.78989280247      -10.29       -5.35    5.2    3.30s
 12   -73.78989280249      -10.86       -6.08    5.1    3.24s
 13   -73.78989280249      -12.25       -6.48    5.3    3.34s
 14   -73.78989280249   +  -12.89       -6.93    4.9    3.07s
 15   -73.78989280249      -13.55       -7.82    5.1    3.22s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.070542659579206e-8,1.6654318181874856e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.378989e+01     4.557769e-09
 * time: 3.695487976074219e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.378989e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 4.56e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.070542659579206e-8,1.6654318181874856e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.070542659579206e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77217167458                   -0.87    9.7    5.76s
  2   -73.78262509468       -1.98       -1.07    5.3    3.02s
  3   -73.78866495688       -2.22       -1.41    6.7    3.90s
  4   -73.78974636436       -2.97       -1.80    5.9    3.37s
  5   -73.78987864812       -3.88       -2.32    5.0    2.86s
  6   -73.78989275698       -4.85       -3.10    5.5    3.36s
  7   -73.78989276854       -7.94       -3.55    4.5    2.85s
  8   -73.78989279977       -7.51       -3.98    5.3    3.20s
  9   -73.78989279988       -9.95       -4.30    5.6    3.18s
 10   -73.78989280243       -8.59       -4.84    5.5    3.34s
 11   -73.78989280247      -10.35       -5.34    5.2    3.15s
 12   -73.78989280249      -10.85       -6.10    5.1    3.15s
 13   -73.78989280249      -12.47       -6.50    5.3    3.00s
 14   -73.78989280249      -13.55       -6.94    4.9    3.03s
 15   -73.78989280249   +  -13.85       -7.82    5.1    3.16s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.38e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.01e+01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.26e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.97e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 4.91e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.72e-07
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.71e-08
┌ Info: GMRES linsolve converged at iteration 2, step 1:
│ * norm of residual = 6.25e-09
└ * number of operations = 9
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}(Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.070542676009587e-8,1.6654318174315426e-7),Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(1.6654318174315426e-7,3.462188518823945e-6))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Computing cross-derivative ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.070542659579206e-8,0.0,0.0)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.070542659579206e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77216743855                   -0.87    9.6    5.30s
  2   -73.78262532195       -1.98       -1.07    5.3    2.85s
  3   -73.78866457227       -2.22       -1.41    6.7    3.84s
  4   -73.78974664221       -2.97       -1.80    5.8    3.18s
  5   -73.78987873251       -3.88       -2.32    5.0    2.83s
  6   -73.78989275865       -4.85       -3.10    5.5    3.31s
  7   -73.78989276798       -8.03       -3.55    4.6    3.22s
  8   -73.78989279972       -7.50       -3.98    5.3    3.00s
  9   -73.78989279990       -9.75       -4.31    5.6    3.35s
 10   -73.78989280242       -8.60       -4.84    5.5    3.27s
 11   -73.78989280247      -10.33       -5.35    5.2    3.08s
 12   -73.78989280249      -10.85       -6.09    5.0    3.14s
 13   -73.78989280249      -12.37       -6.52    5.3    3.16s
 14   -73.78989280249   +  -13.37       -6.94    4.8    2.73s
 15   -73.78989280249   +  -13.85       -7.85    5.1    3.07s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 8.19e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.38e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 6.39e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.45e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 9.97e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 9.33e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.19e-09
└ * number of operations = 8
[ Info: GMRES linsolve starts with norm of residual = 3.93e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.11e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.70e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.38e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.29e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 2.03e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.66e-09
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}, KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.070542676009587e-8,0.0,0.0),Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(1.6654318179016155e-7,0.0,0.0))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
V: 819.352083 seconds (646.16 M allocations: 945.790 GiB, 7.45% gc time, 0.00% compilation time)
    14     7.760906e-05     1.252540e-07
 * Current step size: 1.0
 * time: 47205.683717012405
 * g(x): (κ = -6.79380695701266e-8, μ = -1.2525402720738044e-7)
 * ~inv(H): [451.88238018791765 89.43171587393047; 89.43171587393053 248.84473846841476]
 * x: (κ = 0.5274266054802829, μ = 0.2225734371774011)
┌ Info: 2025-05-21T00:58:25.129
└   θ = ComponentVector{Float64}(κ = 0.5274685071794388, μ = 0.22261068180117846)
┌ Info: 2025-05-21T00:58:25.129
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.317718204075542)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458082591614                   -0.96    7.0    1.30s
  2   -8.460059675751       -2.70       -1.74    2.2    623ms
  3   -8.460123089540       -4.20       -2.83    3.6    915ms
  4   -8.460123821517       -6.14       -3.93    4.1    1.10s
  5   -8.460123826322       -8.32       -4.56    4.3    1.04s
  6   -8.460123826543       -9.66       -5.42    4.2    1.10s
  7   -8.460123826549      -11.24       -6.21    3.8    863ms
  8   -8.460123826549      -12.87       -7.82    3.7    970ms
Iter     Function value   Gradient norm 
     0    -8.460124e+00     2.617690e-06
 * time: 3.600120544433594e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458081111998                   -0.96    6.9    1.48s
  2   -8.460060443604       -2.70       -1.74    2.1    617ms
  3   -8.460123046919       -4.20       -2.83    3.7    937ms
  4   -8.460123821705       -6.11       -3.91    4.2    1.15s
  5   -8.460123826373       -8.33       -4.61    4.4    957ms
  6   -8.460123826551       -9.75       -5.48    4.4    970ms
  7   -8.460123826556      -11.36       -6.29    3.9    1.07s
  8   -8.460123826556      -13.04       -7.82    3.8    886ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458086910448                   -0.96    6.9    1.22s
  2   -8.460062314681       -2.70       -1.74    2.1    845ms
  3   -8.460123143417       -4.22       -2.83    3.7    858ms
  4   -8.460123822019       -6.17       -3.92    4.0    976ms
  5   -8.460123826369       -8.36       -4.60    4.4    1.16s
  6   -8.460123826551       -9.74       -5.46    4.3    901ms
  7   -8.460123826556      -11.32       -6.24    3.8    989ms
  8   -8.460123826556      -12.91       -7.81    3.7    1.04s
     1    -8.460124e+00     2.430451e-06
 * time: 26.27503204345703
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458096010071                   -0.96    7.0    1.66s
  2   -8.460061888059       -2.71       -1.74    2.0    643ms
  3   -8.460123154313       -4.21       -2.83    3.7    1.14s
  4   -8.460123821675       -6.18       -3.92    4.1    929ms
  5   -8.460123826403       -8.33       -4.60    4.4    1.04s
  6   -8.460123826592       -9.72       -5.44    4.3    1.09s
  7   -8.460123826597      -11.29       -6.21    3.9    903ms
  8   -8.460123826597      -12.85       -7.78    3.7    933ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458093783023                   -0.96    7.0    1.42s
  2   -8.460061320085       -2.71       -1.74    1.9    601ms
  3   -8.460123135518       -4.21       -2.83    3.8    971ms
  4   -8.460123821801       -6.16       -3.92    4.1    1.09s
  5   -8.460123826382       -8.34       -4.57    4.4    950ms
  6   -8.460123826591       -9.68       -5.41    4.3    911ms
  7   -8.460123826597      -11.23       -6.21    3.9    1.03s
  8   -8.460123826597      -12.85       -7.75    3.8    871ms
     2    -8.460124e+00     1.054727e-08
 * time: 53.442824840545654
 * Status: success

 * Candidate solution
    Final objective value:     -8.460124e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.40e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.29e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 4.15e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 4.91e-12 ≰ 0.0e+00
    |g(x)|                 = 1.05e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   53  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Si: 69.281693 seconds (140.98 M allocations: 40.249 GiB, 11.35% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T00:59:34.413
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.565310337416772)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18797511136                   -1.18    9.0    7.57s
  2   -62.19173836407       -2.42       -1.24    3.8    3.76s
  3   -62.19554293417       -2.42       -2.10    5.5    5.00s
  4   -62.19556532058       -4.65       -2.92    4.2    4.67s
  5   -62.19556592751       -6.22       -3.67    4.0    4.65s
  6   -62.19556593399       -8.19       -4.54    5.0    5.05s
  7   -62.19556593416       -9.78       -5.18    4.3    4.78s
  8   -62.19556593417      -10.94       -6.86    4.0    5.24s
  9   -62.19556593417      -13.45       -7.91    5.3    7.02s
Iter     Function value   Gradient norm 
     0    -6.219557e+01     1.494610e-06
 * time: 4.1961669921875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18797659399                   -1.18    8.9    7.51s
  2   -62.19174538527       -2.42       -1.24    3.8    3.95s
  3   -62.19554296975       -2.42       -2.10    5.5    4.98s
  4   -62.19556529687       -4.65       -2.91    4.2    4.72s
  5   -62.19556592732       -6.20       -3.66    4.0    4.64s
  6   -62.19556593399       -8.18       -4.53    5.0    4.96s
  7   -62.19556593417       -9.75       -5.28    4.3    6.55s
  8   -62.19556593418      -11.11       -6.76    4.1    4.72s
  9   -62.19556593418   +  -13.67       -7.90    5.0    5.96s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18797757724                   -1.18    8.8    7.15s
  2   -62.19173600007       -2.42       -1.24    3.7    3.67s
  3   -62.19554300092       -2.42       -2.10    5.5    5.19s
  4   -62.19556530788       -4.65       -2.91    4.1    4.63s
  5   -62.19556592749       -6.21       -3.67    4.0    4.57s
  6   -62.19556593400       -8.19       -4.54    4.9    4.77s
  7   -62.19556593416       -9.79       -5.16    4.3    4.66s
  8   -62.19556593418      -10.91       -7.09    3.9    4.38s
     1    -6.219557e+01     1.424160e-06
 * time: 117.74883890151978
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18797606343                   -1.18    9.6    7.69s
  2   -62.19173938629       -2.42       -1.24    4.0    3.86s
  3   -62.19554300489       -2.42       -2.10    6.0    5.10s
  4   -62.19556530993       -4.65       -2.91    4.4    4.62s
  5   -62.19556592768       -6.21       -3.68    4.2    4.59s
  6   -62.19556593403       -8.20       -4.55    5.3    5.07s
  7   -62.19556593420       -9.78       -5.25    4.4    4.85s
  8   -62.19556593421      -11.04       -6.84    4.2    4.67s
  9   -62.19556593421      -13.07       -7.89    5.4    5.36s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18797747800                   -1.18    9.5    7.79s
  2   -62.19173706086       -2.42       -1.24    4.1    4.00s
  3   -62.19554303205       -2.42       -2.10    5.6    4.92s
  4   -62.19556533422       -4.65       -2.92    4.4    4.59s
  5   -62.19556592793       -6.23       -3.69    4.2    4.69s
  6   -62.19556593404       -8.21       -4.56    5.2    4.96s
  7   -62.19556593420       -9.82       -5.17    4.6    4.85s
  8   -62.19556593421      -10.93       -6.92    4.0    4.56s
  9   -62.19556593421   +  -13.67       -7.89    5.7    5.51s
     2    -6.219557e+01     7.852570e-07
 * time: 236.07436084747314
 * Status: success

 * Candidate solution
    Final objective value:     -6.219557e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.02e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.86e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 3.40e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 5.47e-13 ≰ 0.0e+00
    |g(x)|                 = 7.85e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   236  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

NaCl: 306.001572 seconds (535.70 M allocations: 181.380 GiB, 7.57% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:04:40.417
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.631724461681042)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317236852619                   -1.46    5.5    1.29s
  2   -2.317313289424       -4.12       -1.84    1.4    478ms
  3   -2.317330200977       -4.77       -3.57    3.2    768ms
  4   -2.317330386663       -6.73       -4.00    4.6    1.12s
  5   -2.317330387261       -9.22       -4.27    2.4    584ms
  6   -2.317330387456       -9.71       -4.98    2.6    620ms
  7   -2.317330387462      -11.22       -5.71    2.5    886ms
  8   -2.317330387463      -12.62       -6.38    2.6    653ms
  9   -2.317330387463      -14.15       -6.84    2.4    516ms
 10   -2.317330387463      -14.88       -7.39    2.0    501ms
Iter     Function value   Gradient norm 
     0    -2.317330e+00     1.639319e-06
 * time: 3.0994415283203125e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317234345641                   -1.46    5.6    1.29s
  2   -2.317313169358       -4.10       -1.84    1.4    480ms
  3   -2.317330174411       -4.77       -3.57    3.2    780ms
  4   -2.317330386628       -6.67       -4.00    4.5    1.14s
  5   -2.317330387252       -9.20       -4.26    2.3    565ms
  6   -2.317330387459       -9.69       -4.97    2.8    658ms
  7   -2.317330387465      -11.19       -5.71    2.4    830ms
  8   -2.317330387465      -12.65       -6.50    2.7    602ms
  9   -2.317330387465      -14.15       -6.88    2.8    630ms
 10   -2.317330387465   +    -Inf       -7.41    1.7    507ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317234046163                   -1.46    5.5    1.10s
  2   -2.317312865583       -4.10       -1.84    1.4    480ms
  3   -2.317330190913       -4.76       -3.57    3.3    927ms
  4   -2.317330386603       -6.71       -3.99    4.6    944ms
  5   -2.317330387244       -9.19       -4.25    2.3    610ms
  6   -2.317330387458       -9.67       -4.98    2.7    843ms
  7   -2.317330387465      -11.12       -5.70    2.7    614ms
  8   -2.317330387465      -12.62       -6.45    2.6    622ms
  9   -2.317330387465      -14.12       -6.89    2.7    610ms
 10   -2.317330387465      -15.35       -7.43    2.0    690ms
     1    -2.317330e+00     1.571071e-06
 * time: 40.83724808692932
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317234300384                   -1.46    5.5    1.32s
  2   -2.317313005779       -4.10       -1.84    1.4    396ms
  3   -2.317330179832       -4.77       -3.58    3.3    784ms
  4   -2.317330386697       -6.68       -4.01    4.6    1.12s
  5   -2.317330387288       -9.23       -4.27    2.3    564ms
  6   -2.317330387489       -9.70       -4.97    2.7    627ms
  7   -2.317330387496      -11.21       -5.70    2.5    828ms
  8   -2.317330387496      -12.60       -6.33    2.8    597ms
  9   -2.317330387496      -14.12       -6.82    2.4    551ms
 10   -2.317330387496      -14.51       -7.29    2.1    547ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317234188718                   -1.46    5.5    1.09s
  2   -2.317312745503       -4.10       -1.84    1.3    451ms
  3   -2.317330168663       -4.76       -3.57    3.2    935ms
  4   -2.317330386647       -6.66       -4.00    4.5    922ms
  5   -2.317330387276       -9.20       -4.26    2.3    599ms
  6   -2.317330387489       -9.67       -4.96    2.8    856ms
  7   -2.317330387496      -11.18       -5.69    2.6    579ms
  8   -2.317330387496      -12.63       -6.35    2.6    618ms
  9   -2.317330387496      -14.12       -6.90    2.4    593ms
 10   -2.317330387496      -14.57       -7.36    2.3    772ms
     2    -2.317330e+00     4.485786e-08
 * time: 81.53681802749634
 * Status: success

 * Candidate solution
    Final objective value:     -2.317330e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.77e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.94e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 3.05e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.31e-11 ≰ 0.0e+00
    |g(x)|                 = 4.49e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   82  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Al: 106.731435 seconds (106.59 M allocations: 29.632 GiB, 7.07% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:06:27.151
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.6304970033650905)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.070542659579206e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77223590653                   -0.87    9.7    5.81s
  2   -73.78269311919       -1.98       -1.07    5.3    3.14s
  3   -73.78873055340       -2.22       -1.41    6.7    4.02s
  4   -73.78981093386       -2.97       -1.80    5.9    3.41s
  5   -73.78994336069       -3.88       -2.31    5.0    3.02s
  6   -73.78995767718       -4.84       -3.10    5.5    3.40s
  7   -73.78995768715       -8.00       -3.55    4.5    2.88s
  8   -73.78995771953       -7.49       -3.98    5.2    3.19s
  9   -73.78995771990       -9.43       -4.30    5.6    3.41s
 10   -73.78995772246       -8.59       -4.84    5.5    3.30s
 11   -73.78995772251      -10.34       -5.34    5.2    3.08s
 12   -73.78995772252      -10.85       -6.08    5.1    3.23s
 13   -73.78995772252      -12.32       -6.56    5.4    3.37s
 14   -73.78995772252      -13.15       -6.93    4.8    3.06s
 15   -73.78995772252   +  -12.94       -7.84    5.1    3.17s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.070542659579206e-8,1.6654318181874856e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.378996e+01     3.709532e-06
 * time: 4.00543212890625e-5
┌ Warning: Negative ρcore detected: -3.0704808862818426e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77224132420                   -0.87    9.7    5.84s
  2   -73.78269982064       -1.98       -1.07    5.3    3.02s
  3   -73.78872732010       -2.22       -1.41    6.7    3.76s
  4   -73.78981151347       -2.96       -1.80    5.9    3.33s
  5   -73.78994378279       -3.88       -2.32    5.0    3.06s
  6   -73.78995767542       -4.86       -3.10    5.6    3.44s
  7   -73.78995768901       -7.87       -3.55    4.3    2.77s
  8   -73.78995771996       -7.51       -3.98    5.2    2.97s
  9   -73.78995771984   +   -9.95       -4.30    5.6    3.45s
 10   -73.78995772247       -8.58       -4.84    5.5    3.31s
 11   -73.78995772252      -10.36       -5.34    5.0    3.24s
 12   -73.78995772253      -10.86       -6.10    5.0    3.21s
 13   -73.78995772253      -12.37       -6.49    5.2    3.33s
 14   -73.78995772253      -13.85       -6.94    4.8    3.03s
 15   -73.78995772253   +  -13.07       -7.83    5.1    3.26s
┌ Warning: Negative ρcore detected: -3.0704808862818426e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77224543944                   -0.87    9.6    5.73s
  2   -73.78268778528       -1.98       -1.07    5.2    3.02s
  3   -73.78873036599       -2.22       -1.41    6.7    3.99s
  4   -73.78981104593       -2.97       -1.80    5.9    3.36s
  5   -73.78994374808       -3.88       -2.32    5.0    3.07s
  6   -73.78995768053       -4.86       -3.10    5.6    3.39s
  7   -73.78995768662       -8.22       -3.55    4.6    2.99s
  8   -73.78995771958       -7.48       -3.98    5.3    3.24s
  9   -73.78995771990       -9.49       -4.30    5.6    3.43s
 10   -73.78995772247       -8.59       -4.84    5.5    3.34s
 11   -73.78995772252      -10.35       -5.34    5.1    3.26s
 12   -73.78995772253      -10.83       -6.09    5.1    3.22s
 13   -73.78995772253      -12.36       -6.49    5.3    3.30s
 14   -73.78995772253   +  -13.37       -6.91    4.9    3.01s
 15   -73.78995772253      -13.37       -7.82    5.1    3.16s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0704808862818426e-8,1.665560246676513e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     1    -7.378996e+01     3.099364e-06
 * time: 155.66805982589722
┌ Warning: Negative ρcore detected: -3.070167031372851e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77224049364                   -0.87    9.9    5.92s
  2   -73.78270735554       -1.98       -1.07    5.4    3.13s
  3   -73.78872628611       -2.22       -1.41    6.8    4.03s
  4   -73.78981167484       -2.96       -1.80    5.9    3.35s
  5   -73.78994393144       -3.88       -2.32    5.0    3.02s
  6   -73.78995767990       -4.86       -3.10    5.6    3.34s
  7   -73.78995768610       -8.21       -3.56    4.7    3.20s
  8   -73.78995771961       -7.47       -3.99    5.3    3.25s
  9   -73.78995771986       -9.59       -4.30    5.6    3.46s
 10   -73.78995772251       -8.58       -4.86    5.6    3.33s
 11   -73.78995772255      -10.43       -5.35    5.3    3.34s
 12   -73.78995772256      -10.84       -6.09    5.2    3.27s
 13   -73.78995772256      -12.40       -6.57    5.5    3.37s
 14   -73.78995772256      -13.85       -6.96    4.7    3.03s
 15   -73.78995772256      -13.15       -7.82    5.2    3.22s
┌ Warning: Negative ρcore detected: -3.070167031372851e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77223925708                   -0.87    9.8    5.82s
  2   -73.78268542067       -1.98       -1.07    5.4    3.03s
  3   -73.78873008822       -2.22       -1.41    6.8    3.81s
  4   -73.78981134563       -2.97       -1.80    5.9    3.11s
  5   -73.78994380946       -3.88       -2.32    5.0    2.83s
  6   -73.78995767970       -4.86       -3.10    5.7    3.18s
  7   -73.78995769087       -7.95       -3.56    4.5    2.74s
  8   -73.78995772003       -7.54       -3.99    5.4    3.20s
  9   -73.78995772006      -10.50       -4.31    5.7    3.47s
 10   -73.78995772251       -8.61       -4.84    5.5    3.36s
 11   -73.78995772255      -10.40       -5.35    5.2    3.31s
 12   -73.78995772256      -10.86       -6.12    5.1    3.21s
 13   -73.78995772256      -12.43       -6.50    5.3    3.32s
 14   -73.78995772256      -13.55       -6.94    4.9    3.01s
 15   -73.78995772256   +  -13.37       -7.80    5.2    4.23s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.070167031372851e-8,1.6662125196743673e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     2    -7.378996e+01     1.087810e-08
 * time: 311.8961720466614
 * Status: success

 * Candidate solution
    Final objective value:     -7.378996e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.88e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.35e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.85e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.87e-13 ≰ 0.0e+00
    |g(x)|                 = 1.09e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   312  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

V: 401.390866 seconds (358.99 M allocations: 210.669 GiB, 9.26% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:13:08.547
└   θ = ComponentVector{Float64}(κ = 0.5274307956501985, μ = 0.22257716163977884)
┌ Info: 2025-05-21T01:13:08.547
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.317754800664474)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458064522855                   -0.96    7.0    1.29s
  2   -8.460044904660       -2.70       -1.74    2.1    838ms
  3   -8.460110196192       -4.19       -2.83    3.7    878ms
  4   -8.460110863245       -6.18       -3.93    4.1    967ms
  5   -8.460110868410       -8.29       -4.54    4.3    1.18s
  6   -8.460110868656       -9.61       -5.39    4.2    890ms
  7   -8.460110868663      -11.16       -6.23    3.9    957ms
  8   -8.460110868663      -12.89       -7.84    3.8    1.08s
Iter     Function value   Gradient norm 
     0    -8.460111e+00     1.680336e-06
 * time: 3.814697265625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458075201565                   -0.96    7.0    1.48s
  2   -8.460050827685       -2.70       -1.74    2.1    653ms
  3   -8.460110229270       -4.23       -2.82    3.6    1.10s
  4   -8.460110863731       -6.20       -3.91    4.1    902ms
  5   -8.460110868505       -8.32       -4.62    4.4    1.26s
  6   -8.460110868662       -9.80       -5.52    4.4    1.14s
  7   -8.460110868666      -11.45       -6.31    3.9    882ms
  8   -8.460110868666      -13.11       -7.79    3.7    938ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458073535853                   -0.96    7.0    1.62s
  2   -8.460046036231       -2.70       -1.74    2.0    613ms
  3   -8.460110259454       -4.19       -2.82    3.7    948ms
  4   -8.460110863467       -6.22       -3.92    4.2    1.14s
  5   -8.460110868433       -8.30       -4.56    4.5    1.01s
  6   -8.460110868659       -9.64       -5.41    4.2    950ms
  7   -8.460110868666      -11.19       -6.27    3.8    1.07s
  8   -8.460110868666      -13.01       -7.81    3.7    907ms
     1    -8.460111e+00     1.561239e-06
 * time: 27.46875
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458058305543                   -0.96    7.0    1.25s
  2   -8.460047170207       -2.70       -1.74    2.0    820ms
  3   -8.460110024347       -4.20       -2.83    3.7    863ms
  4   -8.460110864672       -6.08       -3.90    4.1    1.03s
  5   -8.460110868542       -8.41       -4.64    4.3    1.15s
  6   -8.460110868680       -9.86       -5.53    4.6    955ms
  7   -8.460110868683      -11.50       -6.29    3.9    1.00s
  8   -8.460110868683      -13.04       -7.67    3.8    1.20s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458069488983                   -0.96    7.0    1.95s
  2   -8.460046747669       -2.70       -1.74    2.1    688ms
  3   -8.460110085072       -4.20       -2.83    3.6    1.14s
  4   -8.460110864175       -6.11       -3.91    4.1    898ms
  5   -8.460110868511       -8.36       -4.61    4.3    1.01s
  6   -8.460110868679       -9.78       -5.47    4.5    1.09s
  7   -8.460110868683      -11.36       -6.26    3.8    877ms
  8   -8.460110868683      -12.98       -7.74    3.8    1.27s
     2    -8.460111e+00     6.143354e-09
 * time: 55.726227045059204
 * Status: success

 * Candidate solution
    Final objective value:     -8.460111e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.20e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.13e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.71e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.02e-12 ≰ 0.0e+00
    |g(x)|                 = 6.14e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   56  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Si: 71.922325 seconds (142.29 M allocations: 40.538 GiB, 11.58% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:14:20.472
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.565342045917928)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18790013945                   -1.18    9.5    11.8s
  2   -62.19166515714       -2.42       -1.24    4.2    5.91s
  3   -62.19546385787       -2.42       -2.10    5.7    6.89s
  4   -62.19548621300       -4.65       -2.92    4.2    5.31s
  5   -62.19548681298       -6.22       -3.67    4.1    4.68s
  6   -62.19548681935       -8.20       -4.54    5.1    5.01s
  7   -62.19548681950       -9.81       -5.21    4.4    4.82s
  8   -62.19548681951      -11.02       -6.76    4.0    5.66s
  9   -62.19548681951   +  -13.45       -7.86    5.1    7.06s
Iter     Function value   Gradient norm 
     0    -6.219549e+01     1.967569e-07
 * time: 3.910064697265625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.219549e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.97e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

NaCl: 78.308584 seconds (120.33 M allocations: 40.012 GiB, 6.80% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:15:38.783
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.631763838018098)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317231446334                   -1.46    5.5    1.26s
  2   -2.317311426431       -4.10       -1.84    1.4    472ms
  3   -2.317328272124       -4.77       -3.57    3.3    778ms
  4   -2.317328492157       -6.66       -3.98    4.5    1.35s
  5   -2.317328492798       -9.19       -4.25    2.3    787ms
  6   -2.317328493018       -9.66       -4.96    2.8    807ms
  7   -2.317328493025      -11.19       -5.71    2.5    1.00s
  8   -2.317328493025      -12.64       -6.49    2.6    747ms
  9   -2.317328493025      -14.12       -6.93    2.9    814ms
 10   -2.317328493025   +    -Inf       -7.33    1.9    674ms
Iter     Function value   Gradient norm 
     0    -2.317328e+00     9.970128e-07
 * time: 2.5987625122070312e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.317328e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 9.97e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Al: 26.753333 seconds (23.95 M allocations: 6.534 GiB, 6.44% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:16:05.539
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.630519555548769)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.070167031372851e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77217112978                   -0.87    9.8    5.74s
  2   -73.78264016301       -1.98       -1.07    5.4    3.13s
  3   -73.78867047152       -2.22       -1.41    6.8    4.74s
  4   -73.78975292394       -2.97       -1.80    6.0    3.59s
  5   -73.78988542897       -3.88       -2.32    5.0    4.16s
  6   -73.78989924888       -4.86       -3.10    5.6    3.33s
  7   -73.78989925963       -7.97       -3.55    4.5    2.84s
  8   -73.78989929180       -7.49       -3.98    5.4    3.15s
  9   -73.78989929182      -10.70       -4.30    5.5    3.91s
 10   -73.78989929443       -8.58       -4.85    5.6    3.96s
 11   -73.78989929447      -10.41       -5.34    5.2    3.23s
 12   -73.78989929449      -10.84       -6.11    5.1    3.25s
 13   -73.78989929449      -12.49       -6.47    5.4    4.50s
 14   -73.78989929449   +  -13.85       -6.94    5.0    3.74s
 15   -73.78989929449   +  -13.55       -7.80    5.3    3.09s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.070167031372851e-8,1.6662125196743673e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.378990e+01     3.355922e-06
 * time: 3.814697265625e-5
┌ Warning: Negative ρcore detected: -3.070222950575614e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77217537112                   -0.87    9.9    5.66s
  2   -73.78264024623       -1.98       -1.07    5.4    3.06s
  3   -73.78867057513       -2.22       -1.41    6.9    3.92s
  4   -73.78975317076       -2.97       -1.80    6.0    3.30s
  5   -73.78988542693       -3.88       -2.32    5.1    3.06s
  6   -73.78989925354       -4.86       -3.10    5.6    3.40s
  7   -73.78989925602       -8.61       -3.55    4.9    2.98s
  8   -73.78989929131       -7.45       -3.98    5.4    3.21s
  9   -73.78989929181       -9.30       -4.30    5.6    3.34s
 10   -73.78989929444       -8.58       -4.85    5.6    3.39s
 11   -73.78989929448      -10.42       -5.34    5.2    3.30s
 12   -73.78989929450      -10.82       -6.09    5.1    3.21s
 13   -73.78989929450      -12.38       -6.51    5.4    3.36s
 14   -73.78989929450      -13.85       -6.94    4.8    3.08s
 15   -73.78989929450   +  -13.37       -7.85    5.2    3.26s
┌ Warning: Negative ρcore detected: -3.070222950575614e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77217751753                   -0.87    9.9    5.88s
  2   -73.78264231433       -1.98       -1.07    5.4    3.15s
  3   -73.78866977765       -2.22       -1.41    6.9    4.06s
  4   -73.78975295954       -2.97       -1.80    6.0    3.48s
  5   -73.78988525961       -3.88       -2.32    5.1    2.96s
  6   -73.78989924962       -4.85       -3.10    5.6    3.34s
  7   -73.78989925783       -8.09       -3.55    4.6    2.90s
  8   -73.78989929161       -7.47       -3.98    5.3    3.17s
  9   -73.78989929181       -9.69       -4.30    5.7    3.35s
 10   -73.78989929444       -8.58       -4.85    5.5    3.27s
 11   -73.78989929448      -10.37       -5.35    5.2    3.38s
 12   -73.78989929450      -10.84       -6.09    5.1    3.46s
 13   -73.78989929450      -12.27       -6.48    5.4    3.28s
 14   -73.78989929450   +  -13.85       -6.95    4.9    2.97s
 15   -73.78989929450   +  -12.94       -7.81    5.1    3.17s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.070222950575614e-8,1.6660963597733801e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     1    -7.378990e+01     2.801683e-06
 * time: 156.70516800880432
┌ Warning: Negative ρcore detected: -3.0705055007280205e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77218269954                   -0.87    9.6    5.78s
  2   -73.78263182016       -1.98       -1.07    5.3    3.06s
  3   -73.78867153438       -2.22       -1.41    6.7    3.88s
  4   -73.78975274284       -2.97       -1.80    5.8    3.23s
  5   -73.78988556762       -3.88       -2.32    5.0    2.97s
  6   -73.78989925165       -4.86       -3.10    5.6    3.36s
  7   -73.78989926055       -8.05       -3.55    4.5    2.88s
  8   -73.78989929176       -7.51       -3.98    5.3    3.24s
  9   -73.78989929186      -10.01       -4.30    5.5    3.47s
 10   -73.78989929446       -8.58       -4.84    5.5    3.24s
 11   -73.78989929451      -10.37       -5.33    5.2    3.20s
 12   -73.78989929452      -10.82       -6.10    5.1    3.11s
 13   -73.78989929452      -12.37       -6.53    5.3    3.26s
 14   -73.78989929452   +  -13.85       -6.92    4.8    2.94s
 15   -73.78989929452      -13.25       -7.82    5.2    3.24s
┌ Warning: Negative ρcore detected: -3.0705055007280205e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77218554904                   -0.87    9.6    5.84s
  2   -73.78264075522       -1.98       -1.07    5.3    3.13s
  3   -73.78866905170       -2.22       -1.41    6.7    4.03s
  4   -73.78975304004       -2.96       -1.80    5.9    4.24s
  5   -73.78988516509       -3.88       -2.32    5.0    3.07s
  6   -73.78989924974       -4.85       -3.10    5.5    3.39s
  7   -73.78989925880       -8.04       -3.55    4.5    2.93s
  8   -73.78989929162       -7.48       -3.99    5.3    3.18s
  9   -73.78989929189       -9.58       -4.30    5.6    3.30s
 10   -73.78989929446       -8.59       -4.84    5.5    3.33s
 11   -73.78989929451      -10.34       -5.34    5.2    3.24s
 12   -73.78989929452      -10.85       -6.08    5.1    3.13s
 13   -73.78989929452      -12.38       -6.52    5.3    3.20s
 14   -73.78989929452      -13.15       -6.94    4.8    2.92s
 15   -73.78989929452   +  -13.25       -7.84    5.1    3.04s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0705055007280205e-8,1.6655090944965332e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     2    -7.378990e+01     3.525945e-09
 * time: 313.5126619338989
 * Status: success

 * Candidate solution
    Final objective value:     -7.378990e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.70e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.01e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.45e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.33e-13 ≰ 0.0e+00
    |g(x)|                 = 3.53e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   314  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

V: 406.819046 seconds (360.81 M allocations: 211.627 GiB, 8.93% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:22:52.379
└   θ = ComponentVector{Float64}(κ = 0.5274270244972744, μ = 0.22257380962363887)
┌ Info: 2025-05-21T01:22:52.379
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.317731092863236)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458062944338                   -0.96    6.9    1.30s
  2   -8.460045962901       -2.70       -1.74    2.0    843ms
  3   -8.460108995669       -4.20       -2.83    3.7    871ms
  4   -8.460109568229       -6.24       -3.92    4.0    973ms
  5   -8.460109572698       -8.35       -4.59    4.5    1.18s
  6   -8.460109572888       -9.72       -5.46    4.2    887ms
  7   -8.460109572892      -11.34       -6.26    3.9    967ms
  8   -8.460109572893      -12.96       -7.80    3.7    1.04s
Iter     Function value   Gradient norm 
     0    -8.460110e+00     1.619613e-07
 * time: 4.100799560546875e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.460110e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.62e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Si: 16.076241 seconds (31.32 M allocations: 8.830 GiB, 10.91% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:23:08.458
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.565342045917928)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18788795774                   -1.18    9.6    7.91s
  2   -62.19164782410       -2.42       -1.24    4.0    3.98s
  3   -62.19545603027       -2.42       -2.10    5.7    5.08s
  4   -62.19547829299       -4.65       -2.92    4.4    4.81s
  5   -62.19547890154       -6.22       -3.68    4.1    5.85s
  6   -62.19547890780       -8.20       -4.55    5.0    6.61s
  7   -62.19547890797       -9.78       -5.16    4.6    4.92s
  8   -62.19547890798      -10.88       -6.96    4.0    6.16s
  9   -62.19547890798   +  -13.45       -7.88    5.8    5.65s
Iter     Function value   Gradient norm 
     0    -6.219548e+01     2.960977e-07
 * time: 4.291534423828125e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.219548e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 2.96e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

NaCl: 72.124769 seconds (120.36 M allocations: 40.094 GiB, 7.43% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:24:20.585
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.631763838018098)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317233309224                   -1.46    5.5    1.27s
  2   -2.317311079487       -4.11       -1.84    1.4    462ms
  3   -2.317328092063       -4.77       -3.57    3.2    754ms
  4   -2.317328302779       -6.68       -4.01    4.6    1.13s
  5   -2.317328303368       -9.23       -4.26    2.3    565ms
  6   -2.317328303572       -9.69       -4.98    2.8    644ms
  7   -2.317328303578      -11.23       -5.72    2.5    829ms
  8   -2.317328303578      -12.63       -6.44    2.8    610ms
  9   -2.317328303578      -14.21       -6.85    2.6    605ms
 10   -2.317328303578      -15.05       -7.30    2.0    532ms
Iter     Function value   Gradient norm 
     0    -2.317328e+00     1.098867e-06
 * time: 3.1948089599609375e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317228852062                   -1.46    5.5    1.27s
  2   -2.317311042306       -4.09       -1.84    1.4    542ms
  3   -2.317328079046       -4.77       -3.57    3.3    897ms
  4   -2.317328302726       -6.65       -3.99    4.5    1.36s
  5   -2.317328303366       -9.19       -4.26    2.2    825ms
  6   -2.317328303573       -9.69       -4.97    2.7    970ms
  7   -2.317328303579      -11.21       -5.69    2.5    1.13s
  8   -2.317328303579      -12.62       -6.22    2.8    874ms
  9   -2.317328303579      -13.97       -6.83    2.1    770ms
 10   -2.317328303579      -15.35       -7.30    2.4    810ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317234308635                   -1.46    5.5    1.07s
  2   -2.317311190406       -4.11       -1.84    1.4    453ms
  3   -2.317328096889       -4.77       -3.57    3.3    907ms
  4   -2.317328302763       -6.69       -4.00    4.6    889ms
  5   -2.317328303366       -9.22       -4.26    2.3    589ms
  6   -2.317328303572       -9.69       -4.98    2.7    862ms
  7   -2.317328303579      -11.15       -5.71    2.5    678ms
  8   -2.317328303579      -12.60       -6.51    2.6    744ms
  9   -2.317328303579      -14.12       -6.95    3.1    1.00s
 10   -2.317328303579      -15.05       -7.41    2.4    1.03s
     1    -2.317328e+00     1.056393e-06
 * time: 43.34887194633484
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317230953382                   -1.46    5.6    1.56s
  2   -2.317310859847       -4.10       -1.84    1.4    597ms
  3   -2.317328035050       -4.77       -3.58    3.2    955ms
  4   -2.317328302759       -6.57       -3.99    4.6    878ms
  5   -2.317328303376       -9.21       -4.25    2.3    689ms
  6   -2.317328303586       -9.68       -4.96    2.7    695ms
  7   -2.317328303593      -11.19       -5.71    2.5    935ms
  8   -2.317328303593      -12.66       -6.51    2.7    612ms
  9   -2.317328303593      -14.18       -7.00    3.1    815ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317234868723                   -1.46    5.6    1.07s
  2   -2.317310928085       -4.12       -1.84    1.3    552ms
  3   -2.317328108251       -4.76       -3.56    3.3    1.09s
  4   -2.317328302752       -6.71       -4.00    4.5    919ms
  5   -2.317328303373       -9.21       -4.26    2.3    601ms
  6   -2.317328303587       -9.67       -4.96    2.7    874ms
  7   -2.317328303593      -11.25       -5.68    2.5    700ms
  8   -2.317328303593      -12.59       -6.10    2.7    722ms
  9   -2.317328303593      -13.92       -6.92    1.9    658ms
 10   -2.317328303593      -14.75       -7.33    2.9    976ms
     2    -2.317328e+00     4.880210e-08
 * time: 85.54489517211914
 * Status: success

 * Candidate solution
    Final objective value:     -2.317328e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.73e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.58e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.38e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 5.95e-12 ≰ 0.0e+00
    |g(x)|                 = 4.88e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   86  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Al: 111.119700 seconds (106.01 M allocations: 29.460 GiB, 6.83% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:26:11.707
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.630499235397173)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.0705055007280205e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77216179516                   -0.87    9.6    5.87s
  2   -73.78263840928       -1.98       -1.07    5.3    3.14s
  3   -73.78866456705       -2.22       -1.41    6.7    4.07s
  4   -73.78974703645       -2.97       -1.80    6.0    3.40s
  5   -73.78987914353       -3.88       -2.32    5.0    3.07s
  6   -73.78989340254       -4.85       -3.10    5.6    3.43s
  7   -73.78989341718       -7.83       -3.55    4.4    3.00s
  8   -73.78989344907       -7.50       -3.98    5.3    3.34s
  9   -73.78989344907   +  -11.97       -4.30    5.6    3.47s
 10   -73.78989345164       -8.59       -4.85    5.6    3.42s
 11   -73.78989345168      -10.41       -5.35    5.1    3.30s
 12   -73.78989345169      -10.86       -6.11    5.1    3.23s
 13   -73.78989345169      -12.38       -6.49    5.4    3.40s
 14   -73.78989345169   +  -13.55       -6.95    4.8    3.05s
 15   -73.78989345169      -13.55       -7.80    5.1    3.25s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0705055007280205e-8,1.6655090944965332e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.378989e+01     3.355093e-07
 * time: 4.1961669921875e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.378989e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.36e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

V: 90.753406 seconds (79.99 M allocations: 44.087 GiB, 9.26% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:27:42.467
└   θ = ComponentVector{Float64}(κ = 0.527426647381982, μ = 0.22257347442202488)
┌ Info: 2025-05-21T01:27:42.467
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.317731092863236)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458076317603                   -0.96    6.9    1.32s
  2   -8.460045024914       -2.71       -1.74    2.1    844ms
  3   -8.460108664069       -4.20       -2.83    3.6    864ms
  4   -8.460109437694       -6.11       -3.91    4.2   1000ms
  5   -8.460109443105       -8.27       -4.58    4.4    1.46s
  6   -8.460109443308       -9.69       -5.42    4.3    1.23s
  7   -8.460109443313      -11.25       -6.26    3.9    978ms
  8   -8.460109443314      -13.00       -7.74    3.7    1.06s
Iter     Function value   Gradient norm 
     0    -8.460109e+00     1.794574e-07
 * time: 3.695487976074219e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.460109e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.79e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Si: 16.764338 seconds (31.32 M allocations: 8.830 GiB, 10.82% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:27:59.233
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.565342045917928)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18788849595                   -1.18    9.6    8.02s
  2   -62.19165148780       -2.42       -1.24    4.0    5.56s
  3   -62.19545522437       -2.42       -2.10    5.9    5.29s
  4   -62.19547750224       -4.65       -2.92    4.2    4.72s
  5   -62.19547811022       -6.22       -3.67    4.1    4.72s
  6   -62.19547811665       -8.19       -4.54    5.1    4.63s
  7   -62.19547811682       -9.78       -5.17    4.5    4.86s
  8   -62.19547811683      -10.91       -6.77    3.9    4.57s
  9   -62.19547811683      -13.67       -7.84    5.3    5.33s
Iter     Function value   Gradient norm 
     0    -6.219548e+01     3.038717e-07
 * time: 4.38690185546875e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.219548e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.04e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

NaCl: 68.749308 seconds (120.33 M allocations: 39.984 GiB, 7.79% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:29:07.985
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.631735408781291)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317232096185                   -1.46    5.6    1.28s
  2   -2.317311295600       -4.10       -1.84    1.4    548ms
  3   -2.317328075905       -4.78       -3.57    3.2    769ms
  4   -2.317328283794       -6.68       -3.99    4.6    1.13s
  5   -2.317328284431       -9.20       -4.26    2.3    573ms
  6   -2.317328284641       -9.68       -4.97    2.7    623ms
  7   -2.317328284648      -11.16       -5.69    2.5    819ms
  8   -2.317328284649      -12.56       -6.42    2.7    596ms
  9   -2.317328284649      -14.10       -6.82    2.7    601ms
 10   -2.317328284649      -15.05       -7.32    2.0    536ms
Iter     Function value   Gradient norm 
     0    -2.317328e+00     4.046136e-08
 * time: 2.7894973754882812e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.317328e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 4.05e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Al: 25.788450 seconds (24.21 M allocations: 6.545 GiB, 6.61% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:29:33.776
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.630499235397173)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.0705055007280205e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77216284666                   -0.87    9.6    5.67s
  2   -73.78263209954       -1.98       -1.07    5.3    3.06s
  3   -73.78866441877       -2.22       -1.41    6.7    4.00s
  4   -73.78974655225       -2.97       -1.80    5.9    3.40s
  5   -73.78987865815       -3.88       -2.32    5.0    3.09s
  6   -73.78989282173       -4.85       -3.10    5.6    3.45s
  7   -73.78989283153       -8.01       -3.55    4.5    2.97s
  8   -73.78989286453       -7.48       -3.98    5.3    3.28s
  9   -73.78989286475       -9.65       -4.30    5.6    3.50s
 10   -73.78989286735       -8.59       -4.84    5.5    3.37s
 11   -73.78989286739      -10.36       -5.35    5.2    3.28s
 12   -73.78989286741      -10.85       -6.09    5.1    3.23s
 13   -73.78989286741      -12.38       -6.49    5.4    3.34s
 14   -73.78989286741   +    -Inf       -6.95    4.8    2.98s
 15   -73.78989286741   +  -13.55       -7.82    5.1    4.17s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0705055007280205e-8,1.6655090944965332e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.378989e+01     3.700511e-07
 * time: 3.886222839355469e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.378989e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.70e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

V: 91.014194 seconds (79.98 M allocations: 44.062 GiB, 9.23% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:31:04.797
└   θ = ComponentVector{Float64}(κ = 0.5274266096704527, μ = 0.22257344090186348)
┌ Info: 2025-05-21T01:31:04.797
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.317731092863236)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458067132377                   -0.96    6.9    1.77s
  2   -8.460047416906       -2.70       -1.74    2.0    848ms
  3   -8.460108827669       -4.21       -2.83    3.7    875ms
  4   -8.460109425079       -6.22       -3.93    4.1    995ms
  5   -8.460109430167       -8.29       -4.60    4.4    1.17s
  6   -8.460109430351       -9.74       -5.47    4.2    888ms
  7   -8.460109430356      -11.33       -6.26    3.9    970ms
  8   -8.460109430356      -12.97       -7.84    3.6    1.04s
Iter     Function value   Gradient norm 
     0    -8.460109e+00     1.798822e-07
 * time: 3.790855407714844e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.460109e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.80e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Si: 16.605981 seconds (31.31 M allocations: 8.813 GiB, 10.96% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:31:21.405
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.565342045917928)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18788777542                   -1.18    9.6    8.05s
  2   -62.19164168326       -2.43       -1.24    4.2    4.17s
  3   -62.19545518424       -2.42       -2.10    6.1    5.37s
  4   -62.19547745106       -4.65       -2.93    4.3    4.80s
  5   -62.19547803173       -6.24       -3.70    4.1    4.84s
  6   -62.19547803755       -8.23       -4.58    5.1    5.03s
  7   -62.19547803770       -9.83       -5.15    4.5    4.96s
  8   -62.19547803771      -10.83       -6.97    3.9    4.56s
  9   -62.19547803771      -13.85       -7.91    5.8    5.69s
Iter     Function value   Gradient norm 
     0    -6.219548e+01     3.068957e-07
 * time: 4.315376281738281e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.219548e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.07e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

NaCl: 68.609945 seconds (120.38 M allocations: 40.151 GiB, 8.15% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:32:30.018
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.631735408781291)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317228060311                   -1.46    5.5    1.28s
  2   -2.317310551399       -4.08       -1.84    1.4    471ms
  3   -2.317328107386       -4.76       -3.56    3.3    780ms
  4   -2.317328281919       -6.76       -4.00    4.5    1.11s
  5   -2.317328282538       -9.21       -4.26    2.4    592ms
  6   -2.317328282748       -9.68       -4.97    2.6    634ms
  7   -2.317328282754      -11.21       -5.68    2.6    838ms
  8   -2.317328282754      -12.65       -6.16    2.6    597ms
  9   -2.317328282754      -13.95       -6.95    1.9    574ms
 10   -2.317328282754   +  -15.35       -7.47    2.7    646ms
Iter     Function value   Gradient norm 
     0    -2.317328e+00     3.753078e-08
 * time: 3.600120544433594e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.317328e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.75e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Al: 25.864135 seconds (24.22 M allocations: 6.547 GiB, 6.76% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:32:55.885
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.630499235397173)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.0705055007280205e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77217288456                   -0.87    9.7    5.74s
  2   -73.78263299611       -1.98       -1.07    5.2    3.11s
  3   -73.78866359159       -2.22       -1.41    6.7    4.02s
  4   -73.78974599665       -2.97       -1.80    5.8    3.33s
  5   -73.78987843861       -3.88       -2.31    5.0    3.08s
  6   -73.78989276182       -4.84       -3.10    5.6    3.41s
  7   -73.78989277401       -7.91       -3.55    4.4    2.91s
  8   -73.78989280622       -7.49       -3.98    5.3    3.41s
  9   -73.78989280639       -9.77       -4.31    5.6    3.54s
 10   -73.78989280892       -8.60       -4.85    5.5    3.24s
 11   -73.78989280896      -10.36       -5.35    5.2    3.21s
 12   -73.78989280898      -10.87       -6.09    5.0    3.17s
 13   -73.78989280898      -12.40       -6.49    5.4    3.31s
 14   -73.78989280898   +  -13.55       -6.94    4.8    3.06s
 15   -73.78989280898      -13.07       -7.82    5.1    3.24s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0705055007280205e-8,1.6655090944965332e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.378989e+01     3.735584e-07
 * time: 4.100799560546875e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.378989e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.74e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

V: 90.067686 seconds (79.96 M allocations: 44.026 GiB, 9.28% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:34:25.959
└   θ = ComponentVector{Float64}(κ = 0.5274266058992999, μ = 0.22257343754984735)
┌ Info: 2025-05-21T01:34:25.959
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.317731092863236)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458063712677                   -0.96    7.1    1.34s
  2   -8.460045720244       -2.70       -1.74    2.0    850ms
  3   -8.460108720373       -4.20       -2.82    3.7    876ms
  4   -8.460109424373       -6.15       -3.91    4.2    1.01s
  5   -8.460109428884       -8.35       -4.61    4.3    1.16s
  6   -8.460109429056       -9.76       -5.52    4.3    1.24s
  7   -8.460109429060      -11.44       -6.28    4.0    990ms
  8   -8.460109429060      -13.02       -7.78    3.7    1.05s
Iter     Function value   Gradient norm 
     0    -8.460109e+00     1.813323e-07
 * time: 3.910064697265625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.460109e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.81e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Si: 16.593101 seconds (31.34 M allocations: 8.856 GiB, 10.60% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:34:42.554
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.565342045917928)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18789047785                   -1.18    9.6    7.93s
  2   -62.19165027257       -2.42       -1.24    4.0    4.34s
  3   -62.19545513527       -2.42       -2.10    6.0    6.07s
  4   -62.19547742731       -4.65       -2.92    4.3    6.91s
  5   -62.19547802353       -6.22       -3.68    4.0    6.69s
  6   -62.19547802963       -8.21       -4.56    5.1    4.95s
  7   -62.19547802979       -9.81       -5.21    4.5    6.53s
  8   -62.19547802980      -10.97       -6.82    4.0    6.27s
  9   -62.19547802980      -13.30       -7.86    5.5    6.31s
Iter     Function value   Gradient norm 
     0    -6.219548e+01     3.064027e-07
 * time: 4.00543212890625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.219548e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.06e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

NaCl: 76.709501 seconds (120.36 M allocations: 40.094 GiB, 6.77% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:35:59.267
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.631735408781291)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317230678346                   -1.46    5.5    1.18s
  2   -2.317311085806       -4.09       -1.84    1.4    515ms
  3   -2.317328077057       -4.77       -3.58    3.3    724ms
  4   -2.317328281777       -6.69       -4.01    4.6    1.08s
  5   -2.317328282360       -9.23       -4.27    2.3    652ms
  6   -2.317328282559       -9.70       -4.98    2.7    615ms
  7   -2.317328282565      -11.24       -5.71    2.6    817ms
  8   -2.317328282565      -12.64       -6.43    2.6    731ms
  9   -2.317328282565      -14.27       -6.85    2.6    739ms
 10   -2.317328282565      -14.88       -7.33    2.0    669ms
Iter     Function value   Gradient norm 
     0    -2.317328e+00     3.945167e-08
 * time: 3.0994415283203125e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.317328e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.95e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Al: 25.914610 seconds (24.23 M allocations: 6.550 GiB, 5.13% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:36:25.184
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.630499235397173)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.0705055007280205e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77217697825                   -0.87    9.6    5.73s
  2   -73.78263034311       -1.98       -1.07    5.3    3.01s
  3   -73.78866346983       -2.22       -1.41    6.7    3.84s
  4   -73.78974612415       -2.97       -1.80    5.9    3.38s
  5   -73.78987926726       -3.88       -2.33    5.0    3.09s
  6   -73.78989276256       -4.87       -3.10    5.6    3.36s
  7   -73.78989276834       -8.24       -3.56    4.7    2.95s
  8   -73.78989280024       -7.50       -3.99    5.3    3.19s
  9   -73.78989280046       -9.65       -4.30    5.5    3.40s
 10   -73.78989280308       -8.58       -4.84    5.6    3.32s
 11   -73.78989280312      -10.36       -5.34    5.1    3.35s
 12   -73.78989280313      -10.84       -6.09    5.1    3.19s
 13   -73.78989280314      -12.29       -6.53    5.4    3.45s
 14   -73.78989280314   +  -13.85       -6.94    4.8    2.91s
 15   -73.78989280314   +  -13.55       -7.84    5.2    3.12s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0705055007280205e-8,1.6655090944965332e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.378989e+01     3.757234e-07
 * time: 3.695487976074219e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.378989e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.76e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

V: 89.377682 seconds (80.00 M allocations: 44.086 GiB, 8.54% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:37:54.568
└   θ = ComponentVector{Float64}(κ = 0.5274266055221846, μ = 0.22257343721464573)
┌ Info: 2025-05-21T01:37:54.568
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.317731092863236)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458063575637                   -0.96    7.0    1.36s
  2   -8.460044890774       -2.70       -1.74    2.1    846ms
  3   -8.460108625919       -4.20       -2.82    3.7    862ms
  4   -8.460109424439       -6.10       -3.90    4.1    1.01s
  5   -8.460109428743       -8.37       -4.59    4.5    1.52s
  6   -8.460109428925       -9.74       -5.44    4.4    1.24s
  7   -8.460109428930      -11.31       -6.23    3.9    1.29s
  8   -8.460109428930      -12.94       -7.65    3.7    1.28s
Iter     Function value   Gradient norm 
     0    -8.460109e+00     1.821714e-07
 * time: 3.600120544433594e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.460109e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.82e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Si: 17.405537 seconds (31.33 M allocations: 8.828 GiB, 10.40% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:38:11.976
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.565342045917928)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18788836357                   -1.18    9.6    12.5s
  2   -62.19164896568       -2.42       -1.24    4.0    3.99s
  3   -62.19545519041       -2.42       -2.10    6.1    7.11s
  4   -62.19547743230       -4.65       -2.92    4.2    4.71s
  5   -62.19547802293       -6.23       -3.69    4.1    4.68s
  6   -62.19547802885       -8.23       -4.58    5.0    4.92s
  7   -62.19547802900       -9.83       -5.17    4.5    5.01s
  8   -62.19547802901      -10.90       -7.03    3.8    4.41s
Iter     Function value   Gradient norm 
     0    -6.219548e+01     3.536324e-07
 * time: 4.38690185546875e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.219548e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.54e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

NaCl: 68.150698 seconds (112.82 M allocations: 36.574 GiB, 6.98% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:39:20.130
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.631735408781291)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317229114020                   -1.46    5.5    1.67s
  2   -2.317310902449       -4.09       -1.84    1.4    680ms
  3   -2.317328077869       -4.77       -3.58    3.2    1.10s
  4   -2.317328281772       -6.69       -4.01    4.6    1.56s
  5   -2.317328282347       -9.24       -4.27    2.4    697ms
  6   -2.317328282541       -9.71       -4.99    2.7    777ms
  7   -2.317328282546      -11.29       -5.74    2.6    984ms
  8   -2.317328282546      -12.63       -6.50    2.6    711ms
  9   -2.317328282546      -14.10       -6.86    2.8    775ms
 10   -2.317328282546      -15.35       -7.36    2.1    533ms
Iter     Function value   Gradient norm 
     0    -2.317328e+00     3.748426e-08
 * time: 3.600120544433594e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.317328e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.75e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Al: 27.702291 seconds (24.24 M allocations: 6.564 GiB, 6.34% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:39:47.835
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.630499235397173)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.0705055007280205e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77217618720                   -0.87    9.7    5.65s
  2   -73.78261846839       -1.98       -1.07    5.3    3.12s
  3   -73.78866543490       -2.22       -1.41    6.7    3.96s
  4   -73.78974632959       -2.97       -1.80    5.8    3.34s
  5   -73.78987891174       -3.88       -2.32    5.0    3.04s
  6   -73.78989276254       -4.86       -3.10    5.5    3.36s
  7   -73.78989276887       -8.20       -3.55    4.6    2.89s
  8   -73.78989279956       -7.51       -3.98    5.2    3.06s
  9   -73.78989279993       -9.44       -4.30    5.6    3.29s
 10   -73.78989280248       -8.59       -4.82    5.5    3.36s
 11   -73.78989280254      -10.29       -5.33    5.1    3.26s
 12   -73.78989280255      -10.82       -6.08    5.1    3.14s
 13   -73.78989280255      -12.38       -6.57    5.4    3.22s
 14   -73.78989280255      -13.15       -6.92    4.8    3.37s
 15   -73.78989280255   +  -13.37       -7.83    5.2    3.25s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0705055007280205e-8,1.6655090944965332e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.378989e+01     3.763563e-07
 * time: 3.695487976074219e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.378989e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.76e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

V: 89.528229 seconds (79.99 M allocations: 44.080 GiB, 8.32% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:41:17.370
└   θ = ComponentVector{Float64}(κ = 0.5274266054844731, μ = 0.22257343718112557)
┌ Info: 2025-05-21T01:41:17.370
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.317731092863236)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458064660584                   -0.96    6.9    1.30s
  2   -8.460046242378       -2.70       -1.74    2.2    846ms
  3   -8.460108659439       -4.20       -2.82    3.6    867ms
  4   -8.460109424106       -6.12       -3.91    4.1    986ms
  5   -8.460109428752       -8.33       -4.61    4.5    1.17s
  6   -8.460109428913       -9.79       -5.49    4.3    870ms
  7   -8.460109428917      -11.41       -6.29    4.0    946ms
  8   -8.460109428917      -13.07       -7.72    3.8    1.01s
Iter     Function value   Gradient norm 
     0    -8.460109e+00     1.815934e-07
 * time: 3.790855407714844e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.460109e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.82e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Si: 15.883420 seconds (31.35 M allocations: 8.854 GiB, 10.28% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:41:33.256
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.565342045917928)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18788859067                   -1.18    9.6    7.89s
  2   -62.19165686699       -2.42       -1.24    4.1    3.91s
  3   -62.19545487399       -2.42       -2.10    5.8    5.02s
  4   -62.19547740725       -4.65       -2.91    4.3    4.65s
  5   -62.19547802186       -6.21       -3.66    4.1    4.75s
  6   -62.19547802874       -8.16       -4.51    5.1    6.57s
  7   -62.19547802892       -9.75       -5.16    4.3    5.18s
  8   -62.19547802893      -10.96       -6.96    4.1    4.65s
  9   -62.19547802893   +  -13.55       -7.86    5.8    8.14s
Iter     Function value   Gradient norm 
     0    -6.219548e+01     3.055224e-07
 * time: 4.38690185546875e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.219548e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.06e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

NaCl: 71.764326 seconds (120.37 M allocations: 40.263 GiB, 7.35% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:42:45.023
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.631735408781291)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317231694449                   -1.46    5.6    1.27s
  2   -2.317310599404       -4.10       -1.84    1.3    461ms
  3   -2.317328078832       -4.76       -3.57    3.2    752ms
  4   -2.317328281697       -6.69       -3.99    4.5    1.13s
  5   -2.317328282330       -9.20       -4.25    2.4    599ms
  6   -2.317328282538       -9.68       -4.97    2.7    620ms
  7   -2.317328282544      -11.23       -5.71    2.6    847ms
  8   -2.317328282544      -12.68       -6.49    2.7    612ms
  9   -2.317328282544      -14.07       -6.84    2.7    620ms
 10   -2.317328282544      -15.35       -7.30    1.8    487ms
Iter     Function value   Gradient norm 
     0    -2.317328e+00     3.936227e-08
 * time: 3.314018249511719e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.317328e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.94e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Al: 25.622997 seconds (24.20 M allocations: 6.535 GiB, 6.65% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:43:10.648
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.630499235397173)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.0705055007280205e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77216478476                   -0.87    9.6    5.73s
  2   -73.78263804376       -1.98       -1.07    5.3    3.13s
  3   -73.78866449055       -2.22       -1.41    6.7    3.96s
  4   -73.78974591447       -2.97       -1.80    5.8    3.30s
  5   -73.78987870405       -3.88       -2.32    5.0    3.04s
  6   -73.78989275807       -4.85       -3.10    5.5    3.28s
  7   -73.78989276535       -8.14       -3.55    4.6    2.85s
  8   -73.78989279946       -7.47       -3.98    5.3    3.31s
  9   -73.78989279981       -9.45       -4.30    5.6    3.62s
 10   -73.78989280244       -8.58       -4.85    5.5    3.32s
 11   -73.78989280248      -10.38       -5.34    5.1    3.25s
 12   -73.78989280249      -10.83       -6.08    5.1    3.19s
 13   -73.78989280249      -12.34       -6.52    5.4    3.33s
 14   -73.78989280249      -13.55       -6.93    4.8    3.01s
 15   -73.78989280249      -13.55       -7.79    5.2    3.53s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0705055007280205e-8,1.6655090944965332e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.378989e+01     3.724818e-07
 * time: 3.790855407714844e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.378989e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.72e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

V: 89.961797 seconds (80.00 M allocations: 44.116 GiB, 8.99% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:44:40.617
└   θ = ComponentVector{Float64}(κ = 0.5274266054807019, μ = 0.22257343717777356)
┌ Info: 2025-05-21T01:44:40.617
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.317731092863236)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458068086147                   -0.96    7.1    1.33s
  2   -8.460046769073       -2.70       -1.74    2.0    903ms
  3   -8.460108648194       -4.21       -2.83    3.6    1.08s
  4   -8.460109424378       -6.11       -3.92    4.2    1.01s
  5   -8.460109428737       -8.36       -4.61    4.3    1.16s
  6   -8.460109428911       -9.76       -5.46    4.4    900ms
  7   -8.460109428916      -11.31       -6.25    4.0    995ms
  8   -8.460109428916      -12.94       -7.82    3.8    1.05s
Iter     Function value   Gradient norm 
     0    -8.460109e+00     1.808880e-07
 * time: 3.695487976074219e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.460109e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.81e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Si: 16.466901 seconds (31.35 M allocations: 8.860 GiB, 10.81% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:44:57.087
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.565342045917928)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18788783423                   -1.18    9.6    8.35s
  2   -62.19164783349       -2.42       -1.24    4.0    4.01s
  3   -62.19545520722       -2.42       -2.10    6.0    5.35s
  4   -62.19547743527       -4.65       -2.92    4.2    4.80s
  5   -62.19547802269       -6.23       -3.69    4.2    4.90s
  6   -62.19547802875       -8.22       -4.56    5.3    6.79s
  7   -62.19547802891       -9.80       -5.15    4.5    6.47s
  8   -62.19547802892      -10.85       -6.88    3.9    6.32s
  9   -62.19547802892      -13.07       -7.88    5.5    5.51s
Iter     Function value   Gradient norm 
     0    -6.219548e+01     3.059324e-07
 * time: 4.291534423828125e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.219548e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.06e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

NaCl: 73.500541 seconds (120.37 M allocations: 40.197 GiB, 7.35% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:46:10.590
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.631735408781291)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317234515677                   -1.46    5.5    1.27s
  2   -2.317310892598       -4.12       -1.84    1.4    479ms
  3   -2.317328039181       -4.77       -3.56    3.2    776ms
  4   -2.317328281688       -6.62       -3.99    4.7    1.13s
  5   -2.317328282328       -9.19       -4.26    2.4    632ms
  6   -2.317328282537       -9.68       -4.96    2.6    635ms
  7   -2.317328282543      -11.21       -5.70    2.6    837ms
  8   -2.317328282544      -12.59       -6.53    2.7    725ms
  9   -2.317328282544      -14.07       -6.96    3.1    784ms
 10   -2.317328282544      -15.35       -7.40    2.3    602ms
Iter     Function value   Gradient norm 
     0    -2.317328e+00     3.707823e-08
 * time: 3.0040740966796875e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.317328e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.71e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Al: 26.171167 seconds (24.32 M allocations: 6.617 GiB, 6.85% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:46:36.764
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.630499235397173)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.0705055007280205e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77217348641                   -0.87    9.7    5.89s
  2   -73.78262604229       -1.98       -1.07    5.3    3.07s
  3   -73.78866470711       -2.22       -1.41    6.7    3.89s
  4   -73.78974626032       -2.97       -1.80    5.9    3.79s
  5   -73.78987856332       -3.88       -2.32    5.1    4.19s
  6   -73.78989275742       -4.85       -3.10    5.6    3.44s
  7   -73.78989276819       -7.97       -3.55    4.5    2.93s
  8   -73.78989279969       -7.50       -3.98    5.3    3.24s
  9   -73.78989279987       -9.74       -4.30    5.6    3.46s
 10   -73.78989280243       -8.59       -4.84    5.5    3.40s
 11   -73.78989280247      -10.33       -5.35    5.2    3.29s
 12   -73.78989280249      -10.85       -6.09    5.1    3.26s
 13   -73.78989280249      -12.40       -6.50    5.3    3.34s
 14   -73.78989280249      -13.15       -6.94    4.8    3.08s
 15   -73.78989280249   +  -13.85       -7.82    5.1    3.13s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0705055007280205e-8,1.6655090944965332e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.378989e+01     3.746787e-07
 * time: 3.910064697265625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.378989e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.75e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

V: 91.479325 seconds (80.01 M allocations: 44.106 GiB, 8.79% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:48:08.251
└   θ = ComponentVector{Float64}(κ = 0.5274266054803247, μ = 0.22257343717743835)
┌ Info: 2025-05-21T01:48:08.251
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.317731092863236)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458064120436                   -0.96    6.8    1.22s
  2   -8.460047018369       -2.70       -1.74    2.2    809ms
  3   -8.460108608034       -4.21       -2.82    3.6    1.12s
  4   -8.460109424362       -6.09       -3.91    4.1    941ms
  5   -8.460109428741       -8.36       -4.60    4.3    1.11s
  6   -8.460109428912       -9.77       -5.49    4.3    863ms
  7   -8.460109428916      -11.38       -6.25    3.9    910ms
  8   -8.460109428916      -12.98       -7.72    3.7    1.06s
Iter     Function value   Gradient norm 
     0    -8.460109e+00     1.817833e-07
 * time: 3.790855407714844e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.460109e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.82e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Si: 16.005026 seconds (31.31 M allocations: 8.810 GiB, 8.73% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:48:24.258
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.565342045917928)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18788888499                   -1.18    9.7    8.11s
  2   -62.19165089940       -2.42       -1.24    4.1    4.09s
  3   -62.19545504248       -2.42       -2.10    5.8    5.23s
  4   -62.19547742561       -4.65       -2.92    4.4    6.46s
  5   -62.19547802261       -6.22       -3.68    4.2    4.68s
  6   -62.19547802876       -8.21       -4.56    5.2    4.98s
  7   -62.19547802891       -9.82       -5.26    4.5    4.80s
  8   -62.19547802892      -11.10       -6.83    4.1    4.53s
  9   -62.19547802892      -13.30       -7.86    5.3    5.30s
Iter     Function value   Gradient norm 
     0    -6.219548e+01     3.079198e-07
 * time: 4.100799560546875e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.219548e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.08e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

NaCl: 69.319336 seconds (120.37 M allocations: 40.167 GiB, 7.60% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:49:33.581
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.631735408781291)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317232067181                   -1.46    5.5    1.27s
  2   -2.317310621588       -4.10       -1.84    1.4    477ms
  3   -2.317328076186       -4.76       -3.57    3.2    766ms
  4   -2.317328281733       -6.69       -4.00    4.7    1.14s
  5   -2.317328282339       -9.22       -4.26    2.3    560ms
  6   -2.317328282537       -9.70       -4.98    2.7    644ms
  7   -2.317328282543      -11.18       -5.72    2.5    825ms
  8   -2.317328282544      -12.64       -6.51    2.5    578ms
  9   -2.317328282544      -14.21       -6.95    3.0    668ms
 10   -2.317328282544      -14.88       -7.42    2.1    550ms
Iter     Function value   Gradient norm 
     0    -2.317328e+00     3.721354e-08
 * time: 2.6941299438476562e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.317328e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.72e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Al: 25.744181 seconds (24.26 M allocations: 6.579 GiB, 6.64% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:49:59.328
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.630499235397173)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.0705055007280205e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77217653478                   -0.87    9.7    5.78s
  2   -73.78262239209       -1.98       -1.07    5.3    3.07s
  3   -73.78866484084       -2.22       -1.41    6.7    3.79s
  4   -73.78974614466       -2.97       -1.80    5.9    3.11s
  5   -73.78987894575       -3.88       -2.32    5.0    2.85s
  6   -73.78989275929       -4.86       -3.10    5.5    3.17s
  7   -73.78989276833       -8.04       -3.55    4.4    2.71s
  8   -73.78989279958       -7.51       -3.98    5.2    3.00s
  9   -73.78989279982       -9.62       -4.30    5.6    3.41s
 10   -73.78989280242       -8.58       -4.82    5.5    4.58s
 11   -73.78989280247      -10.31       -5.33    5.2    3.31s
 12   -73.78989280249      -10.84       -6.10    5.1    3.72s
 13   -73.78989280249      -12.37       -6.49    5.3    3.24s
 14   -73.78989280249   +  -13.85       -6.92    4.9    2.93s
 15   -73.78989280249      -13.00       -7.83    5.2    3.20s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0705055007280205e-8,1.6655090944965332e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.378989e+01     3.744448e-07
 * time: 3.600120544433594e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.378989e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.74e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

V: 90.101368 seconds (79.97 M allocations: 44.036 GiB, 7.87% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:51:29.436
└   θ = ComponentVector{Float64}(κ = 0.5274266054802871, μ = 0.22257343717740483)
┌ Info: 2025-05-21T01:51:29.436
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.317731092863236)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458074586145                   -0.96    6.9    1.82s
  2   -8.460047415796       -2.70       -1.74    2.1    1.08s
  3   -8.460108657551       -4.21       -2.83    3.7    1.20s
  4   -8.460109424212       -6.12       -3.90    4.1    1.35s
  5   -8.460109428745       -8.34       -4.61    4.2    1.10s
  6   -8.460109428912       -9.78       -5.49    4.4    1.01s
  7   -8.460109428916      -11.40       -6.26    3.9    1.32s
  8   -8.460109428916      -13.04       -7.72    3.7    1.06s
Iter     Function value   Gradient norm 
     0    -8.460109e+00     1.816791e-07
 * time: 3.814697265625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.460109e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.82e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Si: 17.904472 seconds (31.33 M allocations: 8.836 GiB, 9.56% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:51:47.344
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.565342045917928)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18788438749                   -1.18    9.6    8.02s
  2   -62.19164838626       -2.42       -1.24    4.0    3.95s
  3   -62.19545504629       -2.42       -2.10    5.8    5.20s
  4   -62.19547741463       -4.65       -2.92    4.3    5.70s
  5   -62.19547802245       -6.22       -3.68    4.2    4.69s
  6   -62.19547802875       -8.20       -4.55    5.4    4.94s
  7   -62.19547802891       -9.81       -5.15    4.5    4.83s
  8   -62.19547802892      -10.87       -6.99    3.9    4.43s
  9   -62.19547802892   +  -14.15       -7.90    6.0    5.59s
Iter     Function value   Gradient norm 
     0    -6.219548e+01     3.061315e-07
 * time: 4.291534423828125e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.219548e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.06e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

NaCl: 68.352409 seconds (120.39 M allocations: 40.263 GiB, 7.00% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:52:55.699
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.631735408781291)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317232883054                   -1.46    5.5    1.30s
  2   -2.317310255551       -4.11       -1.84    1.3    488ms
  3   -2.317328022982       -4.75       -3.56    3.3    720ms
  4   -2.317328281655       -6.59       -3.98    4.6    1.31s
  5   -2.317328282321       -9.18       -4.25    2.3    667ms
  6   -2.317328282537       -9.66       -4.95    2.7    645ms
  7   -2.317328282543      -11.22       -5.70    2.6    821ms
  8   -2.317328282544      -12.66       -6.53    2.6    557ms
  9   -2.317328282544      -14.12       -6.97    3.1    640ms
 10   -2.317328282544      -14.88       -7.38    2.4    562ms
Iter     Function value   Gradient norm 
     0    -2.317328e+00     3.705052e-08
 * time: 3.504753112792969e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.317328e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.71e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Al: 25.898959 seconds (24.31 M allocations: 6.612 GiB, 5.50% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:53:21.601
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.630499235397173)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.0705055007280205e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77217044679                   -0.87    9.7    5.60s
  2   -73.78263779052       -1.98       -1.07    5.3    3.02s
  3   -73.78866207543       -2.22       -1.41    6.7    3.84s
  4   -73.78974691331       -2.96       -1.80    5.9    3.26s
  5   -73.78987857134       -3.88       -2.32    5.0    2.99s
  6   -73.78989275379       -4.85       -3.10    5.5    3.27s
  7   -73.78989276748       -7.86       -3.55    4.3    2.76s
  8   -73.78989279995       -7.49       -3.99    5.2    3.12s
  9   -73.78989279988   +  -10.18       -4.30    5.5    3.28s
 10   -73.78989280244       -8.59       -4.86    5.6    3.30s
 11   -73.78989280247      -10.44       -5.36    5.2    3.50s
 12   -73.78989280249      -10.88       -6.12    5.0    4.08s
 13   -73.78989280249      -12.38       -6.49    5.4    4.76s
 14   -73.78989280249   +  -13.55       -6.95    4.9    4.30s
 15   -73.78989280249      -13.55       -7.81    5.1    3.52s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0705055007280205e-8,1.6655090944965332e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.378989e+01     3.740559e-07
 * time: 3.504753112792969e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.378989e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.74e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

V: 92.857151 seconds (79.95 M allocations: 44.009 GiB, 7.64% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:54:54.465
└   θ = ComponentVector{Float64}(κ = 0.5274266054802833, μ = 0.22257343717740147)
┌ Info: 2025-05-21T01:54:54.466
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.317731092863236)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458075909095                   -0.96    7.0    1.81s
  2   -8.460047530332       -2.71       -1.74    2.0    786ms
  3   -8.460108701351       -4.21       -2.82    3.7    865ms
  4   -8.460109423990       -6.14       -3.91    4.2    953ms
  5   -8.460109428739       -8.32       -4.61    4.4    1.36s
  6   -8.460109428912       -9.76       -5.48    4.3    876ms
  7   -8.460109428916      -11.37       -6.26    4.0    1.10s
  8   -8.460109428916      -13.00       -7.77    3.7    1.01s
Iter     Function value   Gradient norm 
     0    -8.460109e+00     1.811501e-07
 * time: 3.790855407714844e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.460109e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.81e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Si: 16.695773 seconds (31.34 M allocations: 8.859 GiB, 8.90% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:55:11.164
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.565342045917928)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18789064187                   -1.18    9.6    10.4s
  2   -62.19164743114       -2.43       -1.24    4.0    4.04s
  3   -62.19545526411       -2.42       -2.10    5.8    5.23s
  4   -62.19547742005       -4.65       -2.92    4.4    4.76s
  5   -62.19547802275       -6.22       -3.69    4.2    6.16s
  6   -62.19547802876       -8.22       -4.58    5.3    5.07s
  7   -62.19547802891       -9.82       -5.16    4.7    5.01s
  8   -62.19547802892      -10.86       -6.98    4.0    5.75s
  9   -62.19547802892   +  -13.45       -7.90    5.8    8.21s
Iter     Function value   Gradient norm 
     0    -6.219548e+01     3.066454e-07
 * time: 4.291534423828125e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.219548e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.07e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

NaCl: 75.747381 seconds (120.40 M allocations: 40.355 GiB, 7.07% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:56:26.915
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.631735408781291)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317228494992                   -1.46    5.6    1.27s
  2   -2.317310469296       -4.09       -1.84    1.4    450ms
  3   -2.317328071264       -4.75       -3.57    3.3    752ms
  4   -2.317328281739       -6.68       -4.00    4.6    1.38s
  5   -2.317328282336       -9.22       -4.27    2.3    679ms
  6   -2.317328282538       -9.69       -4.98    2.8    644ms
  7   -2.317328282544      -11.26       -5.71    2.6    833ms
  8   -2.317328282544      -12.70       -6.49    2.4    697ms
  9   -2.317328282544      -14.07       -6.92    3.1    741ms
 10   -2.317328282544   +    -Inf       -7.37    2.1    715ms
Iter     Function value   Gradient norm 
     0    -2.317328e+00     3.726326e-08
 * time: 3.0994415283203125e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.317328e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.73e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Al: 26.457848 seconds (24.27 M allocations: 6.585 GiB, 6.47% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:56:53.375
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.630499235397173)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.0705055007280205e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77217188556                   -0.87    9.6    6.24s
  2   -73.78263082888       -1.98       -1.07    5.3    2.91s
  3   -73.78866374459       -2.22       -1.41    6.7    3.87s
  4   -73.78974673999       -2.97       -1.80    5.8    3.30s
  5   -73.78987863302       -3.88       -2.32    5.0    3.42s
  6   -73.78989275943       -4.85       -3.10    5.5    4.24s
  7   -73.78989276601       -8.18       -3.55    4.7    4.13s
  8   -73.78989279943       -7.48       -3.98    5.3    4.54s
  9   -73.78989279984       -9.38       -4.30    5.6    4.55s
 10   -73.78989280243       -8.59       -4.85    5.5    3.24s
 11   -73.78989280247      -10.40       -5.34    5.1    3.18s
 12   -73.78989280249      -10.83       -6.09    5.1    3.11s
 13   -73.78989280249      -12.37       -6.54    5.3    3.25s
 14   -73.78989280249      -12.94       -6.95    4.8    2.95s
 15   -73.78989280249   +  -13.07       -7.84    5.1    3.14s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0705055007280205e-8,1.6655090944965332e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.378989e+01     3.756464e-07
 * time: 3.600120544433594e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.378989e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.76e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

V: 94.346424 seconds (79.98 M allocations: 44.094 GiB, 7.70% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:58:27.729
└   θ = ComponentVector{Float64}(κ = 0.5274266054802829, μ = 0.22257343717740113)
┌ Info: 2025-05-21T01:58:27.729
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.317731092863236)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458073650019                   -0.96    7.1    1.35s
  2   -8.460046405014       -2.70       -1.74    2.0    913ms
  3   -8.460108635940       -4.21       -2.83    3.6    874ms
  4   -8.460109424315       -6.10       -3.89    4.1    1.02s
  5   -8.460109428769       -8.35       -4.64    4.4    1.18s
  6   -8.460109428912       -9.84       -5.50    4.5    921ms
  7   -8.460109428916      -11.45       -6.31    3.9    978ms
  8   -8.460109428916      -13.09       -7.63    3.7    1.07s
Iter     Function value   Gradient norm 
     0    -8.460109e+00     1.813255e-07
 * time: 3.695487976074219e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.460109e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.81e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Si: 16.294575 seconds (31.34 M allocations: 8.848 GiB, 11.20% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:58:44.027
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.565342045917928)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18788820700                   -1.18    9.5    8.00s
  2   -62.19164179600       -2.43       -1.24    4.2    4.10s
  3   -62.19545513732       -2.42       -2.10    5.9    5.17s
  4   -62.19547742999       -4.65       -2.92    4.3    4.76s
  5   -62.19547802265       -6.23       -3.69    4.0    4.68s
  6   -62.19547802875       -8.21       -4.56    5.3    5.13s
  7   -62.19547802891       -9.81       -5.13    4.5    4.96s
  8   -62.19547802892      -10.82       -6.95    4.0    4.64s
  9   -62.19547802892      -13.85       -7.88    5.7    5.63s
Iter     Function value   Gradient norm 
     0    -6.219548e+01     3.048906e-07
 * time: 4.100799560546875e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.219548e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.05e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

NaCl: 68.211442 seconds (120.38 M allocations: 40.231 GiB, 7.93% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T01:59:52.241
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.631735408781291)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317232917922                   -1.46    5.6    1.30s
  2   -2.317311027740       -4.11       -1.84    1.4    508ms
  3   -2.317328015114       -4.77       -3.57    3.3    783ms
  4   -2.317328281687       -6.57       -3.99    4.6    1.34s
  5   -2.317328282319       -9.20       -4.25    2.2    619ms
  6   -2.317328282537       -9.66       -4.95    2.7    645ms
  7   -2.317328282543      -11.22       -5.70    2.4    851ms
  8   -2.317328282544      -12.62       -6.39    2.7    589ms
  9   -2.317328282544      -14.24       -6.87    2.5    577ms
 10   -2.317328282544      -14.75       -7.31    2.0    529ms
Iter     Function value   Gradient norm 
     0    -2.317328e+00     3.642803e-08
 * time: 2.6941299438476562e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.317328e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.64e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Al: 26.040070 seconds (24.20 M allocations: 6.531 GiB, 6.81% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T02:00:18.284
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.630499235397173)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.0705055007280205e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77217145676                   -0.87    9.6    5.71s
  2   -73.78263722800       -1.98       -1.07    5.3    3.14s
  3   -73.78866301356       -2.22       -1.41    6.7    3.96s
  4   -73.78974628949       -2.97       -1.80    5.9    3.37s
  5   -73.78987869041       -3.88       -2.32    5.1    3.10s
  6   -73.78989275499       -4.85       -3.10    5.5    3.44s
  7   -73.78989276734       -7.91       -3.55    4.4    2.90s
  8   -73.78989279984       -7.49       -3.99    5.3    3.25s
  9   -73.78989279984      -11.34       -4.30    5.6    3.46s
 10   -73.78989280243       -8.59       -4.85    5.5    3.35s
 11   -73.78989280247      -10.37       -5.35    5.2    3.32s
 12   -73.78989280249      -10.86       -6.10    5.1    3.24s
 13   -73.78989280249      -12.34       -6.47    5.3    3.36s
 14   -73.78989280249   +  -13.07       -6.94    4.9    3.18s
 15   -73.78989280249      -13.55       -7.84    5.1    3.21s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0705055007280205e-8,1.6655090944965332e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.378989e+01     3.749695e-07
 * time: 4.1961669921875e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.378989e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.75e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

V: 90.252520 seconds (79.99 M allocations: 44.084 GiB, 9.25% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T02:01:48.545
└   θ = ComponentVector{Float64}(κ = 0.5274266054802829, μ = 0.2225734371774011)
┌ Info: 2025-05-21T02:01:48.545
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.317731092863236)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458072326188                   -0.96    6.9    1.33s
  2   -8.460046017897       -2.70       -1.74    2.0    823ms
  3   -8.460108653529       -4.20       -2.82    3.7    871ms
  4   -8.460109423840       -6.11       -3.91    4.2    995ms
  5   -8.460109428707       -8.31       -4.58    4.3    1.15s
  6   -8.460109428910       -9.69       -5.42    4.1    867ms
  7   -8.460109428916      -11.26       -6.25    3.9    957ms
  8   -8.460109428916      -12.99       -7.73    3.7    1.08s
Iter     Function value   Gradient norm 
     0    -8.460109e+00     1.812681e-07
 * time: 3.790855407714844e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.460109e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.81e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Si: 16.045803 seconds (31.31 M allocations: 8.808 GiB, 10.87% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T02:02:04.594
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.565342045917928)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18788877318                   -1.18    9.5    9.72s
  2   -62.19165029786       -2.42       -1.24    4.2    4.99s
  3   -62.19545508485       -2.42       -2.10    5.8    5.21s
  4   -62.19547743226       -4.65       -2.92    4.5    4.82s
  5   -62.19547802255       -6.23       -3.68    4.2    6.50s
  6   -62.19547802875       -8.21       -4.55    5.0    5.00s
  7   -62.19547802891       -9.80       -5.16    4.4    4.84s
  8   -62.19547802892      -10.91       -6.82    3.9    4.58s
  9   -62.19547802892   +    -Inf       -7.90    5.4    5.53s
Iter     Function value   Gradient norm 
     0    -6.219548e+01     3.058737e-07
 * time: 4.1961669921875e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.219548e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.06e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

NaCl: 72.249546 seconds (120.34 M allocations: 40.020 GiB, 7.52% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T02:03:16.846
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.631735408781291)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317231509149                   -1.46    5.6    1.22s
  2   -2.317310773495       -4.10       -1.84    1.4    428ms
  3   -2.317328078918       -4.76       -3.57    3.3    768ms
  4   -2.317328281752       -6.69       -4.00    4.6    1.11s
  5   -2.317328282340       -9.23       -4.26    2.4    567ms
  6   -2.317328282538       -9.70       -4.99    2.6    625ms
  7   -2.317328282544      -11.25       -5.73    2.6    830ms
  8   -2.317328282544      -12.71       -6.42    2.6    682ms
  9   -2.317328282544      -14.05       -6.85    2.8    750ms
 10   -2.317328282544   +    -Inf       -7.36    2.3    709ms
Iter     Function value   Gradient norm 
     0    -2.317328e+00     3.903596e-08
 * time: 2.5987625122070312e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.317328e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.90e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Al: 26.008452 seconds (24.27 M allocations: 6.584 GiB, 6.53% gc time, 0.00% compilation time)
┌ Info: 2025-05-21T02:03:42.858
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.630499235397173)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.0705055007280205e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77216334184                   -0.87    9.6    7.76s
  2   -73.78263611867       -1.98       -1.07    5.2    3.11s
  3   -73.78866309906       -2.22       -1.41    6.7    4.03s
  4   -73.78974644611       -2.97       -1.80    5.8    3.35s
  5   -73.78987877615       -3.88       -2.32    5.0    3.05s
  6   -73.78989275804       -4.85       -3.10    5.6    3.41s
  7   -73.78989276698       -8.05       -3.55    4.6    3.10s
  8   -73.78989279959       -7.49       -3.98    5.3    3.16s
  9   -73.78989279982       -9.65       -4.30    5.6    3.41s
 10   -73.78989280243       -8.58       -4.85    5.5    3.34s
 11   -73.78989280247      -10.40       -5.34    5.2    3.26s
 12   -73.78989280249      -10.84       -6.09    5.1    3.21s
 13   -73.78989280249      -12.38       -6.55    5.4    4.82s
 14   -73.78989280249      -13.07       -6.94    4.7    3.06s
 15   -73.78989280249   +  -13.37       -7.82    5.1    3.23s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0705055007280205e-8,1.6655090944965332e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.378989e+01     3.751286e-07
 * time: 3.910064697265625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.378989e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 3.75e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

V: 93.596272 seconds (79.97 M allocations: 44.076 GiB, 9.12% gc time, 0.00% compilation time)
 * Status: failure (line search failed)

 * Candidate solution
    Final objective value:     7.762111e-05

 * Found with
    Algorithm:     BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≤ 0.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = 1.21e-08 ≰ 0.0e+00
    |f(x) - f(x')|/|f(x')| = 1.55e-04 ≰ 0.0e+00
    |g(x)|                 = 1.25e-07 ≰ 1.0e-08

 * Work counters
    Seconds run:   47206  (vs limit Inf)
    Iterations:    15
    f(x) calls:    29
    ∇f(x) calls:   15

