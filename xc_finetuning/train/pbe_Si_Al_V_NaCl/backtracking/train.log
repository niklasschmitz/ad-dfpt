┌ Info: Threading setup: 
│   Threads.nthreads() = 4
│   n_DFTK = 4
│   n_fft = 1
└   n_blas = 4
┌ Info: 2025-05-20T13:19:50.065
└   θ = ComponentVector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}(κ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.804,1.0,0.0), μ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.21951497276451704,0.0,1.0))
┌ Info: 2025-05-20T13:19:50.676
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460673818454                   -0.96    6.9    9.05s
  2   -8.462432483795       -2.75       -1.73    1.9    3.75s
  3   -8.462496328539       -4.19       -2.82    3.7    928ms
  4   -8.462497436830       -5.96       -3.75    4.4    1.11s
  5   -8.462497456744       -7.70       -4.61    4.7    1.10s
  6   -8.462497457309       -9.25       -5.48    4.8    1.02s
  7   -8.462497457311      -11.59       -6.49    3.6    1.00s
  8   -8.462497457312      -13.29       -7.35    4.0    1.05s
Iter     Function value   Gradient norm 
     0    -8.462497e+00     8.212358e-04
 * time: 3.409385681152344e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460682776632                   -0.96    7.0    1.47s
  2   -8.462436116668       -2.76       -1.73    2.0    748ms
  3   -8.462497142376       -4.21       -2.82    3.8    934ms
  4   -8.462498088020       -6.02       -3.77    4.4    1.11s
  5   -8.462498107858       -7.70       -4.57    4.9    1.02s
  6   -8.462498108452       -9.23       -5.41    4.8    1.13s
  7   -8.462498108457      -11.33       -6.34    3.8    903ms
  8   -8.462498108457      -13.18       -7.37    3.8    1.01s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460680700539                   -0.96    7.1    1.44s
  2   -8.462436105002       -2.76       -1.73    2.0    755ms
  3   -8.462497073615       -4.21       -2.82    3.7    892ms
  4   -8.462498088368       -5.99       -3.76    4.4    1.10s
  5   -8.462498107923       -7.71       -4.60    4.9    1.01s
  6   -8.462498108453       -9.28       -5.46    4.9    1.22s
  7   -8.462498108457      -11.46       -6.39    3.6    881ms
  8   -8.462498108457      -13.17       -7.33    4.0    1.04s
     1    -8.462498e+00     7.645198e-04
 * time: 28.238911151885986
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460639407961                   -0.96    7.3    1.40s
  2   -8.462433961781       -2.75       -1.73    1.9    610ms
  3   -8.462501065994       -4.17       -2.82    3.8    947ms
  4   -8.462502304017       -5.91       -3.75    4.7    1.09s
  5   -8.462502322752       -7.73       -4.60    4.8    964ms
  6   -8.462502323278       -9.28       -5.47    5.0    1.06s
  7   -8.462502323281      -11.51       -6.37    3.8    865ms
  8   -8.462502323282      -13.15       -7.35    4.0    1.03s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460639418081                   -0.96    7.5    1.46s
  2   -8.462431941022       -2.75       -1.73    2.0    747ms
  3   -8.462501101974       -4.16       -2.82    3.8    889ms
  4   -8.462502304119       -5.92       -3.76    4.6    1.10s
  5   -8.462502322725       -7.73       -4.59    5.0    979ms
  6   -8.462502323278       -9.26       -5.46    5.0    1.12s
  7   -8.462502323281      -11.42       -6.37    3.9    919ms
  8   -8.462502323282      -13.16       -7.32    4.1    1.06s
     2    -8.462502e+00     4.403713e-06
 * time: 54.8652081489563
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460645622851                   -0.96    7.7    1.44s
  2   -8.462437551706       -2.75       -1.73    2.2    766ms
  3   -8.462501316491       -4.20       -2.82    3.9    879ms
  4   -8.462502305092       -6.00       -3.77    4.7    1.10s
  5   -8.462502322878       -7.75       -4.60    4.9    988ms
  6   -8.462502323417       -9.27       -5.48    4.9    1.08s
  7   -8.462502323420      -11.51       -6.45    3.8    869ms
  8   -8.462502323420      -13.27       -7.33    4.1    1.01s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460654564377                   -0.96    7.7    1.47s
  2   -8.462432844047       -2.75       -1.73    2.2    759ms
  3   -8.462501206022       -4.17       -2.82    3.8    881ms
  4   -8.462502303729       -5.96       -3.77    4.7    1.09s
  5   -8.462502322802       -7.72       -4.56    4.9    984ms
  6   -8.462502323415       -9.21       -5.39    5.1    1.11s
  7   -8.462502323420      -11.31       -6.28    3.9    887ms
  8   -8.462502323420      -12.95       -7.37    4.1    1.02s
     3    -8.462502e+00     2.482736e-08
 * time: 82.07273602485657
 * Status: success

 * Candidate solution
    Final objective value:     -8.462502e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 6.34e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 6.13e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.39e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.64e-11 ≰ 0.0e+00
    |g(x)|                 = 2.48e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   82  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460650644519                   -0.96    7.6    1.52s
  2   -8.462439600184       -2.75       -1.73    2.3    668ms
  3   -8.462501267553       -4.21       -2.81    3.9    1.08s
  4   -8.462502303845       -5.98       -3.78    4.7    1.01s
  5   -8.462502322843       -7.72       -4.58    5.0    1.16s
  6   -8.462502323416       -9.24       -5.47    4.9    989ms
  7   -8.462502323420      -11.39       -6.39    3.9    1.09s
  8   -8.462502323420      -13.22       -7.38    4.0    996ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.13e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.46e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.24e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 9.90e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 3.70e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.21e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 3.01e-09
└ * number of operations = 8
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460649744631                   -0.96    7.7    1.58s
  2   -8.462434162326       -2.75       -1.73    2.3    654ms
  3   -8.462501187708       -4.17       -2.82    3.8    1.05s
  4   -8.462502302815       -5.95       -3.76    4.7    1.00s
  5   -8.462502322853       -7.70       -4.59    4.8    1.03s
  6   -8.462502323416       -9.25       -5.43    5.1    1.16s
  7   -8.462502323420      -11.34       -6.33    4.0    910ms
  8   -8.462502323420      -13.08       -7.35    4.2    942ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 6.84e-02
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.07e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.30e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.05e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 8.30e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 1.88e-08
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 1.02e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 5.45e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.88e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.34e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 3.72e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.24e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 3.45e-09
└ * number of operations = 8
Si: 445.354990 seconds (795.32 M allocations: 274.345 GiB, 5.32% gc time, 44.59% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-20T13:27:16.301
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.23653549335                   -1.15    9.5    8.21s
  2   -62.24117254543       -2.33       -1.21    3.9    4.24s
  3   -62.24558633909       -2.36       -2.05    5.6    5.03s
  4   -62.24561985094       -4.47       -2.94    4.5    4.56s
  5   -62.24562020867       -6.45       -3.62    4.7    5.29s
  6   -62.24562023817       -7.53       -4.32    5.5    5.09s
  7   -62.24562023866       -9.31       -4.94    4.5    5.22s
  8   -62.24562023869      -10.56       -6.31    4.0    4.88s
  9   -62.24562023869      -12.85       -7.22    5.7    5.67s
Iter     Function value   Gradient norm 
     0    -6.224562e+01     4.284951e-04
 * time: 4.100799560546875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.23653353207                   -1.15    9.0    8.31s
  2   -62.24118892140       -2.33       -1.21    3.8    4.00s
  3   -62.24558569272       -2.36       -2.05    5.4    5.26s
  4   -62.24561996268       -4.47       -2.89    4.5    4.62s
  5   -62.24562038422       -6.38       -3.53    4.4    5.01s
  6   -62.24562041972       -7.45       -4.23    5.2    5.26s
  7   -62.24562042043       -9.15       -4.94    4.3    4.96s
  8   -62.24562042046      -10.51       -6.40    4.1    4.92s
  9   -62.24562042046      -13.07       -7.22    6.0    5.73s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.23653595440                   -1.15    9.0    8.00s
  2   -62.24117588438       -2.33       -1.21    3.8    3.96s
  3   -62.24558650439       -2.36       -2.05    5.4    5.09s
  4   -62.24562003179       -4.47       -2.94    4.6    4.82s
  5   -62.24562038991       -6.45       -3.61    4.5    5.12s
  6   -62.24562041993       -7.52       -4.31    5.5    5.12s
  7   -62.24562042043       -9.30       -4.94    4.4    5.05s
  8   -62.24562042046      -10.57       -6.36    4.1    4.82s
  9   -62.24562042046      -13.00       -7.10    5.9    5.64s
     1    -6.224562e+01     4.199838e-04
 * time: 127.38995695114136
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.23646716132                   -1.15    9.2    8.14s
  2   -62.24111003875       -2.33       -1.21    4.0    4.09s
  3   -62.24559065878       -2.35       -2.05    5.3    5.12s
  4   -62.24562448381       -4.47       -2.95    4.4    4.48s
  5   -62.24562486080       -6.42       -3.63    4.4    5.00s
  6   -62.24562488920       -7.55       -4.35    5.7    5.31s
  7   -62.24562488961       -9.39       -5.01    4.4    5.09s
  8   -62.24562488963      -10.73       -6.34    4.1    4.94s
  9   -62.24562488963      -12.87       -7.08    6.1    6.08s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.23646563519                   -1.15    9.2    8.17s
  2   -62.24110364323       -2.33       -1.21    3.7    3.95s
  3   -62.24559055933       -2.35       -2.05    5.3    5.01s
  4   -62.24562451117       -4.47       -2.95    4.7    4.77s
  5   -62.24562486000       -6.46       -3.63    4.5    5.09s
  6   -62.24562488913       -7.54       -4.34    5.5    5.09s
  7   -62.24562488960       -9.33       -4.97    4.4    5.09s
  8   -62.24562488963      -10.62       -6.32    4.2    4.95s
  9   -62.24562488963      -12.94       -7.23    5.5    5.63s
     2    -6.224562e+01     4.237428e-06
 * time: 254.63133597373962
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.23646454494                   -1.15    9.1    8.14s
  2   -62.24111111216       -2.33       -1.21    3.7    3.83s
  3   -62.24559019368       -2.35       -2.05    5.4    5.20s
  4   -62.24562442651       -4.47       -2.91    4.3    4.86s
  5   -62.24562485654       -6.37       -3.56    4.3    5.17s
  6   -62.24562488946       -7.48       -4.27    5.3    5.12s
  7   -62.24562489006       -9.22       -4.96    4.4    5.01s
  8   -62.24562489009      -10.56       -6.33    4.2    5.01s
  9   -62.24562489009      -12.77       -7.19    5.9    5.68s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.23646606959                   -1.15    9.1    8.16s
  2   -62.24110793908       -2.33       -1.21    3.8    3.99s
  3   -62.24559044738       -2.35       -2.05    5.3    5.04s
  4   -62.24562449078       -4.47       -2.94    4.3    4.54s
  5   -62.24562485958       -6.43       -3.61    4.3    4.95s
  6   -62.24562488959       -7.52       -4.33    5.5    5.03s
  7   -62.24562489007       -9.32       -4.95    4.4    4.99s
  8   -62.24562489009      -10.60       -6.38    4.1    4.85s
  9   -62.24562489009      -12.72       -7.08    5.7    5.62s
     3    -6.224562e+01     9.802358e-08
 * time: 380.9372639656067
 * Status: success

 * Candidate solution
    Final objective value:     -6.224562e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.16e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.00e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 4.65e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 7.48e-12 ≰ 0.0e+00
    |g(x)|                 = 9.80e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   381  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.23646651451                   -1.15    9.2    7.72s
  2   -62.24110791308       -2.33       -1.21    3.7    3.81s
  3   -62.24559046031       -2.35       -2.05    5.5    5.02s
  4   -62.24562449127       -4.47       -2.93    4.6    4.78s
  5   -62.24562485890       -6.43       -3.60    4.5    4.89s
  6   -62.24562488957       -7.51       -4.31    5.6    5.03s
  7   -62.24562489006       -9.31       -4.93    4.5    4.96s
  8   -62.24562489009      -10.56       -6.31    4.0    4.52s
  9   -62.24562489009      -12.75       -7.17    5.5    5.45s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.03e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.98e+00
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.89e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.05e-02
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.67e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 2.39e-05
[ Info: GMRES linsolve in iteration 1; step 6: normres = 8.57e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 5.00e-08
└ * number of operations = 9
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.23646558156                   -1.15    9.1    7.35s
  2   -62.24111775483       -2.33       -1.21    3.7    3.78s
  3   -62.24559033915       -2.35       -2.05    5.3    4.85s
  4   -62.24562446911       -4.47       -2.92    4.3    4.39s
  5   -62.24562485739       -6.41       -3.57    4.4    4.64s
  6   -62.24562488951       -7.49       -4.29    5.6    5.18s
  7   -62.24562489007       -9.26       -4.97    4.5    4.88s
  8   -62.24562489009      -10.60       -6.39    4.2    4.64s
  9   -62.24562489009      -12.94       -7.41    5.9    5.53s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 6.85e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.59e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.93e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.16e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.09e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 6.80e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 3.62e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 1.23e-08
└ * number of operations = 9
[ Info: GMRES linsolve starts with norm of residual = 2.78e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.85e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.05e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.61e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.36e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 8.57e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 3.63e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 1.20e-08
└ * number of operations = 9
NaCl: 1635.282043 seconds (1.63 G allocations: 1.539 TiB, 4.92% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T13:54:31.584
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317292352332                   -1.46    5.5    1.08s
  2   -2.317368156402       -4.12       -1.84    1.4    451ms
  3   -2.317385153874       -4.77       -3.58    3.2    748ms
  4   -2.317385354398       -6.70       -4.06    4.6    1.01s
  5   -2.317385354897       -9.30       -4.33    2.4    630ms
  6   -2.317385355044       -9.83       -5.01    2.7    666ms
  7   -2.317385355049      -11.33       -5.78    2.5    638ms
  8   -2.317385355049      -12.80       -6.56    2.7    678ms
  9   -2.317385355049      -14.35       -7.02    2.9    723ms
Iter     Function value   Gradient norm 
     0    -2.317385e+00     3.376465e-04
 * time: 3.695487976074219e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317293353109                   -1.46    5.4    1.32s
  2   -2.317368071276       -4.13       -1.84    1.3    458ms
  3   -2.317385266009       -4.76       -3.56    3.2    763ms
  4   -2.317385466002       -6.70       -4.03    4.5    1.05s
  5   -2.317385466556       -9.26       -4.31    2.3    760ms
  6   -2.317385466720       -9.79       -4.99    2.6    621ms
  7   -2.317385466726      -11.25       -5.77    2.5    623ms
  8   -2.317385466726      -12.69       -6.59    2.7    821ms
  9   -2.317385466726      -14.35       -6.95    3.1    707ms
 10   -2.317385466726      -15.05       -7.61    1.8    527ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317294623963                   -1.46    5.3    1.10s
  2   -2.317368499895       -4.13       -1.84    1.3    479ms
  3   -2.317385255698       -4.78       -3.57    3.1    911ms
  4   -2.317385466031       -6.68       -4.04    4.6    995ms
  5   -2.317385466562       -9.27       -4.31    2.3    615ms
  6   -2.317385466721       -9.80       -5.00    2.7    850ms
  7   -2.317385466726      -11.33       -5.77    2.4    600ms
  8   -2.317385466726      -12.78       -6.57    2.6    625ms
  9   -2.317385466726      -14.18       -6.96    3.1    733ms
 10   -2.317385466726      -15.05       -7.59    2.0    759ms
     1    -2.317385e+00     3.238547e-04
 * time: 41.34997296333313
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317291115790                   -1.46    5.5    1.29s
  2   -2.317369567657       -4.11       -1.84    1.3    476ms
  3   -2.317386529701       -4.77       -3.58    3.3    794ms
  4   -2.317386756751       -6.64       -4.02    4.5    1.14s
  5   -2.317386757326       -9.24       -4.29    2.4    623ms
  6   -2.317386757508       -9.74       -4.97    2.8    702ms
  7   -2.317386757512      -11.34       -5.67    2.4    823ms
  8   -2.317386757513      -12.59       -6.11    2.7    631ms
  9   -2.317386757513      -13.77       -6.90    2.1    569ms
 10   -2.317386757513      -14.65       -7.50    2.8    703ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317294877605                   -1.46    5.4    1.14s
  2   -2.317370224658       -4.12       -1.84    1.4    501ms
  3   -2.317386568528       -4.79       -3.58    3.2    900ms
  4   -2.317386756786       -6.73       -4.03    4.5    997ms
  5   -2.317386757329       -9.26       -4.30    2.4    645ms
  6   -2.317386757507       -9.75       -4.98    2.6    860ms
  7   -2.317386757512      -11.32       -5.68    2.5    602ms
  8   -2.317386757513      -12.53       -6.30    2.7    651ms
  9   -2.317386757513      -14.12       -6.93    2.3    806ms
 10   -2.317386757513      -15.35       -7.45    2.3    605ms
     2    -2.317387e+00     2.490857e-06
 * time: 84.12829399108887
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317295136382                   -1.46    5.5    1.14s
  2   -2.317369964888       -4.13       -1.84    1.3    454ms
  3   -2.317386497051       -4.78       -3.58    3.3    1.03s
  4   -2.317386756814       -6.59       -4.01    4.5    952ms
  5   -2.317386757396       -9.24       -4.29    2.4    624ms
  6   -2.317386757584       -9.73       -4.96    2.7    871ms
  7   -2.317386757589      -11.26       -5.66    2.4    602ms
  8   -2.317386757590      -12.51       -6.44    2.8    654ms
  9   -2.317386757590      -14.10       -6.74    2.9    701ms
 10   -2.317386757590   +    -Inf       -7.15    2.0    756ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317294084621                   -1.46    5.5    1.05s
  2   -2.317370127871       -4.12       -1.84    1.4    610ms
  3   -2.317386570864       -4.78       -3.57    3.2    693ms
  4   -2.317386756837       -6.73       -4.03    4.6    960ms
  5   -2.317386757408       -9.24       -4.30    2.3    761ms
┌ Warning: Eigensolver not converged
│   n_iter =
│    195-element Vector{Int64}:
│     3
│     2
│     4
│     5
│     ⋮
│     1
│     1
│     1
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/scf/self_consistent_field.jl:76
  6   -2.317386757584       -9.75       -4.97    2.7    672ms
  7   -2.317386757589      -11.30       -5.67    2.4    621ms
  8   -2.317386757590      -12.60       -6.21    2.7    681ms
  9   -2.317386757590      -14.12       -6.88    2.1    761ms
 10   -2.317386757590      -14.88       -7.49    2.5    612ms
     3    -2.317387e+00     1.549865e-08
 * time: 126.04936099052429
 * Status: success

 * Candidate solution
    Final objective value:     -2.317387e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 6.15e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 8.05e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 7.71e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.33e-11 ≰ 0.0e+00
    |g(x)|                 = 1.55e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   126  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317295558616                   -1.46    5.4    1.31s
  2   -2.317370310631       -4.13       -1.84    1.3    468ms
  3   -2.317386515770       -4.79       -3.58    3.3    783ms
  4   -2.317386756822       -6.62       -4.02    4.6    1.21s
  5   -2.317386757404       -9.24       -4.29    2.3    607ms
  6   -2.317386757584       -9.74       -4.96    2.8    644ms
  7   -2.317386757589      -11.30       -5.67    2.3    581ms
  8   -2.317386757590      -12.58       -6.50    2.6    810ms
  9   -2.317386757590      -14.21       -6.80    3.0    615ms
 10   -2.317386757590   +  -15.35       -7.22    2.0    506ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.94e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.68e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.95e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.16e-06
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 4.62e-08
└ * number of operations = 6
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317289555553                   -1.46    5.5    1.33s
  2   -2.317370276107       -4.09       -1.84    1.4    469ms
  3   -2.317386564355       -4.79       -3.58    3.3    804ms
  4   -2.317386756870       -6.72       -4.04    4.5    1.03s
  5   -2.317386757411       -9.27       -4.31    2.3    808ms
  6   -2.317386757585       -9.76       -4.98    2.7    609ms
  7   -2.317386757589      -11.31       -5.68    2.4    586ms
  8   -2.317386757590      -12.66       -6.23    2.7    690ms
  9   -2.317386757590      -14.01       -6.76    2.2    785ms
 10   -2.317386757590      -14.88       -7.37    2.2    556ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.47e-03
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.29e-05
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.94e-06
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.56e-08
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 6.36e-10
└ * number of operations = 6
[ Info: GMRES linsolve starts with norm of residual = 2.42e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.27e-03
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.45e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.06e-06
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 1.38e-08
└ * number of operations = 6
Al: 277.994722 seconds (278.12 M allocations: 118.864 GiB, 6.67% gc time, 0.05% compilation time)
┌ Info: 2025-05-20T13:59:09.579
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.79002858412                   -0.89    9.7    5.82s
  2   -73.80010936800       -2.00       -1.09    5.2    3.01s
  3   -73.80608162665       -2.22       -1.44    6.7    3.99s
  4   -73.80701734506       -3.03       -1.78    5.7    3.21s
  5   -73.80716566218       -3.83       -2.22    4.9    2.96s
  6   -73.80718760301       -4.66       -3.07    5.5    3.25s
  7   -73.80718762543       -7.65       -3.50    5.1    3.11s
  8   -73.80718762912       -8.43       -4.06    3.8    2.53s
  9   -73.80718762900   +   -9.92       -4.43    5.3    3.17s
 10   -73.80718762940       -9.40       -4.79    5.1    2.93s
 11   -73.80718762942      -10.63       -5.58    4.6    2.92s
 12   -73.80718762943      -11.61       -6.33    4.6    3.00s
 13   -73.80718762943      -13.07       -6.55    4.8    3.07s
 14   -73.80718762943      -12.70       -6.81    5.0    2.96s
 15   -73.80718762943      -12.81       -7.74    4.9    2.97s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.380719e+01     5.120954e-03
 * time: 3.600120544433594e-5
┌ Warning: Negative ρcore detected: -3.4032780488681194e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.79014585846                   -0.89    9.8    5.77s
  2   -73.80016485061       -2.00       -1.09    5.4    3.10s
  3   -73.80610796925       -2.23       -1.44    6.8    4.05s
  4   -73.80704210189       -3.03       -1.78    5.8    3.22s
  5   -73.80719044315       -3.83       -2.23    5.0    3.02s
  6   -73.80721185244       -4.67       -3.07    5.5    3.37s
  7   -73.80721187425       -7.66       -3.51    5.2    3.50s
  8   -73.80721187872       -8.35       -4.06    4.3    2.79s
  9   -73.80721187872   +  -11.74       -4.41    5.6    3.39s
 10   -73.80721187920       -9.31       -4.77    5.4    3.27s
 11   -73.80721187923      -10.64       -5.54    4.5    2.86s
 12   -73.80721187923      -11.81       -6.31    4.7    2.99s
 13   -73.80721187923      -13.85       -6.56    4.9    3.17s
 14   -73.80721187923   +  -13.15       -6.91    5.0    3.13s
 15   -73.80721187923   +  -13.85       -7.74    5.0    2.97s
┌ Warning: Negative ρcore detected: -3.4032780488681194e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.79014878797                   -0.89    9.7    5.87s
  2   -73.80016074498       -2.00       -1.09    5.4    3.15s
  3   -73.80610910014       -2.23       -1.44    6.8    4.13s
  4   -73.80704224874       -3.03       -1.78    5.7    3.22s
  5   -73.80719012030       -3.83       -2.23    5.0    2.98s
  6   -73.80721185141       -4.66       -3.06    5.6    3.29s
  7   -73.80721187482       -7.63       -3.50    5.2    3.21s
  8   -73.80721187883       -8.40       -4.07    4.0    2.63s
  9   -73.80721187881   +  -10.74       -4.41    5.5    3.28s
 10   -73.80721187920       -9.40       -4.79    5.2    2.97s
 11   -73.80721187923      -10.61       -5.55    4.6    2.86s
 12   -73.80721187923      -11.88       -6.30    4.7    2.96s
 13   -73.80721187923      -13.37       -6.56    4.8    3.15s
 14   -73.80721187923   +  -13.15       -6.93    5.0    2.99s
 15   -73.80721187923      -13.55       -7.81    5.0    3.12s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4032780488681194e-8,-3.4239452014624274e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     1    -7.380721e+01     4.348085e-03
 * time: 155.5920660495758
┌ Warning: Negative ρcore detected: -3.1182747225235475e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.79077163942                   -0.89    9.6    5.91s
  2   -73.80041017260       -2.02       -1.09    5.3    3.14s
  3   -73.80617739654       -2.24       -1.44    6.7    4.05s
  4   -73.80711795734       -3.03       -1.80    5.8    3.39s
  5   -73.80725348358       -3.87       -2.25    5.0    3.16s
  6   -73.80727326395       -4.70       -3.08    5.5    3.46s
  7   -73.80727328459       -7.69       -3.53    4.3    2.96s
  8   -73.80727329052       -8.23       -4.03    4.9    3.18s
  9   -73.80727329027   +   -9.61       -4.51    5.4    3.43s
 10   -73.80727329084       -9.25       -4.78    5.6    3.55s
 11   -73.80727329088      -10.45       -5.47    4.8    3.09s
 12   -73.80727329088      -11.78       -6.19    4.6    3.10s
 13   -73.80727329088      -12.94       -6.33    4.8    3.22s
 14   -73.80727329088   +  -12.55       -6.89    5.4    3.05s
 15   -73.80727329088   +    -Inf       -7.85    5.0    3.07s
┌ Warning: Negative ρcore detected: -3.1182747225235475e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.79076170410                   -0.89    9.6    5.56s
  2   -73.80040492100       -2.02       -1.09    5.3    3.16s
  3   -73.80617820921       -2.24       -1.44    6.8    3.91s
  4   -73.80711775978       -3.03       -1.80    5.8    3.21s
  5   -73.80725360298       -3.87       -2.25    5.0    2.96s
  6   -73.80727326458       -4.71       -3.08    5.5    3.26s
  7   -73.80727328477       -7.69       -3.54    4.5    2.90s
  8   -73.80727329053       -8.24       -4.03    4.8    3.15s
  9   -73.80727329025   +   -9.55       -4.50    5.4    3.18s
 10   -73.80727329084       -9.23       -4.78    5.6    3.23s
 11   -73.80727329088      -10.44       -5.47    4.8    2.91s
 12   -73.80727329088      -11.71       -6.20    4.6    2.89s
 13   -73.80727329088      -13.07       -6.34    4.7    2.98s
 14   -73.80727329088   +  -12.64       -6.90    5.4    3.09s
 15   -73.80727329088   +  -12.94       -7.84    5.0    2.97s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1182747225235475e-8,4.494845366328152e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     2    -7.380727e+01     1.195280e-04
 * time: 311.44190311431885
┌ Warning: Negative ρcore detected: -3.12535469456222e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.79076691435                   -0.89    9.6    5.25s
  2   -73.80038210990       -2.02       -1.09    5.1    2.89s
  3   -73.80618171231       -2.24       -1.44    6.7    3.70s
  4   -73.80711732300       -3.03       -1.80    5.7    3.06s
  5   -73.80725350796       -3.87       -2.25    4.9    2.84s
  6   -73.80727331066       -4.70       -3.08    5.4    3.15s
  7   -73.80727333008       -7.71       -3.53    4.4    2.69s
  8   -73.80727333561       -8.26       -4.04    4.7    2.86s
  9   -73.80727333541   +   -9.69       -4.52    5.3    3.24s
 10   -73.80727333591       -9.30       -4.78    5.5    3.26s
 11   -73.80727333595      -10.42       -5.47    4.7    2.98s
 12   -73.80727333595      -11.64       -6.19    4.6    3.02s
 13   -73.80727333595      -12.94       -6.35    4.8    3.15s
 14   -73.80727333595   +  -12.62       -6.88    5.4    3.33s
 15   -73.80727333595   +  -12.94       -7.83    5.0    3.20s
┌ Warning: Negative ρcore detected: -3.12535469456222e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.79074864090                   -0.89    9.5    5.61s
  2   -73.80040146671       -2.02       -1.09    5.1    3.03s
  3   -73.80617796575       -2.24       -1.44    6.7    4.04s
  4   -73.80711747313       -3.03       -1.80    5.7    3.25s
  5   -73.80725403567       -3.86       -2.26    4.9    2.98s
  6   -73.80727331049       -4.72       -3.09    5.4    3.33s
  7   -73.80727332995       -7.71       -3.54    4.4    2.93s
  8   -73.80727333559       -8.25       -4.03    4.8    3.02s
  9   -73.80727333533   +   -9.59       -4.50    5.3    3.33s
 10   -73.80727333591       -9.24       -4.78    5.6    3.32s
 11   -73.80727333595      -10.44       -5.47    4.8    2.97s
 12   -73.80727333595      -11.68       -6.21    4.6    3.05s
 13   -73.80727333595      -13.37       -6.34    4.8    3.16s
 14   -73.80727333595   +  -12.73       -6.89    5.4    3.19s
 15   -73.80727333595   +  -13.37       -7.82    4.9    3.18s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.12535469456222e-8,-1.6797613969194222e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     3    -7.380727e+01     2.667588e-06
 * time: 465.0811939239502
┌ Warning: Negative ρcore detected: -3.125071982833476e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.79076030272                   -0.89    9.5    5.40s
  2   -73.80038486987       -2.02       -1.09    5.1    2.96s
  3   -73.80618047639       -2.24       -1.44    6.7    3.87s
  4   -73.80711694225       -3.03       -1.80    5.7    3.20s
  5   -73.80725381293       -3.86       -2.25    5.0    3.06s
  6   -73.80727331004       -4.71       -3.08    5.5    3.41s
  7   -73.80727333024       -7.69       -3.54    4.4    2.88s
  8   -73.80727333564       -8.27       -4.03    4.7    3.01s
  9   -73.80727333540   +   -9.63       -4.51    5.3    3.29s
 10   -73.80727333593       -9.28       -4.79    5.5    3.30s
 11   -73.80727333597      -10.39       -5.48    4.8    3.06s
 12   -73.80727333597      -11.72       -6.19    4.6    2.99s
 13   -73.80727333597      -13.85       -6.35    4.8    3.10s
 14   -73.80727333597   +  -13.25       -6.89    5.3    3.11s
 15   -73.80727333597   +  -13.07       -7.83    4.9    3.15s
┌ Warning: Negative ρcore detected: -3.125071982833476e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.79073589836                   -0.89    9.6    5.53s
  2   -73.80039784041       -2.01       -1.09    5.2    3.11s
  3   -73.80618102159       -2.24       -1.44    6.6    3.79s
  4   -73.80711691534       -3.03       -1.80    5.7    3.14s
  5   -73.80725349813       -3.86       -2.25    4.9    3.09s
  6   -73.80727330775       -4.70       -3.08    5.4    3.26s
  7   -73.80727333035       -7.65       -3.53    4.3    2.79s
  8   -73.80727333564       -8.28       -4.02    4.7    2.91s
  9   -73.80727333543   +   -9.68       -4.52    5.2    3.19s
 10   -73.80727333593       -9.30       -4.79    5.4    3.27s
 11   -73.80727333597      -10.40       -5.48    4.8    3.04s
 12   -73.80727333597      -11.84       -6.19    4.6    2.97s
 13   -73.80727333597      -13.25       -6.34    4.7    3.06s
 14   -73.80727333597   +  -12.59       -6.90    5.3    3.04s
 15   -73.80727333597   +  -13.85       -7.86    4.9    3.05s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.125071982833476e-8,-1.6806350340553366e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     4    -7.380727e+01     2.024492e-09
 * time: 620.8471169471741
 * Status: success

 * Candidate solution
    Final objective value:     -7.380727e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.68e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.97e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.15e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.91e-13 ≰ 0.0e+00
    |g(x)|                 = 2.02e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   621  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

Computing hessian ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.125071982833476e-8,-1.6806350340553366e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.125071982833476e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.79075700470                   -0.89    9.5    5.30s
  2   -73.80039258294       -2.02       -1.09    5.2    2.98s
  3   -73.80617968272       -2.24       -1.44    6.7    3.63s
  4   -73.80711737413       -3.03       -1.80    5.7    3.07s
  5   -73.80725344053       -3.87       -2.25    4.9    2.85s
  6   -73.80727330982       -4.70       -3.08    5.4    3.36s
  7   -73.80727333049       -7.68       -3.53    4.3    2.82s
  8   -73.80727333564       -8.29       -4.03    4.6    2.88s
  9   -73.80727333544   +   -9.69       -4.52    5.3    3.03s
 10   -73.80727333593       -9.31       -4.78    5.4    3.24s
 11   -73.80727333597      -10.41       -5.48    4.8    2.95s
 12   -73.80727333597      -11.77       -6.19    4.6    2.87s
 13   -73.80727333597      -13.55       -6.35    4.8    2.92s
 14   -73.80727333597   +  -12.85       -6.89    5.4    3.21s
 15   -73.80727333597   +  -12.73       -7.86    4.9    3.08s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.35e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.01e+01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.12e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.08e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 5.25e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 4.48e-07
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.62e-08
┌ Info: GMRES linsolve converged at iteration 2, step 1:
│ * norm of residual = 2.30e-09
└ * number of operations = 9
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}(Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.125071979801609e-8,-1.6806350324825653e-7),Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-1.6806350341790725e-7,5.1922019762517835e-6))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Computing cross-derivative ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.125071982833476e-8,0.0,0.0)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.125071982833476e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.79074881598                   -0.89    9.6    5.57s
  2   -73.80039670582       -2.02       -1.09    5.1    2.95s
  3   -73.80617976667       -2.24       -1.44    6.6    4.04s
  4   -73.80711720296       -3.03       -1.80    5.7    3.23s
  5   -73.80725388613       -3.86       -2.25    4.9    2.97s
  6   -73.80727331123       -4.71       -3.08    5.5    3.13s
  7   -73.80727333000       -7.73       -3.54    4.6    2.96s
  8   -73.80727333562       -8.25       -4.04    4.8    2.96s
  9   -73.80727333535   +   -9.57       -4.50    5.3    3.22s
 10   -73.80727333593       -9.23       -4.78    5.5    3.17s
 11   -73.80727333597      -10.43       -5.47    4.7    2.97s
 12   -73.80727333597      -11.66       -6.20    4.5    2.97s
 13   -73.80727333597      -13.55       -6.35    4.7    2.86s
 14   -73.80727333597   +  -12.73       -6.90    5.3    3.05s
 15   -73.80727333597   +  -13.07       -7.82    4.9    3.11s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.38e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 7.96e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.81e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.95e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 5.51e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 7.95e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 6.49e-10
└ * number of operations = 8
[ Info: GMRES linsolve starts with norm of residual = 4.97e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.54e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.53e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 8.91e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 8.96e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 2.00e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 3.07e-09
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}, KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.125071979801609e-8,0.0,0.0),Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-1.6806350344596402e-7,0.0,0.0))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
V: 1462.308673 seconds (1.21 G allocations: 1.249 TiB, 7.69% gc time, 0.01% compilation time)
Iter     Function value   Gradient norm 
     0     1.865744e-04     1.231749e-03
 * Current step size: 1.0
 * time: 2.6941299438476562e-5
 * g(x): (κ = 0.0006851699391925166, μ = 0.0012317494648775283)
 * ~inv(H): [1.0 0.0; 0.0 1.0]
 * x: (κ = 0.804, μ = 0.21951497276451704)
┌ Info: 2025-05-20T14:23:32.686
└   θ = ComponentVector{Float64}(κ = 0.8033148300608075, μ = 0.2182832232996395)
┌ Info: 2025-05-20T14:23:32.723
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.33541839394279)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460146927086                   -0.96    7.6    1.57s
  2   -8.461944550647       -2.75       -1.73    2.2    691ms
  3   -8.462005267951       -4.22       -2.81    3.9    1.16s
  4   -8.462006336874       -5.97       -3.77    4.7    974ms
  5   -8.462006354473       -7.75       -4.60    4.9    1.08s
  6   -8.462006355018       -9.26       -5.48    5.0    1.20s
  7   -8.462006355021      -11.53       -6.45    3.7    901ms
  8   -8.462006355021      -13.23       -7.33    4.0    1.03s
Iter     Function value   Gradient norm 
     0    -8.462006e+00     6.786808e-05
 * time: 3.600120544433594e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460152987223                   -0.96    7.4    1.50s
  2   -8.461942004957       -2.75       -1.73    2.0    634ms
  3   -8.462005247698       -4.20       -2.81    3.8    1.09s
  4   -8.462006340182       -5.96       -3.75    4.6    960ms
  5   -8.462006358922       -7.73       -4.60    4.9    1.02s
  6   -8.462006359464       -9.27       -5.49    5.0    1.20s
  7   -8.462006359466      -11.62       -6.47    3.7    877ms
  8   -8.462006359466      -13.29       -7.32    4.2    1.21s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460157108024                   -0.96    7.5    1.47s
  2   -8.461940426804       -2.75       -1.73    2.1    636ms
  3   -8.462005117600       -4.19       -2.82    3.9    1.08s
  4   -8.462006340306       -5.91       -3.74    4.5    954ms
  5   -8.462006358973       -7.73       -4.63    4.8    1.06s
  6   -8.462006359464       -9.31       -5.50    5.1    1.20s
  7   -8.462006359466      -11.70       -6.49    3.6    864ms
  8   -8.462006359466      -13.30       -7.33    4.2    1.20s
     1    -8.462006e+00     6.312860e-05
 * time: 27.013590097427368
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460160501718                   -0.96    7.3    1.50s
  2   -8.461945348376       -2.75       -1.73    2.0    639ms
  3   -8.462005213367       -4.22       -2.82    3.7    1.15s
  4   -8.462006368569       -5.94       -3.75    4.6    952ms
  5   -8.462006387489       -7.72       -4.62    4.8    1.04s
  6   -8.462006387998       -9.29       -5.50    5.0    1.20s
  7   -8.462006388001      -11.58       -6.44    3.5    861ms
  8   -8.462006388001      -13.21       -7.36    4.1    1.20s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460157334081                   -0.96    7.4    1.51s
  2   -8.461939658429       -2.75       -1.73    2.0    647ms
  3   -8.462005394857       -4.18       -2.82    3.9    1.17s
  4   -8.462006366954       -6.01       -3.78    4.5    993ms
  5   -8.462006387328       -7.69       -4.51    4.8    1.07s
  6   -8.462006387993       -9.18       -5.32    5.1    1.19s
  7   -8.462006388001      -11.09       -6.24    3.7    926ms
  8   -8.462006388001      -12.95       -7.35    4.0    1.19s
     2    -8.462006e+00     9.659925e-09
 * time: 54.70675802230835
 * Status: success

 * Candidate solution
    Final objective value:     -8.462006e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 9.04e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 8.75e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.85e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.37e-09 ≰ 0.0e+00
    |g(x)|                 = 9.66e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   55  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Si: 71.496783 seconds (141.90 M allocations: 41.550 GiB, 11.43% gc time, 0.03% compilation time)
┌ Info: 2025-05-20T14:24:44.223
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.767918261827115)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.23340058846                   -1.15    9.1    7.85s
  2   -62.23803419060       -2.33       -1.21    3.8    4.58s
  3   -62.24249846860       -2.35       -2.05    5.5    5.11s
  4   -62.24253278966       -4.46       -2.91    4.4    4.66s
  5   -62.24253318305       -6.41       -3.56    4.4    5.75s
  6   -62.24253321669       -7.47       -4.26    5.3    5.04s
  7   -62.24253321728       -9.23       -4.89    4.4    4.91s
  8   -62.24253321731      -10.47       -6.41    4.2    5.06s
  9   -62.24253321731      -12.81       -7.13    6.0    5.78s
Iter     Function value   Gradient norm 
     0    -6.224253e+01     3.240170e-05
 * time: 4.482269287109375e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.23339989485                   -1.15    9.1    7.85s
  2   -62.23802143848       -2.34       -1.21    3.6    3.78s
  3   -62.24249896053       -2.35       -2.05    5.5    5.17s
  4   -62.24253282665       -4.47       -2.95    4.6    5.16s
  5   -62.24253318880       -6.44       -3.63    4.4    5.02s
  6   -62.24253321792       -7.54       -4.36    5.6    4.91s
  7   -62.24253321833       -9.38       -5.00    4.6    4.98s
  8   -62.24253321835      -10.70       -6.31    4.2    4.77s
  9   -62.24253321835      -12.83       -7.44    5.8    5.54s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.23340039566                   -1.15    9.0    7.96s
  2   -62.23803249540       -2.33       -1.21    3.8    3.77s
  3   -62.24249866532       -2.35       -2.05    5.3    4.93s
  4   -62.24253281746       -4.47       -2.93    4.6    4.55s
  5   -62.24253318678       -6.43       -3.60    4.4    4.88s
  6   -62.24253321781       -7.51       -4.31    5.4    4.73s
  7   -62.24253321833       -9.29       -4.97    4.5    5.22s
  8   -62.24253321835      -10.62       -6.33    4.2    5.19s
  9   -62.24253321835      -12.72       -7.25    5.9    6.11s
     1    -6.224253e+01     3.177594e-05
 * time: 121.39337491989136
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.23340156261                   -1.15    9.2    9.55s
  2   -62.23802781470       -2.33       -1.21    3.8    3.85s
  3   -62.24249897343       -2.35       -2.05    5.4    4.81s
  4   -62.24253284852       -4.47       -2.96    4.5    4.51s
  5   -62.24253321506       -6.44       -3.63    4.5    5.00s
  6   -62.24253324394       -7.54       -4.34    5.6    5.03s
  7   -62.24253324435       -9.38       -4.93    4.6    5.02s
  8   -62.24253324438      -10.60       -6.30    4.0    4.69s
  9   -62.24253324438      -12.87       -7.08    5.9    5.51s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.23340203959                   -1.15    9.4    8.00s
  2   -62.23803799009       -2.33       -1.21    3.7    3.76s
  3   -62.24249873278       -2.35       -2.05    5.4    4.87s
  4   -62.24253283364       -4.47       -2.93    4.6    4.46s
  5   -62.24253321229       -6.42       -3.59    4.4    4.75s
  6   -62.24253324385       -7.50       -4.30    5.7    4.86s
  7   -62.24253324435       -9.30       -4.94    4.4    4.76s
  8   -62.24253324438      -10.58       -6.38    4.2    4.69s
  9   -62.24253324438      -13.00       -7.16    6.0    5.72s
     2    -6.224253e+01     2.102917e-07
 * time: 243.88179397583008
 * Status: success

 * Candidate solution
    Final objective value:     -6.224253e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.65e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.53e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.60e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 4.18e-10 ≰ 0.0e+00
    |g(x)|                 = 2.10e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   244  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

NaCl: 318.264635 seconds (550.55 M allocations: 190.098 GiB, 6.54% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T14:30:02.488
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.633597945295895)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317222583822                   -1.46    5.5    1.22s
  2   -2.317298881393       -4.12       -1.84    1.3    448ms
  3   -2.317315683385       -4.77       -3.57    3.2    734ms
  4   -2.317315954347       -6.57       -4.01    4.6    1.12s
  5   -2.317315954952       -9.22       -4.30    2.4    608ms
  6   -2.317315955132       -9.75       -4.95    2.7    660ms
  7   -2.317315955137      -11.30       -5.67    2.4    812ms
  8   -2.317315955137      -12.58       -6.55    2.7    635ms
  9   -2.317315955137      -14.31       -7.10    3.1    678ms
Iter     Function value   Gradient norm 
     0    -2.317316e+00     3.911189e-05
 * time: 2.7179718017578125e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317224131894                   -1.46    5.5    1.28s
  2   -2.317299079299       -4.13       -1.84    1.3    459ms
  3   -2.317315707329       -4.78       -3.57    3.3    799ms
  4   -2.317315955842       -6.60       -4.02    4.6    1.13s
  5   -2.317315956447       -9.22       -4.30    2.3    596ms
  6   -2.317315956631       -9.74       -4.96    2.7    665ms
  7   -2.317315956636      -11.32       -5.66    2.4    831ms
  8   -2.317315956636      -12.62       -6.26    2.7    635ms
  9   -2.317315956636      -14.01       -6.76    2.4    629ms
 10   -2.317315956636   +  -15.35       -7.20    2.3    605ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317222839786                   -1.46    5.5    1.10s
  2   -2.317299183614       -4.12       -1.84    1.4    680ms
  3   -2.317315733139       -4.78       -3.58    3.2    716ms
  4   -2.317315955882       -6.65       -4.03    4.5    973ms
  5   -2.317315956457       -9.24       -4.30    2.4    635ms
  6   -2.317315956631       -9.76       -4.97    2.8    859ms
  7   -2.317315956636      -11.31       -5.69    2.5    618ms
  8   -2.317315956636      -12.71       -6.29    2.7    665ms
  9   -2.317315956636      -14.15       -6.92    2.3    793ms
 10   -2.317315956636      -15.05       -7.51    2.5    606ms
     1    -2.317316e+00     3.753800e-05
 * time: 42.61371207237244
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317228329067                   -1.46    5.7    1.29s
  2   -2.317299823080       -4.15       -1.84    1.5    498ms
  3   -2.317315750276       -4.80       -3.57    3.3    787ms
  4   -2.317315973368       -6.65       -4.02    4.6    1.14s
  5   -2.317315973955       -9.23       -4.30    2.5    633ms
  6   -2.317315974138       -9.74       -4.96    2.8    718ms
  7   -2.317315974143      -11.28       -5.65    2.6    807ms
  8   -2.317315974143      -12.56       -6.16    2.8    638ms
  9   -2.317315974143      -14.01       -6.75    2.1    605ms
 10   -2.317315974143      -14.88       -7.24    2.5    837ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317228202622                   -1.46    5.7    1.24s
  2   -2.317299559733       -4.15       -1.84    1.5    722ms
  3   -2.317315770765       -4.79       -3.59    3.3    782ms
  4   -2.317315973432       -6.69       -4.04    4.7    1.08s
  5   -2.317315973965       -9.27       -4.31    2.5    870ms
  6   -2.317315974138       -9.76       -4.98    2.8    653ms
  7   -2.317315974143      -11.32       -5.65    2.5    628ms
  8   -2.317315974143      -12.63       -6.17    2.8    695ms
  9   -2.317315974143      -13.88       -6.73    2.2    804ms
 10   -2.317315974143      -14.65       -7.36    2.3    574ms
     2    -2.317316e+00     1.097315e-09
 * time: 85.1571741104126
 * Status: success

 * Candidate solution
    Final objective value:     -2.317316e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 9.33e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.22e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.75e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 7.55e-09 ≰ 0.0e+00
    |g(x)|                 = 1.10e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   85  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Al: 110.700914 seconds (105.19 M allocations: 29.388 GiB, 6.55% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T14:31:53.190
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.666090627049824)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.125071982833476e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.78841681285                   -0.89    9.6    5.64s
  2   -73.79810366570       -2.01       -1.09    5.2    2.93s
  3   -73.80393025271       -2.23       -1.44    6.7    4.01s
  4   -73.80487031807       -3.03       -1.80    5.7    3.40s
  5   -73.80500748993       -3.86       -2.25    4.9    3.19s
  6   -73.80502740284       -4.70       -3.08    5.5    3.42s
  7   -73.80502742174       -7.72       -3.54    4.6    2.81s
  8   -73.80502742728       -8.26       -4.05    4.8    3.22s
  9   -73.80502742701   +   -9.57       -4.50    5.4    3.31s
 10   -73.80502742757       -9.25       -4.78    5.5    3.41s
 11   -73.80502742761      -10.44       -5.47    4.9    3.07s
 12   -73.80502742761      -11.61       -6.21    4.6    3.61s
 13   -73.80502742761      -12.94       -6.35    4.7    2.95s
 14   -73.80502742761   +  -12.59       -6.90    5.3    2.95s
 15   -73.80502742761   +  -13.85       -7.81    5.0    2.97s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.125071982833476e-8,-1.6806350340553366e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.380503e+01     1.383575e-04
 * time: 3.600120544433594e-5
┌ Warning: Negative ρcore detected: -3.122741719896545e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.78840443478                   -0.89    9.7    5.60s
  2   -73.79810113254       -2.01       -1.09    5.3    3.02s
  3   -73.80393176575       -2.23       -1.44    6.8    3.73s
  4   -73.80486991362       -3.03       -1.80    5.8    3.14s
  5   -73.80500742160       -3.86       -2.25    5.0    2.87s
  6   -73.80502741939       -4.70       -3.08    5.4    3.18s
  7   -73.80502744027       -7.68       -3.53    4.4    2.92s
  8   -73.80502744491       -8.33       -4.03    4.7    2.82s
  9   -73.80502744474   +   -9.77       -4.50    5.3    3.08s
 10   -73.80502744519       -9.34       -4.77    5.4    3.01s
 11   -73.80502744523      -10.42       -5.48    4.7    2.80s
 12   -73.80502744523      -11.71       -6.19    4.5    2.92s
 13   -73.80502744523      -12.94       -6.38    4.7    3.07s
 14   -73.80502744523   +  -12.70       -6.89    5.4    3.14s
 15   -73.80502744523   +  -13.37       -7.88    4.9    3.16s
┌ Warning: Negative ρcore detected: -3.122741719896545e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.78841116937                   -0.89    9.6    5.67s
  2   -73.79811610220       -2.01       -1.09    5.2    3.16s
  3   -73.80392867938       -2.24       -1.44    6.8    4.07s
  4   -73.80487007334       -3.03       -1.80    5.8    3.32s
  5   -73.80500789420       -3.86       -2.25    5.0    3.08s
  6   -73.80502742019       -4.71       -3.08    5.4    3.47s
  7   -73.80502743978       -7.71       -3.54    4.4    2.91s
  8   -73.80502744491       -8.29       -4.04    4.8    2.96s
  9   -73.80502744467   +   -9.62       -4.51    5.3    3.09s
 10   -73.80502744519       -9.28       -4.78    5.5    3.09s
 11   -73.80502744523      -10.44       -5.48    4.7    2.94s
 12   -73.80502744523      -11.73       -6.21    4.6    2.98s
 13   -73.80502744523      -12.94       -6.35    4.8    3.12s
 14   -73.80502744523   +  -12.67       -6.90    5.4    3.08s
 15   -73.80502744523   +  -13.55       -7.81    4.9    3.24s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.122741719896545e-8,-1.6878216669345029e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     1    -7.380503e+01     1.164422e-04
 * time: 154.66844010353088
┌ Warning: Negative ρcore detected: -3.1188093046637456e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.78842288393                   -0.89    9.7    6.02s
  2   -73.79812539830       -2.01       -1.09    5.3    3.11s
  3   -73.80392754574       -2.24       -1.44    6.7    3.99s
  4   -73.80487110547       -3.03       -1.80    5.7    3.27s
  5   -73.80500770930       -3.86       -2.25    4.9    3.19s
  6   -73.80502746245       -4.70       -3.08    5.5    3.41s
  7   -73.80502748189       -7.71       -3.54    4.5    2.96s
  8   -73.80502748764       -8.24       -4.04    4.9    3.03s
  9   -73.80502748736   +   -9.55       -4.50    5.4    3.33s
 10   -73.80502748794       -9.24       -4.79    5.7    3.38s
 11   -73.80502748797      -10.44       -5.47    4.8    3.04s
 12   -73.80502748797      -11.67       -6.21    4.6    2.95s
 13   -73.80502748797      -13.85       -6.35    4.8    3.02s
 14   -73.80502748797   +  -12.77       -6.90    5.4    3.06s
 15   -73.80502748797   +  -13.55       -7.83    5.0    3.20s
┌ Warning: Negative ρcore detected: -3.1188093046637456e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.78842945699                   -0.89    9.8    5.91s
  2   -73.79812121881       -2.01       -1.09    5.2    3.16s
  3   -73.80392671587       -2.24       -1.44    6.8    4.08s
  4   -73.80487175761       -3.02       -1.80    5.8    3.25s
  5   -73.80500796318       -3.87       -2.25    4.9    2.94s
  6   -73.80502746264       -4.71       -3.08    5.5    3.26s
  7   -73.80502748221       -7.71       -3.54    4.5    2.86s
  8   -73.80502748764       -8.26       -4.04    4.8    2.92s
  9   -73.80502748737   +   -9.56       -4.50    5.4    3.21s
 10   -73.80502748794       -9.24       -4.78    5.6    3.29s
 11   -73.80502748797      -10.44       -5.47    4.8    2.95s
 12   -73.80502748797      -11.67       -6.20    4.5    2.91s
 13   -73.80502748797      -13.25       -6.35    4.8    3.03s
 14   -73.80502748797   +  -12.73       -6.90    5.4    3.13s
 15   -73.80502748797   +  -13.15       -7.84    5.0    3.10s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1188093046637456e-8,4.450814840536995e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     2    -7.380503e+01     7.602254e-08
 * time: 310.5809631347656
 * Status: success

 * Candidate solution
    Final objective value:     -7.380503e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 7.35e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.30e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 4.27e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 5.79e-10 ≰ 0.0e+00
    |g(x)|                 = 7.60e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   311  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

V: 400.237888 seconds (360.52 M allocations: 208.339 GiB, 8.25% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T14:38:33.602
└   θ = ComponentVector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}(κ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.8033148300608075,1.0,0.0), μ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.2182832232996395,0.0,1.0))
┌ Info: 2025-05-20T14:38:33.608
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.334446541102897)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460155955354                   -0.96    7.3    1.43s
  2   -8.461942168617       -2.75       -1.73    2.0    851ms
  3   -8.462005364733       -4.20       -2.82    3.9    888ms
  4   -8.462006367634       -6.00       -3.76    4.7    1.08s
  5   -8.462006387434       -7.70       -4.57    4.9    1.20s
  6   -8.462006387996       -9.25       -5.40    5.0    1.02s
  7   -8.462006388001      -11.30       -6.28    3.9    1.17s
  8   -8.462006388001      -12.97       -7.33    3.9    865ms
Iter     Function value   Gradient norm 
     0    -8.462006e+00     1.044595e-08
 * time: 3.910064697265625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.462006e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.04e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460160474063                   -0.96    7.2    1.47s
  2   -8.461942228423       -2.75       -1.73    2.1    678ms
  3   -8.462005405800       -4.20       -2.82    3.8    984ms
  4   -8.462006368018       -6.02       -3.77    4.7    1.20s
  5   -8.462006387430       -7.71       -4.57    4.8    1.04s
  6   -8.462006387996       -9.25       -5.40    5.1    1.05s
  7   -8.462006388001      -11.30       -6.29    3.8    1.11s
  8   -8.462006388001      -13.02       -7.38    3.8    902ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.13e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.46e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.24e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 9.89e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 3.70e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.21e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 3.01e-09
└ * number of operations = 8
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460144258381                   -0.96    7.3    1.25s
  2   -8.461940805284       -2.75       -1.73    2.1    623ms
  3   -8.462005163852       -4.19       -2.82    3.8    1.06s
  4   -8.462006367467       -5.92       -3.75    4.6    982ms
  5   -8.462006387459       -7.70       -4.60    4.9    988ms
  6   -8.462006387997       -9.27       -5.47    5.1    1.18s
  7   -8.462006388001      -11.47       -6.37    3.6    845ms
  8   -8.462006388001      -13.18       -7.30    3.9    887ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 6.78e-02
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.06e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.26e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.03e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 8.29e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 1.88e-08
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 1.02e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 5.47e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.92e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.35e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 3.75e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.24e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 3.36e-09
└ * number of operations = 8
Si: 169.921142 seconds (251.26 M allocations: 206.215 GiB, 9.48% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T14:41:23.530
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.766240504974547)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.23340237385                   -1.15    9.3    8.29s
  2   -62.23804044163       -2.33       -1.21    3.8    3.97s
  3   -62.24249865025       -2.35       -2.05    5.3    5.16s
  4   -62.24253283128       -4.47       -2.92    4.6    4.74s
  5   -62.24253321150       -6.42       -3.58    4.5    5.05s
  6   -62.24253324384       -7.49       -4.29    5.6    5.15s
  7   -62.24253324435       -9.29       -4.93    4.3    4.93s
  8   -62.24253324438      -10.54       -6.38    4.3    4.90s
  9   -62.24253324438      -12.79       -7.16    6.0    5.67s
Iter     Function value   Gradient norm 
     0    -6.224253e+01     2.166074e-07
 * time: 3.504753112792969e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.224253e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 2.17e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.23340255478                   -1.15    9.4    7.98s
  2   -62.23803439177       -2.33       -1.21    3.8    3.69s
  3   -62.24249885119       -2.35       -2.05    5.2    5.00s
  4   -62.24253283868       -4.47       -2.94    4.5    4.53s
  5   -62.24253321336       -6.43       -3.61    4.7    5.01s
  6   -62.24253324390       -7.52       -4.33    5.4    5.64s
  7   -62.24253324436       -9.34       -4.98    4.5    5.07s
  8   -62.24253324438      -10.66       -6.24    4.1    4.90s
  9   -62.24253324438      -13.07       -7.14    5.7    5.46s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.03e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.98e+00
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.89e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.05e-02
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.70e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 2.43e-05
[ Info: GMRES linsolve in iteration 1; step 6: normres = 8.56e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 5.23e-08
└ * number of operations = 9
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.23340029876                   -1.15    9.4    7.47s
  2   -62.23803986005       -2.33       -1.21    3.8    5.28s
  3   -62.24249878586       -2.35       -2.05    5.3    5.14s
  4   -62.24253283166       -4.47       -2.93    4.3    4.30s
  5   -62.24253321261       -6.42       -3.59    4.5    5.01s
  6   -62.24253324386       -7.51       -4.32    5.7    5.10s
  7   -62.24253324435       -9.31       -4.96    4.5    4.83s
  8   -62.24253324438      -10.61       -6.35    4.1    4.83s
  9   -62.24253324438      -12.89       -7.13    5.9    5.65s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 6.82e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.58e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.91e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.16e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.09e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 6.80e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 3.64e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 1.26e-08
└ * number of operations = 9
[ Info: GMRES linsolve starts with norm of residual = 2.79e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.87e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.05e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 3.63e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.30e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 8.60e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 3.74e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 1.65e-08
└ * number of operations = 9
NaCl: 1226.292027 seconds (971.59 M allocations: 1.294 TiB, 4.54% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T15:01:49.822
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.6326259911927)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317227488100                   -1.46    5.7    1.05s
  2   -2.317299113582       -4.14       -1.84    1.6    471ms
  3   -2.317315741034       -4.78       -3.57    3.4    769ms
  4   -2.317315973330       -6.63       -4.01    4.6    940ms
  5   -2.317315973942       -9.21       -4.28    2.5    619ms
  6   -2.317315974137       -9.71       -4.95    2.8    684ms
  7   -2.317315974143      -11.27       -5.65    2.5    629ms
  8   -2.317315974143      -12.55       -6.45    2.8    702ms
  9   -2.317315974143      -14.27       -6.73    2.8    710ms
 10   -2.317315974143      -15.05       -7.21    2.0    571ms
Iter     Function value   Gradient norm 
     0    -2.317316e+00     1.534397e-09
 * time: 3.3855438232421875e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.317316e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.53e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317227578484                   -1.46    5.7    1.37s
  2   -2.317299451398       -4.14       -1.84    1.5    496ms
  3   -2.317315777093       -4.79       -3.58    3.3    797ms
  4   -2.317315973403       -6.71       -4.03    4.7    1.21s
  5   -2.317315973959       -9.26       -4.30    2.5    629ms
  6   -2.317315974137       -9.75       -4.97    2.8    659ms
  7   -2.317315974143      -11.28       -5.66    2.5    648ms
  8   -2.317315974143      -12.54       -6.33    2.7    870ms
  9   -2.317315974143      -14.15       -6.82    2.6    638ms
 10   -2.317315974143      -14.88       -7.34    2.5    624ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.95e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.68e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.99e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.15e-06
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 4.54e-08
└ * number of operations = 6
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317230037908                   -1.46    5.7    1.10s
  2   -2.317299759690       -4.16       -1.84    1.5    467ms
  3   -2.317315758353       -4.80       -3.58    3.3    921ms
  4   -2.317315973394       -6.67       -4.03    4.7    964ms
  5   -2.317315973960       -9.25       -4.30    2.5    623ms
  6   -2.317315974138       -9.75       -4.97    2.8    657ms
  7   -2.317315974143      -11.29       -5.66    2.5    824ms
  8   -2.317315974143      -12.57       -6.31    2.8    671ms
  9   -2.317315974143      -14.15       -6.83    2.5    629ms
 10   -2.317315974143      -14.75       -7.40    2.5    686ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.46e-03
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.32e-05
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.95e-06
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.59e-08
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 6.19e-10
└ * number of operations = 6
[ Info: GMRES linsolve starts with norm of residual = 2.43e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.22e-03
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.43e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.05e-06
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 1.36e-08
└ * number of operations = 6
Al: 146.659513 seconds (154.70 M allocations: 84.803 GiB, 6.22% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T15:04:16.483
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.665217138117349)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.1188093046637456e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.78842683490                   -0.89    9.8    5.89s
  2   -73.79811439624       -2.01       -1.09    5.3    3.09s
  3   -73.80392851153       -2.24       -1.44    6.7    4.07s
  4   -73.80487145804       -3.03       -1.80    5.9    3.35s
  5   -73.80500760213       -3.87       -2.25    4.9    3.05s
  6   -73.80502746205       -4.70       -3.08    5.4    3.34s
  7   -73.80502748231       -7.69       -3.54    4.6    2.96s
  8   -73.80502748766       -8.27       -4.04    4.9    3.07s
  9   -73.80502748739   +   -9.58       -4.51    5.4    3.27s
 10   -73.80502748794       -9.26       -4.78    5.5    3.31s
 11   -73.80502748797      -10.43       -5.48    4.7    3.12s
 12   -73.80502748797      -11.73       -6.21    4.6    3.11s
 13   -73.80502748797      -13.37       -6.35    4.7    3.12s
 14   -73.80502748797   +  -13.07       -6.90    5.3    3.25s
 15   -73.80502748797   +  -12.85       -7.82    5.0    3.24s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1188093046637456e-8,4.450814840536995e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.380503e+01     7.730725e-08
 * time: 3.600120544433594e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.380503e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 7.73e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.1188093046637456e-8,4.450814840536995e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.1188093046637456e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.78842184790                   -0.89    9.8    5.46s
  2   -73.79812710603       -2.01       -1.09    5.3    3.09s
  3   -73.80392822013       -2.24       -1.44    6.8    3.92s
  4   -73.80487087733       -3.03       -1.80    5.6    3.27s
  5   -73.80500790422       -3.86       -2.25    4.9    2.85s
  6   -73.80502746280       -4.71       -3.08    5.5    3.39s
  7   -73.80502748262       -7.70       -3.53    4.4    2.93s
  8   -73.80502748764       -8.30       -4.02    4.7    2.82s
  9   -73.80502748739   +   -9.61       -4.49    5.3    3.12s
 10   -73.80502748794       -9.26       -4.76    5.5    3.22s
 11   -73.80502748797      -10.45       -5.46    4.7    2.94s
 12   -73.80502748797      -11.66       -6.18    4.6    3.01s
 13   -73.80502748798      -12.77       -6.34    4.7    2.86s
 14   -73.80502748797   +  -12.73       -6.90    5.4    3.12s
 15   -73.80502748797   +  -13.55       -7.81    5.0    3.19s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.35e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.01e+01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.12e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.14e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 5.32e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 4.37e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.43e-08
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}(Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.118809304707102e-8,4.4508148433387516e-8),Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(4.45081484453662e-8,3.6857979658451416e-6))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Computing cross-derivative ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.1188093046637456e-8,0.0,0.0)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.1188093046637456e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.78843417317                   -0.89    9.7    5.30s
  2   -73.79811198214       -2.01       -1.09    5.2    2.88s
  3   -73.80392833056       -2.24       -1.44    6.8    3.97s
  4   -73.80487123271       -3.03       -1.80    5.7    3.16s
  5   -73.80500794006       -3.86       -2.25    4.9    2.77s
  6   -73.80502746359       -4.71       -3.08    5.5    3.30s
  7   -73.80502748241       -7.73       -3.53    4.4    2.77s
  8   -73.80502748764       -8.28       -4.04    4.8    2.87s
  9   -73.80502748740   +   -9.63       -4.50    5.3    2.98s
 10   -73.80502748793       -9.27       -4.77    5.5    3.02s
 11   -73.80502748797      -10.42       -5.47    4.8    2.91s
 12   -73.80502748797      -11.64       -6.19    4.6    2.90s
 13   -73.80502748798      -13.37       -6.36    4.7    3.15s
 14   -73.80502748797   +  -12.57       -6.90    5.5    3.14s
 15   -73.80502748797   +  -13.25       -7.84    5.0    3.18s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.35e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 7.91e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.80e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.94e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 5.56e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 7.95e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 6.72e-10
└ * number of operations = 8
[ Info: GMRES linsolve starts with norm of residual = 4.98e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.53e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.51e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 8.86e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 9.05e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.95e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 2.98e-09
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}, KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.118809304707102e-8,0.0,0.0),Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(4.4508148439638037e-8,0.0,0.0))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
V: 795.450035 seconds (629.13 M allocations: 900.535 GiB, 7.24% gc time, 0.00% compilation time)
     1     1.845922e-04     1.218403e-03
 * Current step size: 1.0
 * time: 3240.0495879650116
 * g(x): (κ = 0.0006762881869965995, μ = 0.0012184033941027173)
 * ~inv(H): [21.539536430434584 37.00423312114963; 37.00423312114963 67.66688498310614]
 * x: (κ = 0.8033148300608075, μ = 0.2182832232996395)
┌ Info: 2025-05-20T15:17:32.022
└   θ = ComponentVector{Float64}(κ = 0.7436618127885448, μ = 0.11081213523916299)
┌ Info: 2025-05-20T15:17:32.022
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.334446541102897)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.416028939923                   -0.97    7.4    1.33s
  2   -8.418025567933       -2.70       -1.80    1.9    627ms
  3   -8.418109350570       -4.08       -2.88    4.1    936ms
  4   -8.418109935319       -6.23       -3.79    4.5    1.06s
  5   -8.418109945411       -8.00       -4.49    4.5    1.16s
  6   -8.418109945900       -9.31       -5.21    4.5    920ms
  7   -8.418109945913      -10.88       -6.00    3.7    888ms
  8   -8.418109945913      -12.37       -7.35    3.8    1.05s
Iter     Function value   Gradient norm 
     0    -8.418110e+00     6.485662e-03
 * time: 3.790855407714844e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.416082559948                   -0.97    7.5    1.52s
  2   -8.418073320210       -2.70       -1.80    2.1    642ms
  3   -8.418149977495       -4.12       -2.89    4.1    1.12s
  4   -8.418150543061       -6.25       -3.80    4.4    1.25s
  5   -8.418150552567       -8.02       -4.54    4.4    1.20s
  6   -8.418150552975       -9.39       -5.30    4.7    1.12s
  7   -8.418150552983      -11.06       -6.10    3.7    892ms
  8   -8.418150552984      -12.55       -7.38    3.7    1.13s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.416084186270                   -0.97    7.5    1.53s
  2   -8.418072912685       -2.70       -1.80    2.3    688ms
  3   -8.418149913179       -4.11       -2.88    4.0    1.19s
  4   -8.418150542798       -6.20       -3.80    4.5    951ms
  5   -8.418150552550       -8.01       -4.53    4.5    1.01s
  6   -8.418150552974       -9.37       -5.29    4.5    1.13s
  7   -8.418150552983      -11.04       -6.11    3.8    909ms
  8   -8.418150552984      -12.54       -7.33    3.7    1.42s
     1    -8.418151e+00     6.035984e-03
 * time: 27.91224694252014
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.416144527435                   -0.96    7.3    1.48s
  2   -8.418320782146       -2.66       -1.80    2.0    641ms
  3   -8.418404440054       -4.08       -2.86    4.0    1.02s
  4   -8.418405034853       -6.23       -3.80    4.4    1.15s
  5   -8.418405044192       -8.03       -4.52    4.2    966ms
  6   -8.418405044603       -9.39       -5.27    4.3    1.09s
  7   -8.418405044612      -11.02       -6.05    3.8    864ms
  8   -8.418405044613      -12.42       -7.40    3.7    935ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.416149339476                   -0.96    7.2    1.49s
  2   -8.418319089790       -2.66       -1.79    1.9    624ms
  3   -8.418404343955       -4.07       -2.86    4.1    1.20s
  4   -8.418405035261       -6.16       -3.78    4.4    925ms
  5   -8.418405044199       -8.05       -4.53    4.4    973ms
  6   -8.418405044603       -9.39       -5.27    4.5    1.12s
  7   -8.418405044612      -11.02       -5.99    3.6    869ms
  8   -8.418405044613      -12.33       -7.37    3.7    916ms
     2    -8.418405e+00     2.758213e-04
 * time: 54.81067109107971
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.416167012098                   -0.96    7.2    1.52s
  2   -8.418323007992       -2.67       -1.79    1.8    591ms
  3   -8.418404922217       -4.09       -2.86    4.0    984ms
  4   -8.418405538061       -6.21       -3.79    4.4    1.16s
  5   -8.418405547674       -8.02       -4.49    4.4    966ms
  6   -8.418405548112       -9.36       -5.23    4.4    963ms
  7   -8.418405548124      -10.92       -5.96    3.7    1.04s
  8   -8.418405548125      -12.29       -7.42    3.7    894ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.416164590498                   -0.96    7.3    1.31s
  2   -8.418320355203       -2.67       -1.79    1.8    805ms
  3   -8.418404818069       -4.07       -2.86    4.2    956ms
  4   -8.418405538227       -6.14       -3.78    4.5    1.03s
  5   -8.418405547714       -8.02       -4.52    4.2    1.11s
  6   -8.418405548115       -9.40       -5.28    4.5    940ms
  7   -8.418405548124      -11.03       -6.02    3.8    1.14s
  8   -8.418405548125      -12.40       -7.32    3.7    846ms
     3    -8.418406e+00     1.093866e-05
 * time: 81.76954698562622
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.416163755419                   -0.96    7.3    1.53s
  2   -8.418327988590       -2.66       -1.80    2.2    678ms
  3   -8.418404900726       -4.11       -2.87    4.0    1.15s
  4   -8.418405539486       -6.19       -3.79    4.3    951ms
  5   -8.418405548569       -8.04       -4.56    4.4    996ms
  6   -8.418405548912       -9.46       -5.34    4.7    1.12s
  7   -8.418405548919      -11.18       -6.09    3.8    918ms
  8   -8.418405548919      -12.55       -7.37    3.8    1.08s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.416160275975                   -0.96    7.2    1.51s
  2   -8.418322555840       -2.67       -1.79    2.0    644ms
  3   -8.418404914784       -4.08       -2.86    4.1    1.19s
  4   -8.418405539568       -6.20       -3.78    4.4    947ms
  5   -8.418405548514       -8.05       -4.54    4.3    983ms
  6   -8.418405548911       -9.40       -5.30    4.5    1.11s
  7   -8.418405548919      -11.08       -6.06    3.7    861ms
  8   -8.418405548919      -12.48       -7.36    3.7    916ms
     4    -8.418406e+00     1.882889e-08
 * time: 109.30260992050171
 * Status: success

 * Candidate solution
    Final objective value:     -8.418406e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.45e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.42e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 7.95e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 9.44e-11 ≰ 0.0e+00
    |g(x)|                 = 1.88e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   109  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

Si: 125.231855 seconds (251.13 M allocations: 72.316 GiB, 10.75% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T15:19:37.255
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.766240504974547)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.94723791495                   -1.18    9.3    8.33s
  2   -61.95070716827       -2.46       -1.26    3.5    4.23s
  3   -61.95406936312       -2.47       -2.12    5.0    4.99s
  4   -61.95408787389       -4.73       -2.72    4.7    4.94s
  5   -61.95408992326       -5.69       -3.49    4.0    4.60s
  6   -61.95408998988       -7.18       -4.45    5.6    5.47s
  7   -61.95408999026       -9.42       -4.97    5.1    7.70s
  8   -61.95408999029      -10.50       -6.50    4.2    4.71s
  9   -61.95408999029      -12.97       -7.24    6.2    5.97s
Iter     Function value   Gradient norm 
     0    -6.195409e+01     4.137945e-03
 * time: 3.910064697265625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.94727577437                   -1.18    9.3    9.93s
  2   -61.95074510051       -2.46       -1.26    3.6    3.85s
  3   -61.95408655865       -2.48       -2.12    5.5    5.18s
  4   -61.95410489563       -4.74       -2.72    4.7    4.99s
  5   -61.95410690437       -5.70       -3.49    4.0    4.60s
  6   -61.95410696995       -7.18       -4.45    5.5    5.36s
  7   -61.95410697031       -9.45       -5.02    5.2    5.30s
  8   -61.95410697034      -10.52       -6.57    4.7    4.93s
  9   -61.95410697034      -13.03       -7.24    6.3    6.18s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.94727712425                   -1.18    9.4    8.13s
  2   -61.95074733044       -2.46       -1.26    3.4    4.26s
  3   -61.95408651560       -2.48       -2.12    5.1    5.60s
  4   -61.95410491684       -4.74       -2.72    4.7    5.02s
  5   -61.95410690341       -5.70       -3.49    4.2    4.74s
  6   -61.95410696993       -7.18       -4.42    5.5    5.28s
  7   -61.95410697030       -9.44       -4.96    5.0    5.23s
  8   -61.95410697034      -10.39       -6.57    4.4    4.93s
  9   -61.95410697034      -12.75       -7.14    6.5    6.10s
     1    -6.195411e+01     4.068903e-03
 * time: 128.5201210975647
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.94835230728                   -1.19    9.8    8.07s
  2   -61.95173572891       -2.47       -1.28    3.6    3.76s
  3   -61.95453945602       -2.55       -2.15    5.1    4.87s
  4   -61.95455432458       -4.83       -2.78    4.8    4.82s
  5   -61.95455567766       -5.87       -3.50    4.0    4.52s
  6   -61.95455573224       -7.26       -4.46    5.2    5.14s
  7   -61.95455573252       -9.56       -4.99    4.8    5.08s
  8   -61.95455573255      -10.52       -6.75    4.4    4.67s
  9   -61.95455573255      -12.97       -7.43    6.7    6.25s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.94835362822                   -1.19    9.6    8.02s
  2   -61.95172832911       -2.47       -1.28    3.7    3.86s
  3   -61.95453954855       -2.55       -2.15    5.3    5.06s
  4   -61.95455434083       -4.83       -2.78    4.9    5.21s
  5   -61.95455567885       -5.87       -3.51    4.2    4.68s
  6   -61.95455573227       -7.27       -4.50    5.2    5.08s
  7   -61.95455573253       -9.59       -5.04    5.2    5.27s
  8   -61.95455573255      -10.66       -6.70    4.3    4.71s
  9   -61.95455573255      -13.30       -7.42    6.5    6.93s
     2    -6.195456e+01     5.910998e-04
 * time: 251.96414709091187
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.94828839264                   -1.19    8.8    8.58s
  2   -61.95168023267       -2.47       -1.28    3.2    5.32s
  3   -61.95454712243       -2.54       -2.15    4.8    4.85s
  4   -61.95456221791       -4.82       -2.77    4.8    4.94s
  5   -61.95456368926       -5.83       -3.50    4.1    4.52s
  6   -61.95456374485       -7.25       -4.46    5.2    5.19s
  7   -61.95456374514       -9.54       -4.97    5.0    5.13s
  8   -61.95456374517      -10.52       -6.64    4.2    4.64s
  9   -61.95456374517      -12.83       -7.44    6.3    5.98s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.94828926331                   -1.19    8.7    7.46s
  2   -61.95168626497       -2.47       -1.28    3.1    3.60s
  3   -61.95454704910       -2.54       -2.15    4.9    5.74s
  4   -61.95456223837       -4.82       -2.77    4.6    4.80s
  5   -61.95456368880       -5.84       -3.50    3.9    4.83s
  6   -61.95456374483       -7.25       -4.44    5.3    4.91s
  7   -61.95456374513       -9.52       -4.97    4.8    4.99s
  8   -61.95456374517      -10.48       -6.61    4.2    4.63s
  9   -61.95456374517      -13.03       -7.41    6.5    5.87s
     3    -6.195456e+01     6.933978e-05
 * time: 373.8386700153351
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.94829458282                   -1.19    9.4    8.19s
  2   -61.95168925586       -2.47       -1.28    3.6    3.88s
  3   -61.95454717744       -2.54       -2.15    5.1    5.00s
  4   -61.95456230486       -4.82       -2.76    4.6    5.22s
  5   -61.95456380345       -5.82       -3.49    4.2    4.70s
  6   -61.95456385925       -7.25       -4.44    5.3    5.43s
  7   -61.95456385956       -9.51       -4.99    4.9    5.32s
  8   -61.95456385959      -10.54       -6.63    4.5    6.07s
  9   -61.95456385959      -12.79       -7.38    6.3    6.08s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.94828967516                   -1.19    9.5    7.93s
  2   -61.95168117928       -2.47       -1.28    3.4    3.75s
  3   -61.95454733812       -2.54       -2.15    5.3    5.03s
  4   -61.95456228655       -4.83       -2.76    4.8    4.93s
  5   -61.95456380422       -5.82       -3.50    4.1    4.57s
  6   -61.95456385927       -7.26       -4.46    5.4    5.23s
  7   -61.95456385956       -9.53       -4.97    5.0    5.59s
  8   -61.95456385959      -10.54       -6.67    4.3    4.98s
  9   -61.95456385959      -13.85       -7.44    6.5    6.00s
     4    -6.195456e+01     1.023696e-06
 * time: 501.4996039867401
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.94829026284                   -1.19    9.5    8.00s
  2   -61.95168316056       -2.47       -1.28    3.6    3.89s
  3   -61.95454716259       -2.54       -2.15    5.5    5.15s
  4   -61.95456223443       -4.82       -2.75    4.7    4.90s
  5   -61.95456380285       -5.80       -3.49    4.1    4.41s
  6   -61.95456385926       -7.25       -4.43    5.5    5.07s
  7   -61.95456385958       -9.49       -4.95    5.0    5.19s
  8   -61.95456385962      -10.50       -6.66    4.3    4.90s
  9   -61.95456385962      -12.81       -7.42    6.5    6.03s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.94829138921                   -1.19    9.5    7.96s
  2   -61.95170374143       -2.47       -1.28    3.5    3.81s
  3   -61.95454715225       -2.55       -2.15    5.3    5.05s
  4   -61.95456235485       -4.82       -2.77    4.6    4.93s
  5   -61.95456380286       -5.84       -3.49    4.0    4.55s
  6   -61.95456385927       -7.25       -4.42    5.3    5.14s
  7   -61.95456385958       -9.50       -5.01    4.8    5.18s
  8   -61.95456385962      -10.46       -6.64    4.6    4.80s
  9   -61.95456385962      -13.00       -7.35    6.4    5.97s
     5    -6.195456e+01     1.129463e-08
 * time: 623.9936020374298
 * Status: success

 * Candidate solution
    Final objective value:     -6.195456e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 4.87e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.61e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.63e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 4.25e-13 ≰ 0.0e+00
    |g(x)|                 = 1.13e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   624  (vs limit Inf)
    Iterations:    5
    f(x) calls:    6
    ∇f(x) calls:   6

NaCl: 698.272401 seconds (1.17 G allocations: 409.455 GiB, 6.56% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T15:31:15.528
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.6326259911927)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.310926869611                   -1.43    5.7    1.25s
  2   -2.311074550495       -3.83       -1.83    1.6    481ms
  3   -2.311111314935       -4.43       -3.42    3.6    807ms
  4   -2.311111621627       -6.51       -3.92    4.5    1.09s
  5   -2.311111622407       -9.11       -4.38    2.6    748ms
  6   -2.311111622585       -9.75       -4.89    2.7    812ms
  7   -2.311111622610      -10.59       -5.97    3.2    861ms
  8   -2.311111622610      -12.58       -6.52    3.6    941ms
  9   -2.311111622610      -14.75       -7.20    2.2    770ms
Iter     Function value   Gradient norm 
     0    -2.311112e+00     3.409953e-03
 * time: 2.9802322387695312e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.310938224193                   -1.43    5.6    1.20s
  2   -2.311085154842       -3.83       -1.83    1.6    645ms
  3   -2.311122777350       -4.42       -3.40    3.6    807ms
  4   -2.311123010870       -6.63       -3.89    4.4    1.10s
  5   -2.311123011764       -9.05       -4.38    2.7    641ms
  6   -2.311123011935       -9.77       -4.88    2.7    634ms
  7   -2.311123011962      -10.58       -5.95    3.0    846ms
  8   -2.311123011962      -12.51       -6.49    3.5    729ms
  9   -2.311123011962      -14.45       -7.18    2.0    521ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.310933500795                   -1.43    5.6    1.06s
  2   -2.311084491091       -3.82       -1.83    1.5    588ms
  3   -2.311122734106       -4.42       -3.39    3.6    1.14s
  4   -2.311123010818       -6.56       -3.88    4.4    914ms
  5   -2.311123011759       -9.03       -4.37    2.5    643ms
  6   -2.311123011934       -9.75       -4.87    2.7    830ms
  7   -2.311123011962      -10.56       -5.95    2.9    646ms
  8   -2.311123011962      -12.53       -6.50    3.6    778ms
  9   -2.311123011962      -14.57       -7.19    2.1    772ms
     1    -2.311123e+00     3.270001e-03
 * time: 40.80232501029968
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.311056675134                   -1.43    5.2    1.29s
  2   -2.311204565655       -3.83       -1.83    1.4    601ms
  3   -2.311240744400       -4.44       -3.50    3.4    1.03s
  4   -2.311241014655       -6.57       -4.18    4.3    879ms
  5   -2.311241014974       -9.50       -4.63    2.5    636ms
  6   -2.311241015055      -10.09       -5.44    2.8    700ms
  7   -2.311241015057      -11.73       -6.28    3.2    945ms
  8   -2.311241015057      -13.35       -7.17    3.3    876ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.311063127851                   -1.43    5.3    1.25s
  2   -2.311205799989       -3.85       -1.83    1.4    494ms
  3   -2.311240777262       -4.46       -3.50    3.4    818ms
  4   -2.311241014643       -6.62       -4.19    4.4    1.14s
  5   -2.311241014973       -9.48       -4.62    2.5    617ms
  6   -2.311241015055      -10.08       -5.44    2.8    689ms
  7   -2.311241015057      -11.72       -6.31    3.3    956ms
  8   -2.311241015057      -13.42       -7.18    3.3    749ms
     2    -2.311241e+00     4.848379e-04
 * time: 80.8605809211731
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.311061731652                   -1.43    5.4    1.14s
  2   -2.311206755550       -3.84       -1.83    1.5    508ms
  3   -2.311242962823       -4.44       -3.47    3.4    953ms
  4   -2.311243215833       -6.60       -4.17    4.4    949ms
  5   -2.311243216139       -9.52       -4.64    2.7    693ms
  6   -2.311243216213      -10.13       -5.42    2.9    888ms
  7   -2.311243216215      -11.70       -6.25    3.3    744ms
  8   -2.311243216215      -13.32       -7.16    3.4    788ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.311059156690                   -1.43    5.5    1.07s
  2   -2.311205886371       -3.83       -1.83    1.4    589ms
  3   -2.311242941346       -4.43       -3.46    3.4    1.16s
  4   -2.311243215817       -6.56       -4.16    4.4    1.16s
  5   -2.311243216135       -9.50       -4.62    2.7    747ms
  6   -2.311243216213      -10.11       -5.41    2.9    865ms
  7   -2.311243216215      -11.69       -6.23    3.2    846ms
  8   -2.311243216215      -13.33       -7.13    3.4    748ms
     3    -2.311243e+00     5.532047e-05
 * time: 121.4148678779602
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.311062807623                   -1.43    5.6    1.20s
  2   -2.311206987247       -3.84       -1.83    1.5    538ms
  3   -2.311243005647       -4.44       -3.48    3.6    965ms
  4   -2.311243245229       -6.62       -4.17    4.5    1.10s
  5   -2.311243245535       -9.51       -4.63    2.6    786ms
  6   -2.311243245612      -10.11       -5.42    2.9    767ms
  7   -2.311243245614      -11.70       -6.26    3.4    934ms
  8   -2.311243245614      -13.36       -7.20    3.4    802ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.311065405943                   -1.43    5.6    1.22s
  2   -2.311206800997       -3.85       -1.83    1.5    563ms
  3   -2.311243010460       -4.44       -3.47    3.6    941ms
  4   -2.311243245222       -6.63       -4.16    4.5    1.10s
  5   -2.311243245534       -9.51       -4.63    2.7    749ms
  6   -2.311243245612      -10.11       -5.42    2.9    942ms
  7   -2.311243245614      -11.63       -6.27    3.4    1.06s
  8   -2.311243245614      -13.36       -7.20    3.3    768ms
     4    -2.311243e+00     4.546243e-07
 * time: 162.808091878891
 * Status: success

 * Candidate solution
    Final objective value:     -2.311243e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.05e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.39e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.94e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.27e-08 ≰ 0.0e+00
    |g(x)|                 = 4.55e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   163  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

Al: 188.685992 seconds (170.70 M allocations: 48.041 GiB, 5.81% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T15:34:24.215
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.665217138117349)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.1188093046637456e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.57425037112                   -0.80    9.9    5.65s
  2   -73.59161026010       -1.76       -1.01    5.6    3.14s
  3   -73.59971104940       -2.09       -1.33    7.0    3.90s
  4   -73.60132512364       -2.79       -1.76    6.1    3.29s
  5   -73.60148024941       -3.81       -2.18    5.1    2.98s
  6   -73.60150568668       -4.59       -3.05    5.5    3.24s
  7   -73.60150574637       -7.22       -3.56    4.8    3.03s
  8   -73.60150575866       -7.91       -4.17    5.7    3.53s
  9   -73.60150575840   +   -9.58       -4.51    5.0    3.53s
 10   -73.60150575911       -9.15       -5.09    5.4    3.30s
 11   -73.60150575911      -11.21       -6.04    5.4    3.41s
 12   -73.60150575911      -11.92       -6.62    5.6    3.53s
 13   -73.60150575911      -13.37       -6.76    5.2    3.20s
 14   -73.60150575911   +  -12.42       -7.58    5.6    3.18s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1188093046637456e-8,4.450814840536995e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.360151e+01     1.423079e-02
 * time: 3.3855438232421875e-5
┌ Warning: Negative ρcore detected: -3.1432462728093165e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.57482849048                   -0.80    9.7    5.84s
  2   -73.59192816618       -1.77       -1.01    5.6    3.24s
  3   -73.59993013163       -2.10       -1.33    6.9    4.11s
  4   -73.60151422075       -2.80       -1.76    6.1    3.47s
  5   -73.60167106250       -3.80       -2.21    5.1    3.11s
  6   -73.60169267739       -4.67       -3.06    5.6    3.46s
  7   -73.60169276010       -7.08       -3.57    5.0    3.23s
  8   -73.60169277501       -7.83       -4.20    5.7    3.47s
  9   -73.60169277452   +   -9.31       -4.47    4.9    3.62s
 10   -73.60169277548       -9.02       -4.98    5.6    3.34s
 11   -73.60169277549      -10.88       -5.96    5.3    3.32s
 12   -73.60169277549   +  -12.55       -6.47    4.3    2.88s
 13   -73.60169277549   +  -13.25       -6.52    5.1    3.12s
 14   -73.60169277549   +  -12.18       -7.59    5.1    2.99s
┌ Warning: Negative ρcore detected: -3.1432462728093165e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.57483692682                   -0.80    9.9    7.67s
  2   -73.59189766408       -1.77       -1.01    5.5    4.47s
  3   -73.59993508092       -2.09       -1.33    7.0    4.65s
  4   -73.60151299601       -2.80       -1.76    6.0    4.67s
  5   -73.60167137292       -3.80       -2.21    5.2    3.01s
  6   -73.60169269052       -4.67       -3.06    5.5    3.26s
  7   -73.60169276384       -7.13       -3.56    5.1    3.09s
  8   -73.60169277502       -7.95       -4.20    5.6    3.30s
  9   -73.60169277469   +   -9.49       -4.50    4.9    3.06s
 10   -73.60169277548       -9.11       -4.96    5.5    3.12s
 11   -73.60169277550      -10.82       -5.91    5.3    3.18s
 12   -73.60169277549   +  -12.06       -6.48    4.8    3.03s
 13   -73.60169277549      -12.94       -6.49    3.9    3.04s
 14   -73.60169277549   +  -12.11       -7.54    5.0    2.93s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1432462728093165e-8,-1.1274860131960945e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     1    -7.360169e+01     1.204724e-02
 * time: 158.0638918876648
┌ Warning: Negative ρcore detected: -3.327972402320003e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.57796641224                   -0.81    9.8    5.84s
  2   -73.59266536902       -1.83       -1.01    5.4    3.40s
  3   -73.60044554497       -2.11       -1.33    6.7    4.11s
  4   -73.60186142692       -2.85       -1.67    5.8    3.31s
  5   -73.60213784286       -3.56       -2.50    5.5    3.19s
  6   -73.60214122335       -5.47       -3.09    5.6    3.44s
  7   -73.60214123256       -8.04       -3.60    4.7    3.51s
  8   -73.60214124160       -8.04       -3.96    5.0    3.09s
  9   -73.60214124337       -8.75       -4.58    5.7    3.36s
 10   -73.60214124386       -9.31       -4.78    5.4    3.28s
 11   -73.60214124395      -10.04       -5.41    4.9    3.04s
 12   -73.60214124396      -10.98       -6.27    5.2    3.24s
 13   -73.60214124396   +  -13.55       -6.78    4.6    3.00s
 14   -73.60214124396      -13.85       -7.18    3.5    2.46s
┌ Warning: Negative ρcore detected: -3.327972402320003e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.57795850559                   -0.81    9.7    5.24s
  2   -73.59266685337       -1.83       -1.01    5.4    3.02s
  3   -73.60044639100       -2.11       -1.33    6.8    4.04s
  4   -73.60186085260       -2.85       -1.67    5.9    3.46s
  5   -73.60213776960       -3.56       -2.50    5.4    3.18s
  6   -73.60214122298       -5.46       -3.09    5.4    3.36s
  7   -73.60214123206       -8.04       -3.60    4.6    2.71s
  8   -73.60214124146       -8.03       -3.96    5.0    2.99s
  9   -73.60214124338       -8.72       -4.58    5.7    3.33s
 10   -73.60214124386       -9.32       -4.79    5.4    3.05s
 11   -73.60214124395      -10.06       -5.41    4.9    2.92s
 12   -73.60214124396      -10.98       -6.25    5.2    3.22s
 13   -73.60214124396      -13.15       -6.78    4.7    3.03s
 14   -73.60214124396   +  -13.55       -7.17    3.5    2.44s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.327972402320003e-8,-9.936358262615019e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     2    -7.360214e+01     8.728095e-04
 * time: 306.15339398384094
┌ Warning: Negative ρcore detected: -3.3727718198800915e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.57780215112                   -0.81    9.8    5.72s
  2   -73.59262060220       -1.83       -1.01    5.6    3.17s
  3   -73.60044028844       -2.11       -1.33    6.9    4.08s
  4   -73.60186033474       -2.85       -1.67    5.8    3.33s
  5   -73.60213967955       -3.55       -2.49    5.5    3.19s
  6   -73.60214341972       -5.43       -3.09    5.5    3.40s
  7   -73.60214342497       -8.28       -3.60    4.9    3.08s
  8   -73.60214343590       -7.96       -3.95    5.0    3.02s
  9   -73.60214343835       -8.61       -4.58    5.7    4.32s
 10   -73.60214343884       -9.31       -4.81    5.4    3.36s
 11   -73.60214343892      -10.09       -5.45    5.0    3.08s
 12   -73.60214343893      -11.06       -6.30    5.3    3.33s
 13   -73.60214343893      -13.85       -6.79    4.3    2.84s
 14   -73.60214343893   +  -13.07       -7.23    4.0    2.61s
┌ Warning: Negative ρcore detected: -3.3727718198800915e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.57780115485                   -0.81    9.8    5.83s
  2   -73.59262278658       -1.83       -1.01    5.4    3.16s
  3   -73.60043991142       -2.11       -1.33    6.8    4.02s
  4   -73.60185997759       -2.85       -1.67    5.9    3.35s
  5   -73.60213969051       -3.55       -2.50    5.4    3.22s
  6   -73.60214341844       -5.43       -3.09    5.6    3.44s
  7   -73.60214342624       -8.11       -3.59    4.8    3.02s
  8   -73.60214343632       -8.00       -3.95    5.0    3.03s
  9   -73.60214343829       -8.70       -4.58    5.7    3.33s
 10   -73.60214343884       -9.26       -4.80    5.5    3.59s
 11   -73.60214343892      -10.11       -5.41    5.0    3.04s
 12   -73.60214343893      -10.97       -6.28    5.2    3.20s
 13   -73.60214343893      -13.25       -6.77    4.9    3.12s
 14   -73.60214343893   +    -Inf       -7.16    4.0    2.62s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.3727718198800915e-8,-6.973421181980485e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     3    -7.360214e+01     4.416298e-05
 * time: 456.5923218727112
┌ Warning: Negative ρcore detected: -3.370972489098436e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.57781716806                   -0.81    9.8    8.05s
  2   -73.59261319573       -1.83       -1.01    5.5    3.18s
  3   -73.60044181826       -2.11       -1.33    6.8    3.88s
  4   -73.60186035193       -2.85       -1.67    5.8    3.20s
  5   -73.60213958657       -3.55       -2.49    5.5    3.10s
  6   -73.60214342410       -5.42       -3.08    5.5    3.32s
  7   -73.60214343275       -8.06       -3.60    4.8    2.85s
  8   -73.60214344215       -8.03       -3.96    5.0    2.87s
  9   -73.60214344400       -8.73       -4.59    5.8    3.24s
 10   -73.60214344451       -9.29       -4.80    5.5    3.21s
 11   -73.60214344459      -10.10       -5.43    5.0    2.92s
 12   -73.60214344460      -11.00       -6.32    5.2    3.18s
 13   -73.60214344460   +  -13.37       -6.78    4.7    2.87s
 14   -73.60214344460   +  -13.55       -7.18    3.4    2.25s
┌ Warning: Negative ρcore detected: -3.370972489098436e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.57781231295                   -0.81    9.8    5.60s
  2   -73.59262611244       -1.83       -1.01    5.6    3.16s
  3   -73.60044121941       -2.11       -1.33    6.9    3.93s
  4   -73.60185913908       -2.85       -1.67    5.9    3.24s
  5   -73.60213951197       -3.55       -2.49    5.5    3.14s
  6   -73.60214342413       -5.41       -3.09    5.5    3.38s
  7   -73.60214343211       -8.10       -3.60    4.8    3.03s
  8   -73.60214344194       -8.01       -3.95    5.0    3.02s
  9   -73.60214344401       -8.69       -4.59    5.8    3.33s
 10   -73.60214344450       -9.30       -4.80    5.5    3.37s
 11   -73.60214344458      -10.09       -5.42    4.9    2.85s
 12   -73.60214344460      -10.98       -6.29    5.2    3.29s
 13   -73.60214344460      -13.55       -6.78    4.7    3.05s
 14   -73.60214344460   +  -13.85       -7.17    3.2    2.30s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.370972489098436e-8,-7.113731542609938e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     4    -7.360214e+01     1.404627e-07
 * time: 606.9886050224304
 * Status: success

 * Candidate solution
    Final objective value:     -7.360214e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.55e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.58e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 5.66e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 7.69e-11 ≰ 0.0e+00
    |g(x)|                 = 1.40e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   607  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

V: 694.476370 seconds (608.14 M allocations: 349.318 GiB, 8.35% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T15:45:58.693
└   θ = ComponentVector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}(κ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.7436618127885448,1.0,0.0), μ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.11081213523916299,0.0,1.0))
┌ Info: 2025-05-20T15:45:58.699
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.244563725900377)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.416149467301                   -0.96    7.3    1.36s
  2   -8.418320761176       -2.66       -1.79    2.0    852ms
  3   -8.418404955220       -4.07       -2.86    4.1    931ms
  4   -8.418405538702       -6.23       -3.79    4.4    976ms
  5   -8.418405548487       -8.01       -4.51    4.3    1.08s
  6   -8.418405548908       -9.38       -5.25    4.5    881ms
  7   -8.418405548919      -10.97       -6.03    3.8    909ms
  8   -8.418405548919      -12.42       -7.37    3.7    972ms
Iter     Function value   Gradient norm 
     0    -8.418406e+00     1.949516e-08
 * time: 3.695487976074219e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.418406e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.95e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.416166329470                   -0.96    7.3    1.45s
  2   -8.418324629916       -2.67       -1.80    2.0    636ms
  3   -8.418404908283       -4.10       -2.86    4.1    991ms
  4   -8.418405539624       -6.20       -3.79    4.5    1.12s
  5   -8.418405548527       -8.05       -4.55    4.4    908ms
  6   -8.418405548912       -9.42       -5.32    4.7    939ms
  7   -8.418405548919      -11.15       -6.07    3.8    1.03s
  8   -8.418405548919      -12.45       -7.36    3.7    843ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.17e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.52e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.90e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 9.54e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 3.02e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 7.26e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.62e-09
└ * number of operations = 8
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.416158062160                   -0.96    7.2    1.27s
  2   -8.418323024626       -2.66       -1.79    2.2    643ms
  3   -8.418404767879       -4.09       -2.86    4.0    1.09s
  4   -8.418405540115       -6.11       -3.78    4.4    1.14s
  5   -8.418405548557       -8.07       -4.56    4.5    944ms
  6   -8.418405548913       -9.45       -5.35    4.7    1.07s
  7   -8.418405548919      -11.20       -6.06    3.8    863ms
  8   -8.418405548919      -12.52       -7.33    3.6    868ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.23e-02
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.57e-03
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.23e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 7.99e-06
[ Info: GMRES linsolve in iteration 1; step 4: normres = 2.92e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 6.64e-09
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 1.24e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 8.10e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.62e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.56e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 5.76e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.20e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 1.99e-09
└ * number of operations = 8
Si: 167.779215 seconds (250.74 M allocations: 203.694 GiB, 9.30% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T15:48:46.479
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.545876316281015)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.94829282404                   -1.19    9.5    7.98s
  2   -61.95167919801       -2.47       -1.28    3.5    3.76s
  3   -61.95454731714       -2.54       -2.15    5.4    4.76s
  4   -61.95456233087       -4.82       -2.77    4.9    5.01s
  5   -61.95456380434       -5.83       -3.50    4.2    4.70s
  6   -61.95456385929       -7.26       -4.47    5.6    5.23s
  7   -61.95456385959       -9.52       -4.98    5.3    5.32s
  8   -61.95456385962      -10.59       -6.64    4.2    4.67s
  9   -61.95456385962      -12.94       -7.46    6.4    6.00s
Iter     Function value   Gradient norm 
     0    -6.195456e+01     1.094585e-09
 * time: 4.315376281738281e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.195456e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.09e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.94828929859                   -1.19    9.4    10.1s
  2   -61.95168390935       -2.47       -1.28    3.6    3.95s
  3   -61.95454724530       -2.54       -2.15    5.2    6.09s
  4   -61.95456228229       -4.82       -2.76    4.8    4.95s
  5   -61.95456380424       -5.82       -3.50    4.2    4.58s
  6   -61.95456385930       -7.26       -4.46    5.6    5.40s
  7   -61.95456385959       -9.54       -4.99    5.0    4.99s
  8   -61.95456385962      -10.58       -6.56    4.3    4.63s
  9   -61.95456385962      -13.15       -7.34    6.4    5.69s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.14e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.96e+00
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.78e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.24e-02
[ Info: GMRES linsolve in iteration 1; step 4: normres = 5.50e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.65e-05
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.37e-06
[ Info: GMRES linsolve in iteration 1; step 7: normres = 5.36e-08
┌ Info: GMRES linsolve converged at iteration 1, step 8:
│ * norm of residual = 1.35e-08
└ * number of operations = 10
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.94828945741                   -1.19    9.7    8.05s
  2   -61.95169671947       -2.47       -1.28    3.3    3.85s
  3   -61.95454710317       -2.55       -2.15    5.4    4.88s
  4   -61.95456229106       -4.82       -2.76    4.7    4.91s
  5   -61.95456380290       -5.82       -3.49    4.0    4.58s
  6   -61.95456385926       -7.25       -4.42    5.2    5.05s
  7   -61.95456385959       -9.49       -5.00    4.7    4.84s
  8   -61.95456385962      -10.51       -6.59    4.5    4.75s
  9   -61.95456385962      -12.94       -7.36    6.4    5.96s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 3.46e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 8.13e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.62e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.43e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 7.32e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 3.69e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 2.34e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 8.51e-09
└ * number of operations = 9
[ Info: GMRES linsolve starts with norm of residual = 4.64e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 7.37e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.93e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.18e-02
[ Info: GMRES linsolve in iteration 1; step 4: normres = 6.56e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 3.27e-05
[ Info: GMRES linsolve in iteration 1; step 6: normres = 2.01e-06
[ Info: GMRES linsolve in iteration 1; step 7: normres = 5.74e-08
┌ Info: GMRES linsolve converged at iteration 1, step 8:
│ * norm of residual = 7.11e-09
└ * number of operations = 10
NaCl: 1275.412425 seconds (977.25 M allocations: 1.340 TiB, 4.55% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T16:10:01.893
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.558776261791354)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.311065911251                   -1.43    5.6    1.26s
  2   -2.311207236472       -3.85       -1.83    1.5    479ms
  3   -2.311243045071       -4.45       -3.48    3.5    798ms
  4   -2.311243245247       -6.70       -4.18    4.5    1.09s
  5   -2.311243245541       -9.53       -4.65    2.7    622ms
  6   -2.311243245612      -10.15       -5.44    2.8    660ms
  7   -2.311243245614      -11.68       -6.29    3.3    890ms
  8   -2.311243245614      -13.39       -7.22    3.5    743ms
Iter     Function value   Gradient norm 
     0    -2.311243e+00     4.552753e-07
 * time: 2.5033950805664062e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.311243e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 4.55e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.311063565303                   -1.43    5.6    1.32s
  2   -2.311206776999       -3.84       -1.83    1.5    498ms
  3   -2.311242977528       -4.44       -3.47    3.5    822ms
  4   -2.311243245241       -6.57       -4.17    4.4    1.16s
  5   -2.311243245538       -9.53       -4.64    2.8    645ms
  6   -2.311243245612      -10.13       -5.42    2.9    671ms
  7   -2.311243245614      -11.70       -6.24    3.4    786ms
  8   -2.311243245614      -13.37       -7.17    3.4    988ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.48e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.67e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.59e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.12e-06
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 3.18e-08
└ * number of operations = 6
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.311060430884                   -1.43    5.5    1.16s
  2   -2.311207083795       -3.83       -1.83    1.7    722ms
  3   -2.311243033208       -4.44       -3.49    3.6    796ms
  4   -2.311243245236       -6.67       -4.19    4.5    945ms
  5   -2.311243245535       -9.53       -4.63    2.8    651ms
  6   -2.311243245612      -10.11       -5.44    3.0    872ms
  7   -2.311243245614      -11.74       -6.31    3.4    718ms
  8   -2.311243245614      -13.44       -7.20    3.5    764ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 7.48e-04
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.08e-05
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.05e-06
┌ Info: GMRES linsolve converged at iteration 1, step 3:
│ * norm of residual = 8.35e-09
└ * number of operations = 5
[ Info: GMRES linsolve starts with norm of residual = 2.04e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.37e-03
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.64e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.66e-06
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 1.06e-08
└ * number of operations = 6
Al: 144.631621 seconds (145.32 M allocations: 79.653 GiB, 6.78% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T16:12:26.525
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.577519664810659)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.370972489098436e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.57781152499                   -0.81    9.8    5.81s
  2   -73.59262692974       -1.83       -1.01    5.5    3.17s
  3   -73.60043944995       -2.11       -1.33    6.9    4.09s
  4   -73.60186023154       -2.85       -1.67    5.8    3.35s
  5   -73.60213964273       -3.55       -2.49    5.4    4.31s
  6   -73.60214342405       -5.42       -3.09    5.5    4.00s
  7   -73.60214343186       -8.11       -3.59    4.7    2.96s
  8   -73.60214344191       -8.00       -3.95    5.0    3.04s
  9   -73.60214344401       -8.68       -4.59    5.7    3.36s
 10   -73.60214344451       -9.30       -4.80    5.5    3.34s
 11   -73.60214344458      -10.12       -5.42    4.9    3.01s
 12   -73.60214344460      -10.98       -6.27    5.2    3.25s
 13   -73.60214344460      -13.37       -6.79    4.8    3.07s
 14   -73.60214344460   +  -13.85       -7.16    3.4    2.37s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.370972489098436e-8,-7.113731542609938e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.360214e+01     1.405173e-07
 * time: 3.4809112548828125e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.360214e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.41e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.370972489098436e-8,-7.113731542609938e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.370972489098436e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.57781042798                   -0.81    9.8    5.76s
  2   -73.59262772104       -1.83       -1.01    5.5    3.13s
  3   -73.60043994109       -2.11       -1.33    6.9    3.97s
  4   -73.60186029469       -2.85       -1.67    5.9    3.38s
  5   -73.60213967232       -3.55       -2.49    5.4    3.01s
  6   -73.60214342462       -5.43       -3.09    5.4    3.35s
  7   -73.60214343200       -8.13       -3.60    4.8    2.95s
  8   -73.60214344188       -8.01       -3.95    4.9    2.99s
  9   -73.60214344402       -8.67       -4.59    5.7    3.09s
 10   -73.60214344451       -9.32       -4.80    5.4    3.30s
 11   -73.60214344459      -10.10       -5.43    4.9    3.01s
 12   -73.60214344460      -11.01       -6.29    5.2    3.15s
 13   -73.60214344460   +    -Inf       -6.79    4.8    2.75s
 14   -73.60214344460   +  -13.85       -7.19    3.7    2.42s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.42e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.00e+01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.60e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.15e-02
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.76e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 3.47e-06
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 6.12e-08
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}(Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.370972502304206e-8,-7.113731551257986e-8),Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-7.113731551257986e-8,5.497353989056186e-6))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Computing cross-derivative ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.370972489098436e-8,0.0,0.0)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.370972489098436e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.57780213082                   -0.81    9.8    5.29s
  2   -73.59261390892       -1.83       -1.01    5.5    2.90s
  3   -73.60044197723       -2.11       -1.33    6.9    3.85s
  4   -73.60186081829       -2.85       -1.67    5.8    3.17s
  5   -73.60213969360       -3.55       -2.50    5.4    2.90s
  6   -73.60214342434       -5.43       -3.09    5.5    3.52s
  7   -73.60214343263       -8.08       -3.60    4.7    3.04s
  8   -73.60214344209       -8.02       -3.96    5.0    2.85s
  9   -73.60214344401       -8.72       -4.59    5.8    3.07s
 10   -73.60214344450       -9.31       -4.80    5.4    3.25s
 11   -73.60214344458      -10.08       -5.42    5.0    2.93s
 12   -73.60214344460      -10.97       -6.28    5.2    3.06s
 13   -73.60214344460   +  -13.55       -6.77    4.8    3.06s
 14   -73.60214344460      -13.37       -7.15    3.8    2.53s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.57e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.02e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.18e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.25e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 5.52e-06
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 4.78e-08
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 6.13e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.89e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.74e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 7.67e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 3.63e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 7.12e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 9.44e-09
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}, KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.370972502304206e-8,0.0,0.0),Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-7.113731551257986e-8,0.0,0.0))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
V: 729.968122 seconds (594.19 M allocations: 810.749 GiB, 7.19% gc time, 0.00% compilation time)
     2     1.513202e-04     1.749555e-03
 * Current step size: 1.0
 * time: 7264.522779941559
 * g(x): (κ = -3.157970839325057e-5, μ = -0.0017495550514538892)
 * ~inv(H): [10.87198375112073 17.50600285304877; 17.50600285304877 32.03520278612564]
 * x: (κ = 0.7436618127885448, μ = 0.11081213523916299)
┌ Info: 2025-05-20T16:24:36.495
└   θ = ComponentVector{Float64}(κ = 0.7746328625873791, μ = 0.16741232056320948)
┌ Info: 2025-05-20T16:24:36.495
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.244563725900377)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.439291587110                   -0.95    7.2    1.28s
  2   -8.441289969094       -2.70       -1.76    2.1    617ms
  3   -8.441359298969       -4.16       -2.84    3.9    918ms
  4   -8.441360170631       -6.06       -3.74    4.5    967ms
  5   -8.441360186858       -7.79       -4.59    4.5    1.10s
  6   -8.441360187373       -9.29       -5.46    5.1    1.01s
  7   -8.441360187376      -11.51       -6.40    3.8    1.10s
  8   -8.441360187376      -13.13       -7.39    4.0    874ms
Iter     Function value   Gradient norm 
     0    -8.441360e+00     3.592999e-03
 * time: 3.695487976074219e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.439333747353                   -0.96    7.3    1.47s
  2   -8.441301573149       -2.71       -1.76    2.1    628ms
  3   -8.441371766949       -4.15       -2.83    4.1    1.11s
  4   -8.441372591661       -6.08       -3.75    4.5    946ms
  5   -8.441372608692       -7.77       -4.52    4.7    1.08s
  6   -8.441372609328       -9.20       -5.32    4.8    1.07s
  7   -8.441372609335      -11.16       -6.22    3.9    882ms
  8   -8.441372609335      -12.81       -7.36    3.9    1.08s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.439337737082                   -0.96    7.4    1.44s
  2   -8.441302906179       -2.71       -1.76    2.1    637ms
  3   -8.441371725910       -4.16       -2.84    4.0    1.11s
  4   -8.441372591434       -6.06       -3.73    4.7    991ms
  5   -8.441372608782       -7.76       -4.56    4.6    953ms
  6   -8.441372609330       -9.26       -5.40    4.9    1.12s
  7   -8.441372609335      -11.36       -6.26    3.9    872ms
  8   -8.441372609335      -12.94       -7.34    3.9    923ms
     1    -8.441373e+00     3.321685e-03
 * time: 26.50759792327881
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.439453162656                   -0.96    7.1    1.43s
  2   -8.441374073648       -2.72       -1.76    2.1    648ms
  3   -8.441445968960       -4.14       -2.85    3.9    985ms
  4   -8.441446761767       -6.10       -3.77    4.5    1.17s
  5   -8.441446778822       -7.77       -4.52    4.6    1.05s
  6   -8.441446779457       -9.20       -5.33    4.8    1.10s
  7   -8.441446779464      -11.13       -6.20    3.9    872ms
  8   -8.441446779464      -12.80       -7.38    3.8    904ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.439468411296                   -0.96    7.0    1.41s
  2   -8.441375029759       -2.72       -1.76    2.1    641ms
  3   -8.441445896011       -4.15       -2.85    3.8    1.09s
  4   -8.441446762706       -6.06       -3.76    4.5    952ms
  5   -8.441446778855       -7.79       -4.54    4.6    966ms
  6   -8.441446779458       -9.22       -5.37    4.8    1.10s
  7   -8.441446779464      -11.23       -6.28    4.0    890ms
  8   -8.441446779464      -12.97       -7.36    3.8    931ms
     2    -8.441447e+00     7.286394e-05
 * time: 53.81669092178345
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.439463473508                   -0.96    7.2    1.50s
  2   -8.441375060716       -2.72       -1.76    2.0    629ms
  3   -8.441446072993       -4.15       -2.85    3.8    1.13s
  4   -8.441446798016       -6.14       -3.77    4.5    932ms
  5   -8.441446815572       -7.76       -4.54    4.6    976ms
  6   -8.441446816151       -9.24       -5.35    5.0    1.13s
  7   -8.441446816157      -11.20       -6.23    3.8    878ms
  8   -8.441446816157      -12.83       -7.36    3.8    909ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.439456969900                   -0.96    7.2    1.45s
  2   -8.441372527784       -2.72       -1.76    2.0    621ms
  3   -8.441445956753       -4.13       -2.85    4.0    1.11s
  4   -8.441446798300       -6.07       -3.76    4.5    952ms
  5   -8.441446815584       -7.76       -4.55    4.7    990ms
  6   -8.441446816151       -9.25       -5.36    4.8    1.11s
  7   -8.441446816157      -11.20       -6.25    3.7    875ms
  8   -8.441446816157      -12.91       -7.35    3.8    936ms
     3    -8.441447e+00     1.529210e-06
 * time: 80.38560509681702
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.439467337327                   -0.96    7.0    1.45s
  2   -8.441375799266       -2.72       -1.76    2.1    616ms
  3   -8.441445942574       -4.15       -2.84    3.8    917ms
  4   -8.441446799007       -6.07       -3.76    4.5    1.13s
  5   -8.441446815559       -7.78       -4.53    4.5    950ms
  6   -8.441446816166       -9.22       -5.33    4.8    1.20s
  7   -8.441446816173      -11.11       -6.17    3.7    839ms
  8   -8.441446816174      -12.81       -7.37    3.8    874ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.439460232874                   -0.96    7.1    1.32s
  2   -8.441371237332       -2.72       -1.76    2.1    845ms
  3   -8.441445859778       -4.13       -2.85    3.9    876ms
  4   -8.441446798532       -6.03       -3.76    4.5    1.04s
  5   -8.441446815543       -7.77       -4.52    4.6    1.11s
  6   -8.441446816165       -9.21       -5.30    4.9    986ms
  7   -8.441446816173      -11.08       -6.15    3.8    1.08s
  8   -8.441446816174      -12.74       -7.37    3.7    872ms
     4    -8.441447e+00     1.314625e-09
 * time: 107.80991291999817
 * Status: success

 * Candidate solution
    Final objective value:     -8.441447e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.11e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.05e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.62e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.92e-12 ≰ 0.0e+00
    |g(x)|                 = 1.31e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   108  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

Si: 123.774239 seconds (251.48 M allocations: 72.855 GiB, 9.18% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T16:26:40.270
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.545876316281015)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.10347338040                   -1.17    9.6    7.93s
  2   -62.10753140577       -2.39       -1.26    3.8    3.77s
  3   -62.11085525344       -2.48       -2.10    5.4    4.96s
  4   -62.11087906231       -4.62       -2.85    4.8    4.78s
  5   -62.11087964274       -6.24       -3.49    4.4    4.83s
  6   -62.11087969141       -7.31       -4.29    5.3    4.93s
  7   -62.11087969191       -9.31       -4.95    4.5    4.91s
  8   -62.11087969194      -10.48       -6.43    4.7    4.88s
  9   -62.11087969194      -12.81       -7.30    6.3    5.77s
Iter     Function value   Gradient norm 
     0    -6.211088e+01     2.934872e-03
 * time: 3.504753112792969e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.10347442290                   -1.17    9.2    7.72s
  2   -62.10751987496       -2.39       -1.26    3.4    3.68s
  3   -62.11086389840       -2.48       -2.10    5.2    5.03s
  4   -62.11088763016       -4.62       -2.87    4.7    4.68s
  5   -62.11088816033       -6.28       -3.52    4.3    4.73s
  6   -62.11088820629       -7.34       -4.34    5.4    5.04s
  7   -62.11088820673       -9.36       -4.95    4.8    5.01s
  8   -62.11088820676      -10.52       -6.52    4.3    5.11s
  9   -62.11088820676      -12.97       -7.26    6.2    5.84s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.10347655572                   -1.17    9.3    7.79s
  2   -62.10751499154       -2.39       -1.26    3.5    3.75s
  3   -62.11086400521       -2.48       -2.10    5.2    4.93s
  4   -62.11088766291       -4.63       -2.89    4.6    4.71s
  5   -62.11088816228       -6.30       -3.54    4.4    4.84s
  6   -62.11088820639       -7.36       -4.38    5.4    4.89s
  7   -62.11088820674       -9.45       -4.99    4.6    5.63s
  8   -62.11088820676      -10.63       -6.37    4.2    4.75s
  9   -62.11088820676      -12.85       -7.37    6.0    5.55s
     1    -6.211089e+01     2.867752e-03
 * time: 119.99122595787048
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.10329992014                   -1.17    9.4    7.92s
  2   -62.10737614997       -2.39       -1.24    3.6    3.74s
  3   -62.11104812811       -2.44       -2.09    5.4    5.08s
  4   -62.11107503804       -4.57       -2.87    4.6    4.66s
  5   -62.11107562881       -6.23       -3.54    4.4    4.78s
  6   -62.11107567648       -7.32       -4.37    5.3    4.90s
  7   -62.11107567686       -9.41       -4.91    4.8    5.04s
  8   -62.11107567689      -10.54       -6.31    4.2    4.97s
  9   -62.11107567689      -12.66       -7.30    6.0    6.22s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.10329928348                   -1.17    9.4    8.03s
  2   -62.10737005214       -2.39       -1.24    3.7    3.77s
  3   -62.11104818375       -2.43       -2.09    5.5    4.99s
  4   -62.11107502228       -4.57       -2.87    4.5    4.77s
  5   -62.11107562929       -6.22       -3.54    4.3    4.89s
  6   -62.11107567650       -7.33       -4.38    5.4    4.98s
  7   -62.11107567686       -9.44       -4.90    4.7    5.12s
  8   -62.11107567689      -10.53       -6.33    4.0    4.78s
  9   -62.11107567689      -12.72       -7.32    5.7    6.06s
     2    -6.211108e+01     1.796079e-04
 * time: 245.1256821155548
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.10327428144                   -1.17    9.5    8.96s
  2   -62.10733831411       -2.39       -1.24    3.8    4.01s
  3   -62.11104911596       -2.43       -2.09    5.2    5.11s
  4   -62.11107585313       -4.57       -2.88    4.6    4.95s
  5   -62.11107643262       -6.24       -3.56    4.4    5.01s
  6   -62.11107647767       -7.35       -4.42    5.7    5.18s
  7   -62.11107647801       -9.47       -4.95    4.9    5.31s
  8   -62.11107647804      -10.65       -6.33    4.2    4.79s
  9   -62.11107647804      -12.72       -7.52    6.1    5.75s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.10327431135                   -1.17    9.2    8.40s
  2   -62.10733448027       -2.39       -1.24    3.6    4.47s
  3   -62.11104898536       -2.43       -2.09    5.4    5.12s
  4   -62.11107585323       -4.57       -2.88    4.7    4.79s
  5   -62.11107643177       -6.24       -3.56    4.5    5.25s
  6   -62.11107647767       -7.34       -4.41    5.6    5.08s
  7   -62.11107647801       -9.47       -4.94    4.9    5.22s
  8   -62.11107647804      -10.61       -6.39    4.0    4.78s
  9   -62.11107647804      -12.79       -7.30    6.1    5.86s
     3    -6.211108e+01     1.193257e-05
 * time: 375.0714690685272
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.10326906617                   -1.17    9.0    7.74s
  2   -62.10733696305       -2.39       -1.24    3.5    3.72s
  3   -62.11104888147       -2.43       -2.09    5.3    4.84s
  4   -62.11107584597       -4.57       -2.88    4.5    4.49s
  5   -62.11107643490       -6.23       -3.56    4.4    6.00s
  6   -62.11107648122       -7.33       -4.42    5.7    5.20s
  7   -62.11107648157       -9.46       -4.96    4.8    4.76s
  8   -62.11107648159      -10.65       -6.33    4.1    4.55s
  9   -62.11107648159      -12.66       -7.40    6.0    5.56s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.10326964870                   -1.17    8.9    7.53s
  2   -62.10734617965       -2.39       -1.24    3.7    3.82s
  3   -62.11104891526       -2.43       -2.09    5.1    4.97s
  4   -62.11107582527       -4.57       -2.87    4.6    4.87s
  5   -62.11107643457       -6.22       -3.55    4.3    4.84s
  6   -62.11107648121       -7.33       -4.41    5.4    5.04s
  7   -62.11107648157       -9.44       -4.99    4.8    5.20s
  8   -62.11107648159      -10.67       -6.36    4.2    4.91s
  9   -62.11107648159      -12.89       -7.39    5.9    6.03s
     4    -6.211108e+01     5.577337e-08
 * time: 496.42603516578674
 * Status: success

 * Candidate solution
    Final objective value:     -6.211108e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 5.96e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 5.58e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 3.56e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 5.73e-11 ≰ 0.0e+00
    |g(x)|                 = 5.58e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   496  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

NaCl: 565.834148 seconds (968.47 M allocations: 334.462 GiB, 7.02% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T16:36:06.106
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.558776261791354)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314269736834                   -1.44    5.6    1.32s
  2   -2.314365901010       -4.02       -1.83    1.5    502ms
  3   -2.314389809860       -4.62       -3.54    3.4    807ms
  4   -2.314390008598       -6.70       -4.45    4.6    1.22s
  5   -2.314390008660      -10.21       -5.21    3.0    708ms
  6   -2.314390008661      -11.95       -5.90    2.7    663ms
  7   -2.314390008661      -12.65       -6.53    3.4    1.20s
  8   -2.314390008661      -14.35       -7.12    2.9    653ms
Iter     Function value   Gradient norm 
     0    -2.314390e+00     1.713620e-03
 * time: 2.5987625122070312e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314270360969                   -1.45    5.6    1.14s
  2   -2.314368678190       -4.01       -1.83    1.5    604ms
  3   -2.314392657885       -4.62       -3.55    3.4    1.14s
  4   -2.314392869648       -6.67       -4.45    4.6    950ms
  5   -2.314392869704      -10.25       -5.12    3.0    742ms
  6   -2.314392869707      -11.63       -5.73    2.5    792ms
  7   -2.314392869707      -12.36       -6.38    3.3    873ms
  8   -2.314392869707      -13.89       -7.09    3.1    941ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314269531855                   -1.45    5.5    1.35s
  2   -2.314367988783       -4.01       -1.83    1.4    673ms
  3   -2.314392668107       -4.61       -3.53    3.4    1.31s
  4   -2.314392869635       -6.70       -4.45    4.5    1.44s
  5   -2.314392869705      -10.16       -5.15    3.0    908ms
  6   -2.314392869707      -11.75       -5.78    2.5    857ms
  7   -2.314392869707      -12.42       -6.40    3.3    695ms
  8   -2.314392869707      -13.92       -7.12    3.0    691ms
     1    -2.314393e+00     1.625621e-03
 * time: 41.584542989730835
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314299134560                   -1.45    5.4    1.28s
  2   -2.314395644898       -4.02       -1.83    1.4    445ms
  3   -2.314419248132       -4.63       -3.55    3.4    1.06s
  4   -2.314419498254       -6.60       -4.23    4.6    1.31s
  5   -2.314419498420       -9.78       -4.85    2.7    918ms
  6   -2.314419498427      -11.16       -5.52    2.8    716ms
  7   -2.314419498428      -11.93       -6.30    3.1    788ms
  8   -2.314419498428      -13.94       -6.80    2.8    937ms
  9   -2.314419498428   +  -15.35       -7.55    2.4    593ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314295859352                   -1.45    5.4    1.17s
  2   -2.314394364885       -4.01       -1.83    1.3    518ms
  3   -2.314419300550       -4.60       -3.51    3.4    828ms
  4   -2.314419498227       -6.70       -4.20    4.4    1.32s
  5   -2.314419498419       -9.72       -4.84    2.6    636ms
  6   -2.314419498426      -11.15       -5.46    2.8    694ms
  7   -2.314419498428      -11.83       -6.30    3.1    921ms
  8   -2.314419498428      -13.89       -6.87    2.9    680ms
  9   -2.314419498428      -15.05       -7.76    2.7    667ms
     2    -2.314419e+00     8.839831e-05
 * time: 83.54535293579102
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314299037812                   -1.45    5.4    1.46s
  2   -2.314395691066       -4.01       -1.83    1.4    689ms
  3   -2.314419361397       -4.63       -3.53    3.4    971ms
  4   -2.314419584183       -6.65       -4.21    4.5    1.19s
  5   -2.314419584360       -9.75       -4.82    2.7    645ms
  6   -2.314419584369      -11.09       -5.50    2.8    675ms
  7   -2.314419584370      -11.89       -6.29    2.9    902ms
  8   -2.314419584370      -13.99       -6.77    2.7    631ms
  9   -2.314419584370      -15.35       -7.58    2.3    592ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314297953869                   -1.45    5.4    1.26s
  2   -2.314395493215       -4.01       -1.83    1.5    570ms
  3   -2.314419368098       -4.62       -3.54    3.4    767ms
  4   -2.314419584183       -6.67       -4.22    4.5    1.18s
  5   -2.314419584361       -9.75       -4.83    2.7    807ms
  6   -2.314419584369      -11.10       -5.51    2.8    658ms
  7   -2.314419584370      -11.91       -6.29    3.0    1.09s
  8   -2.314419584370      -13.94       -6.74    2.8    653ms
  9   -2.314419584370   +    -Inf       -7.59    2.1    542ms
     3    -2.314420e+00     6.141651e-06
 * time: 124.84180998802185
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314302117091                   -1.45    5.5    1.76s
  2   -2.314396293340       -4.03       -1.83    1.5    531ms
  3   -2.314419423091       -4.64       -3.54    3.5    825ms
  4   -2.314419584626       -6.79       -4.23    4.5    1.37s
  5   -2.314419584780       -9.81       -4.83    2.7    638ms
  6   -2.314419584787      -11.12       -5.45    2.9    820ms
  7   -2.314419584789      -11.82       -6.29    3.0    1.07s
  8   -2.314419584789      -13.99       -6.75    2.9    685ms
  9   -2.314419584789      -14.88       -7.53    2.2    661ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314300759475                   -1.45    5.5    1.09s
  2   -2.314396418313       -4.02       -1.83    1.5    585ms
  3   -2.314419386049       -4.64       -3.54    3.4    1.13s
  4   -2.314419584625       -6.70       -4.24    4.5    1.18s
  5   -2.314419584780       -9.81       -4.83    2.7    993ms
  6   -2.314419584787      -11.14       -5.46    2.7    975ms
  7   -2.314419584789      -11.83       -6.29    3.1    867ms
  8   -2.314419584789      -13.94       -6.79    2.9    812ms
  9   -2.314419584789   +  -15.35       -7.50    2.3    825ms
     4    -2.314420e+00     2.812561e-08
 * time: 167.245778799057
 * Status: success

 * Candidate solution
    Final objective value:     -2.314420e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.36e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.79e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 4.19e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.81e-10 ≰ 0.0e+00
    |g(x)|                 = 2.81e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   167  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

Al: 193.264404 seconds (174.04 M allocations: 48.789 GiB, 6.11% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T16:39:19.371
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.577519664810659)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.370972489098436e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69163792776                   -0.86    9.8    6.45s
  2   -73.70299056200       -1.94       -1.06    5.4    4.35s
  3   -73.70929014618       -2.20       -1.39    6.8    4.58s
  4   -73.71043860489       -2.94       -1.80    5.8    3.12s
  5   -73.71057488812       -3.87       -2.34    5.1    2.96s
  6   -73.71058649641       -4.94       -3.10    5.6    3.25s
  7   -73.71058650783       -7.94       -3.60    4.6    2.82s
  8   -73.71058653167       -7.62       -4.03    5.4    3.25s
  9   -73.71058653147   +   -9.68       -4.37    5.5    3.42s
 10   -73.71058653331       -8.73       -4.88    5.6    3.24s
 11   -73.71058653335      -10.38       -5.39    5.2    3.11s
 12   -73.71058653336      -10.96       -6.16    5.2    3.09s
 13   -73.71058653336      -13.15       -6.82    5.5    3.25s
 14   -73.71058653336   +  -13.15       -7.45    5.2    3.19s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.370972489098436e-8,-7.113731542609938e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.371059e+01     8.392660e-03
 * time: 3.814697265625e-5
┌ Warning: Negative ρcore detected: -3.411682946224608e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69153569611                   -0.85    9.6    5.38s
  2   -73.70296254716       -1.94       -1.06    5.4    3.03s
  3   -73.70934407102       -2.20       -1.39    6.8    4.05s
  4   -73.71049880976       -2.94       -1.79    5.7    3.36s
  5   -73.71063770820       -3.86       -2.32    5.1    3.15s
  6   -73.71065073870       -4.89       -3.09    5.5    3.45s
  7   -73.71065077280       -7.47       -3.59    4.6    4.01s
  8   -73.71065078384       -7.96       -4.10    5.4    3.30s
  9   -73.71065078313   +   -9.15       -4.48    5.4    3.35s
 10   -73.71065078406       -9.03       -4.81    5.5    3.30s
 11   -73.71065078411      -10.36       -5.46    5.0    3.14s
 12   -73.71065078411      -12.28       -6.21    4.9    3.09s
 13   -73.71065078411      -13.55       -6.54    5.0    3.09s
 14   -73.71065078411   +  -12.32       -7.24    5.2    3.08s
┌ Warning: Negative ρcore detected: -3.411682946224608e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69152160201                   -0.85    9.6    6.12s
  2   -73.70297312534       -1.94       -1.06    5.3    2.97s
  3   -73.70934371650       -2.20       -1.39    6.8    3.83s
  4   -73.71049902590       -2.94       -1.79    5.9    3.45s
  5   -73.71063788848       -3.86       -2.33    5.1    2.97s
  6   -73.71065073606       -4.89       -3.09    5.5    3.26s
  7   -73.71065077219       -7.44       -3.60    4.6    2.88s
  8   -73.71065078385       -7.93       -4.10    5.4    3.12s
  9   -73.71065078309   +   -9.12       -4.47    5.4    3.23s
 10   -73.71065078407       -9.01       -4.82    5.4    3.14s
 11   -73.71065078411      -10.37       -5.47    5.1    3.09s
 12   -73.71065078411      -12.55       -6.20    4.9    3.04s
 13   -73.71065078411   +  -13.37       -6.53    5.1    3.10s
 14   -73.71065078411   +  -12.40       -7.10    5.1    3.14s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.411682946224608e-8,-2.6317468989495002e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     1    -7.371065e+01     6.922720e-03
 * time: 149.19348907470703
┌ Warning: Negative ρcore detected: -3.150286223384563e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69074632371                   -0.85    9.7    7.87s
  2   -73.70267036755       -1.92       -1.05    5.2    3.77s
  3   -73.70945101724       -2.17       -1.39    6.8    4.07s
  4   -73.71061671816       -2.93       -1.77    5.7    3.28s
  5   -73.71077272468       -3.81       -2.26    4.9    3.05s
  6   -73.71079079884       -4.74       -3.09    5.5    3.44s
  7   -73.71079082131       -7.65       -3.55    4.2    2.78s
  8   -73.71079082548       -8.38       -4.05    4.8    3.05s
  9   -73.71079082513   +   -9.46       -4.54    5.2    3.25s
 10   -73.71079082566       -9.27       -4.80    5.5    3.35s
 11   -73.71079082570      -10.41       -5.52    4.8    3.07s
 12   -73.71079082571      -11.14       -6.34    4.7    3.15s
 13   -73.71079082571      -13.25       -6.63    4.3    2.94s
 14   -73.71079082571      -12.49       -7.08    5.0    3.13s
┌ Warning: Negative ρcore detected: -3.150286223384563e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69074921702                   -0.85    9.6    7.33s
  2   -73.70267924355       -1.92       -1.05    5.3    3.09s
  3   -73.70944938503       -2.17       -1.39    6.7    3.97s
  4   -73.71061678911       -2.93       -1.77    5.9    3.31s
  5   -73.71077257716       -3.81       -2.26    5.0    3.10s
  6   -73.71079079616       -4.74       -3.09    5.5    3.41s
  7   -73.71079082121       -7.60       -3.54    4.2    2.80s
  8   -73.71079082545       -8.37       -4.03    4.8    2.95s
  9   -73.71079082516   +   -9.54       -4.55    5.1    3.09s
 10   -73.71079082566       -9.30       -4.80    5.5    3.21s
 11   -73.71079082570      -10.40       -5.52    4.8    2.98s
 12   -73.71079082571      -11.25       -6.26    4.6    2.97s
 13   -73.71079082571      -12.13       -6.62    4.7    3.01s
 14   -73.71079082571      -12.42       -7.08    5.2    3.22s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.150286223384563e-8,1.4853117487359086e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     2    -7.371079e+01     2.209940e-04
 * time: 301.6284341812134
┌ Warning: Negative ρcore detected: -3.1306176827742876e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69071221030                   -0.85    9.6    5.86s
  2   -73.70266286434       -1.92       -1.05    5.3    3.13s
  3   -73.70945126064       -2.17       -1.39    6.6    3.93s
  4   -73.71061556352       -2.93       -1.77    5.7    3.28s
  5   -73.71077253252       -3.80       -2.26    4.9    3.08s
  6   -73.71079094588       -4.73       -3.09    5.5    3.49s
  7   -73.71079096824       -7.65       -3.55    4.3    2.82s
  8   -73.71079097225       -8.40       -4.04    4.8    2.97s
  9   -73.71079097193   +   -9.48       -4.54    5.1    3.16s
 10   -73.71079097243       -9.30       -4.79    5.5    3.26s
 11   -73.71079097247      -10.43       -5.51    4.7    2.96s
 12   -73.71079097248      -11.06       -6.34    4.7    3.02s
 13   -73.71079097248      -13.55       -6.62    4.3    2.98s
 14   -73.71079097248      -12.34       -7.07    4.9    3.01s
┌ Warning: Negative ρcore detected: -3.1306176827742876e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69071728800                   -0.85    9.5    5.42s
  2   -73.70267102045       -1.92       -1.05    5.3    2.99s
  3   -73.70944989220       -2.17       -1.39    6.8    3.89s
  4   -73.71061574995       -2.93       -1.77    5.8    3.21s
  5   -73.71077231191       -3.81       -2.26    5.0    2.94s
  6   -73.71079094490       -4.73       -3.09    5.4    3.22s
  7   -73.71079096791       -7.64       -3.55    4.1    2.70s
  8   -73.71079097226       -8.36       -4.04    4.8    2.97s
  9   -73.71079097191   +   -9.46       -4.55    5.2    3.13s
 10   -73.71079097243       -9.28       -4.81    5.5    3.26s
 11   -73.71079097247      -10.45       -5.52    4.8    3.01s
 12   -73.71079097248      -11.15       -6.26    4.5    3.01s
 13   -73.71079097248      -12.04       -6.63    4.6    3.06s
 14   -73.71079097248      -12.26       -7.08    5.2    3.16s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1306176827742876e-8,1.5326641146470424e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     3    -7.371079e+01     5.819604e-06
 * time: 449.84267115592957
┌ Warning: Negative ρcore detected: -3.130077182565063e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69071909946                   -0.85   10.0    6.13s
  2   -73.70267593286       -1.92       -1.05    5.5    3.11s
  3   -73.70944922215       -2.17       -1.39    7.0    3.96s
  4   -73.71061517430       -2.93       -1.77    5.9    3.26s
  5   -73.71077320273       -3.80       -2.27    5.1    3.03s
  6   -73.71079094755       -4.75       -3.09    5.6    3.54s
  7   -73.71079096821       -7.68       -3.56    4.3    3.64s
  8   -73.71079097235       -8.38       -4.05    4.9    2.96s
  9   -73.71079097192   +   -9.37       -4.52    5.3    3.21s
 10   -73.71079097251       -9.23       -4.80    5.6    3.27s
 11   -73.71079097254      -10.50       -5.51    4.8    2.95s
 12   -73.71079097255      -11.06       -6.36    4.8    3.05s
 13   -73.71079097255      -12.70       -6.64    4.6    3.17s
 14   -73.71079097255      -12.42       -7.07    5.2    3.04s
┌ Warning: Negative ρcore detected: -3.130077182565063e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69071405754                   -0.85   10.0    5.78s
  2   -73.70267627402       -1.92       -1.05    5.5    3.14s
  3   -73.70944998071       -2.17       -1.39    6.9    3.96s
  4   -73.71061536601       -2.93       -1.77    5.9    3.30s
  5   -73.71077315754       -3.80       -2.27    5.1    3.03s
  6   -73.71079094746       -4.75       -3.09    5.7    3.36s
  7   -73.71079096834       -7.68       -3.56    4.3    2.79s
  8   -73.71079097235       -8.40       -4.05    4.9    3.05s
  9   -73.71079097192   +   -9.36       -4.51    5.3    3.12s
 10   -73.71079097251       -9.23       -4.79    5.6    3.16s
 11   -73.71079097254      -10.50       -5.51    4.8    2.92s
 12   -73.71079097255      -11.08       -6.36    4.7    2.99s
 13   -73.71079097255      -12.64       -6.65    4.7    3.03s
 14   -73.71079097255      -12.32       -7.10    5.1    2.97s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.130077182565063e-8,1.5339356521510054e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     4    -7.371079e+01     1.629904e-08
 * time: 599.3050770759583
 * Status: success

 * Candidate solution
    Final objective value:     -7.371079e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.53e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 6.26e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 7.21e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 9.79e-13 ≰ 0.0e+00
    |g(x)|                 = 1.63e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   599  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

V: 687.110259 seconds (606.35 M allocations: 348.766 GiB, 7.81% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T16:50:46.483
└   θ = ComponentVector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}(κ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.7746328625873791,1.0,0.0), μ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.16741232056320948,0.0,1.0))
┌ Info: 2025-05-20T16:50:46.489
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.293153313948476)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.439434712743                   -0.96    7.2    1.28s
  2   -8.441369747790       -2.71       -1.76    2.1    818ms
  3   -8.441445953763       -4.12       -2.85    4.0    925ms
  4   -8.441446798071       -6.07       -3.77    4.5    1.21s
  5   -8.441446815556       -7.76       -4.52    4.7    1.13s
  6   -8.441446816166       -9.21       -5.34    4.9    946ms
  7   -8.441446816173      -11.13       -6.17    3.8    1.07s
  8   -8.441446816174      -12.80       -7.35    3.8    832ms
Iter     Function value   Gradient norm 
     0    -8.441447e+00     1.839534e-11
 * time: 3.2901763916015625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.441447e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.84e-11 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.439464230092                   -0.96    7.1    1.57s
  2   -8.441369985904       -2.72       -1.76    2.1    631ms
  3   -8.441445843316       -4.12       -2.85    3.8    984ms
  4   -8.441446798483       -6.02       -3.76    4.5    1.32s
  5   -8.441446815539       -7.77       -4.52    4.6    953ms
  6   -8.441446816165       -9.20       -5.30    4.8    969ms
  7   -8.441446816173      -11.09       -6.18    3.7    1.04s
  8   -8.441446816174      -12.75       -7.35    3.7    878ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.15e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.48e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.42e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 9.37e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 3.55e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 8.41e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 2.87e-09
└ * number of operations = 8
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.439464132924                   -0.96    7.1    1.28s
  2   -8.441372383127       -2.72       -1.76    2.0    635ms
  3   -8.441445925351       -4.13       -2.85    3.9    1.11s
  4   -8.441446798428       -6.06       -3.76    4.4    965ms
  5   -8.441446815546       -7.77       -4.52    4.7    979ms
  6   -8.441446816166       -9.21       -5.32    4.7    1.13s
  7   -8.441446816173      -11.11       -6.17    3.9    869ms
  8   -8.441446816174      -12.76       -7.34    3.7    893ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.49e-02
[ Info: GMRES linsolve in iteration 1; step 1: normres = 7.18e-03
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.77e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.00e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 6.53e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 1.52e-08
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 1.12e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 6.56e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.19e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.03e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 4.95e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.18e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 3.21e-09
└ * number of operations = 8
Si: 172.124198 seconds (252.47 M allocations: 205.632 GiB, 9.44% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T16:53:38.614
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.68318039719958)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.10327163944                   -1.17    8.9    7.59s
  2   -62.10734938080       -2.39       -1.24    3.7    4.01s
  3   -62.11104877679       -2.43       -2.08    5.3    5.27s
  4   -62.11107584673       -4.57       -2.87    4.6    4.66s
  5   -62.11107643350       -6.23       -3.54    4.2    4.79s
  6   -62.11107648118       -7.32       -4.38    5.4    5.01s
  7   -62.11107648157       -9.42       -4.94    4.8    4.97s
  8   -62.11107648159      -10.55       -6.43    4.3    4.70s
  9   -62.11107648159      -13.07       -7.26    6.0    5.54s
Iter     Function value   Gradient norm 
     0    -6.211108e+01     5.864711e-08
 * time: 3.719329833984375e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.211108e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 5.86e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.10327012977                   -1.17    8.8    6.93s
  2   -62.10733450720       -2.39       -1.24    3.6    3.93s
  3   -62.11104899907       -2.43       -2.09    5.4    5.02s
  4   -62.11107585406       -4.57       -2.88    4.6    4.74s
  5   -62.11107643567       -6.24       -3.56    4.3    4.81s
  6   -62.11107648123       -7.34       -4.42    5.7    5.05s
  7   -62.11107648157       -9.47       -4.95    4.6    5.00s
  8   -62.11107648159      -10.64       -6.35    4.0    4.46s
  9   -62.11107648159      -12.85       -7.52    5.9    5.62s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.07e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.97e+00
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.81e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.13e-02
[ Info: GMRES linsolve in iteration 1; step 4: normres = 4.00e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 4.20e-05
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.02e-06
[ Info: GMRES linsolve in iteration 1; step 7: normres = 4.67e-08
┌ Info: GMRES linsolve converged at iteration 1, step 8:
│ * norm of residual = 3.18e-09
└ * number of operations = 10
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.10326875992                   -1.17    8.8    7.40s
  2   -62.10734660021       -2.39       -1.24    3.5    3.64s
  3   -62.11104880463       -2.43       -2.09    5.1    4.82s
  4   -62.11107582706       -4.57       -2.87    4.5    4.40s
  5   -62.11107643413       -6.22       -3.55    4.4    4.77s
  6   -62.11107648121       -7.33       -4.40    5.8    4.97s
  7   -62.11107648157       -9.44       -4.94    4.9    5.31s
  8   -62.11107648159      -10.59       -6.37    4.1    4.47s
  9   -62.11107648159      -12.73       -7.34    5.9    5.41s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.39e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.26e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.98e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.02e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.02e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 6.11e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 3.73e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 1.28e-08
└ * number of operations = 9
[ Info: GMRES linsolve starts with norm of residual = 3.43e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 5.06e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.28e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 6.01e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 3.09e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.75e-05
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.12e-06
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 4.24e-08
└ * number of operations = 9
NaCl: 1259.646388 seconds (971.00 M allocations: 1.340 TiB, 4.55% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T17:14:38.262
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.594102177055611)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314299366104                   -1.45    5.6    1.05s
  2   -2.314396358781       -4.01       -1.83    1.5    451ms
  3   -2.314419383158       -4.64       -3.55    3.5    763ms
  4   -2.314419584651       -6.70       -4.26    4.5    943ms
  5   -2.314419584781       -9.89       -4.84    2.7    661ms
  6   -2.314419584787      -11.22       -5.43    2.7    630ms
  7   -2.314419584789      -11.78       -6.28    3.0    722ms
  8   -2.314419584789      -13.81       -6.82    2.8    668ms
  9   -2.314419584789      -14.88       -7.43    2.5    857ms
Iter     Function value   Gradient norm 
     0    -2.314420e+00     2.853318e-08
 * time: 3.504753112792969e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.314420e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 2.85e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314301086791                   -1.45    5.6    1.33s
  2   -2.314396016218       -4.02       -1.83    1.5    516ms
  3   -2.314419385734       -4.63       -3.54    3.5    829ms
  4   -2.314419584630       -6.70       -4.24    4.5    1.21s
  5   -2.314419584780       -9.82       -4.83    2.7    695ms
  6   -2.314419584787      -11.15       -5.45    2.9    692ms
  7   -2.314419584789      -11.82       -6.29    3.0    740ms
  8   -2.314419584789      -13.76       -6.79    3.0    949ms
  9   -2.314419584789      -15.05       -7.51    2.3    547ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.81e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.56e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.26e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.00e-06
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 1.37e-08
└ * number of operations = 6
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314302158206                   -1.45    5.6    1.35s
  2   -2.314395862395       -4.03       -1.83    1.5    572ms
  3   -2.314419368556       -4.63       -3.52    3.5    819ms
  4   -2.314419584607       -6.67       -4.21    4.4    989ms
  5   -2.314419584779       -9.77       -4.81    2.8    944ms
  6   -2.314419584787      -11.10       -5.43    2.9    823ms
  7   -2.314419584789      -11.78       -6.27    3.1    716ms
  8   -2.314419584789      -13.77       -6.79    2.9    711ms
  9   -2.314419584789      -15.35       -7.52    2.3    849ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.59e-03
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.31e-05
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.67e-06
┌ Info: GMRES linsolve converged at iteration 1, step 3:
│ * norm of residual = 2.48e-08
└ * number of operations = 5
[ Info: GMRES linsolve starts with norm of residual = 2.18e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.79e-03
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.06e-05
[ Info: GMRES linsolve in iteration 1; step 3: normres = 4.49e-07
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 3.81e-09
└ * number of operations = 6
Al: 144.642314 seconds (147.87 M allocations: 81.500 GiB, 7.16% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T17:17:02.905
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.6267764015877395)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.130077182565063e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69071761257                   -0.85    9.9    5.68s
  2   -73.70267115848       -1.92       -1.05    5.5    3.01s
  3   -73.70944857344       -2.17       -1.39    7.0    3.89s
  4   -73.71061600054       -2.93       -1.77    6.0    3.22s
  5   -73.71077290798       -3.80       -2.26    5.2    2.93s
  6   -73.71079094607       -4.74       -3.09    5.6    3.25s
  7   -73.71079096824       -7.65       -3.56    4.3    2.73s
  8   -73.71079097233       -8.39       -4.04    4.8    2.89s
  9   -73.71079097193   +   -9.40       -4.54    5.2    3.12s
 10   -73.71079097251       -9.24       -4.80    5.6    3.13s
 11   -73.71079097254      -10.44       -5.53    5.0    2.95s
 12   -73.71079097255      -11.10       -6.33    4.7    2.89s
 13   -73.71079097255   +  -12.81       -6.62    3.7    2.49s
 14   -73.71079097255      -12.32       -7.05    5.0    3.01s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.130077182565063e-8,1.5339356521510054e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.371079e+01     4.902106e-09
 * time: 3.814697265625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.371079e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 4.90e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.130077182565063e-8,1.5339356521510054e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.130077182565063e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69071492732                   -0.85   10.0    5.42s
  2   -73.70266105969       -1.92       -1.05    5.5    2.98s
  3   -73.70945169245       -2.17       -1.39    6.9    3.76s
  4   -73.71061533927       -2.93       -1.77    6.0    3.20s
  5   -73.71077297347       -3.80       -2.26    5.2    2.75s
  6   -73.71079094634       -4.75       -3.09    5.6    3.25s
  7   -73.71079096838       -7.66       -3.55    4.3    2.71s
  8   -73.71079097233       -8.40       -4.04    4.9    3.10s
  9   -73.71079097198   +   -9.46       -4.54    5.2    3.10s
 10   -73.71079097251       -9.28       -4.80    5.6    3.33s
 11   -73.71079097254      -10.45       -5.52    4.9    3.02s
 12   -73.71079097255      -11.08       -6.34    4.8    3.13s
 13   -73.71079097255   +  -13.37       -6.62    4.0    2.55s
 14   -73.71079097255      -12.32       -7.06    5.0    3.05s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.37e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.00e+01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.30e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 7.28e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 9.83e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 7.92e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 5.95e-08
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}(Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.130077173154281e-8,1.533935650488513e-7),Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(1.5339356523706693e-7,3.6063961014307053e-6))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Computing cross-derivative ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.130077182565063e-8,0.0,0.0)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.130077182565063e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69073225013                   -0.85   10.0    5.46s
  2   -73.70266860685       -1.92       -1.05    5.5    3.05s
  3   -73.70944777418       -2.17       -1.39    6.9    4.21s
  4   -73.71061592624       -2.93       -1.77    5.9    3.31s
  5   -73.71077308592       -3.80       -2.27    5.2    2.98s
  6   -73.71079094773       -4.75       -3.09    5.6    3.52s
  7   -73.71079096811       -7.69       -3.56    4.2    2.80s
  8   -73.71079097235       -8.37       -4.05    5.0    3.15s
  9   -73.71079097192   +   -9.37       -4.53    5.3    3.17s
 10   -73.71079097251       -9.23       -4.80    5.6    3.48s
 11   -73.71079097254      -10.45       -5.51    4.9    2.93s
 12   -73.71079097255      -11.06       -6.34    4.8    2.88s
 13   -73.71079097255   +  -13.55       -6.63    4.3    2.96s
 14   -73.71079097255      -12.36       -7.06    5.1    3.00s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.98e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 5.56e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.22e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.21e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 7.20e-06
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 7.17e-08
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 5.43e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.42e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.89e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 6.32e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 8.64e-06
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 8.30e-08
└ * number of operations = 7
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}, KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.130077173154281e-8,0.0,0.0),Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(1.5339356523706693e-7,0.0,0.0))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
V: 714.682950 seconds (588.52 M allocations: 794.375 GiB, 6.85% gc time, 0.00% compilation time)
     3     1.271658e-04     3.919686e-04
 * Current step size: 1.0
 * time: 11125.617652893066
 * g(x): (κ = 0.0003118248032052497, μ = 0.0003919686202582236)
 * ~inv(H): [8.378683486546807 13.118590496754905; 13.118590496754905 24.326232228849648]
 * x: (κ = 0.7746328625873791, μ = 0.16741232056320948)
┌ Info: 2025-05-20T17:28:57.590
└   θ = ComponentVector{Float64}(κ = 0.7668781054413218, μ = 0.1537864989804053)
┌ Info: 2025-05-20T17:28:57.590
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.293153313948476)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.433895785543                   -0.96    7.2    1.32s
  2   -8.435837034173       -2.71       -1.77    2.1    629ms
  3   -8.435909459066       -4.14       -2.86    3.9    925ms
  4   -8.435910251655       -6.10       -3.77    4.5    1.16s
  5   -8.435910266884       -7.82       -4.52    4.5    965ms
  6   -8.435910267475       -9.23       -5.32    4.9    1.04s
  7   -8.435910267483      -11.12       -6.15    3.7    1.13s
  8   -8.435910267483      -12.74       -7.33    3.7    838ms
Iter     Function value   Gradient norm 
     0    -8.435910e+00     8.307795e-04
 * time: 3.695487976074219e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.433891348499                   -0.96    7.1    1.45s
  2   -8.435833514188       -2.71       -1.77    1.9    639ms
  3   -8.435910087215       -4.12       -2.85    3.8    1.11s
  4   -8.435910916569       -6.08       -3.77    4.5    976ms
  5   -8.435910932131       -7.81       -4.51    4.6    1.03s
  6   -8.435910932754       -9.21       -5.28    4.7    1.11s
  7   -8.435910932762      -11.05       -6.17    3.7    900ms
  8   -8.435910932763      -12.71       -7.34    3.9    1.08s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.433902107224                   -0.96    7.0    1.57s
  2   -8.435837243103       -2.71       -1.77    1.9    630ms
  3   -8.435910088665       -4.14       -2.85    3.8    1.12s
  4   -8.435910917247       -6.08       -3.76    4.4    1.06s
  5   -8.435910932191       -7.83       -4.53    4.5    1.06s
  6   -8.435910932755       -9.25       -5.33    4.9    1.15s
  7   -8.435910932762      -11.14       -6.16    3.8    900ms
  8   -8.435910932763      -12.74       -7.35    3.8    1.10s
     1    -8.435911e+00     7.707967e-04
 * time: 27.408068895339966
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.433880418282                   -0.96    7.4    1.54s
  2   -8.435844427017       -2.71       -1.77    2.0    659ms
  3   -8.435914192548       -4.16       -2.85    3.9    1.15s
  4   -8.435915017009       -6.08       -3.75    4.5    979ms
  5   -8.435915031187       -7.85       -4.58    4.6    1.03s
  6   -8.435915031667       -9.32       -5.44    4.9    1.15s
  7   -8.435915031672      -11.34       -6.28    3.8    929ms
  8   -8.435915031672      -12.97       -7.38    3.7    1.08s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.433880881551                   -0.96    7.2    1.57s
  2   -8.435846263983       -2.71       -1.77    2.0    643ms
  3   -8.435914019749       -4.17       -2.85    3.9    1.17s
  4   -8.435915017346       -6.00       -3.73    4.4    969ms
  5   -8.435915031177       -7.86       -4.59    4.5    992ms
  6   -8.435915031670       -9.31       -5.47    4.8    1.15s
  7   -8.435915031672      -11.63       -6.56    3.4    813ms
  8   -8.435915031672      -13.47       -7.25    4.1    954ms
     2    -8.435915e+00     4.203346e-06
 * time: 54.67239594459534
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.433867495790                   -0.96    7.2    1.46s
  2   -8.435841245954       -2.70       -1.77    2.1    659ms
  3   -8.435914276343       -4.14       -2.85    3.8    1.02s
  4   -8.435915016638       -6.13       -3.76    4.5    1.15s
  5   -8.435915031255       -7.84       -4.55    4.6    1.00s
  6   -8.435915031788       -9.27       -5.39    4.9    1.17s
  7   -8.435915031793      -11.30       -6.24    3.8    898ms
  8   -8.435915031793      -12.83       -7.36    3.9    961ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.433883324061                   -0.96    7.2    1.51s
  2   -8.435846937932       -2.71       -1.77    1.9    632ms
  3   -8.435914211322       -4.17       -2.85    3.9    1.23s
  4   -8.435915017270       -6.09       -3.76    4.5    1.02s
  5   -8.435915031295       -7.85       -4.58    4.6    1.00s
  6   -8.435915031789       -9.31       -5.43    4.8    1.16s
  7   -8.435915031793      -11.40       -6.34    3.5    861ms
  8   -8.435915031793      -13.08       -7.38    3.8    1.15s
     3    -8.435915e+00     2.321055e-08
 * time: 82.51969194412231
 * Status: success

 * Candidate solution
    Final objective value:     -8.435915e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 5.79e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 5.63e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.21e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.44e-11 ≰ 0.0e+00
    |g(x)|                 = 2.32e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   83  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 98.946405 seconds (196.15 M allocations: 56.611 GiB, 10.99% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T17:30:36.538
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.68318039719958)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.06695178504                   -1.17    8.8    7.28s
  2   -62.07087124845       -2.41       -1.25    3.6    3.74s
  3   -62.07444930573       -2.45       -2.09    5.2    4.81s
  4   -62.07447458046       -4.60       -2.84    4.6    4.77s
  5   -62.07447534557       -6.12       -3.53    4.3    4.86s
  6   -62.07447539762       -7.28       -4.41    5.6    5.32s
  7   -62.07447539796       -9.46       -4.95    4.9    6.93s
  8   -62.07447539799      -10.60       -6.30    4.1    4.70s
  9   -62.07447539799      -12.54       -7.20    6.0    5.66s
Iter     Function value   Gradient norm 
     0    -6.207448e+01     5.530822e-04
 * time: 3.814697265625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.06695713151                   -1.17    9.2    7.95s
  2   -62.07087084844       -2.41       -1.25    3.6    3.83s
  3   -62.07444985433       -2.45       -2.10    5.6    5.19s
  4   -62.07447491882       -4.60       -2.85    4.7    4.78s
  5   -62.07447564958       -6.14       -3.54    4.3    4.90s
  6   -62.07447570054       -7.29       -4.43    5.6    5.15s
  7   -62.07447570089       -9.46       -4.96    4.8    5.17s
  8   -62.07447570091      -10.63       -6.38    4.2    4.86s
  9   -62.07447570091      -12.87       -7.41    6.1    5.76s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.06695831621                   -1.17    9.4    8.38s
  2   -62.07086717492       -2.41       -1.24    3.7    4.69s
  3   -62.07444999552       -2.45       -2.10    5.4    4.97s
  4   -62.07447494104       -4.60       -2.86    4.6    4.81s
  5   -62.07447565083       -6.15       -3.55    4.4    4.84s
  6   -62.07447570058       -7.30       -4.45    5.7    5.06s
  7   -62.07447570089       -9.51       -4.96    5.0    5.16s
  8   -62.07447570091      -10.67       -6.32    4.2    4.65s
  9   -62.07447570091      -12.73       -7.28    5.9    5.66s
     1    -6.207448e+01     5.422910e-04
 * time: 125.33100605010986
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.06704949625                   -1.17    9.3    7.86s
  2   -62.07096337195       -2.41       -1.25    3.8    3.86s
  3   -62.07445793920       -2.46       -2.10    5.0    4.89s
  4   -62.07448237935       -4.61       -2.85    4.8    4.83s
  5   -62.07448309907       -6.14       -3.53    4.3    4.74s
  6   -62.07448314938       -7.30       -4.42    5.4    5.02s
  7   -62.07448314973       -9.47       -4.98    5.0    5.75s
  8   -62.07448314975      -10.64       -6.33    4.2    4.92s
  9   -62.07448314975      -12.79       -7.32    5.8    5.69s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.06704905841                   -1.17    9.2    7.79s
  2   -62.07097340765       -2.41       -1.25    3.7    3.79s
  3   -62.07445770561       -2.46       -2.10    5.3    5.04s
  4   -62.07448237674       -4.61       -2.84    4.6    4.79s
  5   -62.07448309748       -6.14       -3.52    4.3    4.77s
  6   -62.07448314937       -7.28       -4.39    5.4    5.08s
  7   -62.07448314972       -9.45       -4.99    4.9    5.06s
  8   -62.07448314975      -10.59       -6.35    4.5    5.25s
  9   -62.07448314975      -12.79       -7.18    6.2    5.60s
     2    -6.207448e+01     8.947360e-06
 * time: 246.7749810218811
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.06704645786                   -1.17    9.2    7.68s
  2   -62.07096399445       -2.41       -1.25    3.7    3.74s
  3   -62.07445781647       -2.46       -2.10    5.2    5.15s
  4   -62.07448234650       -4.61       -2.84    4.6    5.13s
  5   -62.07448309914       -6.12       -3.52    4.2    4.75s
  6   -62.07448315129       -7.28       -4.37    5.5    5.11s
  7   -62.07448315169       -9.40       -4.93    4.8    5.21s
  8   -62.07448315172      -10.49       -6.49    4.2    4.76s
  9   -62.07448315172      -12.79       -7.25    6.2    5.71s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.06704531051                   -1.17    9.2    9.22s
  2   -62.07096547066       -2.41       -1.25    3.7    3.78s
  3   -62.07445773200       -2.46       -2.10    5.3    4.89s
  4   -62.07448238479       -4.61       -2.85    4.6    4.60s
  5   -62.07448309946       -6.15       -3.52    4.2    4.70s
  6   -62.07448315132       -7.29       -4.39    5.4    5.12s
  7   -62.07448315169       -9.43       -4.96    4.8    4.99s
  8   -62.07448315172      -10.54       -6.48    4.4    4.82s
  9   -62.07448315172      -12.79       -7.30    6.1    6.58s
     3    -6.207448e+01     1.265646e-07
 * time: 368.65214920043945
 * Status: success

 * Candidate solution
    Final objective value:     -6.207448e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 4.51e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.23e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.97e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.18e-11 ≰ 0.0e+00
    |g(x)|                 = 1.27e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   369  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

NaCl: 437.912639 seconds (751.59 M allocations: 261.203 GiB, 6.73% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T17:37:54.451
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.594102177055611)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.313518568498                   -1.44    5.6    1.28s
  2   -2.313623456405       -3.98       -1.83    1.5    498ms
  3   -2.313649230311       -4.59       -3.51    3.5    821ms
  4   -2.313649420252       -6.72       -4.19    4.5    1.15s
  5   -2.313649420405       -9.81       -4.72    2.7    658ms
  6   -2.313649420421      -10.80       -5.25    2.5    642ms
  7   -2.313649420425      -11.40       -6.28    3.1    916ms
  8   -2.313649420425      -13.38       -6.78    3.4    874ms
  9   -2.313649420425      -14.51       -7.50    2.8    856ms
Iter     Function value   Gradient norm 
     0    -2.313649e+00     4.210891e-04
 * time: 3.0040740966796875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.313517506301                   -1.44    5.4    1.27s
  2   -2.313622966976       -3.98       -1.83    1.5    489ms
  3   -2.313649400144       -4.58       -3.50    3.3    802ms
  4   -2.313649593523       -6.71       -4.17    4.5    1.13s
  5   -2.313649593705       -9.74       -4.73    2.5    645ms
  6   -2.313649593719      -10.86       -5.27    2.5    635ms
  7   -2.313649593722      -11.43       -6.27    3.0    904ms
  8   -2.313649593722      -13.44       -6.79    3.2    746ms
  9   -2.313649593722      -15.35       -7.60    2.8    669ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.313517588423                   -1.44    5.4    1.06s
  2   -2.313622657591       -3.98       -1.83    1.4    461ms
  3   -2.313649407734       -4.57       -3.50    3.4    983ms
  4   -2.313649593515       -6.73       -4.16    4.4    988ms
  5   -2.313649593703       -9.73       -4.72    2.5    696ms
  6   -2.313649593718      -10.80       -5.25    2.6    886ms
  7   -2.313649593722      -11.40       -6.22    2.9    703ms
  8   -2.313649593722      -13.41       -6.70    3.2    770ms
  9   -2.313649593722      -15.35       -7.49    2.4    862ms
     1    -2.313650e+00     4.019896e-04
 * time: 41.4591748714447
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.313524238097                   -1.44    5.4    1.32s
  2   -2.313625292744       -4.00       -1.83    1.4    490ms
  3   -2.313651136297       -4.59       -3.51    3.3    784ms
  4   -2.313651348979       -6.67       -4.25    4.5    1.15s
  5   -2.313651349100       -9.92       -4.81    2.7    673ms
  6   -2.313651349112      -10.92       -5.35    2.5    628ms
  7   -2.313651349114      -11.60       -6.22    3.1    937ms
  8   -2.313651349114      -13.38       -6.85    3.1    725ms
  9   -2.313651349114      -15.35       -7.93    3.0    711ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.313526736754                   -1.44    5.4    1.06s
  2   -2.313625129362       -4.01       -1.83    1.4    470ms
  3   -2.313651034550       -4.59       -3.50    3.3    933ms
  4   -2.313651348956       -6.50       -4.20    4.5    923ms
  5   -2.313651349102       -9.84       -4.81    2.6    666ms
  6   -2.313651349112      -11.00       -5.34    2.6    871ms
  7   -2.313651349114      -11.58       -6.22    3.0    799ms
  8   -2.313651349114      -13.45       -6.81    3.2    753ms
  9   -2.313651349114      -14.75       -7.64    2.9    930ms
     2    -2.313651e+00     8.616106e-06
 * time: 82.86156296730042
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.313523582699                   -1.44    5.4    1.23s
  2   -2.313625439939       -3.99       -1.83    1.4    607ms
  3   -2.313651133461       -4.59       -3.52    3.3    790ms
  4   -2.313651349768       -6.66       -4.25    4.6    1.44s
  5   -2.313651349886       -9.93       -4.83    2.7    809ms
  6   -2.313651349897      -10.95       -5.37    2.6    691ms
  7   -2.313651349900      -11.64       -6.23    3.1    941ms
  8   -2.313651349900      -13.46       -6.80    3.2    723ms
  9   -2.313651349900      -14.88       -7.90    3.1    710ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.313526831665                   -1.44    5.4    1.05s
  2   -2.313625282507       -4.01       -1.83    1.4    480ms
  3   -2.313651099430       -4.59       -3.50    3.3    1.01s
  4   -2.313651349747       -6.60       -4.22    4.5    994ms
  5   -2.313651349887       -9.86       -4.81    2.7    688ms
  6   -2.313651349897      -10.99       -5.34    2.6    865ms
  7   -2.313651349900      -11.58       -6.23    3.0    702ms
  8   -2.313651349900      -13.49       -6.85    3.1    725ms
  9   -2.313651349900      -14.75       -7.91    2.7    872ms
     3    -2.313651e+00     1.694176e-07
 * time: 125.25627493858337
 * Status: success

 * Candidate solution
    Final objective value:     -2.313651e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.86e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.45e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 7.85e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.39e-10 ≰ 0.0e+00
    |g(x)|                 = 1.69e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   125  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Al: 151.108529 seconds (139.07 M allocations: 39.191 GiB, 6.55% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T17:40:25.561
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.6267764015877395)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.130077182565063e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.66365843867                   -0.84   10.0    5.60s
  2   -73.67648029957       -1.89       -1.04    5.6    3.14s
  3   -73.68359291187       -2.15       -1.38    7.0    4.01s
  4   -73.68483096823       -2.91       -1.76    5.9    3.24s
  5   -73.68499577936       -3.78       -2.26    5.1    3.61s
  6   -73.68501371465       -4.75       -3.09    5.6    3.40s
  7   -73.68501373262       -7.75       -3.55    4.4    2.88s
  8   -73.68501373728       -8.33       -4.07    4.9    3.11s
  9   -73.68501373702   +   -9.58       -4.53    5.4    3.32s
 10   -73.68501373750       -9.32       -4.82    5.6    3.32s
 11   -73.68501373753      -10.51       -5.53    4.9    3.04s
 12   -73.68501373753      -11.64       -6.36    4.9    3.13s
 13   -73.68501373753   +  -13.00       -6.66    3.9    2.80s
 14   -73.68501373753      -13.37       -7.09    5.0    2.96s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.130077182565063e-8,1.5339356521510054e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.368501e+01     1.848011e-03
 * time: 3.695487976074219e-5
┌ Warning: Negative ρcore detected: -3.157804608820938e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.66370128873                   -0.84    9.6    5.74s
  2   -73.67648735218       -1.89       -1.04    5.3    3.24s
  3   -73.68359884766       -2.15       -1.38    6.8    4.15s
  4   -73.68483571315       -2.91       -1.76    5.8    3.35s
  5   -73.68499798104       -3.79       -2.25    5.0    3.07s
  6   -73.68501684619       -4.72       -3.09    5.5    3.34s
  7   -73.68501686692       -7.68       -3.54    4.2    3.59s
  8   -73.68501687148       -8.34       -4.06    4.9    3.18s
  9   -73.68501687129   +   -9.72       -4.56    5.2    3.43s
 10   -73.68501687171       -9.37       -4.82    5.6    3.44s
 11   -73.68501687174      -10.47       -5.55    4.9    3.08s
 12   -73.68501687175      -11.75       -6.34    4.7    3.06s
 13   -73.68501687175      -13.00       -6.64    4.6    3.04s
 14   -73.68501687175   +  -13.85       -7.08    5.2    3.03s
┌ Warning: Negative ρcore detected: -3.157804608820938e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.66369623360                   -0.84    9.6    5.44s
  2   -73.67649255058       -1.89       -1.04    5.3    2.97s
  3   -73.68359936884       -2.15       -1.38    6.7    3.80s
  4   -73.68483507762       -2.91       -1.76    5.8    3.16s
  5   -73.68499832462       -3.79       -2.26    5.0    2.97s
  6   -73.68501684822       -4.73       -3.09    5.5    3.29s
  7   -73.68501686681       -7.73       -3.55    4.2    3.33s
  8   -73.68501687149       -8.33       -4.07    4.9    4.28s
  9   -73.68501687123   +   -9.57       -4.53    5.3    3.18s
 10   -73.68501687171       -9.31       -4.81    5.7    3.22s
 11   -73.68501687174      -10.49       -5.53    5.0    2.98s
 12   -73.68501687175      -11.65       -6.39    4.8    2.93s
 13   -73.68501687175   +  -13.85       -6.65    4.0    2.60s
 14   -73.68501687175      -13.55       -7.07    5.0    2.88s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.157804608820938e-8,1.4666265351820764e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     1    -7.368502e+01     1.544160e-03
 * time: 149.8972930908203
┌ Warning: Negative ρcore detected: -3.2787866973339396e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.66394645365                   -0.84    9.8    5.43s
  2   -73.67659221643       -1.90       -1.04    5.4    3.08s
  3   -73.68360899860       -2.15       -1.38    6.8    3.90s
  4   -73.68484709891       -2.91       -1.76    5.9    3.22s
  5   -73.68500632947       -3.80       -2.27    5.1    3.00s
  6   -73.68502404732       -4.75       -3.09    5.6    3.33s
  7   -73.68502407058       -7.63       -3.57    4.3    2.84s
  8   -73.68502407575       -8.29       -4.05    5.0    3.01s
  9   -73.68502407530   +   -9.35       -4.54    5.4    3.29s
 10   -73.68502407594       -9.20       -4.81    5.7    4.61s
 11   -73.68502407597      -10.49       -5.52    5.0    3.17s
 12   -73.68502407597      -11.19       -6.34    4.9    3.18s
 13   -73.68502407597   +  -13.55       -6.66    3.6    3.39s
 14   -73.68502407597      -12.47       -7.08    5.2    3.09s
┌ Warning: Negative ρcore detected: -3.2787866973339396e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.66394857985                   -0.84    9.8    5.45s
  2   -73.67658900666       -1.90       -1.04    5.4    3.06s
  3   -73.68360996964       -2.15       -1.38    6.9    3.90s
  4   -73.68484664757       -2.91       -1.76    5.9    3.23s
  5   -73.68500639977       -3.80       -2.27    5.1    3.00s
  6   -73.68502404586       -4.75       -3.09    5.6    3.30s
  7   -73.68502407094       -7.60       -3.56    4.4    2.83s
  8   -73.68502407573       -8.32       -4.04    5.0    3.02s
  9   -73.68502407538   +   -9.46       -4.55    5.2    4.16s
 10   -73.68502407593       -9.26       -4.81    5.6    3.94s
 11   -73.68502407597      -10.46       -5.52    4.9    3.03s
 12   -73.68502407597      -11.17       -6.34    4.8    3.17s
 13   -73.68502407597   +  -13.55       -6.64    3.5    2.69s
 14   -73.68502407597      -12.64       -7.07    5.1    3.20s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.2787866973339396e-8,1.1040682223060144e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     2    -7.368502e+01     1.193522e-05
 * time: 301.3924980163574
┌ Warning: Negative ρcore detected: -3.277990376946347e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.66394752563                   -0.84    9.6    5.88s
  2   -73.67657863544       -1.90       -1.04    5.4    3.14s
  3   -73.68361110479       -2.15       -1.38    6.8    4.04s
  4   -73.68484687787       -2.91       -1.76    5.8    3.35s
  5   -73.68500656716       -3.80       -2.27    5.1    3.15s
  6   -73.68502404791       -4.76       -3.09    5.6    3.43s
  7   -73.68502407142       -7.63       -3.57    4.3    2.92s
  8   -73.68502407614       -8.33       -4.05    5.1    3.02s
  9   -73.68502407573   +   -9.39       -4.55    5.3    3.08s
 10   -73.68502407632       -9.23       -4.81    5.6    3.35s
 11   -73.68502407636      -10.46       -5.53    5.0    3.13s
 12   -73.68502407636      -11.19       -6.35    4.9    3.17s
 13   -73.68502407636   +  -12.94       -6.66    3.6    2.62s
 14   -73.68502407636      -12.47       -7.07    5.0    3.09s
┌ Warning: Negative ρcore detected: -3.277990376946347e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.66394553180                   -0.84    9.8    5.82s
  2   -73.67658488563       -1.90       -1.04    5.4    3.13s
  3   -73.68361020598       -2.15       -1.38    6.8    4.03s
  4   -73.68484674832       -2.91       -1.76    5.9    3.36s
  5   -73.68500646257       -3.80       -2.27    5.1    3.09s
  6   -73.68502404675       -4.75       -3.09    5.6    3.47s
  7   -73.68502407140       -7.61       -3.57    4.3    2.98s
  8   -73.68502407612       -8.33       -4.04    5.1    3.00s
  9   -73.68502407572   +   -9.40       -4.55    5.2    3.24s
 10   -73.68502407632       -9.22       -4.82    5.7    3.87s
 11   -73.68502407636      -10.45       -5.54    5.0    3.05s
 12   -73.68502407636      -11.22       -6.34    4.8    3.08s
 13   -73.68502407636   +  -12.73       -6.65    4.1    2.84s
 14   -73.68502407636      -12.50       -7.06    5.0    3.11s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.277990376946347e-8,1.1069794241001722e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
     3    -7.368502e+01     7.657542e-08
 * time: 451.60035395622253
 * Status: success

 * Candidate solution
    Final objective value:     -7.368502e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 7.20e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.28e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 3.88e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 5.26e-12 ≰ 0.0e+00
    |g(x)|                 = 7.66e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   452  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

V: 538.428306 seconds (472.00 M allocations: 271.235 GiB, 7.77% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T17:49:23.992
└   θ = ComponentVector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}(κ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.7668781054413218,1.0,0.0), μ = Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(0.1537864989804053,0.0,1.0))
┌ Info: 2025-05-20T17:49:23.998
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.281704661255873)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.433875540486                   -0.96    7.2    1.28s
  2   -8.435841385447       -2.71       -1.77    2.0    795ms
  3   -8.435914129717       -4.14       -2.85    4.0    904ms
  4   -8.435915016698       -6.05       -3.75    4.5    991ms
  5   -8.435915031273       -7.84       -4.56    4.6    1.10s
  6   -8.435915031788       -9.29       -5.40    4.9    970ms
  7   -8.435915031793      -11.28       -6.21    3.9    943ms
  8   -8.435915031793      -12.82       -7.30    3.7    991ms
Iter     Function value   Gradient norm 
     0    -8.435915e+00     2.367949e-08
 * time: 4.00543212890625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -8.435915e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 2.37e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.433875709480                   -0.96    7.4    1.45s
  2   -8.435840492778       -2.71       -1.77    2.0    618ms
  3   -8.435914254314       -4.13       -2.85    3.9    920ms
  4   -8.435915015921       -6.12       -3.76    4.5    1.11s
  5   -8.435915031212       -7.82       -4.53    4.8    939ms
  6   -8.435915031787       -9.24       -5.34    4.8    964ms
  7   -8.435915031793      -11.18       -6.18    3.8    1.02s
  8   -8.435915031793      -12.72       -7.36    3.7    846ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.15e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.48e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.50e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 9.31e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 3.44e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 7.54e-08
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 2.27e-09
└ * number of operations = 8
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.433874908538                   -0.96    7.2    1.32s
  2   -8.435840727790       -2.71       -1.77    1.9    662ms
  3   -8.435914215939       -4.13       -2.85    3.9    1.12s
  4   -8.435915016214       -6.10       -3.76    4.5    962ms
  5   -8.435915031234       -7.82       -4.54    4.5    983ms
  6   -8.435915031788       -9.26       -5.37    5.0    1.16s
  7   -8.435915031793      -11.27       -6.23    3.8    894ms
  8   -8.435915031793      -12.86       -7.36    3.7    902ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 3.91e-02
[ Info: GMRES linsolve in iteration 1; step 1: normres = 6.27e-03
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.37e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.69e-05
[ Info: GMRES linsolve in iteration 1; step 4: normres = 5.71e-07
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 1.33e-08
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 1.14e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 6.91e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.39e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 2.20e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 5.23e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 1.18e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 2.57e-09
└ * number of operations = 8
Si: 167.396866 seconds (250.14 M allocations: 204.612 GiB, 9.64% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T17:52:11.396
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.655284405981337)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.06704773778                   -1.17    9.1    7.65s
  2   -62.07095584277       -2.41       -1.25    3.6    3.82s
  3   -62.07445786484       -2.46       -2.10    5.4    4.89s
  4   -62.07448239702       -4.61       -2.85    4.8    4.78s
  5   -62.07448310114       -6.15       -3.54    4.3    4.72s
  6   -62.07448315139       -7.30       -4.43    5.6    5.14s
  7   -62.07448315170       -9.51       -4.98    4.8    6.30s
  8   -62.07448315172      -10.66       -6.39    4.5    4.66s
  9   -62.07448315172      -12.92       -7.14    5.9    5.71s
Iter     Function value   Gradient norm 
     0    -6.207448e+01     1.592899e-07
 * time: 4.100799560546875e-5
 * Status: success

 * Candidate solution
    Final objective value:     -6.207448e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.59e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.06704709531                   -1.17    9.1    7.58s
  2   -62.07095338526       -2.41       -1.25    3.6    3.81s
  3   -62.07445801808       -2.46       -2.10    5.3    5.06s
  4   -62.07448241787       -4.61       -2.86    4.5    4.71s
  5   -62.07448310186       -6.16       -3.55    4.3    4.77s
  6   -62.07448315136       -7.31       -4.44    5.6    5.07s
  7   -62.07448315170       -9.47       -4.97    4.9    5.18s
  8   -62.07448315172      -10.64       -6.44    4.0    4.33s
  9   -62.07448315172      -12.73       -7.33    6.3    5.82s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.08e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.96e+00
[ Info: GMRES linsolve in iteration 1; step 2: normres = 5.79e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.16e-02
[ Info: GMRES linsolve in iteration 1; step 4: normres = 4.37e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 4.63e-05
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.11e-06
[ Info: GMRES linsolve in iteration 1; step 7: normres = 4.84e-08
┌ Info: GMRES linsolve converged at iteration 1, step 8:
│ * norm of residual = 1.46e-08
└ * number of operations = 10
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.06704852582                   -1.17    9.0    7.73s
  2   -62.07097200609       -2.41       -1.25    3.7    3.56s
  3   -62.07445778294       -2.46       -2.10    5.2    4.94s
  4   -62.07448238253       -4.61       -2.84    4.8    4.80s
  5   -62.07448309978       -6.14       -3.52    4.2    4.71s
  6   -62.07448315134       -7.29       -4.38    5.5    4.81s
  7   -62.07448315169       -9.45       -4.95    4.7    4.96s
  8   -62.07448315172      -10.54       -6.35    4.2    4.67s
  9   -62.07448315172      -12.79       -7.13    6.0    5.39s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.96e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.16e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.69e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.92e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 9.79e-05
[ Info: GMRES linsolve in iteration 1; step 5: normres = 5.66e-06
[ Info: GMRES linsolve in iteration 1; step 6: normres = 3.53e-07
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 1.24e-08
└ * number of operations = 9
[ Info: GMRES linsolve starts with norm of residual = 3.66e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 5.49e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.39e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 7.14e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 4.23e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 2.07e-05
[ Info: GMRES linsolve in iteration 1; step 6: normres = 1.33e-06
┌ Info: GMRES linsolve converged at iteration 1, step 7:
│ * norm of residual = 4.70e-08
└ * number of operations = 9
NaCl: 1239.904247 seconds (970.36 M allocations: 1.310 TiB, 4.64% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T18:12:51.301
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.585004372442178)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.313525614921                   -1.44    5.4    1.35s
  2   -2.313624920798       -4.00       -1.83    1.4    498ms
  3   -2.313651114728       -4.58       -3.50    3.4    827ms
  4   -2.313651349735       -6.63       -4.21    4.5    1.19s
  5   -2.313651349888       -9.81       -4.83    2.7    670ms
  6   -2.313651349897      -11.03       -5.37    2.7    672ms
  7   -2.313651349900      -11.64       -6.23    3.1    920ms
  8   -2.313651349900      -13.49       -6.85    3.2    716ms
  9   -2.313651349900      -15.35       -8.01    2.6    634ms
Iter     Function value   Gradient norm 
     0    -2.313651e+00     1.695544e-07
 * time: 3.2901763916015625e-5
 * Status: success

 * Candidate solution
    Final objective value:     -2.313651e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 1.70e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.313522297104                   -1.44    5.4    1.07s
  2   -2.313625814138       -3.98       -1.83    1.5    498ms
  3   -2.313651121563       -4.60       -3.54    3.4    986ms
  4   -2.313651349781       -6.64       -4.27    4.5    920ms
  5   -2.313651349887       -9.98       -4.83    2.6    680ms
  6   -2.313651349897      -10.98       -5.38    2.5    634ms
  7   -2.313651349900      -11.64       -6.26    3.1    931ms
  8   -2.313651349900      -13.43       -6.87    3.2    757ms
  9   -2.313651349900      -14.75       -7.89    2.9    904ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 5.68e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.55e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.50e-04
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.74e-06
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 1.25e-08
└ * number of operations = 6
Computing cross-derivative ...
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.313525047472                   -1.44    5.3    1.10s
  2   -2.313624690878       -4.00       -1.83    1.4    765ms
  3   -2.313651133667       -4.58       -3.49    3.3    757ms
  4   -2.313651349735       -6.67       -4.21    4.5    1.26s
  5   -2.313651349886       -9.82       -4.81    2.6    872ms
  6   -2.313651349897      -10.95       -5.34    2.6    1.01s
  7   -2.313651349900      -11.58       -6.23    3.0    829ms
  8   -2.313651349900      -13.40       -6.87    3.2    787ms
  9   -2.313651349900   +    -Inf       -8.08    2.7    640ms
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 1.36e-03
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.05e-05
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.50e-06
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.56e-08
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 6.75e-11
└ * number of operations = 6
[ Info: GMRES linsolve starts with norm of residual = 2.13e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 2.73e-03
[ Info: GMRES linsolve in iteration 1; step 2: normres = 4.65e-05
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.07e-07
┌ Info: GMRES linsolve converged at iteration 1, step 4:
│ * norm of residual = 2.43e-09
└ * number of operations = 6
Al: 154.045597 seconds (153.38 M allocations: 85.642 GiB, 7.37% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T18:15:25.348
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.615608877631449)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.277990376946347e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.66394209694                   -0.84    9.8    5.93s
  2   -73.67658512510       -1.90       -1.04    5.4    3.04s
  3   -73.68361004899       -2.15       -1.38    6.8    3.99s
  4   -73.68484680549       -2.91       -1.76    5.9    3.21s
  5   -73.68500638447       -3.80       -2.27    5.1    2.95s
  6   -73.68502404717       -4.75       -3.09    5.6    3.29s
  7   -73.68502407161       -7.61       -3.56    4.2    2.82s
  8   -73.68502407612       -8.35       -4.04    5.0    3.11s
  9   -73.68502407575   +   -9.43       -4.55    5.3    3.25s
 10   -73.68502407632       -9.25       -4.81    5.6    3.59s
 11   -73.68502407636      -10.46       -5.53    5.1    3.11s
 12   -73.68502407636      -11.19       -6.36    4.8    3.16s
 13   -73.68502407636   +  -13.55       -6.66    4.2    2.73s
 14   -73.68502407636      -12.62       -7.08    5.1    3.00s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.277990376946347e-8,1.1069794241001722e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.368502e+01     6.806851e-08
 * time: 3.790855407714844e-5
 * Status: success

 * Candidate solution
    Final objective value:     -7.368502e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 0.00e+00 ≰ -1.0e+00
    |x - x'|/|x'|          = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x')|         = NaN ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = NaN ≰ 0.0e+00
    |g(x)|                 = 6.81e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    0
    f(x) calls:    1
    ∇f(x) calls:   1

Computing hessian ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.277990376946347e-8,1.1069794241001722e-7)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.277990376946347e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.66394333612                   -0.84    9.7    5.71s
  2   -73.67659630732       -1.90       -1.04    5.4    2.96s
  3   -73.68360916903       -2.15       -1.38    6.8    3.82s
  4   -73.68484695804       -2.91       -1.76    5.9    3.19s
  5   -73.68500635696       -3.80       -2.27    5.1    2.76s
  6   -73.68502404702       -4.75       -3.09    5.7    3.33s
  7   -73.68502407099       -7.62       -3.56    4.2    2.81s
  8   -73.68502407613       -8.29       -4.04    5.0    2.98s
  9   -73.68502407572   +   -9.39       -4.54    5.3    2.97s
 10   -73.68502407632       -9.22       -4.81    5.7    3.30s
 11   -73.68502407636      -10.49       -5.52    5.0    2.99s
 12   -73.68502407636      -11.19       -6.34    4.8    3.06s
 13   -73.68502407636   +  -13.25       -6.65    3.8    2.42s
 14   -73.68502407636      -12.38       -7.07    5.1    3.08s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 4.38e+01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 1.00e+01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 2.35e-01
[ Info: GMRES linsolve in iteration 1; step 3: normres = 8.25e-03
[ Info: GMRES linsolve in iteration 1; step 4: normres = 1.12e-04
[ Info: GMRES linsolve in iteration 1; step 5: normres = 8.89e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 4.57e-08
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, ForwardDiff.Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}, Float64, 1}}}(Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(-3.2779903743323985e-8,1.1069794251130776e-7),Dual{ForwardDiff.Tag{var"#9#14"{var"#wrap_gradient#13"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Float64}}(1.106979424331919e-7,4.040087935186105e-6))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
Computing cross-derivative ...
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.277990376946347e-8,0.0,0.0)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.277990376946347e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.66394169482                   -0.84    9.6    5.66s
  2   -73.67658625342       -1.90       -1.04    5.4    3.01s
  3   -73.68361020854       -2.15       -1.38    6.8    3.83s
  4   -73.68484703326       -2.91       -1.76    5.9    3.11s
  5   -73.68500595769       -3.80       -2.26    5.1    2.99s
  6   -73.68502404632       -4.74       -3.09    5.6    3.26s
  7   -73.68502407122       -7.60       -3.56    4.3    2.65s
  8   -73.68502407612       -8.31       -4.04    4.9    2.99s
  9   -73.68502407576   +   -9.45       -4.55    5.2    3.08s
 10   -73.68502407632       -9.25       -4.81    5.7    3.34s
 11   -73.68502407636      -10.46       -5.51    4.9    2.79s
 12   -73.68502407636      -11.18       -6.34    4.8    2.99s
 13   -73.68502407636   +    -Inf       -6.65    3.9    2.65s
 14   -73.68502407636      -12.47       -7.07    5.0    2.84s
Solving response problem
[ Info: GMRES linsolve starts with norm of residual = 2.63e-01
[ Info: GMRES linsolve in iteration 1; step 1: normres = 4.94e-02
[ Info: GMRES linsolve in iteration 1; step 2: normres = 3.00e-03
[ Info: GMRES linsolve in iteration 1; step 3: normres = 1.99e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 7.17e-06
┌ Info: GMRES linsolve converged at iteration 1, step 5:
│ * norm of residual = 6.69e-08
└ * number of operations = 7
[ Info: GMRES linsolve starts with norm of residual = 5.58e+00
[ Info: GMRES linsolve in iteration 1; step 1: normres = 3.47e-01
[ Info: GMRES linsolve in iteration 1; step 2: normres = 1.82e-02
[ Info: GMRES linsolve in iteration 1; step 3: normres = 5.77e-04
[ Info: GMRES linsolve in iteration 1; step 4: normres = 9.25e-06
[ Info: GMRES linsolve in iteration 1; step 5: normres = 2.95e-07
┌ Info: GMRES linsolve converged at iteration 1, step 6:
│ * norm of residual = 5.63e-09
└ * number of operations = 8
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, DFTK.CPU, FFTGrid{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}, ρ::Array{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, 4}, eigenvalues::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, occupation::Vector{Vector{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}, εF::ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, ψ::Vector{Matrix{Complex{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}}}}, response::Tuple{KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}, KrylovKit.ConvergenceInfo{Float64, Array{Float64, 4}}}, converged::Bool, occupation_threshold::Float64, α::Float64, n_iter::Int64, n_bands_converge::Int64, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, algorithm::String, runtime_ns::UInt64}, Model{ForwardDiff.Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}, Float64, 2}, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(-3.2779903743323985e-8,0.0,0.0),Dual{ForwardDiff.Tag{var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}}, Float64}}(1.1069794243161221e-7,0.0,0.0))
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
V: 728.843996 seconds (594.12 M allocations: 814.100 GiB, 7.41% gc time, 0.00% compilation time)
     4     1.220018e-04     2.187209e-04
 * Current step size: 1.0
 * time: 14642.221889019012
 * g(x): (κ = 0.00021872089945832194, μ = 5.296437915615565e-5)
 * ~inv(H): [12.250509211351025 19.510631766997008; 19.510631766997008 34.835273925591906]
 * x: (κ = 0.7668781054413218, μ = 0.1537864989804053)
┌ Info: 2025-05-20T18:27:34.195
└   θ = ComponentVector{Float64}(κ = 0.7631652945493094, μ = 0.14767408739512403)
┌ Info: 2025-05-20T18:27:34.195
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.281704661255873)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.431368900457                   -0.96    7.3    1.31s
  2   -8.433358879601       -2.70       -1.77    2.2    644ms
  3   -8.433427431684       -4.16       -2.86    3.8    959ms
  4   -8.433428197722       -6.12       -3.76    4.4    1.13s
  5   -8.433428211342       -7.87       -4.59    4.5    1.29s
  6   -8.433428211811       -9.33       -5.44    4.7    1.00s
  7   -8.433428211814      -11.49       -6.42    3.9    1.04s
  8   -8.433428211814      -13.15       -7.38    3.9    887ms
Iter     Function value   Gradient norm 
     0    -8.433428e+00     3.797191e-04
 * time: 3.600120544433594e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.431372481843                   -0.96    7.3    1.79s
  2   -8.433356316499       -2.70       -1.77    2.1    645ms
  3   -8.433427580619       -4.15       -2.86    4.0    1.10s
  4   -8.433428335956       -6.12       -3.76    4.6    996ms
  5   -8.433428350255       -7.84       -4.58    4.7    985ms
  6   -8.433428350738       -9.32       -5.42    4.8    1.10s
  7   -8.433428350742      -11.34       -6.28    3.8    897ms
  8   -8.433428350742      -12.96       -7.38    3.8    1.05s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.431379215315                   -0.96    7.3    1.45s
  2   -8.433354677862       -2.70       -1.77    2.1    636ms
  3   -8.433427476394       -4.14       -2.85    4.0    1.14s
  4   -8.433428336750       -6.07       -3.76    4.4    940ms
  5   -8.433428350195       -7.87       -4.54    4.6    968ms
  6   -8.433428350735       -9.27       -5.35    4.8    1.10s
  7   -8.433428350742      -11.17       -6.20    3.8    870ms
  8   -8.433428350742      -12.82       -7.37    3.7    906ms
     1    -8.433428e+00     3.520278e-04
 * time: 27.53722596168518
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.431365307328                   -0.96    7.5    1.63s
  2   -8.433356268199       -2.70       -1.77    2.0    691ms
  3   -8.433428431764       -4.14       -2.86    4.0    1.25s
  4   -8.433429184784       -6.12       -3.76    4.6    962ms
  5   -8.433429198473       -7.86       -4.58    4.7    1.09s
  6   -8.433429198934       -9.34       -5.42    4.9    1.17s
  7   -8.433429198939      -11.32       -6.29    3.8    902ms
  8   -8.433429198939      -12.97       -7.36    3.9    999ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.431379602072                   -0.96    7.5    1.57s
  2   -8.433358287145       -2.70       -1.77    2.0    641ms
  3   -8.433428372314       -4.15       -2.85    4.0    1.13s
  4   -8.433429184707       -6.09       -3.75    4.4    1.04s
  5   -8.433429198461       -7.86       -4.58    4.6    1.20s
  6   -8.433429198935       -9.32       -5.42    4.8    1.13s
  7   -8.433429198939      -11.39       -6.31    3.7    1.19s
  8   -8.433429198939      -13.03       -7.36    3.9    1.01s
     2    -8.433429e+00     8.646843e-07
 * time: 56.57823705673218
 * Status: success

 * Candidate solution
    Final objective value:     -8.433429e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 4.83e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.70e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 8.48e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.01e-07 ≰ 0.0e+00
    |g(x)|                 = 8.65e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   57  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Si: 72.489669 seconds (142.49 M allocations: 41.244 GiB, 9.78% gc time, 0.00% compilation time)
┌ Info: 2025-05-20T18:28:46.685
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.655284405981337)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.05052564722                   -1.18    9.2    8.12s
  2   -62.05437659703       -2.41       -1.25    3.7    3.85s
  3   -62.05780782374       -2.46       -2.10    5.0    4.81s
  4   -62.05783144791       -4.63       -2.82    4.6    4.68s
  5   -62.05783229428       -6.07       -3.51    4.2    4.62s
  6   -62.05783234835       -7.27       -4.39    5.2    4.96s
  7   -62.05783234874       -9.41       -4.97    4.8    5.05s
  8   -62.05783234877      -10.54       -6.51    4.2    4.59s
  9   -62.05783234877      -13.07       -7.29    6.3    5.68s
Iter     Function value   Gradient norm 
     0    -6.205783e+01     2.727869e-04
 * time: 3.790855407714844e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.05052753982                   -1.18    9.0    7.84s
  2   -62.05438209460       -2.41       -1.25    3.5    3.71s
  3   -62.05780764746       -2.47       -2.10    5.1    4.92s
  4   -62.05783151754       -4.62       -2.82    4.6    4.68s
  5   -62.05783236745       -6.07       -3.50    4.2    4.78s
  6   -62.05783242202       -7.26       -4.37    5.4    4.95s
  7   -62.05783242242       -9.40       -5.00    4.7    4.94s
  8   -62.05783242245      -10.58       -6.33    4.6    4.85s
  9   -62.05783242245      -12.85       -7.15    5.9    5.59s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.05052563571                   -1.18    9.0    7.70s
  2   -62.05436915547       -2.42       -1.25    3.6    3.83s
  3   -62.05780805907       -2.46       -2.10    5.1    5.05s
  4   -62.05783155593       -4.63       -2.83    4.7    4.78s
  5   -62.05783237026       -6.09       -3.53    4.2    4.74s
  6   -62.05783242209       -7.29       -4.42    5.5    5.12s
  7   -62.05783242243       -9.48       -5.00    4.8    5.16s
  8   -62.05783242245      -10.66       -6.36    4.2    4.60s
  9   -62.05783242245      -13.19       -7.25    5.9    5.49s
     1    -6.205783e+01     2.673620e-04
 * time: 119.38609290122986
┌ Error: Ortho(X, Y) is failing badly, falling back to SVD
│   ninners = 11-element Vector{Int64}: …
│   error = 1.0
│   tol = 4.440892098500626e-16
│   estimated_error = 0.46
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/eigen/lobpcg_hyper_impl.jl:303
ERROR: LoadError: LOBPCG is badly failing to keep the vectors normalized; this should never happen
Stacktrace:
  [1] error(s::String)
    @ Base ./error.jl:35
  [2] macro expansion
    @ ~/.julia/packages/DFTK/NCxPt/src/eigen/lobpcg_hyper_impl.jl:515 [inlined]
  [3] LOBPCG(A::DFTK.DftHamiltonianBlock, X::Matrix{ComplexF64}, B::UniformScaling{Bool}, precon::PreconditionerTPA{Float64, Vector{Float64}}, tol::Float64, maxiter::Int64; miniter::Int64, ortho_tol::Float64, n_conv_check::Int64, display_progress::Bool)
    @ DFTK ~/.julia/packages/TimerOutputs/6KVfH/src/TimerOutput.jl:237
  [4] LOBPCG
    @ ~/.julia/packages/TimerOutputs/6KVfH/src/TimerOutput.jl:230 [inlined]
  [5] lobpcg_hyper(A::DFTK.DftHamiltonianBlock, X0::Matrix{ComplexF64}; maxiter::Int64, prec::PreconditionerTPA{Float64, Vector{Float64}}, tol::Float64, largest::Bool, n_conv_check::Int64, kwargs::@Kwargs{miniter::Int64})
    @ DFTK ~/.julia/packages/DFTK/NCxPt/src/eigen/diag_lobpcg_hyper.jl:11
  [6] diagonalize_all_kblocks(eigensolver::typeof(lobpcg_hyper), ham::Hamiltonian, nev_per_kpoint::Int64; ψguess::Nothing, prec_type::Type{PreconditionerTPA}, interpolate_kpoints::Bool, tol::Float64, miniter::Int64, maxiter::Int64, n_conv_check::Int64)
    @ DFTK ~/.julia/packages/DFTK/NCxPt/src/eigen/diag.jl:50
  [7] next_density(ham::Hamiltonian, nbandsalg::AdaptiveBands, fermialg::FermiBisection; eigensolver::Function, ψ::Nothing, eigenvalues::Nothing, occupation::Nothing, kwargs::@Kwargs{miniter::Int64, tol::Float64})
    @ DFTK ~/.julia/packages/DFTK/NCxPt/src/scf/self_consistent_field.jl:74
  [8] (::DFTK.var"#fixpoint_map#820"{Float64, ScfConvergenceDensity, Int64, χ0Mixing, Float64, typeof(lobpcg_hyper), AdaptiveDiagtol, AdaptiveBands, FermiBisection, ScfDefaultCallback, Bool, PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, DateTime, UInt64})(ρin::Array{Float64, 4}, info::@NamedTuple{ρin::Array{Float64, 4}, τ::Nothing, ψ::Nothing, occupation::Nothing, eigenvalues::Nothing, εF::Nothing, n_iter::Int64, n_matvec::Int64, timedout::Bool, converged::Bool, history_Etot::Vector{Float64}, history_Δρ::Vector{Float64}})
    @ DFTK ~/.julia/packages/DFTK/NCxPt/src/scf/self_consistent_field.jl:168
  [9] (::DFTK.var"#anderson#781"{DFTK.var"#anderson#780#782"{@Kwargs{}}})(f::DFTK.var"#fixpoint_map#820"{Float64, ScfConvergenceDensity, Int64, χ0Mixing, Float64, typeof(lobpcg_hyper), AdaptiveDiagtol, AdaptiveBands, FermiBisection, ScfDefaultCallback, Bool, PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, DateTime, UInt64}, x0::Array{Float64, 4}, info0::@NamedTuple{ρin::Array{Float64, 4}, τ::Nothing, ψ::Nothing, occupation::Nothing, eigenvalues::Nothing, εF::Nothing, n_iter::Int64, n_matvec::Int64, timedout::Bool, converged::Bool, history_Etot::Vector{Float64}, history_Δρ::Vector{Float64}}; maxiter::Int64)
    @ DFTK ~/.julia/packages/DFTK/NCxPt/src/scf/scf_solvers.jl:49
 [10] macro expansion
    @ ~/.julia/packages/DFTK/NCxPt/src/scf/self_consistent_field.jl:217 [inlined]
 [11] self_consistent_field(basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}; ρ::Array{Float64, 4}, τ::Nothing, ψ::Nothing, tol::Float64, is_converged::ScfConvergenceDensity, miniter::Int64, maxiter::Int64, maxtime::Year, mixing::χ0Mixing, damping::Float64, solver::DFTK.var"#anderson#781"{DFTK.var"#anderson#780#782"{@Kwargs{}}}, eigensolver::typeof(lobpcg_hyper), diagtolalg::AdaptiveDiagtol, nbandsalg::AdaptiveBands, fermialg::FermiBisection, callback::ScfDefaultCallback, compute_consistent_energies::Bool, response::ResponseOptions)
    @ DFTK ~/.julia/packages/TimerOutputs/6KVfH/src/TimerOutput.jl:237
 [12] (::var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"})(E::Float64, G::Nothing, p::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, θ::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}})
    @ Main ~/project_autodiff_for_dft_examples/1_ideas/lattice_relaxation.jl:20
 [13] #6
    @ ~/project_autodiff_for_dft_examples/1_ideas/optimise.jl:13 [inlined]
 [14] (::NLSolversBase.var"#55#56"{NLSolversBase.InplaceObjective{Nothing, var"#6#7"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Nothing, Nothing, Nothing}, Float64})(x::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}})
    @ NLSolversBase ~/.julia/packages/NLSolversBase/kavn7/src/objective_types/incomplete.jl:44
 [15] value!!(obj::OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, x::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}})
    @ NLSolversBase ~/.julia/packages/NLSolversBase/kavn7/src/interface.jl:9
 [16] value!(obj::OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, x::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}})
    @ NLSolversBase ~/.julia/packages/NLSolversBase/kavn7/src/interface.jl:28
 [17] value!(obj::Optim.ManifoldObjective{OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}}, x::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}})
    @ Optim ~/.julia/packages/Optim/HvjCd/src/Manifolds.jl:31
 [18] (::LineSearches.var"#ϕ#1"{Optim.ManifoldObjective{OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}})(α::Float64)
    @ LineSearches ~/.julia/packages/LineSearches/jgnxK/src/LineSearches.jl:24
 [19] (::BackTracking{Float64, Int64})(ϕ::LineSearches.var"#ϕ#1"{Optim.ManifoldObjective{OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, αinitial::Float64, ϕ_0::Float64, dϕ_0::Float64)
    @ LineSearches ~/.julia/packages/LineSearches/jgnxK/src/backtracking.jl:63
 [20] BackTracking
    @ ~/.julia/packages/LineSearches/jgnxK/src/backtracking.jl:34 [inlined]
 [21] BackTracking
    @ ~/.julia/packages/LineSearches/jgnxK/src/backtracking.jl:24 [inlined]
 [22] perform_linesearch!(state::Optim.LBFGSState{ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, Vector{ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, Vector{ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, method::LBFGS{Nothing, InitialStatic{Float64}, BackTracking{Float64, Int64}, Optim.var"#20#22"}, d::Optim.ManifoldObjective{OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}})
    @ Optim ~/.julia/packages/Optim/HvjCd/src/utilities/perform_linesearch.jl:58
 [23] update_state!(d::OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, state::Optim.LBFGSState{ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, Vector{ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, Vector{ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, method::LBFGS{Nothing, InitialStatic{Float64}, BackTracking{Float64, Int64}, Optim.var"#20#22"})
    @ Optim ~/.julia/packages/Optim/HvjCd/src/multivariate/solvers/first_order/l_bfgs.jl:204
 [24] optimize(d::OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, initial_x::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, method::LBFGS{Nothing, InitialStatic{Float64}, BackTracking{Float64, Int64}, Optim.var"#20#22"}, options::Optim.Options{Float64, Nothing}, state::Optim.LBFGSState{ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, Vector{ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, Vector{ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}})
    @ Optim ~/.julia/packages/Optim/HvjCd/src/multivariate/optimize/optimize.jl:54
 [25] optimize
    @ ~/.julia/packages/Optim/HvjCd/src/multivariate/optimize/optimize.jl:36 [inlined]
 [26] optimize(f::NLSolversBase.InplaceObjective{Nothing, var"#6#7"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Nothing, Nothing, Nothing}, initial_x::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, method::LBFGS{Nothing, InitialStatic{Float64}, BackTracking{Float64, Int64}, Optim.var"#20#22"}, options::Optim.Options{Float64, Nothing}; inplace::Bool, autodiff::Symbol)
    @ Optim ~/.julia/packages/Optim/HvjCd/src/multivariate/optimize/interface.jl:143
 [27] optimize
    @ ~/.julia/packages/Optim/HvjCd/src/multivariate/optimize/interface.jl:139 [inlined]
 [28] optimise(fg!::var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#31"}, x0::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, θ::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}; show_trace::Bool, kwargs::@Kwargs{f_abstol::Float64, x_tol::Int64, g_abstol::Float64})
    @ Main ~/project_autodiff_for_dft_examples/1_ideas/optimise.jl:13
 [29] #optimal_lattice#18
    @ ~/project_autodiff_for_dft_examples/1_ideas/lattice_relaxation.jl:35 [inlined]
 [30] macro expansion
    @ ./timing.jl:581 [inlined]
 [31] (::var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String})(θ::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}, cases::Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}})
    @ Main ~/project_autodiff_for_dft_examples/1_ideas/xc_finetuning/train/pbe_Si_Al_V_NaCl/train.jl:89
 [32] (::var"#30#37"{var"#loss_fn#33"{DFTK.Smearing.Gaussian, Float64, var"#make_pbe#31", String}, Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}})(θ::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}})
    @ Main ~/project_autodiff_for_dft_examples/1_ideas/xc_finetuning/train/pbe_Si_Al_V_NaCl/train.jl:113
 [33] value!!(obj::OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, x::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}})
    @ NLSolversBase ~/.julia/packages/NLSolversBase/kavn7/src/interface.jl:9
 [34] value!(obj::OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, x::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}})
    @ NLSolversBase ~/.julia/packages/NLSolversBase/kavn7/src/interface.jl:28
 [35] value!(obj::Optim.ManifoldObjective{OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}}, x::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}})
    @ Optim ~/.julia/packages/Optim/HvjCd/src/Manifolds.jl:31
 [36] (::LineSearches.var"#ϕ#1"{Optim.ManifoldObjective{OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}})(α::Float64)
    @ LineSearches ~/.julia/packages/LineSearches/jgnxK/src/LineSearches.jl:24
 [37] (::BackTracking{Float64, Int64})(ϕ::LineSearches.var"#ϕ#1"{Optim.ManifoldObjective{OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, αinitial::Float64, ϕ_0::Float64, dϕ_0::Float64)
    @ LineSearches ~/.julia/packages/LineSearches/jgnxK/src/backtracking.jl:63
 [38] BackTracking
    @ ~/.julia/packages/LineSearches/jgnxK/src/backtracking.jl:34 [inlined]
 [39] BackTracking
    @ ~/.julia/packages/LineSearches/jgnxK/src/backtracking.jl:24 [inlined]
 [40] perform_linesearch!(state::Optim.BFGSState{ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}, ComponentMatrix{Float64, Matrix{Float64}, Tuple{Axis{(κ = 1, μ = 2)}, Axis{(κ = 1, μ = 2)}}}, Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, method::BFGS{InitialStatic{Float64}, BackTracking{Float64, Int64}, Nothing, Nothing, Flat}, d::Optim.ManifoldObjective{OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}})
    @ Optim ~/.julia/packages/Optim/HvjCd/src/utilities/perform_linesearch.jl:58
 [41] update_state!(d::OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, state::Optim.BFGSState{ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}, ComponentMatrix{Float64, Matrix{Float64}, Tuple{Axis{(κ = 1, μ = 2)}, Axis{(κ = 1, μ = 2)}}}, Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, method::BFGS{InitialStatic{Float64}, BackTracking{Float64, Int64}, Nothing, Nothing, Flat})
    @ Optim ~/.julia/packages/Optim/HvjCd/src/multivariate/solvers/first_order/bfgs.jl:139
 [42] optimize(d::OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, initial_x::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}, method::BFGS{InitialStatic{Float64}, BackTracking{Float64, Int64}, Nothing, Nothing, Flat}, options::Optim.Options{Float64, Nothing}, state::Optim.BFGSState{ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}, ComponentMatrix{Float64, Matrix{Float64}, Tuple{Axis{(κ = 1, μ = 2)}, Axis{(κ = 1, μ = 2)}}}, Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}})
    @ Optim ~/.julia/packages/Optim/HvjCd/src/multivariate/optimize/optimize.jl:54
 [43] optimize
    @ ~/.julia/packages/Optim/HvjCd/src/multivariate/optimize/optimize.jl:36 [inlined]
 [44] #optimize#91
    @ ~/.julia/packages/Optim/HvjCd/src/multivariate/optimize/interface.jl:143 [inlined]
 [45] train(workdir::String, num_train_steps::Int64)
    @ Main ~/project_autodiff_for_dft_examples/1_ideas/xc_finetuning/train/pbe_Si_Al_V_NaCl/train.jl:112
 [46] train()
    @ Main ~/project_autodiff_for_dft_examples/1_ideas/xc_finetuning/train/pbe_Si_Al_V_NaCl/train.jl:34
 [47] top-level scope
    @ ~/project_autodiff_for_dft_examples/1_ideas/xc_finetuning/train/pbe_Si_Al_V_NaCl/train.jl:128
in expression starting at /home/schmitz/project_autodiff_for_dft_examples/1_ideas/xc_finetuning/train/pbe_Si_Al_V_NaCl/train.jl:128
