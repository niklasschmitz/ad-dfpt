┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-14T10:00:07.758
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.480385701154                   -0.96    6.9    11.4s
  2   -8.482638211271       -2.65       -1.72    1.9    5.34s
  3   -8.482689237851       -4.29       -2.74    3.9    2.02s
  4   -8.482690026439       -6.10       -3.96    3.7    1.72s
  5   -8.482690032973       -8.18       -4.45    4.3    2.31s
  6   -8.482690033449       -9.32       -5.44    3.7    2.49s
  7   -8.482690033460      -10.99       -6.30    4.1    1.80s
  8   -8.482690033460      -12.75       -7.42    4.1    2.77s
Iter     Function value   Gradient norm 
     0    -8.482690e+00     7.254727e-04
 * time: 4.792213439941406e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.480393748668                   -0.96    7.1    2.60s
  2   -8.482640804432       -2.65       -1.73    2.2    1.44s
  3   -8.482689755390       -4.31       -2.74    3.9    1.65s
  4   -8.482690534708       -6.11       -3.96    3.7    2.00s
  5   -8.482690540907       -8.21       -4.46    4.5    1.97s
  6   -8.482690541358       -9.35       -5.46    3.8    2.28s
  7   -8.482690541367      -11.05       -6.25    4.3    1.87s
  8   -8.482690541367      -12.67       -7.43    4.0    2.15s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.480398466113                   -0.96    7.2    2.73s
  2   -8.482640701244       -2.65       -1.72    2.3    1.55s
  3   -8.482689686124       -4.31       -2.74    3.7    1.65s
  4   -8.482690534792       -6.07       -3.95    3.6    1.99s
  5   -8.482690540897       -8.21       -4.45    4.5    1.86s
  6   -8.482690541358       -9.34       -5.45    3.8    1.94s
  7   -8.482690541367      -11.06       -6.23    4.1    2.12s
  8   -8.482690541367      -12.66       -7.41    4.1    2.37s
     1    -8.482691e+00     6.747377e-04
 * time: 45.55322194099426
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.480358162267                   -0.96    7.2    2.61s
  2   -8.482637434714       -2.64       -1.73    2.3    1.25s
  3   -8.482693030321       -4.25       -2.73    3.7    1.93s
  4   -8.482693776103       -6.13       -3.95    3.7    1.93s
  5   -8.482693784451       -8.08       -4.41    4.6    1.90s
  6   -8.482693785060       -9.22       -5.45    3.7    1.85s
  7   -8.482693785070      -10.99       -6.29    4.4    1.83s
  8   -8.482693785070      -12.73       -7.39    4.2    2.04s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.480369305033                   -0.96    7.2    2.78s
  2   -8.482639969959       -2.64       -1.73    2.3    1.82s
  3   -8.482692952455       -4.28       -2.73    3.7    1.68s
  4   -8.482693776915       -6.08       -3.95    3.7    2.04s
  5   -8.482693784503       -8.12       -4.43    4.5    1.92s
  6   -8.482693785060       -9.25       -5.47    3.8    1.93s
  7   -8.482693785070      -11.01       -6.32    4.3    2.04s
  8   -8.482693785070      -12.81       -7.33    4.1    2.31s
     2    -8.482694e+00     3.382709e-06
 * time: 90.52480697631836
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.480366441116                   -0.96    7.2    2.67s
  2   -8.482638400277       -2.64       -1.73    2.2    1.22s
  3   -8.482692851071       -4.26       -2.73    3.7    1.96s
  4   -8.482693777709       -6.03       -3.98    3.7    1.93s
  5   -8.482693784696       -8.16       -4.47    4.5    1.90s
  6   -8.482693785142       -9.35       -5.45    3.7    1.87s
  7   -8.482693785151      -11.03       -6.30    4.2    1.77s
  8   -8.482693785151      -12.72       -7.43    4.2    2.08s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.480353158176                   -0.96    7.2    2.71s
  2   -8.482639000442       -2.64       -1.73    2.2    1.53s
  3   -8.482692932917       -4.27       -2.73    3.8    1.72s
  4   -8.482693778445       -6.07       -3.97    3.7    2.45s
  5   -8.482693784736       -8.20       -4.48    4.4    2.12s
  6   -8.482693785144       -9.39       -5.51    3.7    1.92s
  7   -8.482693785151      -11.12       -6.28    4.1    1.81s
  8   -8.482693785151      -12.71       -7.46    4.1    2.08s
     3    -8.482694e+00     1.745604e-08
 * time: 134.8753879070282
 * Status: success

 * Candidate solution
    Final objective value:     -8.482694e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 4.81e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.66e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 8.10e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 9.55e-12 ≰ 0.0e+00
    |g(x)|                 = 1.75e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   135  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 212.372204 seconds (308.20 M allocations: 58.439 GiB, 8.13% gc time, 25.03% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-14T10:03:40.934
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.27481552431                   -1.20    8.5    20.9s
  2   -62.27804468486       -2.49       -1.22    3.0    9.04s
  3   -62.28256704372       -2.34       -2.08    4.6    11.5s
  4   -62.28259367711       -4.57       -2.80    4.1    10.9s
  5   -62.28259539132       -5.77       -3.67    4.0    11.6s
  6   -62.28259539883       -8.12       -4.53    4.3    11.1s
  7   -62.28259539922       -9.42       -5.59    4.3    11.7s
  8   -62.28259539922      -11.28       -6.77    4.4    11.4s
  9   -62.28259539922   +  -13.15       -8.13    4.3    11.6s
Iter     Function value   Gradient norm 
     0    -6.228260e+01     6.401245e-03
 * time: 4.38690185546875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.27486264179                   -1.20    8.4    19.0s
  2   -62.27809513542       -2.49       -1.22    3.1    8.90s
  3   -62.28260781887       -2.35       -2.08    4.5    12.6s
  4   -62.28263436904       -4.58       -2.81    3.9    10.7s
  5   -62.28263600124       -5.79       -3.69    4.0    11.9s
  6   -62.28263600826       -8.15       -4.55    4.1    10.7s
  7   -62.28263600863       -9.43       -5.45    4.4    11.6s
  8   -62.28263600864      -11.03       -6.78    4.4    11.1s
  9   -62.28263600864      -13.67       -8.26    4.3    11.6s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.27486283458                   -1.20    8.4    17.9s
  2   -62.27809032962       -2.49       -1.22    3.0    8.66s
  3   -62.28260788423       -2.35       -2.08    4.6    11.1s
  4   -62.28263430959       -4.58       -2.80    4.1    11.1s
  5   -62.28263600083       -5.77       -3.68    4.0    10.9s
  6   -62.28263600826       -8.13       -4.56    4.0    10.9s
  7   -62.28263600863       -9.43       -5.46    4.2    11.4s
  8   -62.28263600864      -11.01       -6.58    4.3    11.9s
  9   -62.28263600864      -13.15       -8.23    4.2    13.7s
     1    -6.228264e+01     6.286597e-03
 * time: 251.62454891204834
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.27657819450                   -1.20    8.4    16.5s
  2   -62.27996762170       -2.47       -1.25    3.3    8.10s
  3   -62.28355831246       -2.44       -2.12    4.5    10.1s
  4   -62.28357799738       -4.71       -2.91    4.1    10.1s
  5   -62.28357878195       -6.11       -3.75    4.0    9.76s
  6   -62.28357878509       -8.50       -4.62    4.0    9.72s
  7   -62.28357878529       -9.71       -5.58    4.4    10.8s
  8   -62.28357878529      -11.40       -7.05    4.3    10.3s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.27657592162                   -1.20    8.5    16.6s
  2   -62.27996878341       -2.47       -1.25    3.2    8.56s
  3   -62.28355839346       -2.44       -2.12    4.4    10.2s
  4   -62.28357800552       -4.71       -2.92    4.1    10.2s
  5   -62.28357878208       -6.11       -3.75    4.1    9.93s
  6   -62.28357878510       -8.52       -4.62    4.1    9.72s
  7   -62.28357878529       -9.72       -5.50    4.3    10.7s
  8   -62.28357878529      -11.29       -7.30    4.2    10.3s
     2    -6.228358e+01     1.402399e-03
 * time: 452.6432418823242
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.27650055821                   -1.20    8.3    16.9s
  2   -62.27986347664       -2.47       -1.25    3.0    8.35s
  3   -62.28359352784       -2.43       -2.11    4.3    10.5s
  4   -62.28361466178       -4.68       -2.89    4.0    10.8s
  5   -62.28361554252       -6.06       -3.73    4.1    10.5s
  6   -62.28361554597       -8.46       -4.60    4.0    10.2s
  7   -62.28361554616       -9.72       -5.58    4.1    10.9s
  8   -62.28361554616      -11.48       -6.96    4.2    10.7s
  9   -62.28361554616      -13.85       -8.16    4.2    11.0s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.27649777344                   -1.20    8.3    17.4s
  2   -62.27986053190       -2.47       -1.25    3.0    8.47s
  3   -62.28359355975       -2.43       -2.11    4.3    10.8s
  4   -62.28361464076       -4.68       -2.89    4.0    12.0s
  5   -62.28361554222       -6.05       -3.72    4.0    12.1s
  6   -62.28361554595       -8.43       -4.58    3.9    10.2s
  7   -62.28361554616       -9.69       -5.53    4.1    11.2s
  8   -62.28361554616      -11.41       -7.03    4.1    11.0s
     3    -6.228362e+01     2.247800e-04
 * time: 677.5515110492706
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.27651392407                   -1.20    8.1    17.6s
  2   -62.27987645898       -2.47       -1.25    3.0    9.48s
  3   -62.28359509409       -2.43       -2.12    4.1    10.4s
  4   -62.28361569015       -4.69       -2.90    3.9    10.3s
  5   -62.28361656606       -6.06       -3.74    4.0    10.8s
  6   -62.28361656950       -8.46       -4.61    3.9    10.2s
  7   -62.28361656971       -9.69       -5.42    4.0    10.7s
  8   -62.28361656971      -11.12       -7.10    4.0    10.6s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.27651573450                   -1.20    8.0    16.3s
  2   -62.27988422849       -2.47       -1.25    2.9    9.12s
  3   -62.28359483022       -2.43       -2.12    4.3    10.7s
  4   -62.28361566037       -4.68       -2.89    3.9    11.1s
  5   -62.28361656576       -6.04       -3.72    3.9    10.4s
  6   -62.28361656950       -8.43       -4.58    3.9    10.6s
  7   -62.28361656971       -9.69       -5.48    4.1    11.5s
  8   -62.28361656971      -11.31       -7.04    4.1    10.7s
     4    -6.228362e+01     6.447625e-06
 * time: 896.1525609493256
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.27651668708                   -1.20    7.9    16.8s
  2   -62.27988612606       -2.47       -1.25    3.1    8.31s
  3   -62.28359497427       -2.43       -2.11    4.2    10.6s
  4   -62.28361561619       -4.69       -2.88    4.0    10.3s
  5   -62.28361656616       -6.02       -3.71    4.0    10.6s
  6   -62.28361657032       -8.38       -4.57    4.0    10.5s
  7   -62.28361657053       -9.67       -5.49    4.1    10.9s
  8   -62.28361657054      -11.34       -7.16    4.1    11.3s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.27651096474                   -1.20    8.0    17.4s
  2   -62.27987714605       -2.47       -1.25    3.0    10.5s
  3   -62.28359504594       -2.43       -2.12    4.2    12.4s
  4   -62.28361565037       -4.69       -2.89    4.0    10.4s
  5   -62.28361656663       -6.04       -3.73    3.9    10.0s
  6   -62.28361657032       -8.43       -4.60    3.9    10.1s
  7   -62.28361657053       -9.68       -5.44    4.2    11.0s
  8   -62.28361657054      -11.18       -7.06    4.0    10.3s
     5    -6.228362e+01     2.634468e-08
 * time: 1109.0494520664215
 * Status: success

 * Candidate solution
    Final objective value:     -6.228362e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.61e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.50e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 8.25e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.32e-11 ≰ 0.0e+00
    |g(x)|                 = 2.63e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   1109  (vs limit Inf)
    Iterations:    5
    f(x) calls:    6
    ∇f(x) calls:   6

NaCl: 1245.691576 seconds (1.13 G allocations: 326.715 GiB, 5.38% gc time, 0.28% compilation time)
┌ Info: 2025-05-14T10:24:26.661
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.321129548360                   -1.49    5.6    2.24s
  2   -2.321196220951       -4.18       -1.85    1.3    811ms
  3   -2.321210454118       -4.85       -3.42    3.2    1.78s
  4   -2.321210634823       -6.74       -3.75    4.2    1.71s
  5   -2.321210635895       -8.97       -3.94    1.9    1.29s
  6   -2.321210636454       -9.25       -4.90    2.3    1.23s
  7   -2.321210636484      -10.52       -5.75    3.5    1.76s
  8   -2.321210636484      -12.54       -5.91    3.0    1.33s
  9   -2.321210636484      -12.67       -6.60    2.6    1.16s
 10   -2.321210636484      -14.07       -7.60    2.8    1.59s
Iter     Function value   Gradient norm 
     0    -2.321211e+00     1.576797e-03
 * time: 3.409385681152344e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.321131203931                   -1.49    5.7    2.27s
  2   -2.321199244957       -4.17       -1.85    1.5    850ms
  3   -2.321212855404       -4.87       -3.42    3.3    1.70s
  4   -2.321213067680       -6.67       -3.76    4.4    1.73s
  5   -2.321213068667       -9.01       -3.94    2.1    1.33s
  6   -2.321213069254       -9.23       -4.92    2.6    1.12s
  7   -2.321213069283      -10.54       -5.74    3.5    1.75s
  8   -2.321213069283      -12.48       -6.08    3.0    1.30s
  9   -2.321213069284      -13.00       -6.46    2.9    1.53s
 10   -2.321213069284      -13.99       -7.39    2.5    1.28s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.321131059970                   -1.49    5.8    2.23s
  2   -2.321199238452       -4.17       -1.85    1.4    1.11s
  3   -2.321212847312       -4.87       -3.42    3.3    1.32s
  4   -2.321213067708       -6.66       -3.76    4.5    1.97s
  5   -2.321213068626       -9.04       -3.92    2.0    1.00s
  6   -2.321213069250       -9.21       -4.87    2.5    1.17s
  7   -2.321213069283      -10.48       -5.72    3.5    1.64s
  8   -2.321213069283      -12.37       -5.94    3.0    1.24s
  9   -2.321213069284      -12.76       -6.49    2.6    1.40s
 10   -2.321213069284      -13.97       -7.47    2.7    1.15s
     1    -2.321213e+00     1.508918e-03
 * time: 61.07186698913574
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.321161419868                   -1.49    5.7    2.19s
  2   -2.321225508073       -4.19       -1.85    1.4    1.57s
  3   -2.321238958513       -4.87       -3.44    3.4    1.76s
  4   -2.321239138353       -6.75       -3.81    4.3    2.31s
  5   -2.321239139212       -9.07       -4.06    2.1    1.14s
  6   -2.321239139542       -9.48       -5.19    2.6    1.88s
  7   -2.321239139552      -11.00       -5.63    3.8    1.51s
  8   -2.321239139553      -12.28       -6.07    2.3    1.40s
  9   -2.321239139553      -12.96       -6.91    2.6    1.47s
 10   -2.321239139553      -14.40       -7.72    3.4    1.93s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.321156879489                   -1.49    5.7    3.09s
  2   -2.321224852015       -4.17       -1.85    1.4    823ms
  3   -2.321238949614       -4.85       -3.45    3.3    1.69s
  4   -2.321239138368       -6.72       -3.81    4.4    1.79s
  5   -2.321239139211       -9.07       -4.06    2.1    1.51s
  6   -2.321239139542       -9.48       -5.19    2.6    1.37s
  7   -2.321239139552      -10.99       -5.70    3.7    1.99s
  8   -2.321239139553      -12.51       -6.06    2.3    1.00s
  9   -2.321239139553      -12.97       -6.77    2.5    1.36s
 10   -2.321239139553      -14.24       -7.92    3.2    1.27s
     2    -2.321239e+00     2.315416e-05
 * time: 124.9020140171051
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.321155533565                   -1.49    5.5    1.91s
  2   -2.321224528311       -4.16       -1.85    1.3    1.14s
  3   -2.321238984611       -4.84       -3.44    3.2    1.39s
  4   -2.321239144523       -6.80       -3.81    4.4    2.12s
  5   -2.321239145373       -9.07       -4.07    1.9    1.24s
  6   -2.321239145705       -9.48       -5.18    2.4    1.39s
  7   -2.321239145716      -10.95       -5.63    3.7    1.44s
  8   -2.321239145717      -12.20       -6.06    2.3    1.38s
  9   -2.321239145717      -12.92       -6.90    2.6    1.22s
 10   -2.321239145717      -14.40       -7.85    3.2    1.57s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.321155002581                   -1.49    5.6    2.31s
  2   -2.321224712344       -4.16       -1.85    1.3    805ms
  3   -2.321238945388       -4.85       -3.44    3.3    1.66s
  4   -2.321239144503       -6.70       -3.81    4.3    1.64s
  5   -2.321239145377       -9.06       -4.07    2.1    1.24s
  6   -2.321239145706       -9.48       -5.20    2.6    1.08s
  7   -2.321239145716      -10.98       -5.67    3.7    1.74s
  8   -2.321239145717      -12.38       -6.07    2.2    1.00s
  9   -2.321239145717      -12.98       -6.85    2.5    1.38s
 10   -2.321239145717      -14.24       -7.94    3.2    1.27s
     3    -2.321239e+00     1.132736e-07
 * time: 185.32997608184814
 * Status: success

 * Candidate solution
    Final objective value:     -2.321239e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 5.30e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 6.90e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 6.16e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.66e-09 ≰ 0.0e+00
    |g(x)|                 = 1.13e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   185  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Al: 221.753956 seconds (170.06 M allocations: 40.956 GiB, 6.93% gc time, 0.00% compilation time)
┌ Info: 2025-05-14T10:28:08.416
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.86273450165                   -0.88    9.6    9.72s
  2   -73.87270600503       -2.00       -1.08    5.1    5.90s
  3   -73.87867345482       -2.22       -1.42    6.6    7.19s
  4   -73.87973983762       -2.97       -1.80    5.8    7.15s
  5   -73.87986711993       -3.90       -2.32    5.1    5.68s
  6   -73.87988183264       -4.83       -3.13    5.5    7.94s
  7   -73.87988180546   +   -7.57       -3.50    5.2    7.72s
  8   -73.87988185509       -7.30       -3.96    5.3    7.19s
  9   -73.87988185710       -8.70       -4.27    5.6    6.19s
 10   -73.87988186024       -8.50       -4.90    5.6    6.56s
 11   -73.87988186024      -11.26       -5.46    4.6    6.76s
 12   -73.87988186025      -11.30       -6.04    4.8    6.00s
 13   -73.87988186025      -12.38       -6.54    5.3    7.38s
 14   -73.87988186025   +  -13.25       -6.89    4.6    7.93s
 15   -73.87988186025   +  -13.85       -8.05    5.2    7.30s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.387988e+01     1.275106e-02
 * time: 3.0994415283203125e-5
┌ Warning: Negative ρcore detected: -3.364287294774025e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.86305640100                   -0.88    9.6    9.83s
  2   -73.87296152922       -2.00       -1.08    5.1    5.75s
  3   -73.87884235207       -2.23       -1.42    6.5    7.00s
  4   -73.87989472891       -2.98       -1.81    5.8    5.96s
  5   -73.88001898276       -3.91       -2.33    5.0    5.68s
  6   -73.88003222659       -4.88       -3.15    5.5    6.29s
  7   -73.88003220739   +   -7.72       -3.52    5.0    5.89s
  8   -73.88003225263       -7.34       -4.00    5.2    5.90s
  9   -73.88003225355       -9.04       -4.30    5.5    7.00s
 10   -73.88003225624       -8.57       -4.96    5.6    6.56s
 11   -73.88003225624      -11.37       -5.53    5.1    5.88s
 12   -73.88003225624      -11.53       -6.12    4.9    5.90s
 13   -73.88003225624      -13.00       -6.60    5.2    5.98s
 14   -73.88003225624   +  -13.85       -7.00    4.8    5.71s
┌ Warning: Negative ρcore detected: -3.364287294774025e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.86305871490                   -0.88    9.6    9.77s
  2   -73.87294800573       -2.00       -1.08    5.1    5.71s
  3   -73.87884528618       -2.23       -1.42    6.5    7.35s
  4   -73.87989420096       -2.98       -1.81    5.8    5.99s
  5   -73.88001901635       -3.90       -2.33    5.1    5.73s
  6   -73.88003223125       -4.88       -3.14    5.6    6.34s
  7   -73.88003221061   +   -7.69       -3.53    5.1    5.89s
  8   -73.88003225254       -7.38       -4.00    5.3    6.20s
  9   -73.88003225384       -8.89       -4.32    5.6    7.86s
 10   -73.88003225624       -8.62       -4.96    5.5    6.54s
 11   -73.88003225624      -11.37       -5.55    4.9    6.90s
 12   -73.88003225624      -11.58       -6.13    4.9    6.24s
 13   -73.88003225624      -13.07       -6.60    5.2    6.76s
 14   -73.88003225624      -13.55       -7.00    4.8    5.69s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.364287294774025e-8,-6.826156318125742e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.388003e+01     1.083223e-02
 * time: 243.97402596473694
┌ Warning: Negative ρcore detected: -3.289654973371402e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.86406040578                   -0.89    9.6    10.1s
  2   -73.87385959412       -2.01       -1.09    5.1    5.84s
  3   -73.87935707264       -2.26       -1.44    6.6    7.34s
  4   -73.88029256575       -3.03       -1.86    5.8    6.12s
  5   -73.88039608701       -3.98       -2.43    5.0    5.84s
  6   -73.88040332249       -5.14       -3.22    5.4    6.66s
  7   -73.88040332143   +   -8.98       -3.68    4.9    5.99s
  8   -73.88040333408       -7.90       -4.47    5.4    5.90s
  9   -73.88040333374   +   -9.46       -4.63    5.2    6.08s
 10   -73.88040333418       -9.35       -5.37    5.4    6.02s
 11   -73.88040333419      -11.52       -6.00    5.6    6.38s
 12   -73.88040333419   +  -13.15       -6.68    4.8    5.91s
 13   -73.88040333419      -13.00       -7.16    5.0    5.75s
┌ Warning: Negative ρcore detected: -3.289654973371402e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.86407260449                   -0.89    9.7    9.84s
  2   -73.87384528449       -2.01       -1.09    5.0    5.85s
  3   -73.87935914528       -2.26       -1.44    6.5    7.15s
  4   -73.88029203227       -3.03       -1.85    5.6    6.11s
  5   -73.88039617155       -3.98       -2.43    5.0    5.77s
  6   -73.88040332313       -5.15       -3.21    5.3    6.10s
  7   -73.88040332387       -9.13       -3.70    4.9    5.88s
  8   -73.88040333409       -7.99       -4.48    5.4    5.78s
  9   -73.88040333378   +   -9.50       -4.65    5.2    5.83s
 10   -73.88040333418       -9.39       -5.37    5.4    6.87s
 11   -73.88040333419      -11.59       -6.01    5.3    6.16s
 12   -73.88040333419   +  -13.00       -6.73    4.8    5.69s
 13   -73.88040333419      -13.37       -7.19    5.0    8.95s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.289654973371402e-8,1.0633286541251488e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.388040e+01     7.063870e-04
 * time: 478.99367809295654
┌ Warning: Negative ρcore detected: -3.2388890090266075e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.86401800940                   -0.89    9.6    9.48s
  2   -73.87382151748       -2.01       -1.09    5.0    7.14s
  3   -73.87935274552       -2.26       -1.44    6.5    7.33s
  4   -73.88029243406       -3.03       -1.85    5.7    6.16s
  5   -73.88039791270       -3.98       -2.44    5.0    6.14s
  6   -73.88040481492       -5.16       -3.21    5.4    6.25s
  7   -73.88040481704       -8.67       -3.70    5.0    5.86s
  8   -73.88040482597       -8.05       -4.47    5.5    5.86s
  9   -73.88040482565   +   -9.50       -4.65    5.1    5.71s
 10   -73.88040482606       -9.39       -5.35    5.4    5.89s
 11   -73.88040482606      -11.88       -6.02    4.8    5.96s
 12   -73.88040482606   +  -12.89       -6.72    5.1    6.18s
 13   -73.88040482606      -13.25       -7.18    4.8    5.98s
┌ Warning: Negative ρcore detected: -3.2388890090266075e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.86400349628                   -0.89    9.4    9.64s
  2   -73.87381627959       -2.01       -1.09    5.0    5.50s
  3   -73.87935488779       -2.26       -1.44    6.6    7.28s
  4   -73.88029282276       -3.03       -1.85    5.7    6.19s
  5   -73.88039749427       -3.98       -2.43    5.1    5.93s
  6   -73.88040481493       -5.14       -3.21    5.3    6.10s
  7   -73.88040481682       -8.72       -3.70    4.9    5.93s
  8   -73.88040482594       -8.04       -4.47    5.5    5.86s
  9   -73.88040482566   +   -9.55       -4.65    5.1    5.87s
 10   -73.88040482606       -9.40       -5.36    5.3    5.67s
 11   -73.88040482606      -11.90       -6.02    4.7    5.75s
 12   -73.88040482606      -13.00       -6.77    5.2    6.04s
 13   -73.88040482606   +  -13.55       -7.21    5.0    5.76s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.2388890090266075e-8,1.239432569623514e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.388040e+01     2.893838e-05
 * time: 706.8265659809113
┌ Warning: Negative ρcore detected: -3.241032670604348e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.86401737716                   -0.89    9.4    9.69s
  2   -73.87380638584       -2.01       -1.09    4.9    5.74s
  3   -73.87935554651       -2.26       -1.44    6.5    7.02s
  4   -73.88029258051       -3.03       -1.85    5.7    6.01s
  5   -73.88039748671       -3.98       -2.42    5.0    5.82s
  6   -73.88040481736       -5.13       -3.21    5.4    6.34s
  7   -73.88040482066       -8.48       -3.69    4.9    6.04s
  8   -73.88040482852       -8.10       -4.46    5.5    6.35s
  9   -73.88040482821   +   -9.51       -4.67    5.1    5.87s
 10   -73.88040482857       -9.44       -5.31    5.3    5.76s
 11   -73.88040482857      -11.85       -6.02    4.8    5.66s
 12   -73.88040482857   +    -Inf       -6.70    5.1    5.80s
 13   -73.88040482857      -13.25       -7.17    4.8    5.57s
┌ Warning: Negative ρcore detected: -3.241032670604348e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.86401446742                   -0.89    9.5    9.61s
  2   -73.87380850695       -2.01       -1.09    5.0    5.46s
  3   -73.87935555446       -2.26       -1.44    6.4    6.94s
  4   -73.88029260065       -3.03       -1.85    5.7    5.82s
  5   -73.88039741583       -3.98       -2.42    5.0    5.42s
  6   -73.88040481736       -5.13       -3.21    5.3    5.75s
  7   -73.88040482009       -8.56       -3.69    4.9    5.37s
  8   -73.88040482847       -8.08       -4.47    5.4    5.55s
  9   -73.88040482820   +   -9.56       -4.66    5.1    5.56s
 10   -73.88040482857       -9.42       -5.33    5.2    5.45s
 11   -73.88040482857      -11.93       -6.03    4.5    5.12s
 12   -73.88040482857      -12.89       -6.75    5.2    6.01s
 13   -73.88040482857   +    -Inf       -7.20    4.9    5.40s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.241032670604348e-8,1.232644688919826e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     4    -7.388040e+01     5.155397e-08
 * time: 927.4824640750885
 * Status: success

 * Candidate solution
    Final objective value:     -7.388040e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.73e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.09e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.51e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.40e-11 ≰ 0.0e+00
    |g(x)|                 = 5.16e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   927  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

V: 1077.955201 seconds (698.34 M allocations: 332.390 GiB, 6.20% gc time, 0.01% compilation time)
