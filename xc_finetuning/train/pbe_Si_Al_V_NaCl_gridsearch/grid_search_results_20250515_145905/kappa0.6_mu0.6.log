n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.583045909934                   -0.93    7.1    11.1s
  2   -8.586950406753       -2.41       -1.61    2.3    5.03s
  3   -8.587111401451       -3.79       -2.34    4.0    1.90s
  4   -8.587118843929       -5.13       -3.54    3.7    1.66s
  5   -8.587118905214       -7.21       -4.16    4.4    2.04s
  6   -8.587118908566       -8.47       -4.92    3.7    1.60s
  7   -8.587118908701       -9.87       -5.47    4.1    1.99s
  8   -8.587118908713      -10.95       -6.93    3.8    1.85s
  9   -8.587118908713      -13.29       -7.90    4.6    1.88s
Iter     Function value   Gradient norm 
     0    -8.587119e+00     9.184463e-03
 * time: 9.059906005859375e-6
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.583164113726                   -0.93    6.8    2.50s
  2   -8.587036403133       -2.41       -1.61    2.7    1.22s
  3   -8.587192315250       -3.81       -2.35    3.8    1.86s
  4   -8.587200179101       -5.10       -3.56    3.7    1.91s
  5   -8.587200243052       -7.19       -4.20    4.6    1.77s
  6   -8.587200246068       -8.52       -4.90    3.8    1.95s
  7   -8.587200246211       -9.84       -5.49    4.1    1.58s
  8   -8.587200246222      -10.97       -6.88    3.7    1.84s
  9   -8.587200246222      -13.32       -7.81    4.8    1.89s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.583164825571                   -0.93    7.0    2.53s
  2   -8.587034395327       -2.41       -1.61    2.4    1.18s
  3   -8.587192275726       -3.80       -2.35    3.9    1.86s
  4   -8.587200179582       -5.10       -3.57    3.7    1.89s
  5   -8.587200243478       -7.19       -4.22    4.5    1.74s
  6   -8.587200246084       -8.58       -4.92    3.9    1.88s
  7   -8.587200246211       -9.89       -5.49    4.0    1.59s
  8   -8.587200246222      -10.98       -6.96    3.7    1.80s
  9   -8.587200246222      -13.35       -7.77    4.8    1.87s
     1    -8.587200e+00     8.528483e-03
 * time: 46.054316997528076
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.583941870328                   -0.95    6.9    2.54s
  2   -8.587565423312       -2.44       -1.56    2.4    1.56s
  3   -8.587724051887       -3.80       -2.39    4.0    1.65s
  4   -8.587730630723       -5.18       -3.62    3.8    1.95s
  5   -8.587730688223       -7.24       -4.37    4.6    1.85s
  6   -8.587730689466       -8.91       -5.13    3.7    1.88s
  7   -8.587730689492      -10.58       -5.68    4.3    1.67s
  8   -8.587730689494      -11.72       -7.05    3.5    1.76s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.583949776058                   -0.95    7.0    2.54s
  2   -8.587561155135       -2.44       -1.56    2.3    1.48s
  3   -8.587724570860       -3.79       -2.39    4.1    1.67s
  4   -8.587730642465       -5.22       -3.60    3.7    1.94s
  5   -8.587730687728       -7.34       -4.31    4.7    1.86s
  6   -8.587730689463       -8.76       -5.10    3.7    1.89s
  7   -8.587730689492      -10.53       -5.62    4.1    1.63s
  8   -8.587730689494      -11.64       -6.94    3.5    1.72s
  9   -8.587730689494      -13.52       -7.64    4.7    1.85s
     2    -8.587731e+00     5.123026e-04
 * time: 89.24949908256531
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.583957460685                   -0.95    7.5    2.63s
  2   -8.587569782571       -2.44       -1.56    2.6    1.49s
  3   -8.587726914546       -3.80       -2.38    4.1    1.66s
  4   -8.587732716839       -5.24       -3.65    4.0    1.93s
  5   -8.587732761056       -7.35       -4.47    4.7    1.82s
  6   -8.587732761847       -9.10       -5.23    4.0    1.97s
  7   -8.587732761865      -10.74       -5.78    4.5    1.74s
  8   -8.587732761866      -11.91       -6.98    3.7    1.77s
  9   -8.587732761866      -13.97       -7.66    4.4    1.73s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.583968598178                   -0.95    7.5    2.66s
  2   -8.587565480940       -2.44       -1.56    2.4    1.25s
  3   -8.587726173936       -3.79       -2.39    4.3    1.93s
  4   -8.587732713899       -5.18       -3.63    3.8    1.90s
  5   -8.587732760900       -7.33       -4.42    4.9    1.87s
  6   -8.587732761842       -9.03       -5.18    3.9    1.89s
  7   -8.587732761865      -10.65       -5.74    4.5    1.67s
  8   -8.587732761866      -11.81       -7.00    3.7    1.76s
  9   -8.587732761866      -13.75       -7.69    4.4    1.78s
     3    -8.587733e+00     3.143682e-05
 * time: 134.46059012413025
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.583963644186                   -0.95    7.3    2.55s
  2   -8.587565703076       -2.44       -1.56    2.5    1.45s
  3   -8.587726602755       -3.79       -2.39    3.9    1.59s
  4   -8.587732725572       -5.21       -3.63    3.8    1.94s
  5   -8.587732768746       -7.36       -4.42    4.5    1.82s
  6   -8.587732769719       -9.01       -5.19    3.8    1.91s
  7   -8.587732769738      -10.71       -5.71    4.4    1.69s
  8   -8.587732769740      -11.80       -7.06    3.4    1.73s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.583963024385                   -0.95    7.2    2.59s
  2   -8.587564273457       -2.44       -1.56    2.4    1.41s
  3   -8.587726171718       -3.79       -2.39    4.0    1.62s
  4   -8.587732720729       -5.18       -3.64    3.8    1.91s
  5   -8.587732768911       -7.32       -4.44    4.6    1.84s
  6   -8.587732769719       -9.09       -5.21    3.9    1.91s
  7   -8.587732769739      -10.70       -5.76    4.5    1.69s
  8   -8.587732769740      -11.86       -7.01    3.7    1.79s
     4    -8.587733e+00     1.426899e-07
 * time: 176.64190912246704
 * Status: success

 * Candidate solution
    Final objective value:     -8.587733e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 4.99e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.76e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 7.87e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 9.17e-10 ≰ 0.0e+00
    |g(x)|                 = 1.43e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   177  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

Si: 251.734590 seconds (385.83 M allocations: 79.848 GiB, 8.32% gc time, 20.45% compilation time: <1% of which was recompilation)
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.83218170124                   -1.14    8.8    19.3s
  2   -62.83632937889       -2.38       -1.16    3.2    8.30s
  3   -62.84318813054       -2.16       -2.11    4.0    9.52s
  4   -62.84321990310       -4.50       -3.17    3.4    8.39s
  5   -62.84322034595       -6.35       -3.55    4.4    10.9s
  6   -62.84322037837       -7.49       -4.24    3.5    9.23s
  7   -62.84322038267       -8.37       -5.72    4.0    9.80s
  8   -62.84322038268      -11.31       -6.29    4.5    10.9s
  9   -62.84322038268      -12.57       -7.85    3.5    9.44s
Iter     Function value   Gradient norm 
     0    -6.284322e+01     3.473380e-03
 * time: 4.0531158447265625e-6
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.83220286964                   -1.14    8.5    16.4s
  2   -62.83638350103       -2.38       -1.16    3.1    7.43s
  3   -62.84319948987       -2.17       -2.10    3.9    8.97s
  4   -62.84323189600       -4.49       -3.11    3.3    8.77s
  5   -62.84323230380       -6.39       -3.52    4.2    10.2s
  6   -62.84323232037       -7.78       -4.17    3.6    9.47s
  7   -62.84323232399       -8.44       -5.67    4.0    9.76s
  8   -62.84323232399      -11.41       -6.17    4.5    11.0s
  9   -62.84323232399      -12.45       -7.74    3.5    8.83s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.83220417666                   -1.14    8.3    16.6s
  2   -62.83640619154       -2.38       -1.17    3.0    7.37s
  3   -62.84319888744       -2.17       -2.10    3.9    8.93s
  4   -62.84323190861       -4.48       -3.06    3.2    8.61s
  5   -62.84323230098       -6.41       -3.61    4.0    10.0s
  6   -62.84323232078       -7.70       -4.13    3.2    8.58s
  7   -62.84323232399       -8.49       -5.69    3.8    10.0s
  8   -62.84323232399      -11.45       -6.30    4.5    11.3s
  9   -62.84323232399      -12.53       -7.53    3.5    8.85s
     1    -6.284323e+01     3.402494e-03
 * time: 213.12380409240723
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.83289038106                   -1.14    8.7    16.7s
  2   -62.83729454724       -2.36       -1.18    3.3    7.67s
  3   -62.84347181747       -2.21       -2.13    3.9    9.38s
  4   -62.84349755386       -4.59       -3.18    3.5    8.58s
  5   -62.84349790598       -6.45       -3.52    4.5    10.4s
  6   -62.84349793495       -7.54       -4.23    3.4    9.14s
  7   -62.84349793830       -8.47       -5.66    4.0    9.75s
  8   -62.84349793830      -11.25       -6.26    4.4    10.5s
  9   -62.84349793830      -13.00       -7.87    3.7    9.53s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.83289150923                   -1.14    8.8    16.9s
  2   -62.83729568779       -2.36       -1.18    3.3    7.74s
  3   -62.84347194176       -2.21       -2.13    4.1    9.17s
  4   -62.84349755358       -4.59       -3.19    3.5    8.95s
  5   -62.84349790433       -6.46       -3.53    4.4    10.4s
  6   -62.84349793468       -7.52       -4.22    3.5    9.10s
  7   -62.84349793830       -8.44       -5.65    3.9    10.0s
  8   -62.84349793830      -11.21       -6.29    4.4    10.6s
  9   -62.84349793830      -12.83       -7.88    3.7    9.88s
     2    -6.284350e+01     3.248673e-04
 * time: 427.6736249923706
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.83285228558                   -1.14    9.1    17.6s
  2   -62.83724918249       -2.36       -1.18    3.3    7.98s
  3   -62.84347305043       -2.21       -2.13    4.0    9.57s
  4   -62.84349972184       -4.57       -3.18    3.5    8.70s
  5   -62.84350006825       -6.46       -3.50    4.3    10.5s
  6   -62.84350009636       -7.55       -4.22    3.5    9.34s
  7   -62.84350009972       -8.47       -5.69    4.0    10.0s
  8   -62.84350009973      -11.40       -6.19    4.4    10.7s
  9   -62.84350009973      -12.59       -7.85    3.6    9.64s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.83285431841                   -1.14    9.2    17.7s
  2   -62.83724412186       -2.36       -1.18    3.3    7.94s
  3   -62.84347312967       -2.21       -2.13    4.1    9.69s
  4   -62.84349972719       -4.58       -3.17    3.4    8.69s
  5   -62.84350006839       -6.47       -3.48    4.3    10.6s
  6   -62.84350009639       -7.55       -4.19    3.6    9.48s
  7   -62.84350009972       -8.48       -5.66    4.1    10.0s
  8   -62.84350009973      -11.32       -6.22    4.3    10.8s
  9   -62.84350009973      -12.77       -7.87    3.6    9.62s
     3    -6.284350e+01     2.649659e-05
 * time: 651.5065159797668
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.83285625012                   -1.14    8.3    16.2s
  2   -62.83725923427       -2.36       -1.18    3.2    7.61s
  3   -62.84347332989       -2.21       -2.13    4.0    9.20s
  4   -62.84349973777       -4.58       -3.17    3.2    8.67s
  5   -62.84350008396       -6.46       -3.49    4.3    10.3s
  6   -62.84350011092       -7.57       -4.21    3.4    8.81s
  7   -62.84350011434       -8.47       -5.63    3.9    10.1s
  8   -62.84350011435      -11.27       -6.29    4.1    10.4s
  9   -62.84350011435      -12.92       -7.89    3.5    9.07s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.83285536530                   -1.14    8.3    16.6s
  2   -62.83725238605       -2.36       -1.18    3.3    7.70s
  3   -62.84347292234       -2.21       -2.13    3.8    8.93s
  4   -62.84349974839       -4.57       -3.15    3.3    8.64s
  5   -62.84350008794       -6.47       -3.48    4.2    10.2s
  6   -62.84350011127       -7.63       -4.19    3.5    9.01s
  7   -62.84350011434       -8.51       -5.60    3.9    10.0s
  8   -62.84350011435      -11.38       -6.11    4.1    10.4s
  9   -62.84350011435      -12.30       -7.44    3.5    8.89s
     4    -6.284350e+01     1.480014e-07
 * time: 864.6345059871674
 * Status: success

 * Candidate solution
    Final objective value:     -6.284350e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.10e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.03e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.46e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.33e-10 ≰ 0.0e+00
    |g(x)|                 = 1.48e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   865  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

NaCl: 985.269667 seconds (1.01 G allocations: 284.077 GiB, 5.56% gc time, 0.34% compilation time)
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.337601914658                   -1.58    5.5    1.78s
  2   -2.337759071353       -3.80       -1.89    1.3    786ms
  3   -2.337828388137       -4.16       -2.85    3.7    1.38s
  4   -2.337830394695       -5.70       -3.45    4.0    1.79s
  5   -2.337830429796       -7.45       -4.02    2.9    1.17s
  6   -2.337830435414       -8.25       -4.42    3.1    1.61s
  7   -2.337830436446       -8.99       -5.26    3.3    1.24s
  8   -2.337830436469      -10.63       -6.14    3.5    1.64s
  9   -2.337830436469      -12.48       -6.56    3.1    1.25s
 10   -2.337830436469      -13.32       -7.34    3.1    1.48s
Iter     Function value   Gradient norm 
     0    -2.337830e+00     1.038045e-02
 * time: 5.0067901611328125e-6
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.337705650623                   -1.58    5.5    2.09s
  2   -2.337865327983       -3.80       -1.89    1.4    786ms
  3   -2.337933880357       -4.16       -2.85    3.7    1.67s
  4   -2.337935842579       -5.71       -3.44    4.2    1.50s
  5   -2.337935878089       -7.45       -4.01    2.8    1.39s
  6   -2.337935884159       -8.22       -4.43    3.2    1.25s
  7   -2.337935885160       -9.00       -5.23    3.2    1.52s
  8   -2.337935885183      -10.64       -6.01    3.4    1.28s
  9   -2.337935885184      -12.22       -6.57    3.4    1.60s
 10   -2.337935885184      -13.18       -7.75    3.0    1.18s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.337705181633                   -1.58    5.6    1.85s
  2   -2.337864933191       -3.80       -1.89    1.4    1.10s
  3   -2.337933861021       -4.16       -2.85    3.7    1.39s
  4   -2.337935843821       -5.70       -3.44    4.1    1.84s
  5   -2.337935878171       -7.46       -4.01    2.9    1.15s
  6   -2.337935884244       -8.22       -4.45    3.2    1.56s
  7   -2.337935885160       -9.04       -5.22    3.3    1.26s
  8   -2.337935885183      -10.63       -6.02    3.4    1.56s
  9   -2.337935885184      -12.23       -6.62    3.4    1.29s
 10   -2.337935885184      -13.28       -7.89    3.0    1.44s
     1    -2.337936e+00     9.937050e-03
 * time: 57.8779730796814
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.339031210542                   -1.62    5.5    1.68s
  2   -2.339170323084       -3.86       -1.92    1.3    609ms
  3   -2.339229310222       -4.23       -2.93    3.7    1.37s
  4   -2.339230913691       -5.79       -3.52    4.2    1.22s
  5   -2.339230942121       -7.55       -4.03    2.9    1.18s
  6   -2.339230948093       -8.22       -4.56    3.2    968ms
  7   -2.339230948780       -9.16       -5.39    3.4    1.29s
  8   -2.339230948797      -10.75       -6.32    3.5    1.04s
  9   -2.339230948798      -12.84       -6.60    3.2    1.29s
 10   -2.339230948798      -15.35       -7.55    1.9    695ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.339030402756                   -1.62    5.5    1.43s
  2   -2.339170432865       -3.85       -1.92    1.3    930ms
  3   -2.339229375245       -4.23       -2.93    3.7    1.13s
  4   -2.339230914387       -5.81       -3.53    4.3    1.54s
  5   -2.339230942268       -7.55       -4.03    2.8    1.22s
  6   -2.339230948121       -8.23       -4.57    3.5    1.02s
  7   -2.339230948782       -9.18       -5.43    3.3    1.33s
  8   -2.339230948797      -10.81       -6.37    3.6    1.09s
  9   -2.339230948798      -12.85       -6.62    3.3    1.29s
 10   -2.339230948798   +    -Inf       -7.65    2.0    689ms
     2    -2.339231e+00     1.697360e-03
 * time: 110.46945905685425
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.339098819010                   -1.62    5.4    1.39s
  2   -2.339225665339       -3.90       -1.93    1.2    857ms
  3   -2.339280072993       -4.26       -2.94    3.8    1.09s
  4   -2.339281600004       -5.82       -3.53    4.2    1.50s
  5   -2.339281627707       -7.56       -3.98    2.9    893ms
  6   -2.339281634337       -8.18       -4.59    3.3    1.26s
  7   -2.339281634924       -9.23       -5.36    3.6    1.05s
  8   -2.339281634946      -10.65       -5.90    3.4    1.30s
  9   -2.339281634946      -12.70       -6.57    2.6    847ms
 10   -2.339281634946      -13.50       -7.05    3.1    1.22s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.339096633767                   -1.62    5.5    1.75s
  2   -2.339226165303       -3.89       -1.93    1.3    600ms
  3   -2.339280106738       -4.27       -2.95    3.8    1.41s
  4   -2.339281598590       -5.83       -3.53    4.3    1.24s
  5   -2.339281627616       -7.54       -3.98    2.9    1.21s
  6   -2.339281634393       -8.17       -4.62    3.4    992ms
  7   -2.339281634928       -9.27       -5.42    3.6    1.34s
  8   -2.339281634946      -10.73       -5.94    3.5    1.05s
  9   -2.339281634946      -12.60       -6.66    2.7    1.16s
 10   -2.339281634946      -13.40       -7.21    3.3    961ms
     3    -2.339282e+00     4.793014e-04
 * time: 163.24972200393677
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.339106244828                   -1.63    5.7    1.48s
  2   -2.339232278888       -3.90       -1.94    1.4    893ms
  3   -2.339285236482       -4.28       -2.96    4.0    1.14s
  4   -2.339286652134       -5.85       -3.55    4.4    1.52s
  5   -2.339286681000       -7.54       -4.05    3.2    952ms
  6   -2.339286686569       -8.25       -4.67    3.4    1.28s
  7   -2.339286686979       -9.39       -5.42    3.7    1.07s
  8   -2.339286686994      -10.82       -6.13    3.5    1.30s
  9   -2.339286686994      -12.87       -6.87    2.8    902ms
 10   -2.339286686994      -13.63       -7.41    3.2    1.27s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.339106994043                   -1.63    5.8    1.76s
  2   -2.339232361937       -3.90       -1.94    1.4    624ms
  3   -2.339285268569       -4.28       -2.96    3.9    1.47s
  4   -2.339286651558       -5.86       -3.55    4.3    1.25s
  5   -2.339286680727       -7.54       -4.04    3.0    1.23s
  6   -2.339286686558       -8.23       -4.67    3.4    1.01s
  7   -2.339286686981       -9.37       -5.45    3.5    1.34s
  8   -2.339286686994      -10.88       -6.21    3.5    1.05s
  9   -2.339286686994      -13.11       -6.69    2.9    1.20s
 10   -2.339286686994      -13.61       -7.55    2.8    856ms
     4    -2.339287e+00     5.346451e-05
 * time: 217.17912888526917
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.339099826543                   -1.63    5.5    1.45s
  2   -2.339231605597       -3.88       -1.94    1.3    899ms
  3   -2.339285341822       -4.27       -2.96    3.8    1.11s
  4   -2.339286714070       -5.86       -3.55    4.2    1.49s
  5   -2.339286742760       -7.54       -4.05    3.0    916ms
  6   -2.339286748163       -8.27       -4.67    3.5    1.29s
  7   -2.339286748572       -9.39       -5.44    3.6    1.04s
  8   -2.339286748586      -10.87       -6.22    3.5    1.31s
  9   -2.339286748586      -13.06       -6.64    3.0    963ms
 10   -2.339286748586      -13.57       -7.50    2.4    1.09s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.339098603524                   -1.63    5.6    1.68s
  2   -2.339230535532       -3.88       -1.94    1.3    589ms
  3   -2.339285297439       -4.26       -2.96    3.8    1.41s
  4   -2.339286716339       -5.85       -3.55    4.1    1.20s
  5   -2.339286742755       -7.58       -4.05    3.1    1.22s
  6   -2.339286748119       -8.27       -4.65    3.5    1.01s
  7   -2.339286748566       -9.35       -5.35    3.6    1.30s
  8   -2.339286748586      -10.70       -6.06    3.4    996ms
  9   -2.339286748586      -12.63       -6.81    3.0    1.20s
 10   -2.339286748586      -13.64       -7.40    3.1    932ms
     5    -2.339287e+00     1.474765e-06
 * time: 270.0723149776459
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.339099244469                   -1.63    5.6    1.43s
  2   -2.339230522297       -3.88       -1.94    1.3    880ms
  3   -2.339285342495       -4.26       -2.96    3.8    1.15s
  4   -2.339286716383       -5.86       -3.55    4.2    1.54s
  5   -2.339286742564       -7.58       -4.05    3.0    909ms
  6   -2.339286748108       -8.26       -4.62    3.4    1.27s
  7   -2.339286748612       -9.30       -5.35    3.5    1.03s
  8   -2.339286748633      -10.69       -6.06    3.4    1.28s
  9   -2.339286748633      -12.63       -6.85    3.0    933ms
 10   -2.339286748633      -13.60       -7.32    3.3    1.29s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.339102564830                   -1.63    5.6    1.70s
  2   -2.339231369257       -3.89       -1.94    1.3    617ms
  3   -2.339285311480       -4.27       -2.96    3.8    1.41s
  4   -2.339286715553       -5.85       -3.55    4.3    1.26s
  5   -2.339286742538       -7.57       -4.05    2.9    1.20s
  6   -2.339286748157       -8.25       -4.65    3.4    1.01s
  7   -2.339286748613       -9.34       -5.35    3.6    1.33s
  8   -2.339286748633      -10.69       -6.09    3.3    976ms
  9   -2.339286748633      -12.79       -6.88    2.7    1.16s
 10   -2.339286748633      -13.57       -7.36    3.5    1.02s
     6    -2.339287e+00     3.463246e-09
 * time: 323.8236770629883
 * Status: success

 * Candidate solution
    Final objective value:     -2.339287e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 6.36e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 7.99e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 4.72e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.02e-11 ≰ 0.0e+00
    |g(x)|                 = 3.46e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   324  (vs limit Inf)
    Iterations:    6
    f(x) calls:    7
    ∇f(x) calls:   7

Al: 357.943117 seconds (339.62 M allocations: 84.732 GiB, 7.51% gc time, 0.00% compilation time)
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -74.32022114285                   -1.06    9.3    9.10s
  2   -74.32363936713       -2.47       -1.26    4.6    5.02s
  3   -74.32605058426       -2.62       -1.73    6.3    6.80s
  4   -74.32626043222       -3.68       -2.12    5.2    5.47s
  5   -74.32628941138       -4.54       -2.71    5.4    5.69s
  6   -74.32629018249       -6.11       -3.21    5.3    5.59s
  7   -74.32629021696       -7.46       -3.70    4.8    5.21s
  8   -74.32629021989       -8.53       -4.35    5.1    5.57s
  9   -74.32629022001       -9.93       -4.54    5.1    5.79s
 10   -74.32629022006      -10.29       -5.15    3.2    3.83s
 11   -74.32629022007      -10.95       -5.44    4.9    5.19s
 12   -74.32629022007      -11.46       -6.07    4.6    5.20s
 13   -74.32629022007   +  -13.25       -6.72    4.8    5.36s
 14   -74.32629022007   +  -13.55       -6.82    4.8    5.17s
 15   -74.32629022007   +  -12.81       -7.32    4.7    5.06s
Iter     Function value   Gradient norm 
     0    -7.432629e+01     2.881749e-03
 * time: 4.0531158447265625e-6
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -74.32021770389                   -1.06    9.3    8.82s
  2   -74.32363755389       -2.47       -1.26    4.5    4.85s
  3   -74.32605769236       -2.62       -1.73    6.2    6.47s
  4   -74.32626783040       -3.68       -2.12    5.1    5.32s
  5   -74.32629697272       -4.54       -2.69    5.2    5.48s
  6   -74.32629784775       -6.06       -3.21    5.3    5.65s
  7   -74.32629788285       -7.45       -3.69    4.8    5.59s
  8   -74.32629788587       -8.52       -4.35    5.0    5.34s
  9   -74.32629788598       -9.95       -4.53    5.1    5.33s
 10   -74.32629788603      -10.27       -5.13    3.2    3.77s
 11   -74.32629788604      -10.95       -5.44    4.9    5.09s
 12   -74.32629788605      -11.45       -6.09    4.6    5.02s
 13   -74.32629788605      -13.55       -6.56    4.7    5.21s
 14   -74.32629788605   +  -13.37       -7.09    5.2    5.50s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -74.32021410094                   -1.06    9.4    8.93s
  2   -74.32362969099       -2.47       -1.26    4.5    4.65s
  3   -74.32605950073       -2.61       -1.73    6.2    6.37s
  4   -74.32626725435       -3.68       -2.12    5.1    5.33s
  5   -74.32629697782       -4.53       -2.68    5.2    5.53s
  6   -74.32629784982       -6.06       -3.21    5.2    5.60s
  7   -74.32629788251       -7.49       -3.69    4.7    5.17s
  8   -74.32629788592       -8.47       -4.35    5.1    5.38s
  9   -74.32629788598      -10.19       -4.53    4.8    4.98s
 10   -74.32629788603      -10.31       -5.11    3.1    3.66s
 11   -74.32629788604      -10.95       -5.43    4.9    5.32s
 12   -74.32629788605      -11.43       -6.08    4.7    5.00s
 13   -74.32629788605      -13.07       -6.54    4.6    5.16s
 14   -74.32629788605   +  -12.77       -7.03    5.4    5.49s
     1    -7.432630e+01     2.438373e-03
 * time: 214.42522811889648
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -74.32018730115                   -1.06    9.6    9.08s
  2   -74.32363521357       -2.46       -1.26    4.6    4.85s
  3   -74.32606955537       -2.61       -1.72    6.4    6.53s
  4   -74.32628776948       -3.66       -2.12    5.2    5.33s
  5   -74.32631637691       -4.54       -2.69    5.4    5.60s
  6   -74.32631735896       -6.01       -3.20    5.3    5.99s
  7   -74.32631740110       -7.38       -3.69    4.9    5.38s
  8   -74.32631740362       -8.60       -4.34    5.1    5.42s
  9   -74.32631740377       -9.82       -4.54    5.3    5.60s
 10   -74.32631740383      -10.25       -5.26    3.6    4.19s
 11   -74.32631740385      -10.76       -5.52    5.4    5.86s
 12   -74.32631740385      -11.57       -6.14    4.5    5.14s
 13   -74.32631740385      -12.81       -6.46    4.4    5.07s
 14   -74.32631740385      -12.94       -7.05    4.9    5.42s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -74.32018594639                   -1.06    9.5    9.31s
  2   -74.32363299121       -2.46       -1.26    4.6    4.99s
  3   -74.32607048498       -2.61       -1.72    6.4    6.59s
  4   -74.32628747275       -3.66       -2.12    5.3    5.48s
  5   -74.32631625024       -4.54       -2.67    5.3    5.66s
  6   -74.32631736082       -5.95       -3.19    5.3    5.89s
  7   -74.32631740119       -7.39       -3.69    4.9    5.20s
  8   -74.32631740365       -8.61       -4.34    5.1    5.35s
  9   -74.32631740376       -9.96       -4.52    5.4    5.60s
 10   -74.32631740383      -10.17       -5.22    3.7    4.15s
 11   -74.32631740385      -10.81       -5.49    5.3    5.69s
 12   -74.32631740385      -11.58       -6.14    4.5    4.97s
 13   -74.32631740385      -12.70       -6.49    4.4    5.10s
 14   -74.32631740385   +    -Inf       -7.09    5.0    5.46s
     2    -7.432632e+01     3.357746e-05
 * time: 434.16462111473083
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -74.32018407266                   -1.06    9.5    9.17s
  2   -74.32363493354       -2.46       -1.26    4.7    5.00s
  3   -74.32607007028       -2.61       -1.72    6.4    6.56s
  4   -74.32628749313       -3.66       -2.12    5.3    5.46s
  5   -74.32631630905       -4.54       -2.68    5.3    5.69s
  6   -74.32631736395       -5.98       -3.20    5.4    5.84s
  7   -74.32631740476       -7.39       -3.69    4.9    5.70s
  8   -74.32631740744       -8.57       -4.34    5.1    5.49s
  9   -74.32631740756       -9.92       -4.54    5.2    5.61s
 10   -74.32631740762      -10.24       -5.23    3.6    4.13s
 11   -74.32631740763      -10.77       -5.51    5.4    5.89s
 12   -74.32631740764      -11.57       -6.13    4.5    5.15s
 13   -74.32631740764      -12.59       -6.47    4.4    5.21s
 14   -74.32631740764      -13.37       -7.06    5.0    5.53s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -74.32018598272                   -1.06    9.5    9.35s
  2   -74.32362856162       -2.46       -1.26    4.6    5.08s
  3   -74.32607078856       -2.61       -1.72    6.4    6.74s
  4   -74.32628737781       -3.66       -2.12    5.2    5.63s
  5   -74.32631630916       -4.54       -2.68    5.4    5.78s
  6   -74.32631736379       -5.98       -3.19    5.4    5.83s
  7   -74.32631740462       -7.39       -3.69    4.9    5.39s
  8   -74.32631740744       -8.55       -4.34    5.2    5.47s
  9   -74.32631740756       -9.95       -4.53    5.3    5.60s
 10   -74.32631740762      -10.21       -5.22    3.6    4.09s
 11   -74.32631740763      -10.80       -5.49    5.4    5.72s
 12   -74.32631740764      -11.53       -6.13    4.5    5.23s
 13   -74.32631740764      -12.70       -6.49    4.4    5.12s
 14   -74.32631740764      -13.37       -7.09    5.0    5.49s
     3    -7.432632e+01     4.027440e-07
 * time: 657.1990411281586
┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-15T16:34:58.361
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Info: 2025-05-15T16:39:10.738
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
┌ Info: 2025-05-15T16:55:36.037
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Info: 2025-05-15T17:01:33.981
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.417041468896849e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.417041468896849e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.417041468896849e-8,-4.883235785044079e-10)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.3684731021576825e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.3684731021576825e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.3684731021576825e-8,6.047598339899006e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.367126057641018e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.367126057641018e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.367126057641018e-8,6.127182388227448e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
 * Status: success

 * Candidate solution
    Final objective value:     -7.432632e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.21e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.87e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 3.79e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 5.10e-11 ≰ 0.0e+00
    |g(x)|                 = 4.03e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   657  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

V: 783.458931 seconds (567.17 M allocations: 265.944 GiB, 6.31% gc time, 0.01% compilation time)
