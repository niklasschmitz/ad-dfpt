┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-13T14:44:12.974
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.435902803921                   -0.97    6.9    12.1s
  2   -8.438135183902       -2.65       -1.75    2.0    5.73s
  3   -8.438199848169       -4.19       -2.91    3.8    1.88s
  4   -8.438200546636       -6.16       -3.96    4.0    2.28s
  5   -8.438200547701       -8.97       -4.70    3.8    2.02s
  6   -8.438200547792      -10.04       -5.73    3.8    1.96s
  7   -8.438200547793      -11.78       -6.72    4.1    2.15s
  8   -8.438200547793      -13.91       -7.63    4.1    1.99s
Iter     Function value   Gradient norm 
     0    -8.438201e+00     6.859700e-03
 * time: 4.8160552978515625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.435910239693                   -0.97    7.2    3.28s
  2   -8.438179743125       -2.64       -1.75    2.2    1.50s
  3   -8.438245416007       -4.18       -2.90    4.0    2.47s
  4   -8.438245971266       -6.26       -3.98    4.0    1.88s
  5   -8.438245972255       -9.00       -4.70    3.9    2.63s
  6   -8.438245972355      -10.00       -5.75    4.0    2.55s
  7   -8.438245972357      -11.86       -6.77    4.0    2.29s
  8   -8.438245972357      -13.97       -7.78    4.2    1.95s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.435916965866                   -0.97    7.3    3.13s
  2   -8.438175454619       -2.65       -1.75    2.2    1.40s
  3   -8.438245449350       -4.15       -2.91    3.9    2.30s
  4   -8.438245970485       -6.28       -3.99    4.1    2.13s
  5   -8.438245972183       -8.77       -4.66    4.1    2.54s
  6   -8.438245972356       -9.76       -5.72    4.0    2.11s
  7   -8.438245972357      -11.98       -6.83    4.0    2.76s
  8   -8.438245972357      -14.15       -7.70    4.2    2.58s
     1    -8.438246e+00     6.383681e-03
 * time: 53.73468613624573
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.436027291184                   -0.96    7.3    3.45s
  2   -8.438464034156       -2.61       -1.79    2.4    2.13s
  3   -8.438529397744       -4.18       -2.83    4.1    3.43s
  4   -8.438529863783       -6.33       -3.99    4.0    3.38s
  5   -8.438529868135       -8.36       -4.52    4.3    3.06s
  6   -8.438529868468       -9.48       -5.65    3.9    3.21s
  7   -8.438529868472      -11.37       -6.79    4.2    2.12s
  8   -8.438529868472      -13.97       -7.54    3.9    2.42s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.436029922023                   -0.96    7.3    3.43s
  2   -8.438460176489       -2.61       -1.79    2.3    1.94s
  3   -8.438529439297       -4.16       -2.83    4.1    2.69s
  4   -8.438529862748       -6.37       -3.99    3.9    2.40s
  5   -8.438529868026       -8.28       -4.47    4.5    2.61s
  6   -8.438529868466       -9.36       -5.64    3.9    2.71s
  7   -8.438529868472      -11.26       -6.75    4.3    1.90s
  8   -8.438529868472      -14.75       -7.55    3.5    2.37s
     2    -8.438530e+00     3.081216e-04
 * time: 111.00035500526428
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.436032335514                   -0.96    7.3    3.02s
  2   -8.438472096039       -2.61       -1.79    2.4    1.79s
  3   -8.438530158308       -4.24       -2.83    3.9    2.58s
  4   -8.438530490275       -6.48       -4.02    4.0    2.03s
  5   -8.438530493196       -8.53       -4.58    4.4    2.71s
  6   -8.438530493414       -9.66       -5.71    4.1    2.21s
  7   -8.438530493417      -11.50       -6.85    4.5    2.42s
  8   -8.438530493417      -14.75       -7.62    3.9    1.85s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.436037606245                   -0.96    7.2    4.14s
  2   -8.438470244356       -2.61       -1.79    2.3    1.63s
  3   -8.438530009623       -4.22       -2.83    4.0    2.57s
  4   -8.438530490360       -6.32       -4.00    3.9    2.26s
  5   -8.438530493217       -8.54       -4.59    4.4    2.88s
  6   -8.438530493413       -9.71       -5.71    3.9    2.23s
  7   -8.438530493417      -11.50       -6.81    4.4    2.44s
  8   -8.438530493417      -14.15       -7.61    3.6    1.76s
     3    -8.438530e+00     1.284065e-05
 * time: 164.70270609855652
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.436027729170                   -0.96    7.0    3.21s
  2   -8.438466469039       -2.61       -1.79    2.3    1.85s
  3   -8.438529934865       -4.20       -2.84    3.9    2.17s
  4   -8.438530491232       -6.25       -4.01    3.9    2.36s
  5   -8.438530494274       -8.52       -4.57    4.2    2.03s
  6   -8.438530494502       -9.64       -5.68    3.9    2.18s
  7   -8.438530494506      -11.46       -6.83    4.2    1.96s
  8   -8.438530494506      -14.15       -7.54    4.0    2.30s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.436021605700                   -0.96    7.1    3.27s
  2   -8.438464527731       -2.61       -1.79    2.0    1.50s
  3   -8.438530062375       -4.18       -2.84    4.0    2.44s
  4   -8.438530489388       -6.37       -4.01    3.9    2.77s
  5   -8.438530494163       -8.32       -4.52    4.3    2.23s
  6   -8.438530494502       -9.47       -5.68    3.8    2.36s
  7   -8.438530494506      -11.41       -6.82    4.4    2.23s
  8   -8.438530494506      -13.97       -7.58    3.6    2.41s
     4    -8.438530e+00     2.326148e-08
 * time: 218.6703679561615
 * Status: success

 * Candidate solution
    Final objective value:     -8.438530e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.69e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.65e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.09e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.29e-10 ≰ 0.0e+00
    |g(x)|                 = 2.33e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   219  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

Si: 301.469066 seconds (366.92 M allocations: 73.570 GiB, 8.04% gc time, 19.52% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-13T14:49:15.128
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.98984309780                   -1.19    8.4    29.3s
  2   -61.99240019547       -2.59       -1.26    2.9    15.0s
  3   -61.99575678278       -2.47       -2.18    4.2    13.0s
  4   -61.99575664120   +   -6.85       -2.55    4.2    15.7s
  5   -61.99576498667       -5.08       -3.61    3.4    11.3s
  6   -61.99576499575       -8.04       -4.57    4.2    14.4s
  7   -61.99576499591       -9.80       -5.32    4.4    12.9s
  8   -61.99576499592      -11.31       -7.26    4.2    14.7s
Iter     Function value   Gradient norm 
     0    -6.199576e+01     1.083894e-02
 * time: 4.57763671875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.98998597122                   -1.19    8.4    21.1s
  2   -61.99254278082       -2.59       -1.26    2.9    8.71s
  3   -61.99587349600       -2.48       -2.18    4.2    12.2s
  4   -61.99587354052       -7.35       -2.56    4.1    12.5s
  5   -61.99588156815       -5.10       -3.62    3.4    13.0s
  6   -61.99588157682       -8.06       -4.58    4.2    16.4s
  7   -61.99588157697       -9.83       -5.31    4.3    14.5s
  8   -61.99588157697      -11.32       -7.35    4.1    15.7s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.98998475133                   -1.19    8.4    21.0s
  2   -61.99253880429       -2.59       -1.26    2.8    9.71s
  3   -61.99587344875       -2.48       -2.18    4.2    13.4s
  4   -61.99587349771       -7.31       -2.56    4.1    12.1s
  5   -61.99588156774       -5.09       -3.62    3.3    11.2s
  6   -61.99588157681       -8.04       -4.55    4.2    13.6s
  7   -61.99588157697       -9.79       -5.25    4.3    12.1s
  8   -61.99588157697      -11.19       -7.29    4.1    11.4s
     1    -6.199588e+01     1.067223e-02
 * time: 257.14057779312134
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.99332349032                   -1.20    8.2    16.1s
  2   -61.99607608485       -2.56       -1.31    3.0    8.76s
  3   -61.99830158185       -2.65       -2.22    4.2    10.1s
  4   -61.99830506333       -5.46       -2.74    4.3    10.4s
  5   -61.99830798472       -5.53       -3.69    3.6    8.98s
  6   -61.99830799000       -8.28       -4.66    4.0    10.2s
  7   -61.99830799009      -10.08       -5.56    4.2    10.7s
  8   -61.99830799009      -11.86       -6.98    4.1    10.6s
  9   -61.99830799009   +  -13.45       -8.56    4.3    11.5s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.99332356333                   -1.20    8.0    16.5s
  2   -61.99607280346       -2.56       -1.31    3.0    8.19s
  3   -61.99830167686       -2.65       -2.22    4.3    10.2s
  4   -61.99830510235       -5.47       -2.74    4.3    11.1s
  5   -61.99830798500       -5.54       -3.70    3.6    8.91s
  6   -61.99830799001       -8.30       -4.68    4.1    10.2s
  7   -61.99830799008      -10.12       -5.51    4.3    10.6s
  8   -61.99830799009      -11.78       -6.92    4.0    11.1s
  9   -61.99830799009   +  -13.37       -8.45    4.3    11.1s
     2    -6.199831e+01     5.826146e-03
 * time: 483.70323491096497
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.99362102525                   -1.20    8.5    19.2s
  2   -61.99627100522       -2.58       -1.30    3.0    8.56s
  3   -61.99878960748       -2.60       -2.22    4.4    12.8s
  4   -61.99879148932       -5.73       -2.67    4.3    14.6s
  5   -61.99879593161       -5.35       -3.68    3.8    13.2s
  6   -61.99879593697       -8.27       -4.68    4.2    14.4s
  7   -61.99879593705      -10.12       -5.43    4.5    13.0s
  8   -61.99879593705      -11.61       -7.01    4.1    13.5s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.99362232988                   -1.20    8.6    22.4s
  2   -61.99627173761       -2.58       -1.30    3.2    10.1s
  3   -61.99878958853       -2.60       -2.22    4.4    14.0s
  4   -61.99879155887       -5.71       -2.67    4.3    14.0s
  5   -61.99879593163       -5.36       -3.68    3.8    12.2s
  6   -61.99879593697       -8.27       -4.70    4.2    14.1s
  7   -61.99879593705      -10.12       -5.48    4.5    11.4s
  8   -61.99879593705      -11.66       -7.23    4.1    11.3s
     3    -6.199880e+01     1.514655e-03
 * time: 735.6220638751984
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.99371093856                   -1.20    8.4    16.1s
  2   -61.99637724570       -2.57       -1.30    2.9    9.32s
  3   -61.99883219047       -2.61       -2.22    4.1    14.0s
  4   -61.99883446917       -5.64       -2.69    4.2    15.9s
  5   -61.99883852982       -5.39       -3.68    3.8    14.9s
  6   -61.99883853523       -8.27       -4.70    4.3    13.9s
  7   -61.99883853530      -10.10       -5.48    4.3    15.1s
  8   -61.99883853531      -11.70       -7.09    4.1    13.1s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.99371311492                   -1.20    8.4    19.6s
  2   -61.99638170786       -2.57       -1.30    3.1    9.73s
  3   -61.99883222537       -2.61       -2.22    4.2    10.4s
  4   -61.99883446475       -5.65       -2.69    4.3    11.6s
  5   -61.99883852985       -5.39       -3.69    3.8    13.0s
  6   -61.99883853522       -8.27       -4.68    4.2    14.7s
  7   -61.99883853530      -10.10       -5.44    4.4    11.6s
  8   -61.99883853531      -11.62       -7.01    4.1    11.1s
     4    -6.199884e+01     1.576744e-04
 * time: 982.0916278362274
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.99371537084                   -1.20    8.2    17.2s
  2   -61.99638732029       -2.57       -1.30    3.1    8.83s
  3   -61.99883253141       -2.61       -2.22    4.1    11.2s
  4   -61.99883484581       -5.64       -2.68    4.3    11.9s
  5   -61.99883897867       -5.38       -3.67    3.6    14.0s
  6   -61.99883898459       -8.23       -4.67    4.1    11.3s
  7   -61.99883898468      -10.04       -5.49    4.4    11.1s
  8   -61.99883898468      -11.69       -7.02    4.2    13.8s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.99371503626                   -1.20    8.2    21.0s
  2   -61.99638498109       -2.57       -1.30    3.0    10.5s
  3   -61.99883266862       -2.61       -2.22    4.1    10.5s
  4   -61.99883488323       -5.65       -2.68    4.2    10.8s
  5   -61.99883897911       -5.39       -3.68    3.5    9.13s
  6   -61.99883898460       -8.26       -4.70    4.2    10.4s
  7   -61.99883898468      -10.12       -5.48    4.4    11.6s
  8   -61.99883898468      -11.66       -6.94    4.2    11.7s
  9   -61.99883898468      -13.37       -8.31    4.3    11.7s
     5    -6.199884e+01     4.919309e-06
 * time: 1225.4809257984161
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.99371657099                   -1.20    8.0    16.0s
  2   -61.99638778940       -2.57       -1.30    3.0    8.25s
  3   -61.99883262421       -2.61       -2.22    4.1    10.5s
  4   -61.99883484001       -5.65       -2.68    4.1    11.5s
  5   -61.99883897944       -5.38       -3.67    3.6    8.60s
  6   -61.99883898503       -8.25       -4.66    4.1    10.7s
  7   -61.99883898512      -10.05       -5.47    4.4    10.9s
  8   -61.99883898512      -11.68       -6.92    4.1    10.3s
  9   -61.99883898512      -13.85       -8.26    4.3    11.1s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -61.99371345168                   -1.20    8.1    16.4s
  2   -61.99638925280       -2.57       -1.30    3.0    8.50s
  3   -61.99883245022       -2.61       -2.22    4.2    11.2s
  4   -61.99883482771       -5.62       -2.68    4.2    10.9s
  5   -61.99883897890       -5.38       -3.67    3.6    11.1s
  6   -61.99883898502       -8.21       -4.64    4.1    13.5s
  7   -61.99883898512      -10.01       -5.44    4.3    13.3s
  8   -61.99883898512      -11.60       -6.95    4.1    12.5s
  9   -61.99883898512      -13.11       -8.41    4.3    11.8s
     6    -6.199884e+01     1.815136e-08
 * time: 1473.81764793396
 * Status: success

 * Candidate solution
    Final objective value:     -6.199884e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.78e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.74e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 4.35e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 7.02e-12 ≰ 0.0e+00
    |g(x)|                 = 1.82e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   1474  (vs limit Inf)
    Iterations:    6
    f(x) calls:    7
    ∇f(x) calls:   7

NaCl: 1638.886317 seconds (1.23 G allocations: 360.171 GiB, 4.96% gc time, 0.32% compilation time)
┌ Info: 2025-05-13T15:16:34.069
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314632665607                   -1.45    5.5    1.86s
  2   -2.314743407945       -3.96       -1.84    1.4    1.16s
  3   -2.314770299714       -4.57       -3.60    3.4    1.41s
  4   -2.314770561876       -6.58       -4.17    4.7    2.07s
  5   -2.314770562181       -9.52       -4.61    2.6    1.10s
  6   -2.314770562233      -10.28       -5.17    2.7    1.50s
  7   -2.314770562236      -11.53       -6.01    2.7    1.11s
  8   -2.314770562236      -12.81       -6.58    3.5    1.39s
  9   -2.314770562236      -14.75       -7.40    2.5    1.40s
Iter     Function value   Gradient norm 
     0    -2.314771e+00     1.938235e-03
 * time: 4.7206878662109375e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314633365747                   -1.45    5.4    2.34s
  2   -2.314746643926       -3.95       -1.84    1.4    1.01s
  3   -2.314774024108       -4.56       -3.59    3.5    1.98s
  4   -2.314774240647       -6.66       -4.15    4.6    2.00s
  5   -2.314774240996       -9.46       -4.60    2.5    1.38s
  6   -2.314774241052      -10.25       -5.16    2.8    1.19s
  7   -2.314774241055      -11.54       -5.96    2.5    1.52s
  8   -2.314774241055      -12.73       -6.59    3.5    1.52s
  9   -2.314774241055      -14.40       -7.35    2.6    1.28s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314632319698                   -1.45    5.4    2.12s
  2   -2.314746439422       -3.94       -1.84    1.4    843ms
  3   -2.314774001524       -4.56       -3.60    3.5    1.75s
  4   -2.314774240694       -6.62       -4.17    4.7    1.79s
  5   -2.314774240999       -9.52       -4.61    2.6    1.71s
  6   -2.314774241051      -10.28       -5.16    2.8    1.27s
  7   -2.314774241055      -11.50       -5.99    2.6    1.52s
  8   -2.314774241055      -12.75       -6.60    3.3    1.45s
  9   -2.314774241055      -14.45       -7.40    2.7    1.18s
     1    -2.314774e+00     1.857860e-03
 * time: 60.7441930770874
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314683939039                   -1.45    5.5    2.44s
  2   -2.314790625675       -3.97       -1.84    1.4    833ms
  3   -2.314816037727       -4.59       -3.59    3.4    1.69s
  4   -2.314816217251       -6.75       -4.19    4.6    2.67s
  5   -2.314816217569       -9.50       -4.69    2.7    2.06s
  6   -2.314816217606      -10.42       -5.29    3.0    1.73s
  7   -2.314816217608      -11.82       -6.10    2.6    1.98s
  8   -2.314816217608      -13.18       -6.72    3.4    1.91s
  9   -2.314816217608      -15.35       -7.38    2.3    1.51s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314681821225                   -1.45    5.5    2.15s
  2   -2.314789582983       -3.97       -1.84    1.5    875ms
  3   -2.314816059366       -4.58       -3.56    3.5    1.72s
  4   -2.314816217181       -6.80       -4.16    4.5    1.74s
  5   -2.314816217559       -9.42       -4.67    2.7    1.46s
  6   -2.314816217606      -10.32       -5.29    3.0    1.26s
  7   -2.314816217608      -11.86       -6.09    2.6    1.58s
  8   -2.314816217608      -13.13       -6.76    3.4    1.40s
  9   -2.314816217608      -14.88       -7.40    2.4    1.46s
     2    -2.314816e+00     1.194185e-06
 * time: 126.11600613594055
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314684464587                   -1.45    5.5    2.52s
  2   -2.314790485271       -3.97       -1.84    1.5    1.01s
  3   -2.314816025064       -4.59       -3.58    3.5    1.91s
  4   -2.314816217255       -6.72       -4.19    4.6    2.14s
  5   -2.314816217582       -9.49       -4.68    2.7    1.71s
  6   -2.314816217623      -10.39       -5.31    3.1    1.41s
  7   -2.314816217624      -11.86       -6.12    2.6    1.46s
  8   -2.314816217624      -13.26       -6.74    3.2    1.27s
  9   -2.314816217624      -15.05       -7.37    2.5    1.34s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314684224806                   -1.45    5.5    2.10s
  2   -2.314790311848       -3.97       -1.84    1.4    796ms
  3   -2.314816033281       -4.59       -3.58    3.4    1.65s
  4   -2.314816217241       -6.74       -4.18    4.6    1.69s
  5   -2.314816217580       -9.47       -4.68    2.7    1.62s
  6   -2.314816217623      -10.37       -5.29    3.0    1.20s
  7   -2.314816217624      -11.83       -6.11    2.6    1.39s
  8   -2.314816217624      -13.17       -6.71    3.3    1.31s
  9   -2.314816217624      -15.05       -7.36    2.3    1.02s
     3    -2.314816e+00     6.209630e-08
 * time: 184.9732460975647
 * Status: success

 * Candidate solution
    Final objective value:     -2.314816e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.88e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.79e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.62e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 6.99e-12 ≰ 0.0e+00
    |g(x)|                 = 6.21e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   185  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Al: 219.253244 seconds (158.48 M allocations: 37.971 GiB, 6.57% gc time, 0.00% compilation time)
┌ Info: 2025-05-13T15:20:13.323
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.64680804586                   -0.79    9.6    13.6s
  2   -73.66420431763       -1.76       -1.00    5.4    6.39s
  3   -73.67262500969       -2.07       -1.31    6.7    8.06s
  4   -73.67435069086       -2.76       -1.74    6.1    6.66s
  5   -73.67451878067       -3.77       -2.27    5.2    7.15s
  6   -73.67453643228       -4.75       -3.09    5.6    7.22s
  7   -73.67453645951       -7.56       -3.54    4.1    6.77s
  8   -73.67453649125       -7.50       -4.29    5.5    8.74s
  9   -73.67453648939   +   -8.73       -4.36    5.3    7.57s
 10   -73.67453649168       -8.64       -4.93    5.8    6.26s
 11   -73.67453649167   +  -11.10       -5.76    5.0    6.28s
 12   -73.67453649168      -11.45       -6.33    4.9    6.86s
 13   -73.67453649168      -13.37       -6.48    2.9    4.91s
 14   -73.67453649168      -12.22       -7.12    4.9    5.99s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.367454e+01     2.609361e-02
 * time: 4.410743713378906e-5
┌ Warning: Negative ρcore detected: -3.2312676230360975e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.64825907042                   -0.80    9.7    14.3s
  2   -73.66490051263       -1.78       -1.00    5.4    8.64s
  3   -73.67330703560       -2.08       -1.32    6.7    10.3s
  4   -73.67498824361       -2.77       -1.75    6.0    8.18s
  5   -73.67515002893       -3.79       -2.28    5.1    8.97s
  6   -73.67516797996       -4.75       -3.10    5.6    11.0s
  7   -73.67516797828   +   -8.77       -3.54    4.9    10.9s
  8   -73.67516801339       -7.45       -4.15    5.3    9.87s
  9   -73.67516801177   +   -8.79       -4.33    5.6    9.78s
 10   -73.67516801419       -8.62       -4.87    5.8    8.39s
 11   -73.67516801421      -10.90       -5.57    4.2    7.40s
 12   -73.67516801421      -12.05       -6.25    5.1    7.94s
 13   -73.67516801421      -12.85       -6.51    4.3    5.79s
 14   -73.67516801421   +  -12.50       -7.06    5.2    6.88s
┌ Warning: Negative ρcore detected: -3.2312676230360975e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.64826033854                   -0.80    9.7    10.8s
  2   -73.66490461752       -1.78       -1.00    5.3    7.28s
  3   -73.67330647245       -2.08       -1.32    6.7    8.85s
  4   -73.67498751170       -2.77       -1.75    6.1    7.91s
  5   -73.67515048143       -3.79       -2.28    5.1    6.63s
  6   -73.67516797972       -4.76       -3.10    5.5    7.89s
  7   -73.67516797799   +   -8.76       -3.55    4.9    7.23s
  8   -73.67516801346       -7.45       -4.15    5.4    7.00s
  9   -73.67516801170   +   -8.75       -4.32    5.6    6.82s
 10   -73.67516801420       -8.60       -4.88    5.8    6.42s
 11   -73.67516801421      -10.93       -5.57    4.2    5.53s
 12   -73.67516801421      -12.01       -6.26    5.1    6.29s
 13   -73.67516801421      -13.85       -6.49    4.3    6.20s
 14   -73.67516801421   +  -12.70       -7.07    5.2    7.52s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.2312676230360975e-8,-1.3203080291722603e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.367517e+01     2.228155e-02
 * time: 303.57212495803833
┌ Warning: Negative ρcore detected: -4.2286054558420205e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.65368359441                   -0.81    9.7    14.7s
  2   -73.66781755700       -1.85       -1.02    5.1    9.17s
  3   -73.67508016613       -2.14       -1.34    6.6    10.8s
  4   -73.67648770782       -2.85       -1.72    5.9    12.2s
  5   -73.67669942479       -3.67       -2.58    5.5    11.7s
  6   -73.67670040257       -6.01       -3.16    5.3    11.8s
  7   -73.67670044267       -7.40       -3.77    5.1    10.5s
  8   -73.67670044511       -8.61       -4.04    4.4    10.1s
  9   -73.67670044560       -9.31       -4.59    5.3    10.3s
 10   -73.67670044610       -9.30       -5.19    5.2    10.0s
 11   -73.67670044611      -10.91       -6.11    5.1    7.98s
 12   -73.67670044611      -12.33       -6.52    5.3    9.14s
 13   -73.67670044611   +  -12.81       -7.08    5.1    8.58s
┌ Warning: Negative ρcore detected: -4.2286054558420205e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.65368790238                   -0.81    9.7    14.1s
  2   -73.66781388923       -1.85       -1.02    5.2    9.20s
  3   -73.67508045897       -2.14       -1.34    6.6    10.6s
  4   -73.67648727804       -2.85       -1.72    5.8    10.3s
  5   -73.67669939716       -3.67       -2.58    5.4    9.82s
  6   -73.67670040789       -6.00       -3.17    5.2    11.3s
  7   -73.67670044336       -7.45       -3.77    5.0    8.30s
  8   -73.67670044532       -8.71       -4.06    4.3    6.84s
  9   -73.67670044557       -9.60       -4.59    5.4    7.72s
 10   -73.67670044610       -9.28       -5.17    5.2    7.86s
 11   -73.67670044611      -10.88       -6.13    5.1    7.83s
 12   -73.67670044611      -12.67       -6.50    5.3    8.28s
 13   -73.67670044611   +  -13.25       -7.02    4.9    7.67s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-4.2286054558420205e-8,-3.4248876836847887e-9)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.367670e+01     2.978193e-03
 * time: 630.8991839885712
┌ Warning: Negative ρcore detected: -4.1547756663300494e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.65353308855                   -0.81    9.5    12.8s
  2   -73.66768158233       -1.85       -1.01    5.1    8.18s
  3   -73.67504247685       -2.13       -1.33    6.5    9.95s
  4   -73.67649835067       -2.84       -1.71    5.8    8.28s
  5   -73.67672373447       -3.65       -2.57    5.4    7.89s
  6   -73.67672499284       -5.90       -3.17    5.4    8.75s
  7   -73.67672501506       -7.65       -3.73    5.0    11.7s
  8   -73.67672501780       -8.56       -4.01    4.4    8.54s
  9   -73.67672501851       -9.15       -4.57    5.4    8.86s
 10   -73.67672501901       -9.30       -5.00    5.1    10.2s
 11   -73.67672501905      -10.32       -5.95    5.1    9.62s
 12   -73.67672501906      -12.37       -6.42    4.9    9.01s
 13   -73.67672501906   +  -12.94       -7.00    4.1    7.30s
┌ Warning: Negative ρcore detected: -4.1547756663300494e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.65352956667                   -0.81    9.6    13.3s
  2   -73.66768883537       -1.85       -1.01    5.3    8.24s
  3   -73.67504223679       -2.13       -1.33    6.5    11.3s
  4   -73.67649847633       -2.84       -1.71    5.9    9.26s
  5   -73.67672371557       -3.65       -2.56    5.4    9.32s
  6   -73.67672498918       -5.89       -3.16    5.4    9.02s
  7   -73.67672501446       -7.60       -3.73    5.0    8.97s
  8   -73.67672501764       -8.50       -4.01    4.4    8.18s
  9   -73.67672501852       -9.06       -4.57    5.3    8.45s
 10   -73.67672501901       -9.31       -5.01    5.1    10.3s
 11   -73.67672501905      -10.33       -5.97    5.1    9.59s
 12   -73.67672501906      -12.42       -6.44    4.9    10.2s
 13   -73.67672501906   +    -Inf       -7.00    4.2    6.86s
 14   -73.67672501906   +    -Inf       -7.55    5.2    8.65s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-4.1547756663300494e-8,8.354534321950734e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.367673e+01     2.327827e-04
 * time: 948.5430369377136
┌ Warning: Negative ρcore detected: -4.1652830052188666e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.65354978572                   -0.81    9.7    14.3s
  2   -73.66770264039       -1.85       -1.01    5.2    9.81s
  3   -73.67504667491       -2.13       -1.33    6.6    11.1s
  4   -73.67649885776       -2.84       -1.71    5.9    10.0s
  5   -73.67672398002       -3.65       -2.57    5.4    8.82s
  6   -73.67672514400       -5.93       -3.17    5.4    10.0s
  7   -73.67672516888       -7.60       -3.74    5.0    9.47s
  8   -73.67672517134       -8.61       -4.02    4.4    7.97s
  9   -73.67672517186       -9.28       -4.58    5.3    9.08s
 10   -73.67672517237       -9.29       -5.02    5.1    10.6s
 11   -73.67672517242      -10.35       -5.98    5.1    10.1s
 12   -73.67672517242      -12.67       -6.43    4.7    11.0s
 13   -73.67672517242      -13.85       -7.01    4.8    9.23s
┌ Warning: Negative ρcore detected: -4.1652830052188666e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.65354336611                   -0.81    9.8    16.3s
  2   -73.66770411981       -1.85       -1.01    5.2    12.5s
  3   -73.67504623494       -2.13       -1.33    6.6    15.6s
  4   -73.67649967955       -2.84       -1.71    5.9    10.5s
  5   -73.67672398198       -3.65       -2.57    5.4    8.38s
  6   -73.67672513168       -5.94       -3.16    5.3    8.49s
  7   -73.67672516684       -7.45       -3.73    5.1    8.81s
  8   -73.67672517055       -8.43       -3.98    4.4    8.35s
  9   -73.67672517198       -8.85       -4.59    5.3    8.68s
 10   -73.67672517238       -9.40       -5.02    5.0    7.77s
 11   -73.67672517242      -10.39       -6.01    5.1    7.83s
 12   -73.67672517242   +  -13.55       -6.39    4.7    8.97s
 13   -73.67672517242      -12.81       -7.05    4.9    7.84s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-4.1652830052188666e-8,7.76437477799475e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     4    -7.367673e+01     2.569074e-06
 * time: 1276.653408050537
┌ Warning: Negative ρcore detected: -4.16539593965425e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.65353769521                   -0.81    9.8    18.5s
  2   -73.66770106985       -1.85       -1.01    5.3    10.9s
  3   -73.67504768242       -2.13       -1.33    6.7    13.2s
  4   -73.67649923530       -2.84       -1.71    5.8    11.9s
  5   -73.67672400037       -3.65       -2.57    5.4    11.2s
  6   -73.67672513716       -5.94       -3.17    5.4    9.56s
  7   -73.67672516776       -7.51       -3.74    5.1    8.54s
  8   -73.67672517094       -8.50       -4.00    4.4    7.34s
  9   -73.67672517195       -9.00       -4.59    5.3    8.36s
 10   -73.67672517240       -9.35       -5.03    5.0    8.41s
 11   -73.67672517244      -10.39       -6.01    5.1    7.96s
 12   -73.67672517244      -13.25       -6.41    4.7    7.93s
 13   -73.67672517244      -12.94       -7.02    4.9    8.37s
┌ Warning: Negative ρcore detected: -4.16539593965425e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.65354486201                   -0.81    9.6    14.8s
  2   -73.66770808850       -1.85       -1.01    5.1    8.56s
  3   -73.67504518239       -2.13       -1.33    6.6    11.7s
  4   -73.67649951200       -2.84       -1.71    5.8    9.55s
  5   -73.67672397286       -3.65       -2.57    5.4    12.3s
  6   -73.67672514145       -5.93       -3.17    5.4    12.0s
  7   -73.67672516826       -7.57       -3.73    5.0    9.47s
  8   -73.67672517109       -8.55       -4.00    4.3    7.22s
  9   -73.67672517190       -9.09       -4.57    5.4    8.33s
 10   -73.67672517239       -9.31       -5.01    5.1    8.04s
 11   -73.67672517244      -10.35       -5.98    5.0    7.92s
 12   -73.67672517244      -12.59       -6.46    5.0    12.3s
 13   -73.67672517244      -13.07       -6.98    4.3    8.11s
 14   -73.67672517244   +  -13.15       -7.59    5.2    8.56s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-4.16539593965425e-8,7.757753079551596e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     5    -7.367673e+01     1.628384e-07
 * time: 1616.5696499347687
 * Status: success

 * Candidate solution
    Final objective value:     -7.367673e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.45e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.63e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.67e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.27e-13 ≰ 0.0e+00
    |g(x)|                 = 1.63e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   1617  (vs limit Inf)
    Iterations:    5
    f(x) calls:    6
    ∇f(x) calls:   6

V: 1773.631808 seconds (808.88 M allocations: 382.602 GiB, 4.98% gc time, 0.01% compilation time)
