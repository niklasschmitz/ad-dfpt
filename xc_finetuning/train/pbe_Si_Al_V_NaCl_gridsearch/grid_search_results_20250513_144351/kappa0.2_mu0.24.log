┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-13T14:44:10.549
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.449685156383                   -0.97    6.9    14.7s
  2   -8.452016447188       -2.63       -1.73    2.1    6.74s
  3   -8.452071230943       -4.26       -2.85    3.8    2.20s
  4   -8.452071737600       -6.30       -3.96    3.7    2.67s
  5   -8.452071738311       -9.15       -4.73    3.6    2.14s
  6   -8.452071738335      -10.62       -5.94    3.5    2.56s
  7   -8.452071738336      -11.97       -6.57    4.3    2.67s
  8   -8.452071738336      -14.15       -7.67    2.9    1.67s
Iter     Function value   Gradient norm 
     0    -8.452072e+00     5.859127e-03
 * time: 4.601478576660156e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.449670975086                   -0.97    7.0    3.15s
  2   -8.452040045681       -2.63       -1.73    2.3    1.55s
  3   -8.452104263496       -4.19       -2.85    3.7    2.92s
  4   -8.452104871600       -6.22       -3.96    3.8    2.99s
  5   -8.452104872953       -8.87       -4.69    3.9    2.17s
  6   -8.452104873019      -10.18       -5.72    3.8    2.94s
  7   -8.452104873021      -11.73       -6.54    4.1    2.86s
  8   -8.452104873021   +    -Inf       -7.66    3.3    2.57s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.449671404766                   -0.97    7.2    3.50s
  2   -8.452039715656       -2.63       -1.73    2.2    1.86s
  3   -8.452104296265       -4.19       -2.85    3.7    2.27s
  4   -8.452104871899       -6.24       -3.97    3.8    2.71s
  5   -8.452104872931       -8.99       -4.69    3.9    2.08s
  6   -8.452104873019      -10.06       -5.68    3.7    2.26s
  7   -8.452104873021      -11.67       -6.56    4.2    2.70s
  8   -8.452104873021      -13.91       -7.62    3.8    2.58s
     1    -8.452105e+00     5.450953e-03
 * time: 58.89273285865784
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.449709823278                   -0.96    7.2    3.17s
  2   -8.452251574594       -2.59       -1.77    2.2    1.77s
  3   -8.452311600909       -4.22       -2.80    3.8    3.32s
  4   -8.452312126279       -6.28       -4.00    3.7    2.69s
  5   -8.452312130229       -8.40       -4.55    4.4    3.53s
  6   -8.452312130536       -9.51       -5.57    3.9    2.60s
  7   -8.452312130541      -11.28       -6.64    4.2    3.39s
  8   -8.452312130542      -13.26       -7.62    4.4    2.95s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.449702194706                   -0.96    7.1    3.52s
  2   -8.452249299549       -2.59       -1.77    2.3    1.73s
  3   -8.452311495574       -4.21       -2.80    3.8    2.81s
  4   -8.452312126769       -6.20       -4.01    3.7    2.29s
  5   -8.452312130245       -8.46       -4.56    4.4    2.97s
  6   -8.452312130536       -9.54       -5.58    3.8    2.18s
  7   -8.452312130541      -11.30       -6.57    4.2    2.68s
  8   -8.452312130542      -13.21       -7.64    4.3    2.53s
     2    -8.452312e+00     2.231792e-04
 * time: 118.73555397987366
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.449734190695                   -0.96    7.3    3.83s
  2   -8.452254757980       -2.60       -1.77    2.5    2.06s
  3   -8.452311974161       -4.24       -2.80    3.9    2.38s
  4   -8.452312457606       -6.32       -4.01    3.8    2.89s
  5   -8.452312461285       -8.43       -4.58    4.4    2.56s
  6   -8.452312461538       -9.60       -5.62    3.9    2.58s
  7   -8.452312461542      -11.36       -6.60    4.3    2.58s
  8   -8.452312461542      -13.27       -7.67    4.4    2.89s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.449723365022                   -0.96    7.4    3.26s
  2   -8.452249096113       -2.60       -1.77    2.3    2.02s
  3   -8.452311911886       -4.20       -2.81    3.8    2.45s
  4   -8.452312456624       -6.26       -4.00    3.7    2.84s
  5   -8.452312461164       -8.34       -4.52    4.4    2.64s
  6   -8.452312461536       -9.43       -5.56    4.0    2.67s
  7   -8.452312461542      -11.24       -6.59    4.2    2.34s
  8   -8.452312461542      -13.22       -7.62    4.3    2.94s
     3    -8.452312e+00     7.975234e-06
 * time: 176.8255500793457
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.449730678408                   -0.96    7.4    3.71s
  2   -8.452251991267       -2.60       -1.77    2.2    1.73s
  3   -8.452311848350       -4.22       -2.80    3.9    2.83s
  4   -8.452312458422       -6.21       -4.00    3.8    2.65s
  5   -8.452312461709       -8.48       -4.57    4.3    2.52s
  6   -8.452312461961       -9.60       -5.60    3.9    2.68s
  7   -8.452312461966      -11.32       -6.59    4.3    2.44s
  8   -8.452312461966      -13.30       -7.66    4.4    2.90s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.449723524007                   -0.96    7.4    3.76s
  2   -8.452249193452       -2.60       -1.77    2.3    2.17s
  3   -8.452311839557       -4.20       -2.81    4.0    2.28s
  4   -8.452312458318       -6.21       -4.00    3.9    2.90s
  5   -8.452312461673       -8.47       -4.56    4.4    2.67s
  6   -8.452312461961       -9.54       -5.60    4.1    2.43s
  7   -8.452312461966      -11.36       -6.54    4.3    2.19s
  8   -8.452312461966      -13.19       -7.75    4.3    2.48s
     4    -8.452312e+00     9.391464e-09
 * time: 233.10778403282166
 * Status: success

 * Candidate solution
    Final objective value:     -8.452312e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.06e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.03e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 4.24e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 5.01e-11 ≰ 0.0e+00
    |g(x)|                 = 9.39e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   233  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

Si: 326.610429 seconds (365.73 M allocations: 73.126 GiB, 7.81% gc time, 19.97% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-13T14:49:37.966
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.05274113150                   -1.20    8.3    24.7s
  2   -62.05523508817       -2.60       -1.26    2.8    9.61s
  3   -62.05868024520       -2.46       -2.17    4.3    11.7s
  4   -62.05868153592       -5.89       -2.56    4.1    12.6s
  5   -62.05868961312       -5.09       -3.63    3.4    9.69s
  6   -62.05868962053       -8.13       -4.56    4.1    12.9s
  7   -62.05868962070       -9.78       -5.68    4.3    12.8s
  8   -62.05868962070      -12.02       -7.12    4.2    13.7s
Iter     Function value   Gradient norm 
     0    -6.205869e+01     1.121268e-02
 * time: 3.790855407714844e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.05288324501                   -1.20    8.5    23.4s
  2   -62.05538400640       -2.60       -1.26    2.7    9.80s
  3   -62.05880494636       -2.47       -2.17    4.0    13.9s
  4   -62.05880635077       -5.85       -2.56    4.0    16.7s
  5   -62.05881437252       -5.10       -3.62    3.2    13.5s
  6   -62.05881438067       -8.09       -4.53    4.2    15.9s
  7   -62.05881438086       -9.73       -5.41    4.3    13.2s
  8   -62.05881438086      -11.50       -7.34    4.2    13.9s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.05288045208                   -1.20    8.4    18.0s
  2   -62.05537392167       -2.60       -1.26    3.0    8.71s
  3   -62.05880497286       -2.46       -2.17    4.2    11.2s
  4   -62.05880644419       -5.83       -2.57    4.1    11.4s
  5   -62.05881437269       -5.10       -3.63    3.3    9.61s
  6   -62.05881438068       -8.10       -4.54    4.1    12.2s
  7   -62.05881438086       -9.74       -5.30    4.4    12.7s
  8   -62.05881438086      -11.28       -7.23    4.2    11.8s
     1    -6.205881e+01     1.104037e-02
 * time: 251.78920006752014
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.05630334577                   -1.21    8.4    18.1s
  2   -62.05905405021       -2.56       -1.31    3.1    8.74s
  3   -62.06133948241       -2.64       -2.21    4.3    12.5s
  4   -62.06134413596       -5.33       -2.75    4.4    11.2s
  5   -62.06134693123       -5.55       -3.70    3.8    12.8s
  6   -62.06134693569       -8.35       -4.64    4.2    11.5s
  7   -62.06134693579       -9.99       -5.63    4.3    11.6s
  8   -62.06134693579      -11.99       -7.13    4.2    15.0s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.05629899033                   -1.21    8.4    18.5s
  2   -62.05905106778       -2.56       -1.31    3.1    8.41s
  3   -62.06133951083       -2.64       -2.22    4.3    10.9s
  4   -62.06134420611       -5.33       -2.76    4.2    11.7s
  5   -62.06134693144       -5.56       -3.71    3.7    9.94s
  6   -62.06134693570       -8.37       -4.65    4.1    11.0s
  7   -62.06134693579      -10.03       -5.61    4.4    11.3s
  8   -62.06134693579      -11.93       -7.33    4.1    11.0s
     2    -6.206135e+01     6.333109e-03
 * time: 484.469407081604
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.05668631329                   -1.21    8.7    20.9s
  2   -62.05930818611       -2.58       -1.30    3.0    13.3s
  3   -62.06189896321       -2.59       -2.20    4.3    17.2s
  4   -62.06190200277       -5.52       -2.67    4.2    16.3s
  5   -62.06190643076       -5.35       -3.69    3.9    13.3s
  6   -62.06190643549       -8.33       -4.66    4.2    10.8s
  7   -62.06190643559      -10.01       -5.69    4.2    10.9s
  8   -62.06190643559      -12.07       -7.46    4.3    11.6s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.05668855884                   -1.21    8.7    19.7s
  2   -62.05930893326       -2.58       -1.30    2.9    11.2s
  3   -62.06189901837       -2.59       -2.20    4.3    12.9s
  4   -62.06190205594       -5.52       -2.68    4.3    14.6s
  5   -62.06190643093       -5.36       -3.69    3.8    13.1s
  6   -62.06190643550       -8.34       -4.67    4.3    13.6s
  7   -62.06190643559      -10.05       -5.60    4.3    12.5s
  8   -62.06190643559      -11.89       -7.16    4.3    10.9s
     3    -6.206191e+01     1.676135e-03
 * time: 745.3865020275116
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.05679457492                   -1.21    8.6    19.0s
  2   -62.05943138424       -2.58       -1.30    2.9    11.6s
  3   -62.06195056365       -2.60       -2.21    4.2    12.0s
  4   -62.06195391184       -5.48       -2.69    4.3    14.8s
  5   -62.06195787473       -5.40       -3.70    3.8    12.1s
  6   -62.06195787914       -8.36       -4.67    4.2    12.0s
  7   -62.06195787923      -10.05       -5.65    4.3    10.9s
  8   -62.06195787923      -12.01       -7.27    4.2    10.5s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.05679063448                   -1.21    8.3    16.3s
  2   -62.05943181492       -2.58       -1.30    2.8    8.83s
  3   -62.06195051646       -2.60       -2.21    4.2    13.6s
  4   -62.06195391317       -5.47       -2.69    4.2    12.4s
  5   -62.06195787453       -5.40       -3.70    3.7    12.7s
  6   -62.06195787913       -8.34       -4.66    4.3    14.8s
  7   -62.06195787923      -10.03       -5.65    4.3    14.4s
  8   -62.06195787923      -12.01       -7.27    4.2    14.1s
     4    -6.206196e+01     1.859738e-04
 * time: 995.6205608844757
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.05679980968                   -1.21    8.2    21.4s
  2   -62.05944285488       -2.58       -1.30    2.9    9.29s
  3   -62.06195110937       -2.60       -2.21    4.1    10.0s
  4   -62.06195449860       -5.47       -2.69    4.2    13.6s
  5   -62.06195848938       -5.40       -3.69    3.6    12.8s
  6   -62.06195849412       -8.32       -4.64    4.2    10.9s
  7   -62.06195849422      -10.00       -5.70    4.2    11.0s
  8   -62.06195849422      -12.12       -7.16    4.2    10.7s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.05679707726                   -1.21    8.2    16.3s
  2   -62.05944005326       -2.58       -1.30    2.9    7.95s
  3   -62.06195119093       -2.60       -2.21    4.1    9.77s
  4   -62.06195455060       -5.47       -2.69    4.2    10.0s
  5   -62.06195848966       -5.40       -3.70    3.6    8.66s
  6   -62.06195849413       -8.35       -4.67    4.2    10.1s
  7   -62.06195849422      -10.04       -5.59    4.3    11.2s
  8   -62.06195849422      -11.90       -7.14    4.1    12.9s
     5    -6.206196e+01     6.463899e-06
 * time: 1226.766795873642
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.05679703732                   -1.21    8.4    22.0s
  2   -62.05944279515       -2.58       -1.30    3.0    10.3s
  3   -62.06195110997       -2.60       -2.21    4.2    10.0s
  4   -62.06195454353       -5.46       -2.69    4.3    15.1s
  5   -62.06195848987       -5.40       -3.68    3.7    14.6s
  6   -62.06195849483       -8.30       -4.61    4.2    17.1s
  7   -62.06195849495       -9.95       -5.63    4.3    12.1s
  8   -62.06195849495      -12.00       -7.18    4.2    10.8s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.05679651043                   -1.21    8.3    15.8s
  2   -62.05943832328       -2.58       -1.30    3.0    7.91s
  3   -62.06195119056       -2.60       -2.21    4.2    10.3s
  4   -62.06195455461       -5.47       -2.69    4.3    11.5s
  5   -62.06195849042       -5.40       -3.70    3.8    12.0s
  6   -62.06195849485       -8.35       -4.66    4.2    10.9s
  7   -62.06195849495      -10.03       -5.60    4.3    11.0s
  8   -62.06195849495      -11.94       -7.26    4.2    10.1s
     6    -6.206196e+01     3.677979e-08
 * time: 1459.737312078476
 * Status: success

 * Candidate solution
    Final objective value:     -6.206196e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.30e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.25e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 7.30e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.18e-11 ≰ 0.0e+00
    |g(x)|                 = 3.68e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   1460  (vs limit Inf)
    Iterations:    6
    f(x) calls:    7
    ∇f(x) calls:   7

NaCl: 1602.421475 seconds (1.20 G allocations: 347.667 GiB, 4.87% gc time, 0.27% compilation time)
┌ Info: 2025-05-13T15:16:20.424
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317040325000                   -1.47    5.5    1.85s
  2   -2.317139260861       -4.00       -1.85    1.4    940ms
  3   -2.317160564199       -4.67       -3.57    3.3    1.64s
  4   -2.317160770365       -6.69       -3.94    4.5    2.01s
  5   -2.317160770976       -9.21       -4.20    2.1    975ms
  6   -2.317160771200       -9.65       -5.22    2.5    1.36s
  7   -2.317160771205      -11.28       -5.98    3.4    1.36s
  8   -2.317160771205      -13.13       -6.60    2.8    1.25s
  9   -2.317160771205      -14.45       -6.93    2.4    1.43s
 10   -2.317160771205      -14.88       -7.72    2.6    1.15s
Iter     Function value   Gradient norm 
     0    -2.317161e+00     7.207672e-04
 * time: 3.0994415283203125e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317042378433                   -1.47    5.5    2.16s
  2   -2.317139153040       -4.01       -1.85    1.3    1.29s
  3   -2.317161045444       -4.66       -3.54    3.4    1.44s
  4   -2.317161278655       -6.63       -3.92    4.5    2.19s
  5   -2.317161279357       -9.15       -4.19    2.1    1.05s
  6   -2.317161279585       -9.64       -5.16    2.5    1.96s
  7   -2.317161279590      -11.28       -5.98    3.2    1.67s
  8   -2.317161279590      -12.97       -6.53    2.9    2.06s
  9   -2.317161279590      -14.10       -6.95    2.7    2.00s
 10   -2.317161279590      -15.35       -7.83    2.8    1.66s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317044020438                   -1.47    5.4    2.70s
  2   -2.317139427920       -4.02       -1.85    1.4    1.13s
  3   -2.317161060413       -4.66       -3.55    3.3    2.24s
  4   -2.317161278640       -6.66       -3.93    4.5    2.43s
  5   -2.317161279350       -9.15       -4.19    2.2    1.79s
  6   -2.317161279584       -9.63       -5.15    2.4    1.50s
  7   -2.317161279590      -11.22       -5.98    3.2    2.13s
  8   -2.317161279590      -12.98       -6.52    2.9    1.73s
  9   -2.317161279590      -14.03       -6.99    2.7    1.98s
 10   -2.317161279590      -15.35       -7.79    2.9    1.72s
     1    -2.317161e+00     6.899192e-04
 * time: 72.01503586769104
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317048098738                   -1.46    5.5    2.39s
  2   -2.317145142044       -4.01       -1.85    1.3    1.29s
  3   -2.317166723248       -4.67       -3.53    3.4    1.50s
  4   -2.317166916181       -6.71       -3.88    4.5    2.09s
  5   -2.317166917102       -9.04       -4.13    2.1    1.05s
  6   -2.317166917441       -9.47       -5.05    2.6    1.18s
  7   -2.317166917450      -11.07       -5.80    3.0    1.57s
  8   -2.317166917450      -12.75       -6.46    2.7    1.20s
  9   -2.317166917450      -14.21       -6.82    2.5    1.46s
 10   -2.317166917450      -14.88       -7.56    2.5    1.11s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317050949822                   -1.46    5.4    2.63s
  2   -2.317145768968       -4.02       -1.85    1.4    1.58s
  3   -2.317166695689       -4.68       -3.54    3.4    2.05s
  4   -2.317166916244       -6.66       -3.89    4.4    2.26s
  5   -2.317166917111       -9.06       -4.14    2.1    1.12s
  6   -2.317166917442       -9.48       -5.05    2.5    1.53s
  7   -2.317166917450      -11.08       -5.81    3.0    1.34s
  8   -2.317166917450      -12.83       -6.34    2.6    1.77s
  9   -2.317166917450      -13.85       -6.79    2.5    1.25s
 10   -2.317166917450   +  -15.35       -7.42    2.6    1.39s
     2    -2.317167e+00     1.365704e-05
 * time: 136.29468894004822
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317048723926                   -1.46    5.5    2.30s
  2   -2.317145417258       -4.01       -1.85    1.3    1.29s
  3   -2.317166710899       -4.67       -3.54    3.4    1.60s
  4   -2.317166918532       -6.68       -3.89    4.5    2.25s
  5   -2.317166919372       -9.08       -4.14    2.1    1.28s
  6   -2.317166919702       -9.48       -5.07    2.6    1.69s
  7   -2.317166919711      -11.09       -5.80    3.1    1.39s
  8   -2.317166919711      -12.79       -6.41    2.6    1.55s
  9   -2.317166919711      -14.05       -6.72    2.5    1.23s
 10   -2.317166919711      -14.75       -7.47    2.5    1.33s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317047719072                   -1.46    5.5    2.16s
  2   -2.317145951161       -4.01       -1.85    1.4    834ms
  3   -2.317166722584       -4.68       -3.55    3.4    1.68s
  4   -2.317166918568       -6.71       -3.90    4.5    2.01s
  5   -2.317166919372       -9.09       -4.14    2.1    1.48s
  6   -2.317166919703       -9.48       -5.09    2.6    1.39s
  7   -2.317166919711      -11.12       -5.79    3.1    1.90s
  8   -2.317166919711      -12.80       -6.41    2.7    1.43s
  9   -2.317166919711      -14.27       -6.72    2.5    1.22s
 10   -2.317166919711      -14.75       -7.44    2.6    1.40s
     3    -2.317167e+00     2.282771e-07
 * time: 200.01776790618896
 * Status: success

 * Candidate solution
    Final objective value:     -2.317167e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.26e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.27e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.26e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 9.76e-10 ≰ 0.0e+00
    |g(x)|                 = 2.28e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   200  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Al: 234.998169 seconds (168.43 M allocations: 40.271 GiB, 6.57% gc time, 0.00% compilation time)
┌ Info: 2025-05-13T15:20:15.423
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70585917072                   -0.80    9.7    11.7s
  2   -73.72153844325       -1.80       -1.01    5.3    6.79s
  3   -73.72975594158       -2.09       -1.32    6.6    9.14s
  4   -73.73137365930       -2.79       -1.74    6.0    7.94s
  5   -73.73154006072       -3.78       -2.28    5.1    7.28s
  6   -73.73155783814       -4.75       -3.09    5.6    7.94s
  7   -73.73155779248   +   -7.34       -3.47    5.2    7.74s
  8   -73.73155785374       -7.21       -3.90    5.2    7.04s
  9   -73.73155785893       -8.28       -4.26    5.7    7.76s
 10   -73.73155786214       -8.49       -4.82    5.6    7.64s
 11   -73.73155786221      -10.15       -5.55    5.4    7.43s
 12   -73.73155786221      -11.94       -6.21    5.2    7.39s
 13   -73.73155786221   +  -13.37       -6.42    4.6    6.68s
 14   -73.73155786221   +  -12.49       -7.21    5.0    6.62s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.373156e+01     2.601762e-02
 * time: 3.1948089599609375e-5
┌ Warning: Negative ρcore detected: -3.232269471527103e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70729431842                   -0.81    9.5    13.2s
  2   -73.72229359893       -1.82       -1.01    5.1    6.98s
  3   -73.73041688228       -2.09       -1.33    6.6    9.15s
  4   -73.73200316274       -2.80       -1.74    5.9    7.78s
  5   -73.73216902373       -3.78       -2.29    5.1    7.19s
  6   -73.73218567926       -4.78       -3.09    5.4    8.76s
  7   -73.73218565175   +   -7.56       -3.51    5.1    7.85s
  8   -73.73218569930       -7.32       -3.92    5.1    7.05s
  9   -73.73218570253       -8.49       -4.27    5.6    8.02s
 10   -73.73218570576       -8.49       -4.80    5.4    7.58s
 11   -73.73218570586       -9.98       -5.49    5.3    8.61s
 12   -73.73218570587      -11.14       -6.17    5.1    7.88s
 13   -73.73218570587      -12.45       -6.68    5.1    7.69s
 14   -73.73218570587      -13.07       -7.42    4.7    6.74s
┌ Warning: Negative ρcore detected: -3.232269471527103e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70730026176                   -0.81    9.6    11.7s
  2   -73.72229989765       -1.82       -1.01    5.2    6.79s
  3   -73.73041450045       -2.09       -1.33    6.5    8.67s
  4   -73.73200356917       -2.80       -1.74    5.9    8.29s
  5   -73.73216899400       -3.78       -2.29    5.1    7.64s
  6   -73.73218567921       -4.78       -3.09    5.5    9.08s
  7   -73.73218565227   +   -7.57       -3.51    5.1    9.64s
  8   -73.73218569936       -7.33       -3.92    5.1    7.08s
  9   -73.73218570253       -8.50       -4.27    5.6    8.00s
 10   -73.73218570577       -8.49       -4.80    5.4    7.90s
 11   -73.73218570586      -10.02       -5.50    5.3    7.67s
 12   -73.73218570587      -11.15       -6.20    5.1    7.67s
 13   -73.73218570587      -12.47       -6.77    5.1    7.55s
 14   -73.73218570587      -13.85       -7.35    4.8    6.63s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.232269471527103e-8,-1.3165237183647742e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.373219e+01     2.222010e-02
 * time: 296.59865498542786
┌ Warning: Negative ρcore detected: -4.228695048170614e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71201891056                   -0.82    9.6    17.6s
  2   -73.72528906590       -1.88       -1.03    5.1    10.5s
  3   -73.73220831408       -2.16       -1.35    6.5    11.9s
  4   -73.73352807460       -2.88       -1.74    5.8    8.32s
  5   -73.73371373355       -3.73       -2.61    5.3    9.53s
  6   -73.73371510022       -5.86       -3.16    5.3    11.8s
  7   -73.73371516351       -7.20       -3.70    5.2    11.8s
  8   -73.73371517390       -7.98       -4.13    4.9    10.6s
  9   -73.73371517527       -8.86       -4.66    5.3    11.6s
 10   -73.73371517556       -9.54       -5.79    5.3    10.4s
 11   -73.73371517556   +  -12.38       -6.25    5.0    8.13s
 12   -73.73371517556      -12.13       -6.87    5.5    8.58s
 13   -73.73371517556   +  -13.55       -7.37    5.2    10.0s
┌ Warning: Negative ρcore detected: -4.228695048170614e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71202023795                   -0.82    9.6    17.9s
  2   -73.72528477756       -1.88       -1.03    5.2    9.72s
  3   -73.73220878748       -2.16       -1.35    6.5    11.9s
  4   -73.73352809236       -2.88       -1.74    5.8    11.3s
  5   -73.73371369744       -3.73       -2.60    5.3    10.9s
  6   -73.73371510406       -5.85       -3.16    5.3    11.6s
  7   -73.73371516354       -7.23       -3.70    5.2    8.70s
  8   -73.73371517397       -7.98       -4.14    4.9    7.32s
  9   -73.73371517527       -8.88       -4.66    5.4    9.12s
 10   -73.73371517556       -9.54       -5.78    5.2    9.36s
 11   -73.73371517556   +  -12.55       -6.25    4.8    8.27s
 12   -73.73371517556      -12.19       -6.84    5.6    7.93s
 13   -73.73371517556      -13.37       -7.35    5.2    9.42s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-4.228695048170614e-8,-1.5731199981867312e-9)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.373372e+01     2.918067e-03
 * time: 644.1602549552917
┌ Warning: Negative ρcore detected: -4.154372963204001e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71164003154                   -0.82    9.7    14.7s
  2   -73.72514591230       -1.87       -1.02    5.1    7.38s
  3   -73.73220239515       -2.15       -1.35    6.5    9.36s
  4   -73.73353107678       -2.88       -1.73    5.8    9.19s
  5   -73.73373747635       -3.69       -2.60    5.4    8.68s
  6   -73.73373847808       -6.00       -3.17    5.4    8.72s
  7   -73.73373853203       -7.27       -3.74    5.0    9.56s
  8   -73.73373853525       -8.49       -4.06    4.4    8.45s
  9   -73.73373853620       -9.02       -4.60    5.2    9.14s
 10   -73.73373853667       -9.33       -5.31    5.1    8.38s
 11   -73.73373853667      -11.10       -6.10    5.1    9.42s
 12   -73.73373853667      -12.33       -6.64    5.5    10.3s
 13   -73.73373853667   +    -Inf       -7.15    4.9    9.40s
┌ Warning: Negative ρcore detected: -4.154372963204001e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71164266155                   -0.82    9.5    15.3s
  2   -73.72514786503       -1.87       -1.02    5.1    8.38s
  3   -73.73220180321       -2.15       -1.35    6.4    10.7s
  4   -73.73353086673       -2.88       -1.73    5.7    11.2s
  5   -73.73373756019       -3.68       -2.61    5.4    11.1s
  6   -73.73373846741       -6.04       -3.16    5.3    10.8s
  7   -73.73373853095       -7.20       -3.74    5.0    9.54s
  8   -73.73373853498       -8.39       -4.04    4.5    11.5s
  9   -73.73373853626       -8.89       -4.62    5.3    9.57s
 10   -73.73373853666       -9.40       -5.30    5.1    9.53s
 11   -73.73373853667      -11.06       -6.10    5.2    8.22s
 12   -73.73373853667      -12.30       -6.63    5.5    9.63s
 13   -73.73373853667      -13.85       -7.18    4.9    7.87s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-4.154372963204001e-8,8.376202146690694e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.373374e+01     2.577625e-04
 * time: 969.3333759307861
┌ Warning: Negative ρcore detected: -4.1659221030755346e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71167000503                   -0.82    9.7    14.2s
  2   -73.72517136076       -1.87       -1.02    5.2    9.75s
  3   -73.73220351525       -2.15       -1.35    6.5    15.1s
  4   -73.73353257593       -2.88       -1.73    5.8    14.1s
  5   -73.73373771579       -3.69       -2.61    5.5    9.89s
  6   -73.73373866895       -6.02       -3.17    5.4    10.4s
  7   -73.73373871967       -7.29       -3.74    5.1    10.2s
  8   -73.73373872257       -8.54       -4.05    4.4    8.38s
  9   -73.73373872349       -9.04       -4.59    5.3    10.3s
 10   -73.73373872398       -9.31       -5.31    5.1    11.3s
 11   -73.73373872399      -11.10       -6.10    5.3    10.2s
 12   -73.73373872399      -12.29       -6.68    5.5    10.6s
 13   -73.73373872399   +  -13.15       -7.15    4.9    11.6s
┌ Warning: Negative ρcore detected: -4.1659221030755346e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71167119394                   -0.82    9.8    16.1s
  2   -73.72516320298       -1.87       -1.02    5.1    9.78s
  3   -73.73220384730       -2.15       -1.35    6.5    10.9s
  4   -73.73353314609       -2.88       -1.73    5.8    9.16s
  5   -73.73373768533       -3.69       -2.60    5.3    11.8s
  6   -73.73373865671       -6.01       -3.16    5.4    10.9s
  7   -73.73373871807       -7.21       -3.74    5.1    11.0s
  8   -73.73373872222       -8.38       -4.04    4.5    9.85s
  9   -73.73373872357       -8.87       -4.62    5.3    11.2s
 10   -73.73373872398       -9.39       -5.32    5.2    9.51s
 11   -73.73373872399      -11.13       -6.10    5.4    9.06s
 12   -73.73373872399      -12.22       -6.66    5.6    8.70s
 13   -73.73373872399   +  -13.85       -7.21    5.1    8.33s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-4.1659221030755346e-8,7.726803396637718e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     4    -7.373374e+01     3.715853e-06
 * time: 1328.3941810131073
┌ Warning: Negative ρcore detected: -4.166084113039868e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71166464111                   -0.82    9.9    17.2s
  2   -73.72517162763       -1.87       -1.02    5.1    7.68s
  3   -73.73220360190       -2.15       -1.35    6.5    9.67s
  4   -73.73353306378       -2.88       -1.73    5.8    10.0s
  5   -73.73373770154       -3.69       -2.60    5.4    10.2s
  6   -73.73373866226       -6.02       -3.17    5.3    12.4s
  7   -73.73373871852       -7.25       -3.74    5.2    10.0s
  8   -73.73373872239       -8.41       -4.05    4.6    7.93s
  9   -73.73373872357       -8.93       -4.61    5.3    8.72s
 10   -73.73373872401       -9.35       -5.33    5.1    10.0s
 11   -73.73373872402      -11.16       -6.11    5.2    12.3s
 12   -73.73373872402      -12.36       -6.68    5.6    12.2s
 13   -73.73373872402      -13.25       -7.22    5.1    8.94s
┌ Warning: Negative ρcore detected: -4.166084113039868e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71166811870                   -0.82    9.7    15.5s
  2   -73.72518394549       -1.87       -1.02    5.1    8.82s
  3   -73.73220191611       -2.15       -1.35    6.5    10.8s
  4   -73.73353296138       -2.88       -1.73    5.9    9.22s
  5   -73.73373770679       -3.69       -2.61    5.4    8.65s
  6   -73.73373865641       -6.02       -3.17    5.4    9.13s
  7   -73.73373871705       -7.22       -3.73    5.1    9.93s
  8   -73.73373872203       -8.30       -4.03    4.7    10.7s
  9   -73.73373872363       -8.80       -4.62    5.3    8.68s
 10   -73.73373872401       -9.41       -5.34    5.1    9.70s
 11   -73.73373872402      -11.22       -6.09    5.3    8.53s
 12   -73.73373872402      -12.22       -6.67    5.6    10.8s
 13   -73.73373872402      -13.85       -7.23    5.1    10.9s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-4.166084113039868e-8,7.717247897261479e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     5    -7.373374e+01     8.946417e-09
 * time: 1671.702518939972
 * Status: success

 * Candidate solution
    Final objective value:     -7.373374e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.10e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.79e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 3.50e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 4.74e-13 ≰ 0.0e+00
    |g(x)|                 = 8.95e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   1672  (vs limit Inf)
    Iterations:    5
    f(x) calls:    6
    ∇f(x) calls:   6

V: 1829.770487 seconds (806.27 M allocations: 383.295 GiB, 4.70% gc time, 0.01% compilation time)
