┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-13T14:44:14.630
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.440775954824                   -0.97    7.0    13.5s
  2   -8.442889555848       -2.67       -1.78    2.1    6.67s
  3   -8.442948809153       -4.23       -2.84    3.8    2.32s
  4   -8.442949288563       -6.32       -3.97    4.0    2.59s
  5   -8.442949294704       -8.21       -4.45    4.4    2.89s
  6   -8.442949295142       -9.36       -5.63    3.7    2.18s
  7   -8.442949295148      -11.25       -6.43    4.3    2.70s
  8   -8.442949295148      -13.57       -7.61    3.6    2.32s
Iter     Function value   Gradient norm 
     0    -8.442949e+00     5.344228e-03
 * time: 4.792213439941406e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.440762902460                   -0.97    7.6    3.55s
  2   -8.442913614906       -2.67       -1.78    2.4    2.35s
  3   -8.442976441722       -4.20       -2.84    4.1    2.19s
  4   -8.442976860626       -6.38       -3.96    4.3    2.50s
  5   -8.442976866598       -8.22       -4.46    4.8    2.32s
  6   -8.442976866995       -9.40       -5.60    3.9    2.46s
  7   -8.442976867001      -11.27       -6.32    4.6    2.87s
  8   -8.442976867001      -12.98       -7.82    4.0    2.77s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.440765045098                   -0.97    7.4    3.56s
  2   -8.442911580486       -2.67       -1.78    2.5    2.11s
  3   -8.442976268998       -4.19       -2.84    4.0    2.36s
  4   -8.442976860576       -6.23       -3.95    4.3    2.65s
  5   -8.442976866597       -8.22       -4.46    4.5    2.42s
  6   -8.442976866995       -9.40       -5.58    4.0    2.32s
  7   -8.442976867001      -11.24       -6.34    4.5    2.29s
  8   -8.442976867001      -13.09       -7.63    4.0    2.46s
     1    -8.442977e+00     4.973830e-03
 * time: 55.73134994506836
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.440834060150                   -0.96    7.1    3.09s
  2   -8.443090521785       -2.65       -1.78    2.1    1.41s
  3   -8.443150314758       -4.22       -2.82    4.0    2.73s
  4   -8.443150735784       -6.38       -3.99    3.9    2.81s
  5   -8.443150739332       -8.45       -4.55    4.3    2.54s
  6   -8.443150739546       -9.67       -5.64    3.8    2.57s
  7   -8.443150739550      -11.40       -6.36    4.4    2.55s
  8   -8.443150739550      -13.01       -7.91    3.9    2.81s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.440823641549                   -0.96    7.2    3.21s
  2   -8.443093691375       -2.64       -1.78    2.2    1.92s
  3   -8.443150343196       -4.25       -2.83    3.8    2.26s
  4   -8.443150736131       -6.41       -3.99    4.0    2.59s
  5   -8.443150739375       -8.49       -4.59    4.2    2.73s
  6   -8.443150739547       -9.77       -5.68    3.8    3.01s
  7   -8.443150739550      -11.47       -6.36    4.5    2.46s
  8   -8.443150739550      -13.02       -7.96    4.0    2.26s
     2    -8.443151e+00     1.864827e-04
 * time: 111.93558287620544
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.440810002905                   -0.96    7.2    4.00s
  2   -8.443084578009       -2.64       -1.78    2.3    1.56s
  3   -8.443150588761       -4.18       -2.83    3.8    3.14s
  4   -8.443150968663       -6.42       -4.00    4.0    2.57s
  5   -8.443150973050       -8.36       -4.53    4.4    2.57s
  6   -8.443150973306       -9.59       -5.63    3.9    2.44s
  7   -8.443150973311      -11.34       -6.40    4.4    2.40s
  8   -8.443150973311      -13.14       -7.94    3.9    2.81s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.440812394136                   -0.96    7.4    3.53s
  2   -8.443082701156       -2.64       -1.78    2.3    1.75s
  3   -8.443150483403       -4.17       -2.83    3.9    2.05s
  4   -8.443150968756       -6.31       -3.98    4.1    2.39s
  5   -8.443150973048       -8.37       -4.53    4.4    2.62s
  6   -8.443150973306       -9.59       -5.61    3.8    2.65s
  7   -8.443150973311      -11.32       -6.40    4.4    2.39s
  8   -8.443150973311      -13.17       -7.80    4.0    3.16s
     3    -8.443151e+00     6.135745e-06
 * time: 170.46383690834045
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.440800328747                   -0.96    7.3    3.42s
  2   -8.443084705562       -2.64       -1.78    2.3    1.69s
  3   -8.443150513204       -4.18       -2.83    3.9    2.70s
  4   -8.443150969465       -6.34       -4.00    4.0    2.91s
  5   -8.443150973314       -8.41       -4.54    4.5    2.32s
  6   -8.443150973560       -9.61       -5.63    3.8    2.56s
  7   -8.443150973565      -11.33       -6.43    4.4    2.61s
  8   -8.443150973565      -13.22       -7.88    3.8    2.40s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.440795625016                   -0.96    7.4    3.63s
  2   -8.443081253200       -2.64       -1.78    2.2    1.92s
  3   -8.443150557428       -4.16       -2.83    4.0    2.31s
  4   -8.443150969384       -6.39       -4.00    4.0    2.61s
  5   -8.443150973304       -8.41       -4.53    4.4    2.46s
  6   -8.443150973560       -9.59       -5.60    3.9    2.59s
  7   -8.443150973564      -11.31       -6.37    4.3    2.40s
  8   -8.443150973565      -13.02       -7.89    4.0    2.61s
     4    -8.443151e+00     7.419851e-09
 * time: 226.927081823349
 * Status: success

 * Candidate solution
    Final objective value:     -8.443151e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 8.26e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 8.04e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.54e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.00e-11 ≰ 0.0e+00
    |g(x)|                 = 7.42e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   227  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

Si: 317.035887 seconds (367.38 M allocations: 73.997 GiB, 7.94% gc time, 19.24% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-13T14:49:32.699
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.04667417681                   -1.19    8.4    23.3s
  2   -62.04956186764       -2.54       -1.25    2.9    9.45s
  3   -62.05326569838       -2.43       -2.14    4.3    11.6s
  4   -62.05327457436       -5.05       -2.64    4.1    11.3s
  5   -62.05327937783       -5.32       -3.62    3.7    10.5s
  6   -62.05327938501       -8.14       -4.58    4.3    14.8s
  7   -62.05327938516       -9.82       -5.43    4.3    13.3s
  8   -62.05327938516      -11.41       -6.97    4.2    12.8s
  9   -62.05327938516      -13.37       -8.03    4.6    12.8s
Iter     Function value   Gradient norm 
     0    -6.205328e+01     8.335750e-03
 * time: 3.3855438232421875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.04676262779                   -1.19    9.1    25.4s
  2   -62.04964933674       -2.54       -1.25    3.0    12.7s
  3   -62.05333496823       -2.43       -2.14    4.5    17.1s
  4   -62.05334349283       -5.07       -2.64    4.2    14.5s
  5   -62.05334829053       -5.32       -3.63    3.8    11.6s
  6   -62.05334829703       -8.19       -4.63    4.2    12.5s
  7   -62.05334829717       -9.85       -5.44    4.3    13.0s
  8   -62.05334829717      -11.38       -7.20    4.2    12.6s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.04676624801                   -1.19    9.3    24.3s
  2   -62.04965560144       -2.54       -1.25    3.0    8.71s
  3   -62.05333496142       -2.43       -2.14    4.4    11.6s
  4   -62.05334359201       -5.06       -2.64    4.2    13.0s
  5   -62.05334829089       -5.33       -3.64    3.9    13.0s
  6   -62.05334829704       -8.21       -4.65    4.3    17.2s
  7   -62.05334829717       -9.88       -5.55    4.3    16.7s
  8   -62.05334829717      -11.58       -7.00    4.3    13.5s
     1    -6.205335e+01     8.198188e-03
 * time: 274.9704089164734
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.04925671961                   -1.20    8.9    17.6s
  2   -62.05225127767       -2.52       -1.29    3.2    8.32s
  3   -62.05492333475       -2.57       -2.18    4.5    10.6s
  4   -62.05493107871       -5.11       -2.79    4.2    10.4s
  5   -62.05493302237       -5.71       -3.70    4.0    10.3s
  6   -62.05493302668       -8.37       -4.73    4.4    10.7s
  7   -62.05493302674      -10.23       -5.57    4.4    10.9s
  8   -62.05493302674      -11.83       -7.47    4.4    10.7s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.04925632196                   -1.20    8.8    19.0s
  2   -62.05224740330       -2.52       -1.29    3.2    9.67s
  3   -62.05492330977       -2.57       -2.18    4.3    11.0s
  4   -62.05493106550       -5.11       -2.79    4.3    11.5s
  5   -62.05493302222       -5.71       -3.69    3.9    11.9s
  6   -62.05493302667       -8.35       -4.73    4.4    14.9s
  7   -62.05493302673      -10.19       -5.54    4.4    14.8s
  8   -62.05493302674      -11.73       -7.44    4.3    15.0s
     2    -6.205493e+01     2.834399e-03
 * time: 509.1071720123291
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.04921254909                   -1.20    8.5    25.7s
  2   -62.05217246308       -2.53       -1.28    3.0    8.18s
  3   -62.05506031238       -2.54       -2.17    4.3    11.4s
  4   -62.05506812957       -5.11       -2.75    4.3    14.6s
  5   -62.05507065924       -5.60       -3.68    3.9    10.2s
  6   -62.05507066390       -8.33       -4.71    4.4    11.8s
  7   -62.05507066397      -10.16       -5.51    4.2    11.8s
  8   -62.05507066397      -11.66       -7.30    4.2    11.6s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.04921492826                   -1.20    8.5    22.1s
  2   -62.05218134908       -2.53       -1.28    3.0    7.98s
  3   -62.05506023348       -2.54       -2.17    4.3    15.1s
  4   -62.05506808193       -5.11       -2.74    4.1    12.2s
  5   -62.05507065883       -5.59       -3.67    4.0    12.7s
  6   -62.05507066389       -8.30       -4.67    4.4    15.0s
  7   -62.05507066397      -10.09       -5.56    4.2    11.9s
  8   -62.05507066397      -11.75       -7.48    4.3    10.8s
     3    -6.205507e+01     5.987328e-04
 * time: 758.6598188877106
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.04925870251                   -1.20    8.4    23.4s
  2   -62.05222603506       -2.53       -1.28    3.1    11.9s
  3   -62.05506745990       -2.55       -2.18    4.4    14.2s
  4   -62.05507531207       -5.11       -2.76    4.2    14.5s
  5   -62.05507772145       -5.62       -3.68    3.9    14.6s
  6   -62.05507772625       -8.32       -4.69    4.3    15.2s
  7   -62.05507772632      -10.14       -5.52    4.3    15.1s
  8   -62.05507772632      -11.76       -7.47    4.2    14.0s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.04925210175                   -1.20    8.6    22.4s
  2   -62.05222245557       -2.53       -1.28    3.2    11.4s
  3   -62.05506737355       -2.55       -2.17    4.4    13.6s
  4   -62.05507527005       -5.10       -2.75    4.1    14.6s
  5   -62.05507772126       -5.61       -3.68    3.8    12.7s
  6   -62.05507772625       -8.30       -4.72    4.4    11.6s
  7   -62.05507772632      -10.14       -5.57    4.3    13.3s
  8   -62.05507772632      -11.83       -7.37    4.3    14.5s
     4    -6.205508e+01     3.354410e-05
 * time: 1032.7027740478516
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.04925668275                   -1.20    8.4    17.1s
  2   -62.05222541077       -2.53       -1.28    2.9    8.08s
  3   -62.05506748076       -2.55       -2.18    4.3    11.3s
  4   -62.05507529825       -5.11       -2.75    4.0    10.5s
  5   -62.05507774337       -5.61       -3.68    3.8    10.2s
  6   -62.05507774816       -8.32       -4.70    4.3    10.6s
  7   -62.05507774823      -10.14       -5.56    4.2    10.4s
  8   -62.05507774823      -11.78       -7.51    4.1    10.1s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.04925587105                   -1.20    8.3    16.1s
  2   -62.05222697424       -2.53       -1.28    3.0    7.76s
  3   -62.05506729135       -2.55       -2.17    4.2    9.81s
  4   -62.05507522295       -5.10       -2.74    4.1    10.3s
  5   -62.05507774271       -5.60       -3.66    3.8    9.31s
  6   -62.05507774814       -8.26       -4.65    4.2    10.9s
  7   -62.05507774823      -10.06       -5.47    4.2    12.0s
  8   -62.05507774823      -11.63       -7.27    4.1    10.8s
     5    -6.205508e+01     4.377073e-07
 * time: 1240.957473039627
 * Status: success

 * Candidate solution
    Final objective value:     -6.205508e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.32e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.28e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.19e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.53e-10 ≰ 0.0e+00
    |g(x)|                 = 4.38e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   1241  (vs limit Inf)
    Iterations:    5
    f(x) calls:    6
    ∇f(x) calls:   6

NaCl: 1388.207603 seconds (1.04 G allocations: 308.892 GiB, 5.02% gc time, 0.28% compilation time)
┌ Info: 2025-05-13T15:12:40.943
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315023765838                   -1.45    5.5    2.28s
  2   -2.315128385184       -3.98       -1.84    1.4    1.26s
  3   -2.315152556830       -4.62       -3.60    3.3    1.76s
  4   -2.315152778596       -6.65       -4.20    4.7    1.84s
  5   -2.315152778892       -9.53       -4.63    2.6    1.74s
  6   -2.315152778944      -10.29       -5.20    2.8    1.27s
  7   -2.315152778946      -11.57       -6.01    2.6    1.48s
  8   -2.315152778946      -13.14       -6.66    3.1    1.32s
  9   -2.315152778946      -14.57       -7.36    2.5    1.20s
Iter     Function value   Gradient norm 
     0    -2.315153e+00     1.661383e-03
 * time: 3.886222839355469e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315025605324                   -1.45    5.4    2.24s
  2   -2.315130654347       -3.98       -1.84    1.3    981ms
  3   -2.315155268314       -4.61       -3.59    3.4    2.15s
  4   -2.315155482011       -6.67       -4.14    4.6    1.97s
  5   -2.315155482379       -9.44       -4.59    2.5    1.43s
  6   -2.315155482438      -10.23       -5.16    2.7    1.19s
  7   -2.315155482441      -11.46       -6.00    2.5    1.70s
  8   -2.315155482441      -13.04       -6.67    3.1    2.11s
  9   -2.315155482441      -14.51       -7.32    2.7    2.01s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315026936513                   -1.45    5.5    2.50s
  2   -2.315130366824       -3.99       -1.84    1.3    978ms
  3   -2.315155232270       -4.60       -3.57    3.3    2.12s
  4   -2.315155481931       -6.60       -4.10    4.6    2.10s
  5   -2.315155482367       -9.36       -4.55    2.5    1.63s
  6   -2.315155482438      -10.15       -5.12    2.7    1.38s
  7   -2.315155482441      -11.42       -6.01    2.5    1.66s
  8   -2.315155482441      -13.06       -6.60    3.1    1.59s
  9   -2.315155482441      -14.31       -7.33    2.7    1.65s
     1    -2.315155e+00     1.593156e-03
 * time: 63.99535393714905
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315068537807                   -1.45    5.5    2.21s
  2   -2.315162987753       -4.02       -1.84    1.4    843ms
  3   -2.315186419949       -4.63       -3.55    3.4    1.72s
  4   -2.315186609361       -6.72       -4.13    4.5    1.72s
  5   -2.315186609780       -9.38       -4.61    2.7    1.48s
  6   -2.315186609837      -10.24       -5.25    3.0    1.24s
  7   -2.315186609840      -11.59       -6.00    2.8    1.54s
  8   -2.315186609840      -13.62       -6.63    2.7    1.20s
  9   -2.315186609840      -14.57       -7.38    2.6    1.19s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315063699545                   -1.45    5.5    2.18s
  2   -2.315162228582       -4.01       -1.84    1.4    828ms
  3   -2.315186383538       -4.62       -3.54    3.5    1.72s
  4   -2.315186609344       -6.65       -4.12    4.5    1.71s
  5   -2.315186609778       -9.36       -4.60    2.7    1.47s
  6   -2.315186609838      -10.22       -5.27    3.0    1.21s
  7   -2.315186609840      -11.72       -6.01    2.8    1.43s
  8   -2.315186609840      -13.57       -6.66    2.7    1.16s
  9   -2.315186609840      -14.51       -7.38    2.8    1.49s
     2    -2.315187e+00     5.718193e-07
 * time: 121.09932494163513
 * Status: success

 * Candidate solution
    Final objective value:     -2.315187e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.88e-02 ≰ -1.0e+00
    |x - x'|/|x'|          = 5.10e-03 ≰ 0.0e+00
    |f(x) - f(x')|         = 3.11e-05 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.34e-05 ≰ 0.0e+00
    |g(x)|                 = 5.72e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   121  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Al: 157.311905 seconds (113.59 M allocations: 27.118 GiB, 6.74% gc time, 0.00% compilation time)
┌ Info: 2025-05-13T15:15:18.255
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.67867550047                   -0.81    9.7    11.2s
  2   -73.69415117066       -1.81       -1.02    5.4    6.69s
  3   -73.70191355211       -2.11       -1.34    6.7    8.42s
  4   -73.70342293265       -2.82       -1.75    6.0    7.48s
  5   -73.70358789754       -3.78       -2.27    5.1    6.87s
  6   -73.70360602209       -4.74       -3.09    5.6    7.39s
  7   -73.70360605285       -7.51       -3.55    4.1    6.46s
  8   -73.70360607772       -7.60       -4.24    5.5    7.18s
  9   -73.70360607597   +   -8.76       -4.38    5.3    7.78s
 10   -73.70360607782       -8.73       -4.84    5.8    7.42s
 11   -73.70360607784      -10.69       -5.76    5.2    7.03s
 12   -73.70360607784      -12.94       -6.26    4.7    6.86s
 13   -73.70360607784   +    -Inf       -6.53    4.4    6.58s
 14   -73.70360607784   +  -13.37       -7.04    5.0    6.94s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.370361e+01     2.058812e-02
 * time: 3.695487976074219e-5
┌ Warning: Negative ρcore detected: -3.296491664079127e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.67972697985                   -0.82    9.6    11.9s
  2   -73.69457012841       -1.83       -1.02    5.4    7.82s
  3   -73.70234030711       -2.11       -1.34    6.6    9.55s
  4   -73.70381387925       -2.83       -1.75    6.0    8.09s
  5   -73.70398044241       -3.78       -2.27    5.0    7.70s
  6   -73.70399882332       -4.74       -3.09    5.5    8.85s
  7   -73.70399883149       -8.09       -3.56    4.7    7.42s
  8   -73.70399885108       -7.71       -4.16    5.6    7.99s
  9   -73.70399884960   +   -8.83       -4.37    5.3    8.20s
 10   -73.70399885147       -8.73       -4.84    5.8    8.57s
 11   -73.70399885148      -10.85       -5.58    4.1    6.50s
 12   -73.70399885148      -12.07       -6.24    4.9    6.67s
 13   -73.70399885148      -13.37       -6.56    4.0    5.93s
 14   -73.70399885148   +  -12.67       -7.03    5.3    7.86s
┌ Warning: Negative ρcore detected: -3.296491664079127e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.67973679847                   -0.82    9.6    13.9s
  2   -73.69456177601       -1.83       -1.02    5.3    7.75s
  3   -73.70234078462       -2.11       -1.34    6.7    9.76s
  4   -73.70381386171       -2.83       -1.75    5.9    8.13s
  5   -73.70398009618       -3.78       -2.26    5.0    8.50s
  6   -73.70399882366       -4.73       -3.09    5.4    8.91s
  7   -73.70399883167       -8.10       -3.55    4.7    8.30s
  8   -73.70399885109       -7.71       -4.15    5.4    8.00s
  9   -73.70399884969   +   -8.85       -4.38    5.4    8.09s
 10   -73.70399885147       -8.75       -4.83    5.7    8.09s
 11   -73.70399885148      -10.84       -5.59    4.1    6.88s
 12   -73.70399885148      -12.11       -6.25    4.9    7.79s
 13   -73.70399885148      -13.15       -6.54    4.3    7.04s
 14   -73.70399885148   +  -12.57       -7.03    5.2    8.67s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.296491664079127e-8,-1.05063415620543e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.370400e+01     1.754964e-02
 * time: 302.2858350276947
┌ Warning: Negative ρcore detected: -3.2550861340587194e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.68373499141                   -0.83    9.8    12.4s
  2   -73.69655586621       -1.89       -1.03    5.4    7.10s
  3   -73.70342079307       -2.16       -1.36    6.8    8.80s
  4   -73.70472309307       -2.89       -1.71    6.0    7.54s
  5   -73.70495818146       -3.63       -2.56    5.5    7.80s
  6   -73.70495971440       -5.81       -3.18    5.5    8.79s
  7   -73.70495971613       -8.76       -3.67    5.0    8.23s
  8   -73.70495972176       -8.25       -3.98    4.7    8.52s
  9   -73.70495972315       -8.85       -4.54    5.4    7.49s
 10   -73.70495972365       -9.31       -4.84    5.0    6.76s
 11   -73.70495972372      -10.16       -5.64    5.2    6.77s
 12   -73.70495972372      -11.68       -6.02    5.3    7.52s
 13   -73.70495972372      -12.70       -7.01    5.1    6.96s
┌ Warning: Negative ρcore detected: -3.2550861340587194e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.68372942372                   -0.83    9.8    12.8s
  2   -73.69656565213       -1.89       -1.03    5.4    7.09s
  3   -73.70342028077       -2.16       -1.36    6.8    9.05s
  4   -73.70472273630       -2.89       -1.71    5.9    7.98s
  5   -73.70495823765       -3.63       -2.57    5.5    7.94s
  6   -73.70495971419       -5.83       -3.18    5.5    8.56s
  7   -73.70495971579       -8.80       -3.68    5.1    8.37s
  8   -73.70495972157       -8.24       -3.98    4.6    7.07s
  9   -73.70495972318       -8.79       -4.55    5.4    8.07s
 10   -73.70495972365       -9.33       -4.85    5.0    7.83s
 11   -73.70495972372      -10.17       -5.65    5.1    7.20s
 12   -73.70495972372      -11.73       -6.06    5.2    8.07s
 13   -73.70495972372      -13.07       -7.01    5.0    7.64s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.2550861340587194e-8,4.48022254414674e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.370496e+01     1.915740e-03
 * time: 585.5940489768982
┌ Warning: Negative ρcore detected: -3.3177357031516406e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.68358995154                   -0.83    9.7    12.6s
  2   -73.69648604871       -1.89       -1.03    5.3    7.34s
  3   -73.70340207387       -2.16       -1.35    6.7    9.14s
  4   -73.70472299458       -2.88       -1.70    5.8    7.40s
  5   -73.70496860459       -3.61       -2.57    5.4    7.16s
  6   -73.70497011649       -5.82       -3.18    5.4    8.68s
  7   -73.70497010866   +   -8.11       -3.63    5.1    8.54s
  8   -73.70497012103       -7.91       -3.93    4.8    7.95s
  9   -73.70497012478       -8.43       -4.52    5.4    8.36s
 10   -73.70497012515       -9.44       -4.82    4.8    7.77s
 11   -73.70497012521      -10.20       -5.48    5.1    7.40s
 12   -73.70497012522      -11.13       -6.00    5.5    8.13s
 13   -73.70497012522   +  -13.15       -6.92    5.1    7.45s
 14   -73.70497012522   +  -13.25       -7.17    5.2    8.29s
┌ Warning: Negative ρcore detected: -3.3177357031516406e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.68357913617                   -0.83    9.7    12.6s
  2   -73.69647717577       -1.89       -1.03    5.3    7.46s
  3   -73.70340383920       -2.16       -1.35    6.7    9.28s
  4   -73.70472352142       -2.88       -1.70    5.9    8.25s
  5   -73.70496844346       -3.61       -2.56    5.4    8.12s
  6   -73.70497011470       -5.78       -3.18    5.5    8.43s
  7   -73.70497011219   +   -8.60       -3.63    4.9    7.61s
  8   -73.70497012206       -8.01       -3.95    4.8    7.25s
  9   -73.70497012461       -8.59       -4.52    5.3    7.76s
 10   -73.70497012513       -9.28       -4.80    4.9    7.86s
 11   -73.70497012521      -10.13       -5.49    5.1    7.72s
 12   -73.70497012522      -11.16       -5.89    5.4    8.54s
 13   -73.70497012522   +  -13.85       -6.77    5.1    7.49s
 14   -73.70497012522   +  -13.07       -7.03    5.1    7.72s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.3177357031516406e-8,-1.0507445462639637e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.370497e+01     1.349872e-04
 * time: 884.9354250431061
┌ Warning: Negative ρcore detected: -3.309471257162538e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.68358510583                   -0.83    9.8    12.5s
  2   -73.69648507245       -1.89       -1.03    5.2    8.03s
  3   -73.70340643322       -2.16       -1.35    6.7    9.89s
  4   -73.70472372821       -2.88       -1.70    5.9    7.75s
  5   -73.70496860609       -3.61       -2.56    5.4    8.01s
  6   -73.70497016870       -5.81       -3.18    5.6    8.46s
  7   -73.70497016319   +   -8.26       -3.64    5.0    8.39s
  8   -73.70497017394       -7.97       -3.94    4.9    7.51s
  9   -73.70497017705       -8.51       -4.52    5.4    8.81s
 10   -73.70497017748       -9.37       -4.81    4.9    7.19s
 11   -73.70497017754      -10.18       -5.47    5.1    7.36s
 12   -73.70497017755      -11.12       -5.95    5.4    8.31s
 13   -73.70497017755   +  -13.55       -6.99    5.2    7.92s
 14   -73.70497017755   +    -Inf       -7.17    4.9    8.19s
┌ Warning: Negative ρcore detected: -3.309471257162538e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.68358559186                   -0.83    9.6    13.7s
  2   -73.69648923024       -1.89       -1.03    5.3    8.81s
  3   -73.70340559871       -2.16       -1.35    6.7    10.3s
  4   -73.70472376298       -2.88       -1.70    5.9    9.25s
  5   -73.70496855101       -3.61       -2.56    5.4    8.35s
  6   -73.70497016798       -5.79       -3.18    5.5    9.03s
  7   -73.70497016350   +   -8.35       -3.64    4.9    8.85s
  8   -73.70497017421       -7.97       -3.95    4.8    8.46s
  9   -73.70497017698       -8.56       -4.52    5.3    7.45s
 10   -73.70497017747       -9.30       -4.82    5.0    7.39s
 11   -73.70497017754      -10.15       -5.52    5.1    7.11s
 12   -73.70497017755      -11.23       -5.93    5.4    8.48s
 13   -73.70497017755      -13.25       -6.81    5.1    7.65s
 14   -73.70497017755   +  -13.55       -7.03    5.2    7.78s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.309471257162538e-8,-1.0949234936642968e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     4    -7.370497e+01     6.213466e-07
 * time: 1201.2322430610657
 * Status: success

 * Candidate solution
    Final objective value:     -7.370497e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 7.70e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.38e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 5.23e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 7.10e-10 ≰ 0.0e+00
    |g(x)|                 = 6.21e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   1201  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

V: 1353.119158 seconds (715.85 M allocations: 337.911 GiB, 5.67% gc time, 0.01% compilation time)
