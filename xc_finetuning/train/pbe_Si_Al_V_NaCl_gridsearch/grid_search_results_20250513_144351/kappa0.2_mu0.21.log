┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-13T14:44:10.282
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441565670525                   -0.97    7.0    14.6s
  2   -8.443831506350       -2.64       -1.74    2.0    6.07s
  3   -8.443894174466       -4.20       -2.89    3.8    2.30s
  4   -8.443894622325       -6.35       -4.00    3.8    2.60s
  5   -8.443894623637       -8.88       -4.72    3.9    2.77s
  6   -8.443894623727      -10.05       -5.73    3.9    1.98s
  7   -8.443894623729      -11.77       -6.69    4.0    2.36s
  8   -8.443894623729      -13.85       -7.75    4.0    2.36s
Iter     Function value   Gradient norm 
     0    -8.443895e+00     6.424129e-03
 * time: 5.1975250244140625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441577147794                   -0.97    7.5    3.75s
  2   -8.443873355917       -2.64       -1.74    2.3    1.95s
  3   -8.443933913562       -4.22       -2.88    4.0    2.30s
  4   -8.443934459314       -6.26       -3.99    4.0    2.68s
  5   -8.443934460256       -9.03       -4.72    4.1    2.04s
  6   -8.443934460332      -10.12       -5.76    3.9    2.43s
  7   -8.443934460334      -11.84       -6.70    4.2    2.68s
  8   -8.443934460334      -13.97       -7.86    4.2    2.87s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441569300656                   -0.97    7.4    3.71s
  2   -8.443867522589       -2.64       -1.74    2.5    1.85s
  3   -8.443933857918       -4.18       -2.88    3.9    2.11s
  4   -8.443934459205       -6.22       -3.97    4.1    2.46s
  5   -8.443934460244       -8.98       -4.70    4.0    2.07s
  6   -8.443934460332      -10.06       -5.73    4.1    2.47s
  7   -8.443934460334      -11.79       -6.65    4.3    2.36s
  8   -8.443934460334      -13.97       -7.79    4.2    2.73s
     1    -8.443934e+00     5.977603e-03
 * time: 56.086936950683594
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441644755176                   -0.96    7.1    3.40s
  2   -8.444120258005       -2.61       -1.78    2.4    1.62s
  3   -8.444183085924       -4.20       -2.83    3.9    2.64s
  4   -8.444183534616       -6.35       -4.03    3.8    2.60s
  5   -8.444183539636       -8.30       -4.52    4.4    2.49s
  6   -8.444183540002       -9.44       -5.65    3.8    2.71s
  7   -8.444183540007      -11.38       -6.77    4.3    2.62s
  8   -8.444183540007      -13.71       -7.70    4.3    2.83s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441661473330                   -0.96    7.1    3.62s
  2   -8.444122816154       -2.61       -1.78    2.4    2.24s
  3   -8.444183127012       -4.22       -2.83    3.9    2.38s
  4   -8.444183536145       -6.39       -4.03    3.9    2.75s
  5   -8.444183539718       -8.45       -4.55    4.4    2.72s
  6   -8.444183540003       -9.54       -5.67    3.9    2.77s
  7   -8.444183540007      -11.46       -6.82    4.4    2.67s
  8   -8.444183540007      -13.85       -7.68    4.3    3.15s
     2    -8.444184e+00     2.693943e-04
 * time: 114.61473298072815
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441634334838                   -0.96    7.0    3.87s
  2   -8.444122077642       -2.60       -1.78    2.1    1.76s
  3   -8.444183497927       -4.21       -2.83    4.0    3.02s
  4   -8.444184015943       -6.29       -4.02    3.9    2.68s
  5   -8.444184019468       -8.45       -4.57    4.3    2.59s
  6   -8.444184019731       -9.58       -5.67    3.9    2.49s
  7   -8.444184019735      -11.44       -6.76    4.3    2.58s
  8   -8.444184019735      -13.64       -7.73    4.3    3.16s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441634086671                   -0.96    7.1    3.95s
  2   -8.444121000889       -2.60       -1.78    2.3    2.26s
  3   -8.444183531314       -4.20       -2.83    3.8    2.39s
  4   -8.444184015033       -6.32       -4.02    3.8    2.55s
  5   -8.444184019404       -8.36       -4.54    4.3    2.46s
  6   -8.444184019731       -9.49       -5.66    3.8    2.54s
  7   -8.444184019735      -11.37       -6.83    4.3    3.00s
  8   -8.444184019735      -13.85       -7.51    4.2    3.17s
     3    -8.444184e+00     1.053338e-05
 * time: 175.4827311038971
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441630387121                   -0.96    7.1    3.46s
  2   -8.444121246662       -2.60       -1.78    2.4    1.70s
  3   -8.444183611400       -4.21       -2.82    3.8    2.50s
  4   -8.444184015545       -6.39       -4.03    3.8    2.54s
  5   -8.444184020145       -8.34       -4.54    4.4    2.43s
  6   -8.444184020466       -9.49       -5.68    3.8    2.56s
  7   -8.444184020470      -11.39       -6.88    4.3    2.48s
  8   -8.444184020470      -14.05       -7.46    4.2    3.21s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441641284316                   -0.96    7.0    3.80s
  2   -8.444125527535       -2.60       -1.78    2.5    2.30s
  3   -8.444183496862       -4.24       -2.82    3.9    2.70s
  4   -8.444184016492       -6.28       -4.00    4.0    3.11s
  5   -8.444184020210       -8.43       -4.57    4.3    2.87s
  6   -8.444184020467       -9.59       -5.70    3.9    3.07s
  7   -8.444184020470      -11.47       -6.82    4.3    3.21s
  8   -8.444184020470      -14.05       -7.58    4.2    3.54s
     4    -8.444184e+00     1.701360e-08
 * time: 238.11713004112244
 * Status: success

 * Candidate solution
    Final objective value:     -8.444184e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.40e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.36e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 7.35e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 8.71e-11 ≰ 0.0e+00
    |g(x)|                 = 1.70e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   238  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

Si: 324.121686 seconds (366.83 M allocations: 73.842 GiB, 7.76% gc time, 17.72% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-13T14:49:35.100
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.01611203009                   -1.20    8.4    27.1s
  2   -62.01863971111       -2.60       -1.26    2.9    12.1s
  3   -62.02203794730       -2.47       -2.17    4.2    16.2s
  4   -62.02203829322       -6.46       -2.56    4.2    13.7s
  5   -62.02204648053       -5.09       -3.63    3.5    13.9s
  6   -62.02204648843       -8.10       -4.58    4.2    17.0s
  7   -62.02204648859       -9.80       -5.40    4.3    18.1s
  8   -62.02204648859      -11.45       -7.36    4.2    13.9s
Iter     Function value   Gradient norm 
     0    -6.202205e+01     1.098197e-02
 * time: 4.1961669921875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.01625239705                   -1.20    8.6    20.1s
  2   -62.01879117592       -2.60       -1.26    2.7    8.45s
  3   -62.02215747234       -2.47       -2.17    4.2    11.5s
  4   -62.02215807785       -6.22       -2.56    4.2    12.0s
  5   -62.02216615787       -5.09       -3.62    3.4    9.68s
  6   -62.02216616608       -8.09       -4.52    4.1    15.1s
  7   -62.02216616625       -9.75       -5.40    4.3    13.3s
  8   -62.02216616626      -11.55       -7.05    4.2    13.9s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.01624851168                   -1.20    8.5    23.9s
  2   -62.01878477456       -2.60       -1.26    2.8    8.39s
  3   -62.02215753676       -2.47       -2.17    4.1    11.4s
  4   -62.02215809154       -6.26       -2.56    4.1    12.5s
  5   -62.02216615782       -5.09       -3.62    3.4    10.6s
  6   -62.02216616609       -8.08       -4.55    4.2    11.9s
  7   -62.02216616625       -9.79       -5.35    4.3    13.3s
  8   -62.02216616626      -11.37       -7.38    4.1    12.3s
     1    -6.202217e+01     1.081300e-02
 * time: 253.72125101089478
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.01963262789                   -1.21    8.6    22.9s
  2   -62.02237232923       -2.56       -1.31    3.1    11.2s
  3   -62.02462671599       -2.65       -2.22    4.2    14.3s
  4   -62.02463048547       -5.42       -2.75    4.2    14.6s
  5   -62.02463334073       -5.54       -3.71    3.6    12.6s
  6   -62.02463334506       -8.36       -4.70    4.1    14.4s
  7   -62.02463334514      -10.13       -5.63    4.4    14.6s
  8   -62.02463334514      -11.97       -7.05    4.1    12.8s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.01963153027                   -1.21    8.7    17.3s
  2   -62.02237061585       -2.56       -1.31    3.2    9.32s
  3   -62.02462668533       -2.65       -2.22    4.3    10.8s
  4   -62.02463047270       -5.42       -2.75    4.3    11.7s
  5   -62.02463334056       -5.54       -3.70    3.6    9.72s
  6   -62.02463334506       -8.35       -4.69    4.2    12.8s
  7   -62.02463334514      -10.11       -5.62    4.3    11.3s
  8   -62.02463334514      -11.96       -7.09    4.1    11.2s
     2    -6.202463e+01     6.010332e-03
 * time: 502.2443380355835
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.01995105044                   -1.21    8.2    19.0s
  2   -62.02259014140       -2.58       -1.30    3.0    8.61s
  3   -62.02513989072       -2.59       -2.21    4.2    10.7s
  4   -62.02514230358       -5.62       -2.67    4.2    10.5s
  5   -62.02514666700       -5.36       -3.68    3.6    8.95s
  6   -62.02514667206       -8.30       -4.66    4.2    11.2s
  7   -62.02514667214      -10.07       -5.50    4.4    12.1s
  8   -62.02514667215      -11.72       -7.32    4.1    11.2s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.01995213177                   -1.21    8.2    16.5s
  2   -62.02258543232       -2.58       -1.30    2.9    8.47s
  3   -62.02513992980       -2.59       -2.21    4.2    14.8s
  4   -62.02514234603       -5.62       -2.68    4.2    13.5s
  5   -62.02514666720       -5.36       -3.69    3.6    10.4s
  6   -62.02514667207       -8.31       -4.71    4.1    12.5s
  7   -62.02514667214      -10.12       -5.54    4.5    11.8s
  8   -62.02514667215      -11.76       -7.14    4.2    11.2s
     3    -6.202515e+01     1.573074e-03
 * time: 732.6949608325958
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.02004293605                   -1.21    8.1    17.0s
  2   -62.02270272128       -2.58       -1.30    2.9    7.64s
  3   -62.02518561248       -2.61       -2.21    4.1    9.79s
  4   -62.02518830712       -5.57       -2.69    4.1    10.1s
  5   -62.02519235249       -5.39       -3.69    3.5    9.42s
  6   -62.02519235756       -8.29       -4.67    4.0    14.4s
  7   -62.02519235765      -10.07       -5.52    4.2    12.4s
  8   -62.02519235765      -11.78       -6.98    4.1    13.4s
  9   -62.02519235765      -13.25       -8.20    4.2    15.1s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.02004574609                   -1.21    8.0    18.4s
  2   -62.02270600485       -2.58       -1.30    2.9    7.95s
  3   -62.02518559839       -2.61       -2.21    4.2    10.1s
  4   -62.02518830430       -5.57       -2.69    4.1    10.6s
  5   -62.02519235247       -5.39       -3.68    3.6    10.3s
  6   -62.02519235755       -8.29       -4.64    4.1    11.8s
  7   -62.02519235765      -10.03       -5.53    4.2    11.9s
  8   -62.02519235765      -11.79       -7.32    4.1    11.8s
     4    -6.202519e+01     1.676630e-04
 * time: 974.6994979381561
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.02004656461                   -1.21    8.2    19.2s
  2   -62.02271018305       -2.57       -1.30    3.1    11.0s
  3   -62.02518609420       -2.61       -2.21    4.1    10.7s
  4   -62.02518882214       -5.56       -2.69    4.2    12.6s
  5   -62.02519285678       -5.39       -3.68    3.7    11.8s
  6   -62.02519286212       -8.27       -4.66    4.2    13.7s
  7   -62.02519286222      -10.03       -5.47    4.3    14.8s
  8   -62.02519286222      -11.64       -7.09    4.1    10.1s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.02004392597                   -1.21    8.2    18.3s
  2   -62.02270736333       -2.57       -1.30    3.1    10.6s
  3   -62.02518607129       -2.61       -2.21    4.1    10.5s
  4   -62.02518877607       -5.57       -2.68    4.3    16.7s
  5   -62.02519285690       -5.39       -3.68    3.7    15.4s
  6   -62.02519286213       -8.28       -4.67    4.2    17.6s
  7   -62.02519286222      -10.05       -5.50    4.3    15.7s
  8   -62.02519286222      -11.72       -6.89    4.0    12.0s
  9   -62.02519286222      -13.30       -8.38    4.3    11.9s
     5    -6.202519e+01     5.463946e-06
 * time: 1244.4881839752197
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.02005169799                   -1.21    8.5    21.7s
  2   -62.02271440880       -2.57       -1.30    3.0    8.04s
  3   -62.02518618676       -2.61       -2.21    4.3    11.1s
  4   -62.02518881831       -5.58       -2.69    4.3    11.7s
  5   -62.02519285773       -5.39       -3.69    3.6    9.39s
  6   -62.02519286267       -8.31       -4.66    4.3    10.9s
  7   -62.02519286275      -10.07       -5.48    4.4    10.2s
  8   -62.02519286275      -11.70       -7.07    4.2    10.0s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.02005177521                   -1.21    8.5    15.6s
  2   -62.02271522605       -2.57       -1.30    3.1    8.00s
  3   -62.02518613359       -2.61       -2.21    4.2    9.59s
  4   -62.02518884590       -5.57       -2.69    4.3    9.79s
  5   -62.02519285769       -5.40       -3.69    3.6    8.42s
  6   -62.02519286267       -8.30       -4.66    4.2    10.0s
  7   -62.02519286275      -10.07       -5.53    4.5    10.2s
  8   -62.02519286275      -11.81       -7.15    4.2    9.87s
     6    -6.202519e+01     1.353291e-08
 * time: 1454.6796770095825
 * Status: success

 * Candidate solution
    Final objective value:     -6.202519e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.96e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.92e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 5.34e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 8.60e-12 ≰ 0.0e+00
    |g(x)|                 = 1.35e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   1455  (vs limit Inf)
    Iterations:    6
    f(x) calls:    7
    ∇f(x) calls:   7

NaCl: 1616.397734 seconds (1.21 G allocations: 352.527 GiB, 4.86% gc time, 0.28% compilation time)
┌ Info: 2025-05-13T15:16:31.570
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315604778759                   -1.46    5.5    1.95s
  2   -2.315714342477       -3.96       -1.85    1.4    1.12s
  3   -2.315738915239       -4.61       -3.62    3.5    1.39s
  4   -2.315739134813       -6.66       -4.10    4.7    2.03s
  5   -2.315739135221       -9.39       -4.40    2.3    1.20s
  6   -2.315739135342       -9.92       -5.11    2.6    1.36s
  7   -2.315739135346      -11.44       -6.05    2.9    1.16s
  8   -2.315739135346      -12.83       -6.68    3.4    1.35s
  9   -2.315739135346      -14.75       -7.21    2.6    1.64s
Iter     Function value   Gradient norm 
     0    -2.315739e+00     1.440878e-03
 * time: 3.0994415283203125e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315611575434                   -1.46    5.6    2.69s
  2   -2.315715975734       -3.98       -1.85    1.4    1.02s
  3   -2.315740943283       -4.60       -3.59    3.5    1.75s
  4   -2.315741167274       -6.65       -4.06    4.6    1.92s
  5   -2.315741167785       -9.29       -4.38    2.5    1.51s
  6   -2.315741167926       -9.85       -5.06    2.7    1.12s
  7   -2.315741167930      -11.39       -6.03    2.7    1.42s
  8   -2.315741167930      -12.84       -6.63    3.5    1.39s
  9   -2.315741167930      -14.51       -7.31    2.7    1.43s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315612254216                   -1.46    5.6    2.08s
  2   -2.315716353067       -3.98       -1.85    1.5    815ms
  3   -2.315740970463       -4.61       -3.60    3.5    1.72s
  4   -2.315741167293       -6.71       -4.07    4.6    1.70s
  5   -2.315741167790       -9.30       -4.39    2.5    1.35s
  6   -2.315741167926       -9.87       -5.07    2.7    1.14s
  7   -2.315741167930      -11.38       -6.05    2.8    1.52s
  8   -2.315741167930      -12.93       -6.58    3.4    1.35s
  9   -2.315741167930      -14.57       -7.34    2.4    1.10s
     1    -2.315741e+00     1.380460e-03
 * time: 59.58228302001953
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315638597104                   -1.45    5.4    2.17s
  2   -2.315740023068       -3.99       -1.84    1.5    1.03s
  3   -2.315764140597       -4.62       -3.56    3.5    1.79s
  4   -2.315764305488       -6.78       -4.02    4.6    1.76s
  5   -2.315764306218       -9.14       -4.35    2.4    1.44s
  6   -2.315764306411       -9.72       -4.98    2.9    1.26s
  7   -2.315764306416      -11.25       -5.83    2.6    1.43s
  8   -2.315764306416      -12.91       -6.28    3.0    1.28s
  9   -2.315764306416      -14.35       -7.29    1.9    1.04s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315639087436                   -1.45    5.4    2.12s
  2   -2.315740112964       -4.00       -1.84    1.4    824ms
  3   -2.315764144187       -4.62       -3.57    3.4    1.70s
  4   -2.315764305555       -6.79       -4.03    4.5    1.74s
  5   -2.315764306237       -9.17       -4.36    2.6    1.41s
  6   -2.315764306411       -9.76       -4.99    2.8    1.17s
  7   -2.315764306416      -11.26       -5.87    2.7    1.60s
  8   -2.315764306416      -12.93       -6.32    2.9    1.51s
  9   -2.315764306416      -14.35       -7.22    2.1    1.11s
     2    -2.315764e+00     2.802352e-05
 * time: 119.07879114151001
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315636796563                   -1.45    5.4    2.39s
  2   -2.315739591210       -3.99       -1.84    1.4    844ms
  3   -2.315764088475       -4.61       -3.57    3.4    1.82s
  4   -2.315764315070       -6.64       -4.04    4.5    1.75s
  5   -2.315764315716       -9.19       -4.36    2.5    1.44s
  6   -2.315764315889       -9.76       -5.00    2.7    1.21s
  7   -2.315764315894      -11.28       -5.87    2.5    1.44s
  8   -2.315764315895      -12.89       -6.52    3.0    1.30s
  9   -2.315764315895      -14.45       -7.21    2.5    1.16s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315638839898                   -1.45    5.4    2.12s
  2   -2.315740233451       -3.99       -1.84    1.4    878ms
  3   -2.315764095352       -4.62       -3.58    3.5    1.66s
  4   -2.315764315098       -6.66       -4.04    4.6    1.74s
  5   -2.315764315720       -9.21       -4.36    2.5    1.38s
  6   -2.315764315889       -9.77       -5.00    2.8    1.20s
  7   -2.315764315894      -11.30       -5.89    2.7    1.45s
  8   -2.315764315895      -12.95       -6.51    2.9    1.21s
  9   -2.315764315895      -14.75       -7.17    2.6    1.41s
     3    -2.315764e+00     2.492827e-07
 * time: 177.85827016830444
 * Status: success

 * Candidate solution
    Final objective value:     -2.315764e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 6.82e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 8.97e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 9.48e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 4.09e-09 ≰ 0.0e+00
    |g(x)|                 = 2.49e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   178  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Al: 212.854684 seconds (159.16 M allocations: 37.870 GiB, 6.40% gc time, 0.00% compilation time)
┌ Info: 2025-05-13T15:20:04.425
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.67118674822                   -0.80    9.7    11.5s
  2   -73.68791008239       -1.78       -1.00    5.3    6.84s
  3   -73.69624412966       -2.08       -1.32    6.6    8.35s
  4   -73.69792114575       -2.78       -1.75    6.0    7.27s
  5   -73.69808549885       -3.78       -2.28    5.0    6.76s
  6   -73.69810288118       -4.76       -3.09    5.5    8.19s
  7   -73.69810288198       -9.10       -3.53    4.8    7.42s
  8   -73.69810292557       -7.36       -4.21    5.4    7.97s
  9   -73.69810292299   +   -8.59       -4.30    5.6    7.70s
 10   -73.69810292580       -8.55       -4.84    5.8    7.40s
 11   -73.69810292582      -10.56       -5.65    5.5    7.25s
 12   -73.69810292582      -12.43       -6.18    4.9    7.03s
 13   -73.69810292582   +  -12.73       -6.57    4.8    7.85s
 14   -73.69810292582   +  -12.89       -7.06    4.9    7.81s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.369810e+01     2.600178e-02
 * time: 2.9087066650390625e-5
┌ Warning: Negative ρcore detected: -3.232477976226023e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.67272134763                   -0.80    9.5    13.2s
  2   -73.68860875467       -1.80       -1.00    5.3    7.80s
  3   -73.69690574729       -2.08       -1.32    6.7    9.01s
  4   -73.69854669028       -2.78       -1.74    5.9    10.3s
  5   -73.69871171242       -3.78       -2.28    5.1    9.46s
  6   -73.69872992632       -4.74       -3.10    5.5    9.40s
  7   -73.69872988414   +   -7.37       -3.50    5.2    8.30s
  8   -73.69872994188       -7.24       -3.92    5.2    8.55s
  9   -73.69872994616       -8.37       -4.30    5.6    8.37s
 10   -73.69872994895       -8.55       -4.85    5.5    7.27s
 11   -73.69872994901      -10.20       -5.56    5.4    7.37s
 12   -73.69872994902      -11.50       -6.23    5.2    8.61s
 13   -73.69872994902   +    -Inf       -6.48    4.8    8.20s
 14   -73.69872994902   +  -13.25       -7.37    5.1    7.83s
┌ Warning: Negative ρcore detected: -3.232477976226023e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.67272339494                   -0.80    9.6    11.9s
  2   -73.68860026894       -1.80       -1.00    5.3    6.83s
  3   -73.69690729445       -2.08       -1.32    6.6    8.88s
  4   -73.69854659691       -2.79       -1.74    6.0    8.08s
  5   -73.69871173419       -3.78       -2.27    5.1    7.09s
  6   -73.69872991973       -4.74       -3.09    5.4    10.4s
  7   -73.69872991824   +   -8.82       -3.55    5.0    10.2s
  8   -73.69872994733       -7.54       -4.08    5.3    7.73s
  9   -73.69872994667   +   -9.18       -4.34    5.5    9.24s
 10   -73.69872994898       -8.64       -4.85    5.6    7.28s
 11   -73.69872994902      -10.40       -5.54    5.3    7.46s
 12   -73.69872994902      -11.74       -6.20    5.1    7.01s
 13   -73.69872994902      -12.73       -6.44    5.1    6.95s
 14   -73.69872994902   +  -12.94       -7.07    5.1    7.40s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.232477976226023e-8,-1.3157350083083153e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.369873e+01     2.220032e-02
 * time: 312.3842191696167
┌ Warning: Negative ρcore detected: -4.228716711156543e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.67774387607                   -0.81    9.9    19.6s
  2   -73.69156910666       -1.86       -1.02    5.3    11.7s
  3   -73.69868577786       -2.15       -1.35    6.8    13.8s
  4   -73.70005025848       -2.87       -1.73    5.9    13.0s
  5   -73.70025302369       -3.69       -2.59    5.5    10.2s
  6   -73.70025408293       -5.98       -3.16    5.4    9.89s
  7   -73.70025413058       -7.32       -3.75    5.2    8.23s
  8   -73.70025413482       -8.37       -4.05    4.5    7.86s
  9   -73.70025413585       -8.99       -4.63    5.3    8.41s
 10   -73.70025413627       -9.37       -5.36    5.3    8.33s
 11   -73.70025413628      -11.31       -6.10    5.3    8.46s
 12   -73.70025413628      -12.53       -6.66    5.6    8.95s
 13   -73.70025413628      -13.55       -7.22    5.0    8.16s
┌ Warning: Negative ρcore detected: -4.228716711156543e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.67774375597                   -0.81    9.8    13.5s
  2   -73.69157079169       -1.86       -1.02    5.3    8.45s
  3   -73.69868540799       -2.15       -1.35    6.7    12.8s
  4   -73.70005076086       -2.86       -1.73    6.1    13.8s
  5   -73.70025302399       -3.69       -2.59    5.5    10.9s
  6   -73.70025408751       -5.97       -3.17    5.4    12.0s
  7   -73.70025413065       -7.37       -3.75    5.2    9.26s
  8   -73.70025413487       -8.38       -4.05    4.7    7.54s
  9   -73.70025413584       -9.01       -4.62    5.3    11.4s
 10   -73.70025413627       -9.37       -5.36    5.3    14.5s
 11   -73.70025413628      -11.34       -6.09    5.3    11.7s
 12   -73.70025413628      -12.47       -6.66    5.6    13.5s
 13   -73.70025413628   +  -13.55       -7.21    5.1    12.8s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-4.228716711156543e-8,4.949614603267384e-10)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.370025e+01     2.906453e-03
 * time: 675.4827311038971
┌ Warning: Negative ρcore detected: -4.151765066896958e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.67753474855                   -0.81    9.6    14.2s
  2   -73.69142946617       -1.86       -1.02    5.1    8.43s
  3   -73.69865821974       -2.14       -1.34    6.4    11.7s
  4   -73.70005672105       -2.85       -1.72    5.7    10.3s
  5   -73.70027651230       -3.66       -2.59    5.3    8.48s
  6   -73.70027744010       -6.03       -3.16    5.3    10.4s
  7   -73.70027748702       -7.33       -3.75    5.0    12.5s
  8   -73.70027748833       -8.88       -4.03    4.0    10.8s
  9   -73.70027748861       -9.55       -4.60    5.3    9.31s
 10   -73.70027748908       -9.33       -5.07    5.1    8.51s
 11   -73.70027748911      -10.52       -6.06    5.0    8.67s
 12   -73.70027748911   +  -13.55       -6.47    4.5    8.35s
 13   -73.70027748911      -13.25       -6.94    4.6    7.59s
 14   -73.70027748911   +  -12.89       -7.76    5.2    11.4s
┌ Warning: Negative ρcore detected: -4.151765066896958e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.67752794922                   -0.81    9.5    13.7s
  2   -73.69142717363       -1.86       -1.02    5.0    8.72s
  3   -73.69865822770       -2.14       -1.34    6.5    10.9s
  4   -73.70005736847       -2.85       -1.72    5.7    9.67s
  5   -73.70027641994       -3.66       -2.58    5.3    8.78s
  6   -73.70027744065       -5.99       -3.16    5.4    9.11s
  7   -73.70027748625       -7.34       -3.75    5.0    8.22s
  8   -73.70027748805       -8.75       -4.02    4.1    6.72s
  9   -73.70027748861       -9.25       -4.59    5.3    7.91s
 10   -73.70027748908       -9.33       -5.07    4.9    7.99s
 11   -73.70027748911      -10.53       -6.06    5.1    7.78s
 12   -73.70027748911   +  -13.37       -6.52    4.6    8.37s
 13   -73.70027748911   +  -13.25       -6.91    4.7    7.97s
 14   -73.70027748911   +  -13.15       -7.78    5.2    8.91s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-4.151765066896958e-8,8.515006701115093e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.370028e+01     2.348988e-04
 * time: 1010.8354370594025
┌ Warning: Negative ρcore detected: -4.1625685159777586e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.67753608820                   -0.81    9.7    22.0s
  2   -73.69145055541       -1.86       -1.02    5.0    7.88s
  3   -73.69866257234       -2.14       -1.34    6.5    10.3s
  4   -73.70005822906       -2.86       -1.72    5.8    9.53s
  5   -73.70027662013       -3.66       -2.58    5.4    10.2s
  6   -73.70027759763       -6.01       -3.16    5.4    9.94s
  7   -73.70027764216       -7.35       -3.75    5.0    8.84s
  8   -73.70027764407       -8.72       -4.02    4.3    7.97s
  9   -73.70027764465       -9.24       -4.58    5.3    9.10s
 10   -73.70027764515       -9.30       -5.08    5.2    9.50s
 11   -73.70027764517      -10.59       -6.08    5.0    9.79s
 12   -73.70027764517      -13.55       -6.51    4.4    8.85s
 13   -73.70027764517   +  -13.25       -6.93    4.7    8.61s
 14   -73.70027764517   +  -13.00       -7.77    5.1    8.73s
┌ Warning: Negative ρcore detected: -4.1625685159777586e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.67754199260                   -0.81    9.7    15.2s
  2   -73.69144364396       -1.86       -1.02    5.2    9.32s
  3   -73.69866301544       -2.14       -1.34    6.6    12.0s
  4   -73.70005790318       -2.86       -1.72    5.8    11.2s
  5   -73.70027660236       -3.66       -2.58    5.4    10.7s
  6   -73.70027759947       -6.00       -3.16    5.4    9.33s
  7   -73.70027764231       -7.37       -3.75    5.0    9.40s
  8   -73.70027764413       -8.74       -4.02    4.2    7.63s
  9   -73.70027764465       -9.29       -4.59    5.2    8.32s
 10   -73.70027764515       -9.30       -5.09    5.0    9.33s
 11   -73.70027764517      -10.59       -6.09    5.0    8.73s
 12   -73.70027764517   +  -13.85       -6.51    4.1    8.97s
 13   -73.70027764517      -13.55       -6.93    4.8    10.3s
 14   -73.70027764517   +  -12.89       -7.78    5.2    12.0s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-4.1625685159777586e-8,7.921673192755493e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     4    -7.370028e+01     2.883755e-06
 * time: 1368.1706261634827
┌ Warning: Negative ρcore detected: -4.1626978981692054e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.67753163675                   -0.81    9.6    19.1s
  2   -73.69144986328       -1.86       -1.02    5.1    10.7s
  3   -73.69866328657       -2.14       -1.34    6.5    13.2s
  4   -73.70005806132       -2.86       -1.72    5.8    11.4s
  5   -73.70027660610       -3.66       -2.58    5.3    12.3s
  6   -73.70027760296       -6.00       -3.17    5.4    12.8s
  7   -73.70027764241       -7.40       -3.75    5.0    8.68s
  8   -73.70027764421       -8.74       -4.03    4.3    7.38s
  9   -73.70027764469       -9.32       -4.59    5.3    10.6s
 10   -73.70027764516       -9.32       -5.10    5.1    9.40s
 11   -73.70027764519      -10.58       -6.10    5.1    13.3s
 12   -73.70027764519      -13.25       -6.47    4.8    11.2s
 13   -73.70027764519   +  -13.55       -6.93    4.7    10.7s
 14   -73.70027764519   +  -13.00       -7.82    5.2    11.0s
┌ Warning: Negative ρcore detected: -4.1626978981692054e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.67753639741                   -0.81    9.8    19.4s
  2   -73.69144694383       -1.86       -1.02    5.2    8.77s
  3   -73.69866329837       -2.14       -1.34    6.5    10.3s
  4   -73.70005831239       -2.86       -1.72    5.8    9.12s
  5   -73.70027666078       -3.66       -2.59    5.3    8.37s
  6   -73.70027759389       -6.03       -3.16    5.3    10.4s
  7   -73.70027764125       -7.32       -3.75    5.1    9.01s
  8   -73.70027764382       -8.59       -4.01    4.3    7.92s
  9   -73.70027764475       -9.03       -4.60    5.2    8.07s
 10   -73.70027764517       -9.37       -5.10    5.1    9.06s
 11   -73.70027764519      -10.67       -6.11    5.0    9.48s
 12   -73.70027764519      -13.07       -6.46    4.9    8.48s
 13   -73.70027764519      -13.55       -6.96    4.8    8.16s
 14   -73.70027764519   +  -13.00       -7.84    5.2    8.41s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-4.1626978981692054e-8,7.914257967297635e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     5    -7.370028e+01     8.344364e-09
 * time: 1739.7534019947052
 * Status: success

 * Candidate solution
    Final objective value:     -7.370028e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.63e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.95e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.00e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.71e-13 ≰ 0.0e+00
    |g(x)|                 = 8.34e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   1740  (vs limit Inf)
    Iterations:    5
    f(x) calls:    6
    ∇f(x) calls:   6

V: 1897.376649 seconds (821.25 M allocations: 392.057 GiB, 4.65% gc time, 0.00% compilation time)
