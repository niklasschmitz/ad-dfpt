n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.580499616611                   -0.92    7.0    11.8s
  2   -8.582739200200       -2.65       -1.58    2.0    5.35s
  3   -8.582925800225       -3.73       -2.41    4.2    2.06s
  4   -8.582935920929       -4.99       -3.61    3.8    1.75s
  5   -8.582935996848       -7.12       -4.34    4.6    2.17s
  6   -8.582935998498       -8.78       -5.31    4.4    2.24s
  7   -8.582935998512      -10.85       -6.07    3.7    1.64s
  8   -8.582935998513      -12.31       -7.06    3.8    1.91s
Iter     Function value   Gradient norm 
     0    -8.582936e+00     1.517649e-02
 * time: 9.775161743164062e-6
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.580754042179                   -0.93    7.1    2.71s
  2   -8.582965495050       -2.66       -1.58    2.0    1.13s
  3   -8.583148525521       -3.74       -2.42    4.2    2.05s
  4   -8.583158081078       -5.02       -3.58    3.9    1.76s
  5   -8.583158149277       -7.17       -4.34    4.6    2.20s
  6   -8.583158150843       -8.81       -5.17    4.2    1.79s
  7   -8.583158150862      -10.73       -5.78    3.8    1.96s
  8   -8.583158150863      -11.96       -6.88    3.4    1.63s
  9   -8.583158150863      -13.85       -7.50    4.0    2.07s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.580741691074                   -0.93    7.1    2.71s
  2   -8.582962490629       -2.65       -1.58    2.1    1.49s
  3   -8.583148968159       -3.73       -2.42    4.1    1.81s
  4   -8.583158078844       -5.04       -3.59    4.0    2.84s
  5   -8.583158149024       -7.15       -4.32    4.5    2.58s
  6   -8.583158150838       -8.74       -5.09    4.2    2.10s
  7   -8.583158150862      -10.63       -5.99    3.6    1.60s
  8   -8.583158150863      -12.00       -6.96    4.1    2.01s
  9   -8.583158150863      -14.15       -7.55    3.9    1.74s
     1    -8.583158e+00     1.410197e-02
 * time: 50.565025806427
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.582424593543                   -0.95    7.0    2.69s
  2   -8.584470993407       -2.69       -1.55    1.9    1.44s
  3   -8.584649822141       -3.75       -2.51    4.2    1.74s
  4   -8.584658489179       -5.06       -3.28    4.0    2.12s
  5   -8.584658603005       -6.94       -4.00    4.2    1.75s
  6   -8.584658606548       -8.45       -4.84    3.7    2.05s
  7   -8.584658606632      -10.08       -5.73    4.1    1.83s
  8   -8.584658606633      -11.81       -6.56    3.9    1.97s
  9   -8.584658606633      -13.55       -7.49    3.5    1.57s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.582412470068                   -0.95    6.9    2.68s
  2   -8.584471199060       -2.69       -1.55    1.9    1.11s
  3   -8.584649199777       -3.75       -2.51    4.1    1.93s
  4   -8.584658488826       -5.03       -3.27    4.0    2.53s
  5   -8.584658602909       -6.94       -4.00    4.2    1.76s
  6   -8.584658606540       -8.44       -4.80    3.6    1.92s
  7   -8.584658606631      -10.04       -5.70    4.1    1.70s
  8   -8.584658606633      -11.69       -6.42    3.9    2.04s
  9   -8.584658606633      -13.47       -7.47    3.4    1.58s
     2    -8.584659e+00     1.382680e-03
 * time: 97.4304850101471
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.582450521868                   -0.95    7.2    2.78s
  2   -8.584491751776       -2.69       -1.56    1.8    1.44s
  3   -8.584666575259       -3.76       -2.51    4.4    1.80s
  4   -8.584675013188       -5.07       -3.32    4.0    2.14s
  5   -8.584675117200       -6.98       -4.04    4.3    1.80s
  6   -8.584675120342       -8.50       -4.86    3.7    2.19s
  7   -8.584675120420      -10.11       -5.75    4.3    1.90s
  8   -8.584675120422      -11.83       -6.57    3.9    2.64s
  9   -8.584675120422      -13.64       -7.45    3.5    2.20s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.582451430743                   -0.95    7.2    2.89s
  2   -8.584492760419       -2.69       -1.56    1.9    1.29s
  3   -8.584666799106       -3.76       -2.51    4.1    2.63s
  4   -8.584675020358       -5.09       -3.32    4.1    2.16s
  5   -8.584675117082       -7.01       -4.05    4.4    1.83s
  6   -8.584675120343       -8.49       -4.86    3.6    2.03s
  7   -8.584675120420      -10.11       -5.73    4.3    1.81s
  8   -8.584675120422      -11.81       -6.53    3.9    2.11s
  9   -8.584675120422      -13.67       -7.57    3.8    1.89s
     3    -8.584675e+00     1.473241e-04
 * time: 147.95306277275085
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.582457513698                   -0.95    7.3    2.81s
  2   -8.584494258327       -2.69       -1.56    2.3    1.54s
  3   -8.584666916438       -3.76       -2.51    4.2    1.79s
  4   -8.584675209696       -5.08       -3.34    4.1    2.16s
  5   -8.584675310035       -7.00       -4.06    4.5    1.87s
  6   -8.584675312836       -8.55       -4.89    3.9    2.00s
  7   -8.584675312903      -10.17       -5.75    4.4    1.83s
  8   -8.584675312904      -11.87       -6.53    3.9    2.02s
  9   -8.584675312904      -13.67       -7.55    3.7    1.67s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.582463351064                   -0.95    7.3    2.74s
  2   -8.584498374757       -2.69       -1.56    2.1    1.18s
  3   -8.584667694601       -3.77       -2.51    4.3    2.07s
  4   -8.584675212356       -5.12       -3.35    4.0    2.10s
  5   -8.584675309765       -7.01       -4.06    4.4    1.81s
  6   -8.584675312836       -8.51       -4.92    3.8    1.95s
  7   -8.584675312903      -10.18       -5.73    4.4    1.81s
  8   -8.584675312904      -11.85       -6.52    3.9    1.90s
  9   -8.584675312904      -13.71       -8.10    3.8    1.61s
     4    -8.584675e+00     1.835544e-06
 * time: 195.9910659790039
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.582471908432                   -0.95    7.3    2.67s
  2   -8.584496786371       -2.69       -1.56    2.0    1.42s
  3   -8.584666255841       -3.77       -2.51    4.4    1.79s
  4   -8.584675209690       -5.05       -3.31    4.1    2.22s
  5   -8.584675310063       -7.00       -4.04    4.3    1.80s
  6   -8.584675312862       -8.55       -4.84    3.8    1.92s
  7   -8.584675312933      -10.15       -5.69    4.2    1.78s
  8   -8.584675312934      -11.81       -6.52    3.9    1.97s
  9   -8.584675312934      -13.64       -7.49    3.5    1.61s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.582462416713                   -0.95    7.3    2.75s
  2   -8.584495251567       -2.69       -1.56    2.0    1.19s
  3   -8.584667446378       -3.76       -2.51    4.4    2.08s
  4   -8.584675215756       -5.11       -3.34    4.1    2.12s
  5   -8.584675309969       -7.03       -4.06    4.5    1.82s
  6   -8.584675312862       -8.54       -4.90    3.5    1.94s
  7   -8.584675312933      -10.15       -5.74    4.4    1.81s
  8   -8.584675312934      -11.84       -6.50    3.7    1.96s
  9   -8.584675312934      -13.55       -7.80    3.6    1.58s
     5    -8.584675e+00     3.707379e-09
 * time: 243.30036282539368
 * Status: success

 * Candidate solution
    Final objective value:     -8.584675e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.26e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.08e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.99e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.48e-12 ≰ 0.0e+00
    |g(x)|                 = 3.71e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   243  (vs limit Inf)
    Iterations:    5
    f(x) calls:    6
    ∇f(x) calls:   6

Si: 322.648551 seconds (456.38 M allocations: 98.429 GiB, 8.31% gc time, 17.35% compilation time: <1% of which was recompilation)
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.98935025651                   -0.98    9.0    19.7s
  2   -62.99949256961       -1.99       -1.10    2.5    7.29s
  3   -63.00727869603       -2.11       -2.05    3.8    8.68s
  4   -63.00728428295       -5.25       -2.43    3.1    8.54s
  5   -63.00729420921       -5.00       -3.55    2.8    7.90s
  6   -63.00729430171       -7.03       -4.23    4.1    10.0s
  7   -63.00729430796       -8.20       -5.60    3.3    9.05s
  8   -63.00729430798      -10.56       -6.09    4.5    11.1s
  9   -63.00729430798      -11.91       -7.39    3.1    8.25s
Iter     Function value   Gradient norm 
     0    -6.300729e+01     1.175550e-02
 * time: 5.9604644775390625e-6
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.98943212697                   -0.98    9.1    17.6s
  2   -62.99959838162       -1.99       -1.10    2.6    6.98s
  3   -63.00741463527       -2.11       -2.05    3.7    9.19s
  4   -63.00742063489       -5.22       -2.42    3.1    8.63s
  5   -63.00743057048       -5.00       -3.55    3.0    8.31s
  6   -63.00743066015       -7.05       -4.22    4.1    10.3s
  7   -63.00743066643       -8.20       -5.58    3.3    8.83s
  8   -63.00743066646      -10.59       -6.05    4.4    11.2s
  9   -63.00743066646      -11.89       -7.35    3.2    8.69s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.98943046118                   -0.98    9.1    18.1s
  2   -62.99962147838       -1.99       -1.10    2.5    7.02s
  3   -63.00741487843       -2.11       -2.05    3.7    8.95s
  4   -63.00742083758       -5.22       -2.43    3.0    8.55s
  5   -63.00743057354       -5.01       -3.57    2.9    8.16s
  6   -63.00743066065       -7.06       -4.24    4.0    10.5s
  7   -63.00743066644       -8.24       -5.64    3.4    9.75s
  8   -63.00743066646      -10.60       -6.13    4.5    11.2s
  9   -63.00743066646      -12.01       -7.37    3.5    8.81s
     1    -6.300743e+01     1.144420e-02
 * time: 214.03668904304504
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.98969322914                   -0.97    8.4    18.8s
  2   -62.99951519881       -2.01       -1.05    2.4    7.44s
  3   -63.01018112571       -1.97       -2.01    3.5    9.79s
  4   -63.01018996540       -5.05       -2.39    2.6    8.40s
  5   -63.01020402299       -4.85       -3.45    2.7    8.97s
  6   -63.01020419436       -6.77       -4.05    3.8    10.8s
  7   -63.01020421145       -7.77       -5.45    3.0    9.63s
  8   -63.01020421149      -10.41       -5.90    4.5    12.5s
  9   -63.01020421149      -11.58       -7.21    3.0    9.12s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.98969565116                   -0.97    8.5    18.6s
  2   -62.99951346557       -2.01       -1.05    2.4    7.43s
  3   -63.01018108062       -1.97       -2.01    3.6    9.75s
  4   -63.01019012869       -5.04       -2.39    2.5    8.39s
  5   -63.01020402450       -4.86       -3.45    2.8    9.16s
  6   -63.01020419416       -6.77       -4.04    3.7    10.5s
  7   -63.01020421145       -7.76       -5.44    3.1    9.71s
  8   -63.01020421149      -10.47       -5.86    4.5    12.5s
  9   -63.01020421149      -11.51       -7.19    3.0    9.19s
     2    -6.301020e+01     1.993798e-03
 * time: 443.5029420852661
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.98921567362                   -0.97    9.1    19.8s
  2   -62.99895368172       -2.01       -1.04    2.5    7.65s
  3   -63.01028893661       -1.95       -1.99    3.6    10.1s
  4   -63.01029736067       -5.07       -2.37    2.5    8.35s
  5   -63.01031333526       -4.80       -3.42    2.8    9.13s
  6   -63.01031354737       -6.67       -3.98    3.7    10.7s
  7   -63.01031357028       -7.64       -5.38    2.8    9.27s
  8   -63.01031357032      -10.42       -5.82    4.4    12.5s
  9   -63.01031357032      -11.67       -6.93    2.9    9.55s
 10   -63.01031357032      -13.45       -7.90    4.0    11.3s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.98921521470                   -0.97    9.2    20.1s
  2   -62.99893774402       -2.01       -1.04    2.5    7.79s
  3   -63.01028854315       -1.94       -1.99    3.7    10.1s
  4   -63.01029768157       -5.04       -2.38    2.6    8.47s
  5   -63.01031334977       -4.80       -3.43    2.7    8.96s
  6   -63.01031354859       -6.70       -3.98    3.7    10.8s
  7   -63.01031357028       -7.66       -5.47    2.8    9.38s
  8   -63.01031357032      -10.39       -5.88    4.4    12.4s
  9   -63.01031357032      -11.65       -6.96    2.8    9.19s
 10   -63.01031357032   +  -13.45       -7.82    3.9    10.7s
     3    -6.301031e+01     4.267026e-04
 * time: 694.6109409332275
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.98905571973                   -0.97    8.6    19.3s
  2   -62.99875836499       -2.01       -1.04    2.4    7.37s
  3   -63.01029352333       -1.94       -1.99    3.6    10.1s
  4   -63.01030241356       -5.05       -2.36    2.6    8.50s
  5   -63.01031887363       -4.78       -3.41    2.6    8.73s
  6   -63.01031909814       -6.65       -3.97    3.7    10.7s
  7   -63.01031912146       -7.63       -5.39    2.9    9.31s
  8   -63.01031912151      -10.32       -5.84    4.5    12.4s
  9   -63.01031912151      -11.61       -6.97    2.8    8.91s
 10   -63.01031912151      -13.03       -7.83    3.9    10.6s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.98905240301                   -0.97    8.7    19.0s
  2   -62.99875463932       -2.01       -1.04    2.5    7.52s
  3   -63.01029357247       -1.94       -1.99    3.6    9.94s
  4   -63.01030290148       -5.03       -2.38    2.5    8.20s
  5   -63.01031889296       -4.80       -3.43    2.7    9.01s
  6   -63.01031909924       -6.69       -3.98    3.9    11.0s
  7   -63.01031912147       -7.65       -5.49    2.9    9.31s
  8   -63.01031912151      -10.39       -5.91    4.5    12.5s
  9   -63.01031912151      -11.71       -7.07    2.8    9.00s
     4    -6.301032e+01     2.210546e-05
 * time: 931.9573130607605
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.98904341918                   -0.97    9.0    19.8s
  2   -62.99870890926       -2.01       -1.04    2.6    8.09s
  3   -63.01029408889       -1.94       -1.99    3.6    9.77s
  4   -63.01030277050       -5.06       -2.37    2.6    8.49s
  5   -63.01031889994       -4.79       -3.42    2.7    9.14s
  6   -63.01031911289       -6.67       -3.98    3.7    10.7s
  7   -63.01031913654       -7.63       -5.44    3.0    9.53s
  8   -63.01031913658      -10.39       -5.86    4.6    12.7s
  9   -63.01031913658      -11.58       -7.11    2.9    9.24s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.98904614216                   -0.97    9.0    20.2s
  2   -62.99871844372       -2.01       -1.04    2.7    7.58s
  3   -63.01029361223       -1.94       -1.99    3.6    10.0s
  4   -63.01030297996       -5.03       -2.38    2.5    8.26s
  5   -63.01031891870       -4.80       -3.44    2.7    8.79s
  6   -63.01031911525       -6.71       -3.98    3.9    11.0s
  7   -63.01031913653       -7.67       -5.48    2.9    9.36s
  8   -63.01031913658      -10.32       -6.02    4.4    12.2s
  9   -63.01031913658      -11.92       -7.14    3.1    9.68s
     5    -6.301032e+01     2.180523e-07
 * time: 1167.3958818912506
 * Status: success

 * Candidate solution
    Final objective value:     -6.301032e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.36e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.20e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.51e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.39e-10 ≰ 0.0e+00
    |g(x)|                 = 2.18e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   1167  (vs limit Inf)
    Iterations:    5
    f(x) calls:    6
    ∇f(x) calls:   6

NaCl: 1283.949274 seconds (1.36 G allocations: 375.721 GiB, 5.84% gc time, 0.26% compilation time)
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.333965865658                   -1.55    5.5    2.08s
  2   -2.334111482350       -3.84       -1.87    1.3    757ms
  3   -2.334167114654       -4.25       -2.97    3.6    1.66s
  4   -2.334168116766       -6.00       -3.45    4.1    1.53s
  5   -2.334168158282       -7.38       -4.08    2.7    1.48s
  6   -2.334168161588       -8.48       -4.70    3.5    1.35s
  7   -2.334168162031       -9.35       -5.33    3.3    1.57s
  8   -2.334168162042      -10.96       -5.99    3.1    1.22s
  9   -2.334168162043      -12.15       -6.75    2.7    1.45s
 10   -2.334168162043      -13.47       -7.54    3.4    1.30s
Iter     Function value   Gradient norm 
     0    -2.334168e+00     8.851270e-03
 * time: 5.9604644775390625e-6
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.334044838129                   -1.56    5.5    2.19s
  2   -2.334188292550       -3.84       -1.87    1.3    1.08s
  3   -2.334243867509       -4.26       -2.97    3.7    1.42s
  4   -2.334244836963       -6.01       -3.46    4.0    1.83s
  5   -2.334244876599       -7.40       -4.08    2.8    1.19s
  6   -2.334244879881       -8.48       -4.72    3.3    1.62s
  7   -2.334244880272       -9.41       -5.32    3.3    1.34s
  8   -2.334244880283      -10.98       -5.92    3.1    1.60s
  9   -2.334244880283      -12.08       -6.83    2.7    1.20s
 10   -2.334244880284      -13.57       -7.33    3.7    1.74s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.334044798265                   -1.56    5.5    2.12s
  2   -2.334188485356       -3.84       -1.87    1.3    780ms
  3   -2.334243858050       -4.26       -2.97    3.6    1.67s
  4   -2.334244836754       -6.01       -3.46    4.0    1.52s
  5   -2.334244876703       -7.40       -4.10    2.9    1.46s
  6   -2.334244879890       -8.50       -4.72    3.4    1.33s
  7   -2.334244880274       -9.42       -5.38    3.3    1.60s
  8   -2.334244880283      -11.03       -6.02    3.2    1.27s
  9   -2.334244880283      -12.22       -6.80    2.9    1.51s
 10   -2.334244880284      -13.57       -7.55    3.4    1.36s
     1    -2.334245e+00     8.483048e-03
 * time: 59.64016604423523
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.334986236969                   -1.59    5.5    1.74s
  2   -2.335124884937       -3.86       -1.89    1.2    940ms
  3   -2.335176702306       -4.29       -3.08    3.7    1.13s
  4   -2.335177497536       -6.10       -3.43    4.0    1.59s
  5   -2.335177536006       -7.41       -3.58    2.0    739ms
  6   -2.335177571504       -7.45       -4.72    2.6    1.21s
  7   -2.335177572188       -9.16       -5.23    4.4    1.25s
  8   -2.335177572211      -10.64       -5.89    3.2    1.34s
  9   -2.335177572213      -11.72       -6.14    2.9    935ms
 10   -2.335177572213      -12.35       -6.89    3.1    1.28s
 11   -2.335177572213      -13.71       -7.90    2.9    960ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.334984094131                   -1.59    5.5    1.66s
  2   -2.335123805190       -3.85       -1.89    1.3    919ms
  3   -2.335176691565       -4.28       -3.08    3.7    1.12s
  4   -2.335177498518       -6.09       -3.43    4.1    1.53s
  5   -2.335177533553       -7.46       -3.57    1.9    714ms
  6   -2.335177571472       -7.42       -4.71    2.4    1.14s
  7   -2.335177572190       -9.14       -5.18    4.4    1.25s
  8   -2.335177572211      -10.67       -5.87    3.1    1.24s
  9   -2.335177572213      -11.75       -6.04    3.3    988ms
 10   -2.335177572213      -12.22       -6.77    3.1    1.25s
 11   -2.335177572213      -13.55       -7.70    2.7    883ms
     2    -2.335178e+00     1.060221e-03
 * time: 115.66084098815918
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.335001719195                   -1.59    5.7    1.45s
  2   -2.335141730246       -3.85       -1.89    1.4    927ms
  3   -2.335194732064       -4.28       -3.08    3.7    1.13s
  4   -2.335195491917       -6.12       -3.42    4.1    1.52s
  5   -2.335195533148       -7.38       -3.59    2.2    743ms
  6   -2.335195567768       -7.46       -4.70    2.6    1.17s
  7   -2.335195568491       -9.14       -5.29    4.2    1.25s
  8   -2.335195568503      -10.93       -5.83    3.1    1.36s
  9   -2.335195568505      -11.64       -6.11    2.7    887ms
 10   -2.335195568506      -12.13       -6.79    3.2    1.31s
 11   -2.335195568506   +  -14.12       -7.96    2.8    908ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.334997796604                   -1.59    5.6    1.53s
  2   -2.335141281974       -3.84       -1.89    1.4    1.01s
  3   -2.335194797387       -4.27       -3.08    3.8    1.17s
  4   -2.335195493342       -6.16       -3.43    4.1    1.60s
  5   -2.335195531310       -7.42       -3.57    2.0    772ms
  6   -2.335195567719       -7.44       -4.68    2.6    1.17s
  7   -2.335195568494       -9.11       -5.25    4.2    1.25s
  8   -2.335195568502      -11.11       -5.76    2.9    1.28s
  9   -2.335195568505      -11.57       -5.96    2.7    907ms
 10   -2.335195568506      -11.93       -6.67    3.2    1.35s
 11   -2.335195568506      -14.07       -7.77    2.7    923ms
     3    -2.335196e+00     1.834077e-04
 * time: 172.5035901069641
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.335002075041                   -1.59    5.5    1.76s
  2   -2.335141476820       -3.86       -1.89    1.4    953ms
  3   -2.335195383663       -4.27       -3.07    3.7    1.15s
  4   -2.335196069394       -6.16       -3.42    4.2    1.58s
  5   -2.335196105405       -7.44       -3.56    2.1    765ms
  6   -2.335196144051       -7.41       -4.70    2.6    1.19s
  7   -2.335196144817       -9.12       -5.31    4.4    1.28s
  8   -2.335196144831      -10.86       -5.92    3.2    1.35s
  9   -2.335196144833      -11.77       -6.42    3.3    1.00s
 10   -2.335196144833      -12.76       -7.43    3.0    1.29s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.335003091285                   -1.59    5.6    1.80s
  2   -2.335141328698       -3.86       -1.89    1.4    665ms
  3   -2.335195330870       -4.27       -3.07    3.8    1.52s
  4   -2.335196068747       -6.13       -3.42    4.1    1.30s
  5   -2.335196108480       -7.40       -3.58    2.1    1.10s
  6   -2.335196144062       -7.45       -4.70    2.7    880ms
  7   -2.335196144814       -9.12       -5.27    4.3    1.57s
  8   -2.335196144831      -10.77       -5.95    3.1    994ms
  9   -2.335196144833      -11.80       -6.45    3.3    1.35s
 10   -2.335196144833      -12.78       -7.43    3.1    983ms
     4    -2.335196e+00     6.110421e-06
 * time: 227.67090511322021
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.335002536855                   -1.59    5.6    1.52s
  2   -2.335140893693       -3.86       -1.89    1.4    982ms
  3   -2.335195306573       -4.26       -3.07    3.8    1.17s
  4   -2.335196067838       -6.12       -3.42    4.1    1.56s
  5   -2.335196109182       -7.38       -3.58    2.1    766ms
  6   -2.335196144721       -7.45       -4.70    2.6    1.19s
  7   -2.335196145469       -9.13       -5.33    4.4    1.28s
  8   -2.335196145482      -10.89       -5.95    3.1    1.33s
  9   -2.335196145483      -11.80       -6.48    3.2    969ms
 10   -2.335196145483      -12.82       -7.45    3.2    1.29s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.335001575631                   -1.59    5.7    1.74s
  2   -2.335141054429       -3.86       -1.89    1.4    641ms
  3   -2.335195290971       -4.27       -3.07    3.8    1.43s
  4   -2.335196068492       -6.11       -3.42    4.2    1.24s
  5   -2.335196105896       -7.43       -3.56    2.1    1.05s
  6   -2.335196144653       -7.41       -4.69    2.5    832ms
  7   -2.335196145464       -9.09       -5.25    4.4    1.59s
  8   -2.335196145482      -10.75       -5.91    3.2    1.01s
  9   -2.335196145483      -11.76       -6.41    3.3    1.26s
 10   -2.335196145483      -12.74       -7.39    3.2    967ms
     5    -2.335196e+00     4.003811e-08
 * time: 282.56894993782043
 * Status: success

 * Candidate solution
    Final objective value:     -2.335196e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.10e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.66e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 6.50e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.79e-10 ≰ 0.0e+00
    |g(x)|                 = 4.00e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   283  (vs limit Inf)
    Iterations:    5
    f(x) calls:    6
    ∇f(x) calls:   6

Al: 317.525307 seconds (291.85 M allocations: 72.117 GiB, 7.82% gc time, 0.00% compilation time)
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -74.33937993086                   -1.22    9.3    9.64s
  2   -74.34038073319       -3.00       -1.42    3.9    4.58s
  3   -74.34128571769       -3.04       -2.02    6.4    7.07s
  4   -74.34133640720       -4.30       -2.47    5.3    6.17s
  5   -74.34134195233       -5.26       -2.78    5.0    5.97s
  6   -74.34134268154       -6.14       -3.11    4.8    5.55s
  7   -74.34134287116       -6.72       -3.68    5.1    5.77s
  8   -74.34134287900       -8.11       -4.28    5.2    5.80s
  9   -74.34134287909      -10.03       -4.67    4.4    4.97s
 10   -74.34134287917      -10.09       -5.22    4.2    4.94s
 11   -74.34134287918      -10.84       -5.53    6.2    6.76s
 12   -74.34134287918      -11.73       -6.01    4.8    5.07s
 13   -74.34134287918   +  -13.85       -6.36    4.3    5.16s
 14   -74.34134287918   +  -13.85       -6.64    4.8    5.68s
 15   -74.34134287918   +  -12.62       -7.45    5.0    5.61s
Iter     Function value   Gradient norm 
     0    -7.434134e+01     3.093363e-02
 * time: 5.9604644775390625e-6
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -74.34022864585                   -1.22    9.5    9.64s
  2   -74.34124507725       -2.99       -1.42    4.0    4.72s
  3   -74.34216277126       -3.04       -2.01    6.5    7.04s
  4   -74.34221565270       -4.28       -2.47    5.3    6.14s
  5   -74.34222084005       -5.29       -2.78    5.1    6.04s
  6   -74.34222161695       -6.11       -3.11    5.0    5.74s
  7   -74.34222181055       -6.71       -3.67    5.1    6.21s
  8   -74.34222181865       -8.09       -4.25    5.2    5.96s
  9   -74.34222181880       -9.84       -4.69    3.3    4.37s
 10   -74.34222181887      -10.14       -5.26    4.5    5.39s
 11   -74.34222181888      -10.93       -5.57    6.2    6.68s
 12   -74.34222181888      -12.43       -6.02    4.4    5.09s
 13   -74.34222181888      -13.07       -6.39    4.3    5.34s
 14   -74.34222181888   +  -13.00       -6.71    4.7    5.55s
 15   -74.34222181888   +  -12.89       -7.29    4.9    5.64s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -74.34023060107                   -1.22    9.4    9.71s
  2   -74.34124365488       -2.99       -1.42    4.0    4.68s
  3   -74.34216251267       -3.04       -2.01    6.5    7.09s
  4   -74.34221581889       -4.27       -2.48    5.3    6.09s
  5   -74.34222084724       -5.30       -2.78    5.2    6.16s
  6   -74.34222161736       -6.11       -3.11    4.9    5.44s
  7   -74.34222181092       -6.71       -3.67    5.1    5.51s
  8   -74.34222181864       -8.11       -4.24    5.2    5.83s
  9   -74.34222181880       -9.81       -4.71    3.3    4.39s
 10   -74.34222181887      -10.14       -5.27    4.6    5.46s
 11   -74.34222181888      -10.93       -5.60    6.2    6.48s
 12   -74.34222181888      -12.37       -6.01    4.4    5.16s
 13   -74.34222181888      -13.55       -6.37    4.3    5.21s
 14   -74.34222181888   +  -13.85       -6.74    4.8    5.45s
 15   -74.34222181888   +  -12.59       -7.43    4.9    5.52s
     1    -7.434222e+01     2.592502e-02
 * time: 240.7746548652649
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -74.34247138534                   -1.22    9.7    10.2s
  2   -74.34343646279       -3.02       -1.41    4.1    4.80s
  3   -74.34441064197       -3.01       -1.98    6.7    7.28s
  4   -74.34447159191       -4.22       -2.52    5.6    6.27s
  5   -74.34447391022       -5.63       -2.80    5.0    6.21s
  6   -74.34447458105       -6.17       -3.11    5.1    5.92s
  7   -74.34447469295       -6.95       -3.65    4.8    5.60s
  8   -74.34447469518       -8.65       -4.02    4.0    4.87s
  9   -74.34447469614       -9.02       -4.46    4.2    5.38s
 10   -74.34447469632       -9.75       -5.13    4.9    5.70s
 11   -74.34447469634      -10.78       -5.28    5.0    5.69s
 12   -74.34447469634      -11.34       -5.58    4.2    4.94s
 13   -74.34447469634   +  -12.59       -5.93    4.5    5.45s
 14   -74.34447469634   +  -12.09       -6.23    4.6    5.34s
 15   -74.34447469634   +  -11.99       -7.03    5.0    5.54s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -74.34247292828                   -1.22    9.7    10.2s
  2   -74.34343117902       -3.02       -1.41    4.1    4.74s
  3   -74.34441072857       -3.01       -1.98    6.8    7.23s
  4   -74.34447172201       -4.21       -2.52    5.5    6.35s
  5   -74.34447389507       -5.66       -2.80    4.9    6.33s
  6   -74.34447458337       -6.16       -3.11    5.0    5.95s
  7   -74.34447469323       -6.96       -3.65    5.0    5.67s
  8   -74.34447469520       -8.71       -4.02    3.8    4.81s
  9   -74.34447469615       -9.02       -4.48    4.2    5.16s
 10   -74.34447469632       -9.78       -5.13    5.0    5.76s
 11   -74.34447469634      -10.74       -5.27    5.1    6.13s
 12   -74.34447469634      -11.35       -5.58    4.1    4.80s
 13   -74.34447469634   +  -13.15       -5.91    4.6    5.48s
 14   -74.34447469634   +  -12.01       -6.27    4.6    5.35s
 15   -74.34447469634   +  -12.05       -6.83    4.8    5.43s
 16   -74.34447469634   +  -12.85       -7.47    5.0    5.76s
     2    -7.434447e+01     3.111876e-03
 * time: 488.13380885124207
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -74.34251677287                   -1.22    9.8    10.0s
  2   -74.34347936168       -3.02       -1.41    4.0    4.97s
  3   -74.34444871977       -3.01       -1.98    6.8    7.43s
  4   -74.34451012165       -4.21       -2.53    5.7    6.44s
  5   -74.34451212934       -5.70       -2.81    4.8    6.00s
  6   -74.34451278520       -6.18       -3.11    4.9    5.63s
  7   -74.34451289255       -6.97       -3.63    4.8    5.38s
  8   -74.34451289462       -8.68       -4.01    3.8    4.71s
  9   -74.34451289572       -8.96       -4.47    4.3    5.28s
 10   -74.34451289590       -9.73       -5.11    5.0    5.51s
 11   -74.34451289592      -10.92       -5.25    4.9    5.38s
 12   -74.34451289592      -11.20       -5.58    4.3    4.89s
 13   -74.34451289592      -12.18       -5.91    4.6    5.68s
 14   -74.34451289592   +  -12.17       -6.23    4.7    5.26s
 15   -74.34451289592   +  -12.05       -6.88    4.9    5.51s
 16   -74.34451289592   +  -12.62       -7.65    5.0    5.72s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -74.34251321063                   -1.22    9.9    10.1s
  2   -74.34348502110       -3.01       -1.41    4.2    4.90s
  3   -74.34444859992       -3.02       -1.98    6.8    7.29s
  4   -74.34451003645       -4.21       -2.52    5.7    6.36s
  5   -74.34451212064       -5.68       -2.80    4.8    6.10s
  6   -74.34451277973       -6.18       -3.11    5.0    5.75s
  7   -74.34451289224       -6.95       -3.63    4.9    5.58s
  8   -74.34451289466       -8.62       -4.01    3.9    4.84s
  9   -74.34451289572       -8.97       -4.47    4.3    5.18s
 10   -74.34451289590       -9.73       -5.10    5.0    5.75s
 11   -74.34451289592      -10.90       -5.28    4.7    5.25s
 12   -74.34451289592      -11.25       -5.59    4.4    4.99s
 13   -74.34451289592      -12.55       -5.93    4.6    5.38s
 14   -74.34451289592   +  -12.29       -6.19    4.7    5.40s
 15   -74.34451289592   +  -11.93       -7.11    5.1    5.48s
     3    -7.434451e+01     4.002937e-04
 * time: 733.0555469989777
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -74.34251589086                   -1.22    9.7    10.1s
  2   -74.34349293751       -3.01       -1.41    4.2    5.15s
  3   -74.34444845421       -3.02       -1.98    6.7    7.37s
  4   -74.34451075382       -4.21       -2.52    5.6    6.39s
  5   -74.34451274926       -5.70       -2.80    4.7    5.61s
  6   -74.34451343696       -6.16       -3.11    5.1    5.84s
  7   -74.34451354921       -6.95       -3.63    4.8    5.38s
  8   -74.34451355159       -8.62       -4.02    3.9    4.76s
  9   -74.34451355271       -8.95       -4.50    4.4    5.20s
 10   -74.34451355287       -9.80       -5.06    5.0    5.80s
 11   -74.34451355288      -10.96       -5.27    4.5    4.99s
 12   -74.34451355288      -11.19       -5.58    4.3    4.85s
 13   -74.34451355288      -12.12       -5.90    4.6    5.28s
 14   -74.34451355288   +  -12.07       -6.29    4.8    5.27s
 15   -74.34451355288   +  -12.17       -6.96    5.0    5.56s
 16   -74.34451355288   +  -12.70       -7.62    4.9    5.80s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -74.34251802314                   -1.22    9.7    10.1s
  2   -74.34348628495       -3.01       -1.41    4.2    4.87s
  3   -74.34444904407       -3.02       -1.98    6.7    7.41s
  4   -74.34451075115       -4.21       -2.52    5.6    6.57s
  5   -74.34451277887       -5.69       -2.80    4.7    5.66s
  6   -74.34451343758       -6.18       -3.11    4.9    5.84s
  7   -74.34451354943       -6.95       -3.63    4.9    5.67s
  8   -74.34451355156       -8.67       -4.01    3.6    4.59s
  9   -74.34451355268       -8.95       -4.48    4.3    5.20s
 10   -74.34451355287       -9.73       -5.08    5.1    6.01s
 11   -74.34451355288      -10.94       -5.28    4.7    5.18s
 12   -74.34451355288      -11.19       -5.59    4.3    4.88s
 13   -74.34451355288      -12.18       -5.92    4.7    5.35s
 14   -74.34451355288   +  -12.36       -6.19    4.7    5.46s
 15   -74.34451355288   +  -11.94       -7.13    5.1    5.53s
     4    -7.434451e+01     7.301892e-06
 * time: 976.7328219413757
┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-14T12:08:42.774
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Info: 2025-05-14T12:14:06.237
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
┌ Info: 2025-05-14T12:35:30.221
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Info: 2025-05-14T12:40:47.746
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.268808197404857e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Eigensolver not converged
│   n_iter =
│    256-element Vector{Int64}:
│     1
│     2
│     3
│     7
│     ⋮
│     7
│     6
│     2
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/scf/self_consistent_field.jl:76
┌ Warning: Negative ρcore detected: -3.268808197404857e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.268808197404857e-8,1.0209032537819548e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -4.0034324655651e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -4.0034324655651e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-4.0034324655651e-8,1.0516911140408439e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.881725276080173e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.881725276080173e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.881725276080173e-8,9.848388149901142e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.8480709677887405e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.8480709677887405e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.8480709677887405e-8,1.1022157762476582e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.8474099489152586e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
ERROR: LoadError: Ortho(X,Y) is failing badly, this should never happen
Stacktrace:
  [1] error(s::String)
    @ Base ./error.jl:35
  [2] macro expansion
    @ ~/.julia/packages/DFTK/n2IL4/src/eigen/lobpcg_hyper_impl.jl:302 [inlined]
  [3] ortho!(X::Matrix{ComplexF64}, Y::SubArray{ComplexF64, 2, Matrix{ComplexF64}, Tuple{Base.Slice{Base.OneTo{Int64}}, UnitRange{Int64}}, true}, BY::SubArray{ComplexF64, 2, Matrix{ComplexF64}, Tuple{Base.Slice{Base.OneTo{Int64}}, UnitRange{Int64}}, true}; tol::Float64)
    @ DFTK ~/.julia/packages/TimerOutputs/6KVfH/src/TimerOutput.jl:237
  [4] macro expansion
    @ ~/.julia/packages/DFTK/n2IL4/src/eigen/lobpcg_hyper_impl.jl:484 [inlined]
  [5] LOBPCG(A::DFTK.DftHamiltonianBlock, X::Matrix{ComplexF64}, B::UniformScaling{Bool}, precon::PreconditionerTPA{Float64}, tol::Float64, maxiter::Int64; miniter::Int64, ortho_tol::Float64, n_conv_check::Int64, display_progress::Bool)
    @ DFTK ~/.julia/packages/TimerOutputs/6KVfH/src/TimerOutput.jl:237
  [6] LOBPCG
    @ ~/.julia/packages/TimerOutputs/6KVfH/src/TimerOutput.jl:230 [inlined]
  [7] lobpcg_hyper(A::DFTK.DftHamiltonianBlock, X0::Matrix{ComplexF64}; maxiter::Int64, prec::PreconditionerTPA{Float64}, tol::Float64, largest::Bool, n_conv_check::Int64, kwargs::@Kwargs{miniter::Int64})
    @ DFTK ~/.julia/packages/DFTK/n2IL4/src/eigen/diag_lobpcg_hyper.jl:11
  [8] diagonalize_all_kblocks(eigensolver::typeof(lobpcg_hyper), ham::Hamiltonian, nev_per_kpoint::Int64; ψguess::Nothing, prec_type::Type{PreconditionerTPA}, interpolate_kpoints::Bool, tol::Float64, miniter::Int64, maxiter::Int64, n_conv_check::Int64)
    @ DFTK ~/.julia/packages/DFTK/n2IL4/src/eigen/diag.jl:50
  [9] next_density(ham::Hamiltonian, nbandsalg::AdaptiveBands, fermialg::FermiBisection; eigensolver::Function, ψ::Nothing, eigenvalues::Nothing, occupation::Nothing, kwargs::@Kwargs{miniter::Int64, tol::Float64})
    @ DFTK ~/.julia/packages/DFTK/n2IL4/src/scf/self_consistent_field.jl:74
 [10] (::DFTK.var"#fixpoint_map#818"{Float64, ScfConvergenceDensity, Int64, χ0Mixing, Float64, typeof(lobpcg_hyper), AdaptiveDiagtol, AdaptiveBands, FermiBisection, ScfDefaultCallback, Bool, PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, DateTime, UInt64})(ρin::Array{Float64, 4}, info::@NamedTuple{ρin::Array{Float64, 4}, τ::Nothing, ψ::Nothing, occupation::Nothing, eigenvalues::Nothing, εF::Nothing, n_iter::Int64, n_matvec::Int64, timedout::Bool, converged::Bool, history_Etot::Vector{Float64}, history_Δρ::Vector{Float64}})
    @ DFTK ~/.julia/packages/DFTK/n2IL4/src/scf/self_consistent_field.jl:168
 [11] (::DFTK.var"#anderson#779"{DFTK.var"#anderson#778#780"{@Kwargs{}}})(f::DFTK.var"#fixpoint_map#818"{Float64, ScfConvergenceDensity, Int64, χ0Mixing, Float64, typeof(lobpcg_hyper), AdaptiveDiagtol, AdaptiveBands, FermiBisection, ScfDefaultCallback, Bool, PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, DateTime, UInt64}, x0::Array{Float64, 4}, info0::@NamedTuple{ρin::Array{Float64, 4}, τ::Nothing, ψ::Nothing, occupation::Nothing, eigenvalues::Nothing, εF::Nothing, n_iter::Int64, n_matvec::Int64, timedout::Bool, converged::Bool, history_Etot::Vector{Float64}, history_Δρ::Vector{Float64}}; maxiter::Int64)
    @ DFTK ~/.julia/packages/DFTK/n2IL4/src/scf/scf_solvers.jl:49
 [12] macro expansion
    @ ~/.julia/packages/DFTK/n2IL4/src/scf/self_consistent_field.jl:217 [inlined]
 [13] self_consistent_field(basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}; ρ::Array{Float64, 4}, τ::Nothing, ψ::Nothing, tol::Float64, is_converged::ScfConvergenceDensity, miniter::Int64, maxiter::Int64, maxtime::Year, mixing::χ0Mixing, damping::Float64, solver::DFTK.var"#anderson#779"{DFTK.var"#anderson#778#780"{@Kwargs{}}}, eigensolver::typeof(lobpcg_hyper), diagtolalg::AdaptiveDiagtol, nbandsalg::AdaptiveBands, fermialg::FermiBisection, callback::ScfDefaultCallback, compute_consistent_energies::Bool, response::ResponseOptions)
    @ DFTK ~/.julia/packages/TimerOutputs/6KVfH/src/TimerOutput.jl:237
 [14] (::var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#30"})(E::Float64, G::Nothing, p::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, θ::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}})
    @ Main ~/project_autodiff_for_dft_examples/1_ideas/lattice_relaxation.jl:20
 [15] #6
    @ ~/project_autodiff_for_dft_examples/1_ideas/optimise.jl:13 [inlined]
 [16] (::NLSolversBase.var"#55#56"{NLSolversBase.InplaceObjective{Nothing, var"#6#7"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#30"}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Nothing, Nothing, Nothing}, Float64})(x::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}})
    @ NLSolversBase ~/.julia/packages/NLSolversBase/kavn7/src/objective_types/incomplete.jl:44
 [17] value!!(obj::OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, x::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}})
    @ NLSolversBase ~/.julia/packages/NLSolversBase/kavn7/src/interface.jl:9
 [18] value!(obj::OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, x::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}})
    @ NLSolversBase ~/.julia/packages/NLSolversBase/kavn7/src/interface.jl:28
 [19] value!(obj::Optim.ManifoldObjective{OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}}, x::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}})
    @ Optim ~/.julia/packages/Optim/HvjCd/src/Manifolds.jl:31
 [20] (::LineSearches.var"#ϕ#1"{Optim.ManifoldObjective{OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}})(α::Float64)
    @ LineSearches ~/.julia/packages/LineSearches/jgnxK/src/LineSearches.jl:24
 [21] (::BackTracking{Float64, Int64})(ϕ::LineSearches.var"#ϕ#1"{Optim.ManifoldObjective{OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, αinitial::Float64, ϕ_0::Float64, dϕ_0::Float64)
    @ LineSearches ~/.julia/packages/LineSearches/jgnxK/src/backtracking.jl:63
 [22] BackTracking
    @ ~/.julia/packages/LineSearches/jgnxK/src/backtracking.jl:34 [inlined]
 [23] BackTracking
    @ ~/.julia/packages/LineSearches/jgnxK/src/backtracking.jl:24 [inlined]
 [24] perform_linesearch!(state::Optim.LBFGSState{ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, Vector{ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, Vector{ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, method::LBFGS{Nothing, InitialStatic{Float64}, BackTracking{Float64, Int64}, Optim.var"#20#22"}, d::Optim.ManifoldObjective{OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}})
    @ Optim ~/.julia/packages/Optim/HvjCd/src/utilities/perform_linesearch.jl:58
 [25] update_state!(d::OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, state::Optim.LBFGSState{ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, Vector{ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, Vector{ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, method::LBFGS{Nothing, InitialStatic{Float64}, BackTracking{Float64, Int64}, Optim.var"#20#22"})
    @ Optim ~/.julia/packages/Optim/HvjCd/src/multivariate/solvers/first_order/l_bfgs.jl:204
 [26] optimize(d::OnceDifferentiable{Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, initial_x::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, method::LBFGS{Nothing, InitialStatic{Float64}, BackTracking{Float64, Int64}, Optim.var"#20#22"}, options::Optim.Options{Float64, Nothing}, state::Optim.LBFGSState{ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, Vector{ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, Vector{ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}}, Float64, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}})
    @ Optim ~/.julia/packages/Optim/HvjCd/src/multivariate/optimize/optimize.jl:54
 [27] optimize
    @ ~/.julia/packages/Optim/HvjCd/src/multivariate/optimize/optimize.jl:36 [inlined]
 [28] optimize(f::NLSolversBase.InplaceObjective{Nothing, var"#6#7"{var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#30"}, ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}}, Nothing, Nothing, Nothing}, initial_x::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, method::LBFGS{Nothing, InitialStatic{Float64}, BackTracking{Float64, Int64}, Optim.var"#20#22"}, options::Optim.Options{Float64, Nothing}; inplace::Bool, autodiff::Symbol)
    @ Optim ~/.julia/packages/Optim/HvjCd/src/multivariate/optimize/interface.jl:143
 [29] optimize
    @ ~/.julia/packages/Optim/HvjCd/src/multivariate/optimize/interface.jl:139 [inlined]
 [30] optimise(fg!::var"#dftk_fg!#20"{Float64, MonkhorstPack, Float64, DFTK.Smearing.Gaussian, BlowupCHV, Vector{Any}, Float64, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}, var"#make_pbe#30"}, x0::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(a = 1,)}}}, θ::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}; show_trace::Bool, kwargs::@Kwargs{f_abstol::Float64, x_tol::Int64, g_abstol::Float64})
    @ Main ~/project_autodiff_for_dft_examples/1_ideas/optimise.jl:13
 [31] #optimal_lattice#18
    @ ~/project_autodiff_for_dft_examples/1_ideas/lattice_relaxation.jl:35 [inlined]
 [32] macro expansion
    @ ./timing.jl:581 [inlined]
 [33] (::var"#loss_fn#32"{Vector{Any}, var"#make_pbe#30", String})(θ::ComponentVector{Float64, Vector{Float64}, Tuple{Axis{(κ = 1, μ = 2)}}}, cases::Vector{var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}})
    @ Main ~/project_autodiff_for_dft_examples/1_ideas/xc_finetuning/train/pbe_Si_Al_V_NaCl_gridsearch/loss.jl:87
 [34] main(workdir::String, κ::Float64, μ::Float64)
    @ Main ~/project_autodiff_for_dft_examples/1_ideas/xc_finetuning/train/pbe_Si_Al_V_NaCl_gridsearch/loss.jl:111
 [35] top-level scope
    @ ~/project_autodiff_for_dft_examples/1_ideas/xc_finetuning/train/pbe_Si_Al_V_NaCl_gridsearch/loss.jl:121
in expression starting at /home/schmitz/project_autodiff_for_dft_examples/1_ideas/xc_finetuning/train/pbe_Si_Al_V_NaCl_gridsearch/loss.jl:114
