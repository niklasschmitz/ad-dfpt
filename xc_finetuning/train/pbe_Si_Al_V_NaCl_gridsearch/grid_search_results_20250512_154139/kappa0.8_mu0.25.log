┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-12T17:03:27.734
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.472681254688                   -0.96    7.1    12.3s
  2   -8.474439569764       -2.75       -1.72    1.8    5.12s
  3   -8.474503206769       -4.20       -2.74    3.7    1.94s
  4   -8.474504454329       -5.90       -3.81    4.2    1.73s
  5   -8.474504470261       -7.80       -4.43    4.7    2.32s
  6   -8.474504471004       -9.13       -5.43    4.6    2.15s
  7   -8.474504471013      -11.08       -6.15    4.1    2.57s
  8   -8.474504471013      -12.75       -7.49    3.7    2.64s
Iter     Function value   Gradient norm 
     0    -8.474504e+00     7.177428e-04
 * time: 5.507469177246094e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.472678893448                   -0.96    6.9    2.53s
  2   -8.474437232995       -2.75       -1.72    2.0    1.41s
  3   -8.474503641192       -4.18       -2.75    3.7    1.63s
  4   -8.474504950460       -5.88       -3.81    4.4    2.06s
  5   -8.474504967573       -7.77       -4.44    4.8    1.86s
  6   -8.474504968312       -9.13       -5.41    4.5    1.93s
  7   -8.474504968322      -11.01       -6.13    4.0    1.71s
  8   -8.474504968322      -12.69       -7.44    3.8    1.88s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.472683286586                   -0.96    6.9    2.59s
  2   -8.474440266753       -2.76       -1.72    1.9    1.44s
  3   -8.474503324034       -4.20       -2.75    3.7    1.64s
  4   -8.474504951684       -5.79       -3.77    4.3    2.11s
  5   -8.474504967797       -7.79       -4.54    4.6    1.86s
  6   -8.474504968316       -9.28       -5.52    4.7    2.07s
  7   -8.474504968322      -11.24       -6.18    4.0    1.74s
  8   -8.474504968322      -12.74       -7.35    3.8    1.93s
     1    -8.474505e+00     6.680232e-04
 * time: 42.88882803916931
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.472707205949                   -0.96    7.2    2.67s
  2   -8.474442780887       -2.76       -1.72    2.2    1.31s
  3   -8.474506786607       -4.19       -2.75    3.7    1.97s
  4   -8.474508185002       -5.85       -3.80    4.5    2.16s
  5   -8.474508199521       -7.84       -4.50    4.7    1.93s
  6   -8.474508200119       -9.22       -5.50    4.8    2.06s
  7   -8.474508200125      -11.22       -6.19    4.3    1.82s
  8   -8.474508200125      -12.76       -7.35    3.8    1.96s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.472706115973                   -0.96    7.3    2.72s
  2   -8.474441927336       -2.76       -1.72    1.9    1.52s
  3   -8.474506607850       -4.19       -2.75    3.7    1.71s
  4   -8.474508184873       -5.80       -3.79    4.5    2.31s
  5   -8.474508199550       -7.83       -4.52    4.8    1.88s
  6   -8.474508200119       -9.24       -5.51    4.8    2.10s
  7   -8.474508200125      -11.21       -6.17    4.1    1.80s
  8   -8.474508200125      -12.72       -7.35    3.9    2.20s
     2    -8.474508e+00     3.264534e-06
 * time: 87.9644410610199
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.472709744970                   -0.96    7.2    2.70s
  2   -8.474444063942       -2.76       -1.72    2.3    1.39s
  3   -8.474506769111       -4.20       -2.75    3.7    2.04s
  4   -8.474508184321       -5.85       -3.80    4.6    2.16s
  5   -8.474508199547       -7.82       -4.47    4.8    1.87s
  6   -8.474508200195       -9.19       -5.46    4.6    2.01s
  7   -8.474508200203      -11.13       -6.13    4.2    1.80s
  8   -8.474508200203      -12.66       -7.40    3.6    1.92s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.472713433326                   -0.96    7.2    2.71s
  2   -8.474444437978       -2.76       -1.72    1.9    1.58s
  3   -8.474506743729       -4.21       -2.75    3.7    1.84s
  4   -8.474508185295       -5.84       -3.81    4.5    2.20s
  5   -8.474508199601       -7.84       -4.49    4.8    2.23s
  6   -8.474508200195       -9.23       -5.49    5.0    2.46s
  7   -8.474508200203      -11.12       -6.14    4.2    1.86s
  8   -8.474508200203      -12.70       -7.47    3.8    1.93s
     3    -8.474508e+00     1.191121e-08
 * time: 132.31822991371155
 * Status: success

 * Candidate solution
    Final objective value:     -8.474508e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 4.74e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.57e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 7.76e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 9.15e-12 ≰ 0.0e+00
    |g(x)|                 = 1.19e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   132  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 214.978169 seconds (307.06 M allocations: 58.689 GiB, 7.57% gc time, 26.25% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-12T17:07:03.442
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30742515725                   -1.14    8.5    19.4s
  2   -62.31231733382       -2.31       -1.20    2.6    8.05s
  3   -62.31701960022       -2.33       -2.04    3.9    10.1s
  4   -62.31705429506       -4.46       -2.93    3.4    9.48s
  5   -62.31705462639       -6.48       -3.59    4.1    10.6s
  6   -62.31705465056       -7.62       -4.23    3.7    9.39s
  7   -62.31705465128       -9.14       -4.98    4.0    10.3s
  8   -62.31705465130      -10.64       -6.57    3.9    10.2s
  9   -62.31705465130      -12.79       -7.54    4.3    11.7s
Iter     Function value   Gradient norm 
     0    -6.231705e+01     8.877692e-04
 * time: 3.1948089599609375e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30742970432                   -1.14    8.8    18.3s
  2   -62.31229285034       -2.31       -1.20    2.8    7.76s
  3   -62.31702106051       -2.33       -2.05    4.2    10.6s
  4   -62.31705510684       -4.47       -2.97    3.5    9.01s
  5   -62.31705540997       -6.52       -3.66    4.2    10.6s
  6   -62.31705543081       -7.68       -4.28    3.5    9.39s
  7   -62.31705543138       -9.24       -4.97    4.0    11.6s
  8   -62.31705543141      -10.62       -6.51    4.0    11.1s
  9   -62.31705543141      -12.83       -7.24    4.3    11.3s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30743089628                   -1.14    8.7    18.1s
  2   -62.31230314436       -2.31       -1.20    2.9    7.62s
  3   -62.31702099561       -2.33       -2.05    4.3    10.3s
  4   -62.31705512840       -4.47       -2.98    3.4    8.80s
  5   -62.31705541110       -6.55       -3.68    4.1    10.6s
  6   -62.31705543085       -7.70       -4.29    3.6    9.23s
  7   -62.31705543138       -9.27       -4.98    4.0    10.5s
  8   -62.31705543141      -10.65       -6.58    4.0    10.2s
  9   -62.31705543141      -13.25       -7.04    4.5    11.5s
     1    -6.231706e+01     8.696902e-04
 * time: 227.39766883850098
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30728855113                   -1.14    8.6    17.0s
  2   -62.31217071040       -2.31       -1.20    2.7    7.43s
  3   -62.31703824315       -2.31       -2.04    3.9    9.79s
  4   -62.31707395435       -4.45       -2.98    3.5    9.41s
  5   -62.31707424224       -6.54       -3.67    4.1    12.0s
  6   -62.31707426278       -7.69       -4.29    3.6    9.91s
  7   -62.31707426332       -9.26       -4.98    3.9    10.9s
  8   -62.31707426335      -10.64       -6.55    3.9    11.1s
  9   -62.31707426335      -13.15       -7.59    4.1    11.5s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30728440739                   -1.14    8.6    17.6s
  2   -62.31215108496       -2.31       -1.20    2.8    7.63s
  3   -62.31703834391       -2.31       -2.04    4.0    9.85s
  4   -62.31707392019       -4.45       -2.96    3.5    9.54s
  5   -62.31707424061       -6.49       -3.65    4.0    10.7s
  6   -62.31707426272       -7.66       -4.28    3.4    9.48s
  7   -62.31707426332       -9.22       -4.98    3.8    10.0s
  8   -62.31707426335      -10.64       -6.45    3.9    11.0s
  9   -62.31707426335      -13.11       -7.56    4.2    12.2s
     2    -6.231707e+01     1.829489e-05
 * time: 463.8989419937134
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30728508610                   -1.14    8.5    18.6s
  2   -62.31215012372       -2.31       -1.20    2.8    8.60s
  3   -62.31703858524       -2.31       -2.04    3.9    10.8s
  4   -62.31707397625       -4.45       -3.00    3.4    9.51s
  5   -62.31707425253       -6.56       -3.72    4.1    11.9s
  6   -62.31707427142       -7.72       -4.34    3.4    8.56s
  7   -62.31707427189       -9.32       -5.01    4.0    10.3s
  8   -62.31707427191      -10.69       -6.96    3.8    9.93s
  9   -62.31707427191      -12.94       -7.68    4.7    12.6s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30728672556                   -1.14    8.5    17.6s
  2   -62.31215420470       -2.31       -1.20    2.6    7.31s
  3   -62.31703844755       -2.31       -2.04    3.8    9.93s
  4   -62.31707398609       -4.45       -3.01    3.5    9.81s
  5   -62.31707425304       -6.57       -3.72    4.2    10.8s
  6   -62.31707427144       -7.74       -4.33    3.4    8.89s
  7   -62.31707427189       -9.34       -4.99    3.9    11.9s
  8   -62.31707427191      -10.66       -6.76    3.8    10.8s
  9   -62.31707427191      -13.15       -7.64    4.5    12.8s
     3    -6.231707e+01     3.915622e-07
 * time: 696.0434958934784
 * Status: success

 * Candidate solution
    Final objective value:     -6.231707e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 9.18e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 8.50e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 8.57e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.37e-10 ≰ 0.0e+00
    |g(x)|                 = 3.92e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   696  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

NaCl: 821.364951 seconds (795.93 M allocations: 227.663 GiB, 5.45% gc time, 0.38% compilation time)
┌ Info: 2025-05-12T17:20:44.835
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.319048209024                   -1.47    5.5    2.31s
  2   -2.319115546893       -4.17       -1.84    1.3    822ms
  3   -2.319129414406       -4.86       -3.54    3.1    1.85s
  4   -2.319129597321       -6.74       -3.93    4.5    2.20s
  5   -2.319129597910       -9.23       -4.14    2.0    1.47s
  6   -2.319129598153       -9.61       -4.98    2.5    1.42s
  7   -2.319129598167      -10.85       -5.68    3.1    1.91s
  8   -2.319129598168      -12.43       -5.93    2.6    1.19s
  9   -2.319129598168      -12.98       -6.47    2.3    1.09s
 10   -2.319129598168      -14.07       -7.49    2.7    1.67s
Iter     Function value   Gradient norm 
     0    -2.319130e+00     6.112573e-04
 * time: 4.100799560546875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.319048417550                   -1.47    5.6    2.71s
  2   -2.319115670238       -4.17       -1.84    1.3    1.23s
  3   -2.319129758891       -4.85       -3.54    3.2    1.32s
  4   -2.319129963244       -6.69       -3.93    4.4    1.99s
  5   -2.319129963803       -9.25       -4.13    2.1    1.00s
  6   -2.319129964052       -9.60       -4.97    2.6    1.41s
  7   -2.319129964068      -10.81       -5.68    3.1    1.29s
  8   -2.319129964068      -12.46       -5.94    2.6    1.43s
  9   -2.319129964068      -12.98       -6.54    2.3    1.06s
 10   -2.319129964068      -14.27       -7.44    2.9    2.08s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.319042966769                   -1.47    5.5    2.08s
  2   -2.319115464498       -4.14       -1.84    1.3    762ms
  3   -2.319129802740       -4.84       -3.53    3.2    1.88s
  4   -2.319129963248       -6.79       -3.93    4.5    1.87s
  5   -2.319129963812       -9.25       -4.14    2.2    1.46s
  6   -2.319129964053       -9.62       -4.99    2.7    1.12s
  7   -2.319129964068      -10.84       -5.69    3.1    1.62s
  8   -2.319129964068      -12.52       -5.94    2.6    1.09s
  9   -2.319129964068      -12.98       -6.48    2.2    1.51s
 10   -2.319129964068      -14.15       -7.53    2.7    1.38s
     1    -2.319130e+00     5.859443e-04
 * time: 61.654090881347656
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.319059681905                   -1.48    5.6    2.15s
  2   -2.319120892630       -4.21       -1.84    1.3    1.09s
  3   -2.319133852250       -4.89       -3.54    3.3    1.33s
  4   -2.319134059275       -6.68       -3.98    4.5    1.98s
  5   -2.319134059725       -9.35       -4.20    2.1    997ms
  6   -2.319134059898       -9.76       -5.05    2.7    1.41s
  7   -2.319134059908      -10.99       -5.94    3.1    1.28s
  8   -2.319134059909      -12.71       -6.29    3.0    1.54s
  9   -2.319134059909      -13.65       -6.87    2.7    1.15s
 10   -2.319134059909      -14.57       -7.88    2.8    1.47s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.319060119173                   -1.48    5.6    2.17s
  2   -2.319120882542       -4.22       -1.84    1.3    760ms
  3   -2.319133850401       -4.89       -3.54    3.3    1.59s
  4   -2.319134059238       -6.68       -3.97    4.5    1.67s
  5   -2.319134059721       -9.32       -4.19    2.2    1.27s
  6   -2.319134059898       -9.75       -5.04    2.6    1.08s
  7   -2.319134059908      -10.98       -5.95    3.2    1.54s
  8   -2.319134059909      -12.79       -6.30    3.0    1.22s
  9   -2.319134059909      -13.60       -6.88    2.9    1.46s
 10   -2.319134059909      -15.35       -7.82    2.9    1.17s
     2    -2.319134e+00     1.021852e-05
 * time: 121.88543391227722
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.319060381599                   -1.48    5.7    1.89s
  2   -2.319121211185       -4.22       -1.84    1.4    1.10s
  3   -2.319133849403       -4.90       -3.54    3.3    1.36s
  4   -2.319134060491       -6.68       -3.97    4.5    2.01s
  5   -2.319134060945       -9.34       -4.19    2.2    1.02s
  6   -2.319134061118       -9.76       -5.06    2.6    1.40s
  7   -2.319134061129      -10.98       -5.93    3.2    1.29s
  8   -2.319134061129      -12.75       -6.32    3.0    1.58s
  9   -2.319134061129      -13.67       -6.92    2.9    1.23s
 10   -2.319134061129      -14.75       -7.66    2.9    1.51s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.319059548517                   -1.48    5.6    2.16s
  2   -2.319120937580       -4.21       -1.84    1.4    795ms
  3   -2.319133880775       -4.89       -3.54    3.3    1.75s
  4   -2.319134060474       -6.75       -3.98    4.5    1.90s
  5   -2.319134060944       -9.33       -4.19    2.3    1.48s
  6   -2.319134061118       -9.76       -5.05    2.8    1.14s
  7   -2.319134061129      -10.98       -5.92    3.2    1.54s
  8   -2.319134061129      -12.74       -6.29    3.0    1.22s
  9   -2.319134061129      -13.55       -6.86    2.9    1.44s
 10   -2.319134061129      -14.75       -8.01    2.8    1.13s
     3    -2.319134e+00     1.561262e-07
 * time: 180.78077697753906
 * Status: success

 * Candidate solution
    Final objective value:     -2.319134e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.43e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.17e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.22e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 5.26e-10 ≰ 0.0e+00
    |g(x)|                 = 1.56e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   181  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Al: 217.868849 seconds (170.46 M allocations: 40.794 GiB, 6.87% gc time, 0.10% compilation time)
┌ Info: 2025-05-12T17:24:22.705
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.84591276990                   -0.91    9.5    9.84s
  2   -73.85451645429       -2.07       -1.11    5.2    5.46s
  3   -73.85989014323       -2.27       -1.46    6.7    7.29s
  4   -73.86071460869       -3.08       -1.81    5.6    5.98s
  5   -73.86084218490       -3.89       -2.24    4.8    5.72s
  6   -73.86086264674       -4.69       -3.08    5.4    6.42s
  7   -73.86086266554       -7.73       -3.51    4.7    5.83s
  8   -73.86086266993       -8.36       -4.02    4.4    5.17s
  9   -73.86086266987   +  -10.28       -4.47    5.3    6.16s
 10   -73.86086267031       -9.36       -4.76    5.3    5.67s
 11   -73.86086267035      -10.37       -5.47    4.7    5.46s
 12   -73.86086267035      -11.49       -6.13    4.6    5.87s
 13   -73.86086267035      -12.45       -6.34    4.7    6.40s
 14   -73.86086267035      -12.81       -6.78    5.4    6.73s
 15   -73.86086267035      -12.94       -7.74    4.8    5.89s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.386086e+01     2.287512e-03
 * time: 3.504753112792969e-5
┌ Warning: Negative ρcore detected: -3.4112485838608556e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.84595376920                   -0.91    9.7    9.72s
  2   -73.85455713066       -2.07       -1.11    5.2    5.52s
  3   -73.85989076582       -2.27       -1.46    6.6    6.97s
  4   -73.86072132541       -3.08       -1.81    5.6    6.15s
  5   -73.86084688457       -3.90       -2.24    4.9    5.56s
  6   -73.86086748053       -4.69       -3.08    5.5    6.09s
  7   -73.86086749995       -7.71       -3.52    4.8    5.60s
  8   -73.86086750500       -8.30       -4.03    4.6    5.52s
  9   -73.86086750480   +   -9.70       -4.47    5.4    5.98s
 10   -73.86086750536       -9.25       -4.77    5.3    5.79s
 11   -73.86086750540      -10.37       -5.46    4.8    5.81s
 12   -73.86086750541      -11.51       -6.15    4.6    5.70s
 13   -73.86086750541      -12.77       -6.29    4.7    6.48s
 14   -73.86086750541      -12.67       -6.80    5.3    5.73s
 15   -73.86086750541      -13.25       -7.73    4.9    6.33s
┌ Warning: Negative ρcore detected: -3.4112485838608556e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.84595647560                   -0.91    9.6    9.72s
  2   -73.85456167054       -2.07       -1.11    5.1    5.57s
  3   -73.85988975418       -2.27       -1.46    6.6    7.58s
  4   -73.86072149405       -3.08       -1.81    5.7    5.94s
  5   -73.86084671023       -3.90       -2.24    4.8    6.54s
  6   -73.86086748168       -4.68       -3.08    5.5    6.19s
  7   -73.86086749965       -7.75       -3.52    4.7    5.70s
  8   -73.86086750494       -8.28       -4.02    4.5    5.10s
  9   -73.86086750480   +   -9.87       -4.46    5.4    6.73s
 10   -73.86086750536       -9.25       -4.76    5.5    6.05s
 11   -73.86086750540      -10.39       -5.45    4.6    6.28s
 12   -73.86086750541      -11.51       -6.14    4.6    5.76s
 13   -73.86086750541      -12.53       -6.30    4.8    5.89s
 14   -73.86086750541      -12.73       -6.79    5.3    6.97s
 15   -73.86086750541      -13.37       -7.72    4.9    5.82s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4112485838608556e-8,-2.2062611107001128e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.386087e+01     1.939584e-03
 * time: 251.94983196258545
┌ Warning: Negative ρcore detected: -3.347460771151782e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.84617183006                   -0.91    9.7    10.4s
  2   -73.85465236786       -2.07       -1.11    5.1    6.66s
  3   -73.85990508266       -2.28       -1.46    6.6    8.27s
  4   -73.86074056954       -3.08       -1.82    5.6    5.97s
  5   -73.86086069831       -3.92       -2.26    4.8    5.76s
  6   -73.86087972786       -4.72       -3.09    5.6    6.43s
  7   -73.86087975366       -7.59       -3.54    4.3    5.22s
  8   -73.86087975991       -8.20       -4.02    4.8    5.96s
  9   -73.86087975934   +   -9.24       -4.49    5.4    5.81s
 10   -73.86087976011       -9.11       -4.76    5.6    6.07s
 11   -73.86087976016      -10.34       -5.44    4.8    5.71s
 12   -73.86087976017      -11.09       -6.10    4.6    5.27s
 13   -73.86087976017      -12.25       -6.26    4.7    5.42s
 14   -73.86087976017      -11.89       -6.83    5.4    5.69s
 15   -73.86087976017      -12.59       -7.82    4.9    5.58s
┌ Warning: Negative ρcore detected: -3.347460771151782e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.84617246195                   -0.91    9.6    9.55s
  2   -73.85464426772       -2.07       -1.11    5.0    5.80s
  3   -73.85990702338       -2.28       -1.47    6.6    7.15s
  4   -73.86074028500       -3.08       -1.82    5.7    5.91s
  5   -73.86086052196       -3.92       -2.26    4.9    6.09s
  6   -73.86087972702       -4.72       -3.08    5.4    6.66s
  7   -73.86087975389       -7.57       -3.53    4.2    5.56s
  8   -73.86087975991       -8.22       -4.02    4.8    6.01s
  9   -73.86087975942   +   -9.31       -4.50    5.3    6.77s
 10   -73.86087976012       -9.16       -4.76    5.5    5.87s
 11   -73.86087976016      -10.36       -5.45    4.7    5.66s
 12   -73.86087976017      -11.11       -6.10    4.5    5.38s
 13   -73.86087976017      -12.18       -6.27    4.7    5.72s
 14   -73.86087976017      -11.90       -6.82    5.3    5.58s
 15   -73.86087976017      -12.64       -7.85    4.9    6.20s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.347460771151782e-8,-7.88146237586529e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.386088e+01     2.347630e-05
 * time: 503.7106931209564
┌ Warning: Negative ρcore detected: -3.348657315819593e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.84617968802                   -0.91    9.7    10.5s
  2   -73.85463901200       -2.07       -1.11    5.1    5.84s
  3   -73.85990696271       -2.28       -1.47    6.5    7.97s
  4   -73.86074051033       -3.08       -1.82    5.6    6.59s
  5   -73.86086046802       -3.92       -2.26    4.9    5.64s
  6   -73.86087972753       -4.72       -3.08    5.5    6.51s
  7   -73.86087975599       -7.55       -3.53    4.2    5.35s
  8   -73.86087976157       -8.25       -4.02    4.7    5.38s
  9   -73.86087976114   +   -9.37       -4.51    5.2    5.99s
 10   -73.86087976177       -9.20       -4.76    5.4    5.99s
 11   -73.86087976182      -10.30       -5.45    4.8    5.52s
 12   -73.86087976183      -11.10       -6.10    4.5    5.37s
 13   -73.86087976183      -12.18       -6.27    4.7    5.52s
 14   -73.86087976183      -11.93       -6.82    5.4    5.60s
 15   -73.86087976183      -12.43       -7.85    4.9    5.76s
┌ Warning: Negative ρcore detected: -3.348657315819593e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.84617407805                   -0.91    9.7    10.5s
  2   -73.85465317108       -2.07       -1.11    5.0    5.84s
  3   -73.85990577011       -2.28       -1.46    6.5    8.27s
  4   -73.86073971597       -3.08       -1.82    5.6    6.76s
  5   -73.86086060734       -3.92       -2.26    4.9    5.80s
  6   -73.86087972835       -4.72       -3.08    5.4    6.64s
  7   -73.86087975605       -7.56       -3.52    4.3    5.46s
  8   -73.86087976157       -8.26       -4.01    4.7    6.03s
  9   -73.86087976111   +   -9.34       -4.50    5.3    6.61s
 10   -73.86087976178       -9.18       -4.75    5.4    6.32s
 11   -73.86087976182      -10.36       -5.44    4.7    5.60s
 12   -73.86087976183      -11.10       -6.10    4.6    5.85s
 13   -73.86087976183      -12.18       -6.27    4.8    6.31s
 14   -73.86087976183      -11.90       -6.83    5.4    6.89s
 15   -73.86087976183      -12.59       -7.85    4.9    6.06s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.348657315819593e-8,-7.810641523285856e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.386088e+01     2.379865e-07
 * time: 759.2277729511261
 * Status: success

 * Candidate solution
    Final objective value:     -7.386088e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.53e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.68e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.66e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.25e-11 ≰ 0.0e+00
    |g(x)|                 = 2.38e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   759  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

V: 896.578254 seconds (592.03 M allocations: 282.543 GiB, 6.22% gc time, 0.01% compilation time)
