┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-12T15:41:58.198
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.450800361212                   -0.96    6.9    11.2s
  2   -8.452662490592       -2.73       -1.76    2.1    5.10s
  3   -8.452722441464       -4.22       -2.80    3.7    2.27s
  4   -8.452723242261       -6.10       -3.84    4.4    1.84s
  5   -8.452723251622       -8.03       -4.48    4.3    2.26s
  6   -8.452723252063       -9.36       -5.51    4.3    2.19s
  7   -8.452723252069      -11.23       -6.22    4.2    2.08s
  8   -8.452723252069      -12.85       -7.63    3.7    2.01s
Iter     Function value   Gradient norm 
     0    -8.452723e+00     2.675166e-03
 * time: 3.790855407714844e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.450807788730                   -0.96    7.3    2.63s
  2   -8.452668603980       -2.73       -1.76    2.1    1.44s
  3   -8.452729254453       -4.22       -2.80    3.9    1.67s
  4   -8.452730152325       -6.05       -3.83    4.4    2.04s
  5   -8.452730161025       -8.06       -4.47    4.5    1.77s
  6   -8.452730161452       -9.37       -5.50    4.3    1.87s
  7   -8.452730161457      -11.24       -6.14    4.3    1.69s
  8   -8.452730161458      -12.75       -7.60    3.7    1.80s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.450804341476                   -0.96    7.2    2.56s
  2   -8.452669600898       -2.73       -1.76    2.0    1.43s
  3   -8.452729373077       -4.22       -2.80    3.8    1.67s
  4   -8.452730152391       -6.11       -3.84    4.4    2.07s
  5   -8.452730161022       -8.06       -4.47    4.5    1.85s
  6   -8.452730161452       -9.37       -5.50    4.2    1.91s
  7   -8.452730161457      -11.23       -6.19    4.4    1.72s
  8   -8.452730161458      -12.78       -7.67    3.7    1.80s
     1    -8.452730e+00     2.490335e-03
 * time: 42.23900890350342
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.450777394464                   -0.96    7.0    2.63s
  2   -8.452707727869       -2.71       -1.76    2.1    1.21s
  3   -8.452773690088       -4.18       -2.79    3.8    1.96s
  4   -8.452774454942       -6.12       -3.83    4.3    1.75s
  5   -8.452774463747       -8.06       -4.50    4.6    2.10s
  6   -8.452774464106       -9.45       -5.49    4.5    1.61s
  7   -8.452774464111      -11.28       -6.19    4.2    1.96s
  8   -8.452774464111      -12.86       -7.58    3.6    1.49s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.450779772086                   -0.96    7.1    2.49s
  2   -8.452709867959       -2.71       -1.76    2.2    1.17s
  3   -8.452773793582       -4.19       -2.79    3.8    1.96s
  4   -8.452774454730       -6.18       -3.85    4.3    1.73s
  5   -8.452774463724       -8.05       -4.49    4.5    2.08s
  6   -8.452774464105       -9.42       -5.48    4.6    1.60s
  7   -8.452774464111      -11.26       -6.20    4.1    1.92s
  8   -8.452774464111      -12.78       -7.66    3.8    1.50s
     2    -8.452774e+00     4.661040e-05
 * time: 83.63757109642029
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.450784781346                   -0.96    7.2    2.53s
  2   -8.452707649886       -2.72       -1.76    2.2    1.47s
  3   -8.452773736162       -4.18       -2.79    3.9    1.66s
  4   -8.452774470440       -6.13       -3.85    4.4    2.07s
  5   -8.452774478849       -8.08       -4.47    4.5    1.78s
  6   -8.452774479276       -9.37       -5.46    4.6    1.91s
  7   -8.452774479282      -11.19       -6.17    4.0    1.67s
  8   -8.452774479282      -12.75       -7.62    3.8    1.80s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.450779373452                   -0.96    7.2    2.49s
  2   -8.452713652539       -2.71       -1.76    2.3    1.51s
  3   -8.452773786166       -4.22       -2.79    3.9    1.67s
  4   -8.452774470268       -6.16       -3.83    4.4    2.06s
  5   -8.452774478949       -8.06       -4.52    4.5    1.76s
  6   -8.452774479278       -9.48       -5.55    4.7    1.92s
  7   -8.452774479282      -11.33       -6.22    4.3    1.72s
  8   -8.452774479282      -12.92       -7.57    3.7    1.80s
     3    -8.452774e+00     7.900564e-07
 * time: 124.83297610282898
 * Status: success

 * Candidate solution
    Final objective value:     -8.452774e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 6.62e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 6.42e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.52e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.79e-09 ≰ 0.0e+00
    |g(x)|                 = 7.90e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   125  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 200.011141 seconds (307.97 M allocations: 58.711 GiB, 7.83% gc time, 25.58% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-12T15:45:18.829
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.15578886571                   -1.17    8.4    19.5s
  2   -62.15970898873       -2.41       -1.23    2.7    7.94s
  3   -62.16386991545       -2.38       -2.07    4.0    10.3s
  4   -62.16389769174       -4.56       -2.85    3.7    10.0s
  5   -62.16389846822       -6.11       -3.59    3.9    10.3s
  6   -62.16389848421       -7.80       -4.44    4.1    10.5s
  7   -62.16389848443       -9.65       -5.12    4.0    11.1s
  8   -62.16389848444      -10.97       -6.58    4.0    11.3s
  9   -62.16389848444      -13.55       -7.63    4.4    11.9s
Iter     Function value   Gradient norm 
     0    -6.216390e+01     2.704173e-03
 * time: 4.291534423828125e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.15580144993                   -1.17    8.5    17.3s
  2   -62.15971413994       -2.41       -1.23    2.7    7.50s
  3   -62.16387779278       -2.38       -2.07    4.0    9.83s
  4   -62.16390493983       -4.57       -2.86    3.8    10.0s
  5   -62.16390571327       -6.11       -3.60    4.0    10.3s
  6   -62.16390572854       -7.82       -4.46    3.9    10.0s
  7   -62.16390572876       -9.66       -5.10    4.0    10.7s
  8   -62.16390572877      -10.90       -6.62    3.9    10.2s
  9   -62.16390572877   +  -13.55       -7.62    4.3    11.1s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.15580370586                   -1.17    8.6    17.3s
  2   -62.15971366498       -2.41       -1.23    2.7    7.57s
  3   -62.16387778776       -2.38       -2.07    4.0    10.1s
  4   -62.16390490466       -4.57       -2.85    3.8    10.0s
  5   -62.16390571318       -6.09       -3.60    4.0    10.2s
  6   -62.16390572852       -7.81       -4.47    3.9    10.0s
  7   -62.16390572876       -9.63       -5.15    4.0    10.7s
  8   -62.16390572877      -10.95       -6.50    3.9    10.2s
  9   -62.16390572877      -12.94       -7.61    4.3    11.0s
     1    -6.216391e+01     2.653698e-03
 * time: 229.20056986808777
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.15639457102                   -1.18    8.1    15.9s
  2   -62.16031499438       -2.41       -1.24    2.6    7.12s
  3   -62.16405997230       -2.43       -2.09    3.9    9.58s
  4   -62.16408371491       -4.62       -2.87    3.7    9.70s
  5   -62.16408437692       -6.18       -3.59    3.9    9.94s
  6   -62.16408439263       -7.80       -4.42    4.0    10.4s
  7   -62.16408439287       -9.62       -5.10    4.1    10.7s
  8   -62.16408439288      -10.94       -6.80    3.9    10.1s
  9   -62.16408439288      -13.11       -7.36    4.6    11.6s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.15640129943                   -1.18    8.2    16.3s
  2   -62.16031387484       -2.41       -1.24    2.5    7.09s
  3   -62.16405995641       -2.43       -2.09    3.9    9.68s
  4   -62.16408375836       -4.62       -2.88    3.8    9.85s
  5   -62.16408437738       -6.21       -3.59    3.9    10.6s
  6   -62.16408439265       -7.82       -4.43    4.0    11.1s
  7   -62.16408439287       -9.66       -5.10    4.0    12.5s
  8   -62.16408439288      -10.94       -6.75    3.9    10.4s
  9   -62.16408439288      -14.15       -7.47    4.5    12.4s
     2    -6.216408e+01     2.110083e-04
 * time: 457.4818260669708
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.15637282961                   -1.18    8.6    16.8s
  2   -62.16026548963       -2.41       -1.24    2.7    7.34s
  3   -62.16406128251       -2.42       -2.09    4.1    9.84s
  4   -62.16408487850       -4.63       -2.92    3.8    10.0s
  5   -62.16408540573       -6.28       -3.67    4.0    10.2s
  6   -62.16408541817       -7.91       -4.55    3.8    10.4s
  7   -62.16408541832       -9.82       -5.14    4.0    11.0s
  8   -62.16408541833      -10.97       -6.66    3.8    9.81s
  9   -62.16408541833   +  -13.45       -7.66    4.6    11.5s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.15637117635                   -1.18    8.6    17.5s
  2   -62.16027947909       -2.41       -1.24    2.7    7.51s
  3   -62.16406096891       -2.42       -2.09    4.0    10.3s
  4   -62.16408484183       -4.62       -2.90    3.9    10.6s
  5   -62.16408540445       -6.25       -3.63    4.0    10.2s
  6   -62.16408541814       -7.86       -4.49    4.0    10.1s
  7   -62.16408541832       -9.75       -5.10    4.1    11.0s
  8   -62.16408541833      -10.94       -6.67    3.9    10.0s
  9   -62.16408541833      -13.37       -7.61    4.6    12.0s
     3    -6.216409e+01     1.477048e-05
 * time: 685.3290479183197
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.15637003803                   -1.18    8.1    16.1s
  2   -62.16028568512       -2.41       -1.24    2.4    6.91s
  3   -62.16406096445       -2.42       -2.09    4.0    9.64s
  4   -62.16408484175       -4.62       -2.90    3.8    9.91s
  5   -62.16408540940       -6.25       -3.63    3.9    10.1s
  6   -62.16408542322       -7.86       -4.49    3.9    10.0s
  7   -62.16408542340       -9.75       -5.13    4.0    10.8s
  8   -62.16408542341      -11.01       -6.77    3.9    10.1s
  9   -62.16408542341   +  -13.45       -7.66    4.5    12.4s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.15637250411                   -1.18    8.1    16.7s
  2   -62.16027724972       -2.41       -1.24    2.6    7.47s
  3   -62.16406123022       -2.42       -2.09    3.9    9.82s
  4   -62.16408484212       -4.63       -2.90    3.9    9.80s
  5   -62.16408540989       -6.25       -3.64    4.0    10.4s
  6   -62.16408542323       -7.88       -4.51    3.9    9.85s
  7   -62.16408542340       -9.76       -5.12    4.0    10.3s
  8   -62.16408542341      -10.96       -6.68    3.9    10.0s
  9   -62.16408542341   +  -13.85       -7.66    4.5    11.2s
     4    -6.216409e+01     7.064837e-08
 * time: 909.6512248516083
 * Status: success

 * Candidate solution
    Final objective value:     -6.216409e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 6.85e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 6.46e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 5.08e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 8.17e-11 ≰ 0.0e+00
    |g(x)|                 = 7.06e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   910  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

NaCl: 1038.911398 seconds (1.01 G allocations: 290.257 GiB, 5.13% gc time, 0.35% compilation time)
┌ Info: 2025-05-12T16:02:37.768
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316028697598                   -1.46    5.5    2.00s
  2   -2.316117665533       -4.05       -1.84    1.4    948ms
  3   -2.316137563008       -4.70       -3.60    3.2    1.72s
  4   -2.316137754902       -6.72       -4.17    4.7    1.70s
  5   -2.316137755251       -9.46       -4.53    2.5    1.47s
  6   -2.316137755328      -10.11       -5.11    2.9    1.36s
  7   -2.316137755331      -11.51       -5.88    2.5    1.34s
  8   -2.316137755331      -13.12       -6.60    2.6    1.04s
  9   -2.316137755331      -14.51       -7.26    2.7    1.11s
Iter     Function value   Gradient norm 
     0    -2.316138e+00     1.045229e-03
 * time: 3.4809112548828125e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316033994832                   -1.46    5.5    1.75s
  2   -2.316118457375       -4.07       -1.84    1.4    1.04s
  3   -2.316138639803       -4.70       -3.58    3.3    1.28s
  4   -2.316138825069       -6.73       -4.12    4.5    1.89s
  5   -2.316138825497       -9.37       -4.50    2.5    1.05s
  6   -2.316138825586      -10.05       -5.08    2.7    1.32s
  7   -2.316138825590      -11.42       -5.87    2.4    991ms
  8   -2.316138825590      -13.08       -6.63    2.8    1.31s
  9   -2.316138825590      -14.51       -7.36    2.7    1.05s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316031822338                   -1.46    5.5    1.79s
  2   -2.316118284864       -4.06       -1.84    1.4    1.10s
  3   -2.316138624654       -4.69       -3.58    3.3    1.23s
  4   -2.316138825070       -6.70       -4.13    4.5    1.87s
  5   -2.316138825493       -9.37       -4.49    2.5    1.04s
  6   -2.316138825586      -10.03       -5.07    2.8    1.36s
  7   -2.316138825590      -11.42       -5.85    2.4    1.23s
  8   -2.316138825590      -13.07       -6.63    2.9    1.46s
  9   -2.316138825590      -14.51       -7.31    2.7    1.03s
     1    -2.316139e+00     1.002674e-03
 * time: 54.326300859451294
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316049481955                   -1.46    5.4    2.03s
  2   -2.316131928450       -4.08       -1.84    1.3    1.05s
  3   -2.316151032124       -4.72       -3.56    3.2    1.27s
  4   -2.316151284761       -6.60       -4.08    4.6    1.93s
  5   -2.316151285274       -9.29       -4.45    2.5    1.03s
  6   -2.316151285394       -9.92       -5.06    2.8    1.31s
  7   -2.316151285399      -11.32       -5.68    2.8    1.06s
  8   -2.316151285399      -12.80       -6.41    2.5    1.03s
  9   -2.316151285399      -13.94       -7.15    2.7    1.25s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316050468335                   -1.46    5.4    1.91s
  2   -2.316131769509       -4.09       -1.84    1.4    734ms
  3   -2.316151032740       -4.72       -3.56    3.3    1.47s
  4   -2.316151284758       -6.60       -4.07    4.6    1.59s
  5   -2.316151285278       -9.28       -4.45    2.5    1.23s
  6   -2.316151285394       -9.94       -5.06    2.8    1.06s
  7   -2.316151285399      -11.30       -5.69    2.7    1.32s
  8   -2.316151285399      -12.85       -6.40    2.6    1.03s
  9   -2.316151285399      -13.97       -7.08    2.9    1.10s
     2    -2.316151e+00     9.344157e-06
 * time: 106.73430681228638
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316048657093                   -1.46    5.4    2.02s
  2   -2.316131076232       -4.08       -1.84    1.4    755ms
  3   -2.316151044686       -4.70       -3.55    3.2    1.54s
  4   -2.316151285807       -6.62       -4.06    4.5    1.61s
  5   -2.316151286355       -9.26       -4.46    2.5    1.31s
  6   -2.316151286468       -9.95       -5.06    2.8    1.11s
  7   -2.316151286472      -11.34       -5.71    2.7    1.52s
  8   -2.316151286472      -12.91       -6.49    2.7    1.08s
  9   -2.316151286472      -14.10       -7.20    2.8    1.11s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316052176523                   -1.46    5.4    1.89s
  2   -2.316131865833       -4.10       -1.84    1.4    734ms
  3   -2.316151058897       -4.72       -3.56    3.3    1.48s
  4   -2.316151285851       -6.64       -4.08    4.5    1.56s
  5   -2.316151286360       -9.29       -4.47    2.5    1.27s
  6   -2.316151286468       -9.97       -5.06    2.8    1.08s
  7   -2.316151286472      -11.36       -5.71    2.7    1.28s
  8   -2.316151286472      -12.92       -6.46    2.6   1000ms
  9   -2.316151286472      -14.12       -7.11    2.9    1.34s
     3    -2.316151e+00     7.834829e-08
 * time: 159.6233069896698
 * Status: success

 * Candidate solution
    Final objective value:     -2.316151e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.32e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.04e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.07e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 4.63e-10 ≰ 0.0e+00
    |g(x)|                 = 7.83e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   160  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Al: 192.230702 seconds (157.95 M allocations: 37.498 GiB, 6.31% gc time, 0.00% compilation time)
┌ Info: 2025-05-12T16:05:50
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73890974897                   -0.86    9.6    9.25s
  2   -73.75101730891       -1.92       -1.06    5.3    5.54s
  3   -73.75768707437       -2.18       -1.40    6.7    6.94s
  4   -73.75883131377       -2.94       -1.77    5.8    5.86s
  5   -73.75898973392       -3.80       -2.25    4.9    5.71s
  6   -73.75900965738       -4.70       -3.08    5.6    5.86s
  7   -73.75900967548       -7.74       -3.54    4.6    5.22s
  8   -73.75900968265       -8.14       -4.12    5.0    5.47s
  9   -73.75900968196   +   -9.16       -4.46    5.6    5.95s
 10   -73.75900968283       -9.06       -4.79    5.7    5.72s
 11   -73.75900968284      -10.82       -5.67    3.7    4.48s
 12   -73.75900968284      -13.00       -6.34    4.7    5.36s
 13   -73.75900968284      -12.85       -6.52    4.3    4.79s
 14   -73.75900968284   +  -12.70       -6.90    5.2    5.18s
 15   -73.75900968284   +  -13.07       -7.79    4.7    5.19s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.375901e+01     1.068213e-02
 * time: 3.0994415283203125e-5
┌ Warning: Negative ρcore detected: -3.377435237957783e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73928369164                   -0.86    9.7    9.41s
  2   -73.75113353972       -1.93       -1.06    5.4    5.45s
  3   -73.75780756361       -2.18       -1.40    6.7    6.90s
  4   -73.75893341461       -2.95       -1.77    5.9    5.81s
  5   -73.75909464594       -3.79       -2.24    5.0    5.55s
  6   -73.75911525040       -4.69       -3.08    5.5    5.93s
  7   -73.75911526800       -7.75       -3.51    4.6    5.24s
  8   -73.75911527289       -8.31       -4.09    4.7    5.17s
  9   -73.75911527246   +   -9.36       -4.43    5.4    5.78s
 10   -73.75911527309       -9.20       -4.76    5.6    5.66s
 11   -73.75911527311      -10.69       -5.60    4.5    5.07s
 12   -73.75911527312      -11.64       -6.27    4.7    5.44s
 13   -73.75911527312   +  -12.85       -6.53    4.0    4.73s
 14   -73.75911527312      -12.70       -6.88    5.2    5.25s
 15   -73.75911527312      -12.94       -7.77    4.8    5.21s
┌ Warning: Negative ρcore detected: -3.377435237957783e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73928026834                   -0.86    9.7    9.37s
  2   -73.75113990169       -1.93       -1.06    5.2    5.63s
  3   -73.75780656784       -2.18       -1.40    6.8    7.03s
  4   -73.75893395656       -2.95       -1.77    5.9    6.23s
  5   -73.75909474867       -3.79       -2.24    5.0    5.70s
  6   -73.75911525107       -4.69       -3.08    5.5    5.97s
  7   -73.75911526795       -7.77       -3.51    4.7    5.64s
  8   -73.75911527288       -8.31       -4.09    4.7    5.33s
  9   -73.75911527241   +   -9.33       -4.41    5.5    5.91s
 10   -73.75911527310       -9.16       -4.76    5.7    5.81s
 11   -73.75911527311      -10.74       -5.60    4.4    5.12s
 12   -73.75911527312      -11.68       -6.30    4.8    5.49s
 13   -73.75911527312   +  -13.85       -6.56    3.4    4.45s
 14   -73.75911527312      -12.73       -6.91    5.3    6.20s
 15   -73.75911527312      -12.94       -7.75    4.9    5.44s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.377435237957783e-8,-5.8859395526124154e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.375912e+01     9.083593e-03
 * time: 235.6095700263977
┌ Warning: Negative ρcore detected: -3.112852659399205e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.74091576541                   -0.86    9.8    9.19s
  2   -73.75183628682       -1.96       -1.07    5.3    5.79s
  3   -73.75811010216       -2.20       -1.40    6.8    7.13s
  4   -73.75922410642       -2.95       -1.79    5.9    5.89s
  5   -73.75936359256       -3.86       -2.30    5.1    5.53s
  6   -73.75937936486       -4.80       -3.09    5.6    6.07s
  7   -73.75937940385       -7.41       -3.58    4.5    5.33s
  8   -73.75937941563       -7.93       -4.06    5.3    5.69s
  9   -73.75937941486   +   -9.12       -4.45    5.4    5.90s
 10   -73.75937941597       -8.96       -4.80    5.5    5.88s
 11   -73.75937941602      -10.32       -5.45    5.0    5.55s
 12   -73.75937941602      -11.47       -6.17    4.9    5.59s
 13   -73.75937941602      -12.85       -6.38    3.9    4.82s
 14   -73.75937941602   +  -12.81       -6.97    5.1    5.39s
 15   -73.75937941602   +  -12.85       -7.85    5.1    5.45s
┌ Warning: Negative ρcore detected: -3.112852659399205e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.74091707923                   -0.86    9.8    9.52s
  2   -73.75183351400       -1.96       -1.07    5.3    5.62s
  3   -73.75810887974       -2.20       -1.40    6.8    7.30s
  4   -73.75922422109       -2.95       -1.79    5.8    5.93s
  5   -73.75936367888       -3.86       -2.30    5.0    5.61s
  6   -73.75937936085       -4.80       -3.09    5.7    6.12s
  7   -73.75937940433       -7.36       -3.57    4.6    5.44s
  8   -73.75937941565       -7.95       -4.05    5.4    5.71s
  9   -73.75937941498   +   -9.18       -4.47    5.5    5.92s
 10   -73.75937941597       -9.01       -4.80    5.4    6.04s
 11   -73.75937941602      -10.31       -5.46    5.1    5.70s
 12   -73.75937941602      -11.52       -6.17    4.8    5.40s
 13   -73.75937941602      -12.77       -6.37    4.0    4.83s
 14   -73.75937941602   +  -12.73       -6.98    5.1    5.33s
 15   -73.75937941602   +  -13.37       -7.92    5.1    5.49s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.112852659399205e-8,1.5736746859871892e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.375938e+01     5.255817e-04
 * time: 474.71332597732544
┌ Warning: Negative ρcore detected: -3.058665257405955e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.74084062403                   -0.86    9.7    9.15s
  2   -73.75179886806       -1.96       -1.06    5.4    5.82s
  3   -73.75810749381       -2.20       -1.40    6.8    7.07s
  4   -73.75922348945       -2.95       -1.79    5.9    6.00s
  5   -73.75936372626       -3.85       -2.29    4.9    5.40s
  6   -73.75938019642       -4.78       -3.09    5.6    6.11s
  7   -73.75938024203       -7.34       -3.57    4.7    5.89s
  8   -73.75938025111       -8.04       -4.04    5.3    5.64s
  9   -73.75938025050   +   -9.22       -4.49    5.5    6.08s
 10   -73.75938025138       -9.06       -4.79    5.7    5.94s
 11   -73.75938025143      -10.31       -5.47    5.1    5.58s
 12   -73.75938025143      -11.55       -6.20    4.8    5.43s
 13   -73.75938025143      -12.89       -6.40    3.9    4.79s
 14   -73.75938025143   +  -12.85       -7.00    5.2    5.32s
┌ Warning: Negative ρcore detected: -3.058665257405955e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.74083231938                   -0.86    9.7    9.47s
  2   -73.75181146947       -1.96       -1.07    5.4    5.51s
  3   -73.75810694237       -2.20       -1.40    6.8    7.18s
  4   -73.75922340952       -2.95       -1.79    5.8    5.91s
  5   -73.75936342292       -3.85       -2.28    5.0    5.54s
  6   -73.75938020035       -4.78       -3.09    5.6    6.18s
  7   -73.75938023905       -7.41       -3.57    4.5    5.64s
  8   -73.75938025096       -7.92       -4.05    5.3    5.95s
  9   -73.75938025035   +   -9.21       -4.47    5.5    5.98s
 10   -73.75938025138       -8.99       -4.79    5.6    6.19s
 11   -73.75938025143      -10.33       -5.44    5.1    5.57s
 12   -73.75938025143      -11.44       -6.16    4.9    5.48s
 13   -73.75938025143      -12.81       -6.38    3.9    4.86s
 14   -73.75938025143   +  -12.73       -6.98    5.1    5.65s
 15   -73.75938025143   +  -12.85       -7.84    5.1    5.50s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.058665257405955e-8,1.689846282271154e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.375938e+01     2.198266e-05
 * time: 711.4831390380859
┌ Warning: Negative ρcore detected: -3.0609145921177456e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.74083660056                   -0.86    9.7    9.37s
  2   -73.75181796361       -1.96       -1.07    5.4    6.29s
  3   -73.75810618618       -2.20       -1.40    6.8    6.99s
  4   -73.75922373632       -2.95       -1.79    5.8    5.99s
  5   -73.75936361521       -3.85       -2.29    5.0    5.48s
  6   -73.75938019593       -4.78       -3.09    5.6    6.28s
  7   -73.75938024274       -7.33       -3.57    4.8    5.49s
  8   -73.75938025257       -8.01       -4.05    5.3    5.70s
  9   -73.75938025187   +   -9.15       -4.47    5.6    5.83s
 10   -73.75938025285       -9.01       -4.80    5.6    5.80s
 11   -73.75938025290      -10.34       -5.47    5.0    5.43s
 12   -73.75938025290      -11.56       -6.19    4.8    5.30s
 13   -73.75938025290      -12.73       -6.40    4.1    4.89s
 14   -73.75938025290   +  -12.77       -7.00    5.2    5.56s
 15   -73.75938025290   +  -13.15       -7.88    5.1    5.68s
┌ Warning: Negative ρcore detected: -3.0609145921177456e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.74084204141                   -0.86    9.7    9.45s
  2   -73.75180344035       -1.96       -1.06    5.3    5.43s
  3   -73.75810616726       -2.20       -1.40    6.9    7.37s
  4   -73.75922436510       -2.95       -1.79    5.9    6.03s
  5   -73.75936387182       -3.86       -2.29    4.9    5.53s
  6   -73.75938020211       -4.79       -3.09    5.5    6.07s
  7   -73.75938024142       -7.41       -3.57    4.5    5.35s
  8   -73.75938025246       -7.96       -4.04    5.3    5.78s
  9   -73.75938025184   +   -9.21       -4.47    5.4    6.10s
 10   -73.75938025285       -9.00       -4.79    5.6    5.74s
 11   -73.75938025290      -10.34       -5.44    4.9    5.44s
 12   -73.75938025290      -11.42       -6.17    4.8    5.37s
 13   -73.75938025290      -12.59       -6.39    4.1    4.91s
 14   -73.75938025290   +  -12.70       -6.96    5.2    5.45s
 15   -73.75938025290   +  -13.07       -7.82    5.1    5.56s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0609145921177456e-8,1.6852646874343596e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     4    -7.375938e+01     4.616378e-08
 * time: 953.4101090431213
 * Status: success

 * Candidate solution
    Final objective value:     -7.375938e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.33e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.37e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.47e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.99e-11 ≰ 0.0e+00
    |g(x)|                 = 4.62e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   953  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

V: 1081.417113 seconds (754.16 M allocations: 360.988 GiB, 6.01% gc time, 0.01% compilation time)
