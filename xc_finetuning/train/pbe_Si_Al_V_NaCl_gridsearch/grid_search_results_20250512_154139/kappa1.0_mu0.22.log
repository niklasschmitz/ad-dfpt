┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-12T17:39:38.955
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.462401144746                   -0.96    6.9    12.2s
  2   -8.464084651509       -2.77       -1.73    1.8    4.88s
  3   -8.464158141470       -4.13       -2.76    3.7    2.00s
  4   -8.464159829970       -5.77       -3.71    4.6    1.80s
  5   -8.464159873514       -7.36       -4.40    4.8    2.13s
  6   -8.464159875227       -8.77       -5.35    4.9    1.73s
  7   -8.464159875244      -10.77       -6.12    4.2    2.45s
  8   -8.464159875244      -12.67       -7.28    3.8    1.91s
Iter     Function value   Gradient norm 
     0    -8.464160e+00     1.804848e-04
 * time: 3.981590270996094e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.462411536899                   -0.96    6.9    2.48s
  2   -8.464085837269       -2.78       -1.73    1.9    1.08s
  3   -8.464158100955       -4.14       -2.76    3.9    1.94s
  4   -8.464159863714       -5.75       -3.69    4.6    2.02s
  5   -8.464159905059       -7.38       -4.44    5.0    1.80s
  6   -8.464159906681       -8.79       -5.39    5.1    2.04s
  7   -8.464159906696      -10.82       -6.15    4.2    1.69s
  8   -8.464159906697      -12.65       -7.23    3.7    1.80s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.462421248277                   -0.96    7.1    2.97s
  2   -8.464088745683       -2.78       -1.73    1.8    1.51s
  3   -8.464158039399       -4.16       -2.76    3.8    1.77s
  4   -8.464159864111       -5.74       -3.69    4.5    2.63s
  5   -8.464159905156       -7.39       -4.46    4.8    1.91s
  6   -8.464159906683       -8.82       -5.42    4.9    2.00s
  7   -8.464159906696      -10.86       -6.21    4.2    1.68s
  8   -8.464159906697      -12.73       -7.18    4.1    1.86s
     1    -8.464160e+00     1.680385e-04
 * time: 45.277721881866455
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.462401935359                   -0.96    7.3    2.62s
  2   -8.464088038724       -2.77       -1.73    2.1    1.19s
  3   -8.464158289448       -4.15       -2.76    3.9    2.06s
  4   -8.464160069823       -5.75       -3.68    4.7    2.33s
  5   -8.464160109840       -7.40       -4.47    4.8    1.82s
  6   -8.464160111320       -8.83       -5.45    5.0    2.14s
  7   -8.464160111332      -10.93       -6.28    4.4    1.79s
  8   -8.464160111332      -12.85       -7.20    4.2    1.96s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.462408476630                   -0.96    7.2    2.61s
  2   -8.464093638938       -2.77       -1.73    2.2    1.47s
  3   -8.464158373718       -4.19       -2.76    3.7    1.64s
  4   -8.464160071072       -5.77       -3.68    4.6    2.06s
  5   -8.464160109943       -7.41       -4.47    4.8    1.82s
  6   -8.464160111320       -8.86       -5.46    5.0    2.07s
  7   -8.464160111332      -10.91       -6.22    4.5    1.83s
  8   -8.464160111332      -12.76       -7.22    4.0    1.90s
     2    -8.464160e+00     1.558887e-07
 * time: 88.5180869102478
 * Status: success

 * Candidate solution
    Final objective value:     -8.464160e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.44e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.36e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.05e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.42e-08 ≰ 0.0e+00
    |g(x)|                 = 1.56e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   89  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Si: 166.924362 seconds (250.24 M allocations: 44.240 GiB, 7.04% gc time, 32.60% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-12T17:42:26.559
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26317775785                   -1.14    8.5    21.2s
  2   -62.26837763457       -2.28       -1.21    2.7    9.27s
  3   -62.27272436127       -2.36       -2.04    3.9    9.57s
  4   -62.27276299419       -4.41       -2.88    3.3    9.34s
  5   -62.27276343586       -6.35       -3.48    3.9    11.2s
  6   -62.27276351292       -7.11       -4.11    3.8    11.2s
  7   -62.27276351468       -8.75       -4.75    3.8    11.6s
  8   -62.27276351479       -9.98       -6.33    3.9    10.2s
  9   -62.27276351479      -12.33       -7.08    4.4    15.1s
Iter     Function value   Gradient norm 
     0    -6.227276e+01     2.681961e-03
 * time: 4.00543212890625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26318065609                   -1.14    9.4    17.9s
  2   -62.26834408787       -2.29       -1.21    2.9    7.57s
  3   -62.27273232600       -2.36       -2.04    3.9    9.47s
  4   -62.27277015737       -4.42       -2.91    3.3    8.33s
  5   -62.27277056400       -6.39       -3.55    4.1    10.1s
  6   -62.27277063225       -7.17       -4.16    3.8    10.1s
  7   -62.27277063363       -8.86       -4.77    4.0    10.0s
  8   -62.27277063371      -10.06       -6.41    3.9    11.4s
  9   -62.27277063371      -12.31       -7.06    4.5    11.8s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26318237936                   -1.14    9.2    18.3s
  2   -62.26836889052       -2.29       -1.21    2.8    7.85s
  3   -62.27273167850       -2.36       -2.04    3.9    10.4s
  4   -62.27277013270       -4.42       -2.89    3.5    10.2s
  5   -62.27277055780       -6.37       -3.51    4.1    10.7s
  6   -62.27277063214       -7.13       -4.14    3.8    11.1s
  7   -62.27277063363       -8.83       -4.79    3.9    11.0s
  8   -62.27277063371      -10.09       -6.39    3.9    10.3s
  9   -62.27277063371      -12.40       -7.07    4.4    12.5s
     1    -6.227277e+01     2.626901e-03
 * time: 236.55783009529114
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26284977321                   -1.13    8.4    17.0s
  2   -62.26807341628       -2.28       -1.19    2.6    7.82s
  3   -62.27290232236       -2.32       -2.02    3.7    9.33s
  4   -62.27294519664       -4.37       -2.93    3.2    9.02s
  5   -62.27294562536       -6.37       -3.59    4.0    11.5s
  6   -62.27294569253       -7.17       -4.20    3.6    9.73s
  7   -62.27294569366       -8.95       -4.78    3.9    10.8s
  8   -62.27294569373      -10.12       -6.31    3.7    10.6s
  9   -62.27294569374      -12.29       -7.07    4.2    11.5s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26285037797                   -1.13    8.4    17.5s
  2   -62.26809235487       -2.28       -1.19    2.6    7.58s
  3   -62.27290112653       -2.32       -2.02    3.9    9.66s
  4   -62.27294511403       -4.36       -2.88    3.1    8.66s
  5   -62.27294561392       -6.30       -3.50    3.9    10.3s
  6   -62.27294569181       -7.11       -4.11    3.7    10.3s
  7   -62.27294569361       -8.74       -4.75    3.8    10.1s
  8   -62.27294569373       -9.92       -6.25    3.7    11.0s
  9   -62.27294569374      -12.11       -7.07    4.2    11.2s
     2    -6.227295e+01     1.607787e-04
 * time: 467.2528669834137
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26281830583                   -1.13    8.4    17.2s
  2   -62.26804442518       -2.28       -1.19    2.7    7.29s
  3   -62.27290205127       -2.31       -2.02    3.8    9.88s
  4   -62.27294587342       -4.36       -2.89    3.1    10.4s
  5   -62.27294632849       -6.34       -3.51    3.9    11.3s
  6   -62.27294640504       -7.12       -4.12    3.6    9.79s
  7   -62.27294640669       -8.78       -4.76    3.8    12.4s
  8   -62.27294640679      -10.02       -6.18    3.8    10.4s
  9   -62.27294640679      -12.12       -6.75    4.2    11.2s
 10   -62.27294640679      -13.11       -7.99    4.0    10.7s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26281702751                   -1.13    8.3    17.7s
  2   -62.26804472167       -2.28       -1.19    2.6    7.35s
  3   -62.27290216830       -2.31       -2.02    3.6    9.84s
  4   -62.27294587921       -4.36       -2.89    3.2    8.73s
  5   -62.27294632973       -6.35       -3.52    4.0    10.6s
  6   -62.27294640533       -7.12       -4.16    3.6    10.3s
  7   -62.27294640672       -8.86       -4.82    3.9    10.4s
  8   -62.27294640679      -10.18       -6.31    3.8    11.8s
  9   -62.27294640679      -12.29       -7.02    4.2    12.1s
     3    -6.227295e+01     1.048009e-05
 * time: 714.3407781124115
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26281611651                   -1.13    8.2    18.0s
  2   -62.26805136354       -2.28       -1.19    2.5    7.69s
  3   -62.27290157159       -2.31       -2.02    3.6    9.61s
  4   -62.27294584186       -4.35       -2.88    3.1    9.54s
  5   -62.27294632783       -6.31       -3.49    4.0    12.3s
  6   -62.27294640783       -7.10       -4.09    3.6    10.6s
  7   -62.27294640969       -8.73       -4.73    3.8    10.1s
  8   -62.27294640982       -9.90       -6.18    3.8    10.6s
  9   -62.27294640982      -12.10       -6.89    4.2    11.9s
 10   -62.27294640982      -13.85       -7.75    3.9    10.1s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26281537480                   -1.13    8.2    17.8s
  2   -62.26805822605       -2.28       -1.19    2.5    7.25s
  3   -62.27290185722       -2.31       -2.02    3.6    9.39s
  4   -62.27294590300       -4.36       -2.90    3.2    9.01s
  5   -62.27294633146       -6.37       -3.51    3.9    11.7s
  6   -62.27294640825       -7.11       -4.13    3.8    12.5s
  7   -62.27294640973       -8.83       -4.77    3.9    12.4s
  8   -62.27294640982      -10.06       -6.34    3.9    10.1s
  9   -62.27294640982      -12.36       -7.05    4.4    11.7s
     4    -6.227295e+01     3.089977e-08
 * time: 964.0608580112457
 * Status: success

 * Candidate solution
    Final objective value:     -6.227295e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 5.82e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 5.34e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 3.03e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 4.87e-11 ≰ 0.0e+00
    |g(x)|                 = 3.09e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   964  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

NaCl: 1100.356379 seconds (1.04 G allocations: 299.059 GiB, 5.27% gc time, 0.33% compilation time)
┌ Info: 2025-05-12T18:00:46.948
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317408544943                   -1.47    5.5    2.00s
  2   -2.317484767704       -4.12       -1.84    1.3    1.15s
  3   -2.317501593414       -4.77       -3.57    3.2    1.35s
  4   -2.317501822853       -6.64       -4.06    4.6    2.15s
  5   -2.317501823340       -9.31       -4.33    2.4    1.09s
  6   -2.317501823489       -9.83       -5.01    2.7    1.46s
  7   -2.317501823494      -11.34       -5.76    2.5    1.23s
  8   -2.317501823494      -12.76       -6.55    2.6    1.20s
  9   -2.317501823494      -14.21       -7.00    3.1    1.89s
 10   -2.317501823494      -15.05       -7.57    2.2    1.18s
Iter     Function value   Gradient norm 
     0    -2.317502e+00     2.565328e-04
 * time: 4.291534423828125e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317410651389                   -1.47    5.4    1.86s
  2   -2.317484527626       -4.13       -1.84    1.3    1.28s
  3   -2.317501647419       -4.77       -3.56    3.2    1.40s
  4   -2.317501887226       -6.62       -4.02    4.5    2.10s
  5   -2.317501887788       -9.25       -4.31    2.2    1.04s
  6   -2.317501887957       -9.77       -4.97    2.6    1.45s
  7   -2.317501887962      -11.27       -5.74    2.4    1.08s
  8   -2.317501887962      -12.65       -6.60    2.7    1.48s
  9   -2.317501887962      -14.21       -7.05    3.2    1.33s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317407153788                   -1.47    5.3    2.06s
  2   -2.317485022293       -4.11       -1.84    1.3    790ms
  3   -2.317501648085       -4.78       -3.58    3.1    1.56s
  4   -2.317501887290       -6.62       -4.05    4.5    1.72s
  5   -2.317501887801       -9.29       -4.33    2.3    1.35s
  6   -2.317501887958       -9.80       -5.00    2.7    1.15s
  7   -2.317501887962      -11.36       -5.75    2.4    1.39s
  8   -2.317501887962      -12.70       -6.58    2.7    1.17s
  9   -2.317501887962      -14.40       -7.01    3.0    1.30s
     1    -2.317502e+00     2.460773e-04
 * time: 57.127047061920166
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317409036887                   -1.46    5.5    2.26s
  2   -2.317486069971       -4.11       -1.84    1.3    833ms
  3   -2.317502447574       -4.79       -3.58    3.2    1.83s
  4   -2.317502633366       -6.73       -4.04    4.7    1.79s
  5   -2.317502633910       -9.26       -4.31    2.4    1.50s
  6   -2.317502634080       -9.77       -4.98    2.8    1.20s
  7   -2.317502634085      -11.33       -5.66    2.5    1.45s
  8   -2.317502634085      -12.59       -6.20    2.7    1.22s
  9   -2.317502634085      -13.99       -6.79    2.2    1.02s
 10   -2.317502634085   +  -15.05       -7.47    2.4    1.37s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317410726318                   -1.46    5.6    2.12s
  2   -2.317485558213       -4.13       -1.84    1.4    803ms
  3   -2.317502419838       -4.77       -3.56    3.3    1.63s
  4   -2.317502633315       -6.67       -4.02    4.6    1.71s
  5   -2.317502633895       -9.24       -4.29    2.3    1.33s
  6   -2.317502634080       -9.73       -4.96    2.7    1.09s
  7   -2.317502634085      -11.28       -5.67    2.5    1.39s
  8   -2.317502634085      -12.51       -6.41    2.7    1.13s
  9   -2.317502634085      -14.15       -6.86    2.6    1.14s
 10   -2.317502634085      -14.88       -7.43    2.0    1.24s
     2    -2.317503e+00     1.519283e-06
 * time: 117.0978090763092
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317410634659                   -1.46    5.5    2.27s
  2   -2.317486134712       -4.12       -1.84    1.4    828ms
  3   -2.317502404760       -4.79       -3.58    3.2    1.65s
  4   -2.317502633337       -6.64       -4.02    4.5    1.74s
  5   -2.317502633922       -9.23       -4.29    2.3    1.38s
  6   -2.317502634109       -9.73       -4.96    2.7    1.26s
  7   -2.317502634114      -11.28       -5.66    2.4    1.74s
  8   -2.317502634114      -12.54       -6.48    2.8    1.39s
  9   -2.317502634114      -14.05       -6.75    2.8    1.42s
 10   -2.317502634114   +  -14.75       -7.23    2.1    1.73s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317409446921                   -1.46    5.6    2.18s
  2   -2.317485758269       -4.12       -1.84    1.4    835ms
  3   -2.317502405804       -4.78       -3.58    3.3    1.68s
  4   -2.317502633374       -6.64       -4.03    4.7    1.80s
  5   -2.317502633929       -9.26       -4.30    2.3    1.50s
  6   -2.317502634108       -9.74       -4.97    2.8    1.16s
  7   -2.317502634114      -11.28       -5.65    2.4    1.41s
  8   -2.317502634114      -12.59       -6.42    2.7    1.29s
  9   -2.317502634114      -14.15       -6.74    2.8    1.38s
 10   -2.317502634114      -14.88       -7.26    2.2    1.66s
     3    -2.317503e+00     4.667436e-09
 * time: 177.8553318977356
 * Status: success

 * Candidate solution
    Final objective value:     -2.317503e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.75e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.91e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.87e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.24e-11 ≰ 0.0e+00
    |g(x)|                 = 4.67e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   178  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Al: 214.565958 seconds (164.64 M allocations: 39.254 GiB, 6.63% gc time, 0.00% compilation time)
┌ Info: 2025-05-12T18:04:21.515
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80128399280                   -0.90    9.5    10.7s
  2   -73.81075720308       -2.02       -1.10    5.3    6.00s
  3   -73.81647941109       -2.24       -1.45    6.8    9.20s
  4   -73.81733746950       -3.07       -1.79    5.7    7.18s
  5   -73.81747934993       -3.85       -2.22    5.0    5.75s
  6   -73.81750180855       -4.65       -3.06    5.4    6.57s
  7   -73.81750183473       -7.58       -3.49    5.2    6.27s
  8   -73.81750183819       -8.46       -4.06    3.4    4.71s
  9   -73.81750183830       -9.95       -4.45    5.2    5.91s
 10   -73.81750183850       -9.70       -4.80    4.8    5.19s
 11   -73.81750183852      -10.64       -5.58    4.5    5.70s
 12   -73.81750183852      -12.25       -6.31    4.6    6.02s
 13   -73.81750183852   +  -13.25       -6.56    5.1    6.23s
 14   -73.81750183852      -13.37       -6.85    5.1    6.49s
 15   -73.81750183852   +  -12.62       -7.88    4.8    6.14s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.381750e+01     2.401459e-03
 * time: 3.3855438232421875e-5
┌ Warning: Negative ρcore detected: -3.410994446751132e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80133296178                   -0.90    9.7    11.2s
  2   -73.81078204122       -2.02       -1.10    5.3    5.83s
  3   -73.81648400053       -2.24       -1.45    6.8    8.04s
  4   -73.81734332780       -3.07       -1.79    5.7    5.93s
  5   -73.81748491233       -3.85       -2.22    5.0    5.58s
  6   -73.81750713342       -4.65       -3.06    5.6    6.44s
  7   -73.81750715898       -7.59       -3.49    5.2    6.05s
  8   -73.81750716226       -8.48       -4.06    3.3    4.46s
  9   -73.81750716226      -11.39       -4.43    5.3    6.49s
 10   -73.81750716252       -9.58       -4.79    4.7    5.81s
 11   -73.81750716254      -10.68       -5.56    4.6    5.31s
 12   -73.81750716255      -11.40       -6.27    4.6    5.51s
 13   -73.81750716255      -12.43       -6.57    5.1    6.02s
 14   -73.81750716255      -12.34       -6.82    5.1    6.54s
 15   -73.81750716255      -12.55       -7.82    4.9    6.04s
┌ Warning: Negative ρcore detected: -3.410994446751132e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80133062829                   -0.90    9.7    11.1s
  2   -73.81078857170       -2.02       -1.10    5.3    5.74s
  3   -73.81648401582       -2.24       -1.45    6.7    7.17s
  4   -73.81734293304       -3.07       -1.79    5.7    6.65s
  5   -73.81748465669       -3.85       -2.22    4.9    5.51s
  6   -73.81750713501       -4.65       -3.06    5.5    6.93s
  7   -73.81750715909       -7.62       -3.48    5.1    5.82s
  8   -73.81750716227       -8.50       -4.05    3.2    4.28s
  9   -73.81750716231      -10.45       -4.43    5.1    5.81s
 10   -73.81750716252       -9.67       -4.79    4.7    5.22s
 11   -73.81750716254      -10.68       -5.55    4.5    5.18s
 12   -73.81750716255      -11.42       -6.26    4.6    5.76s
 13   -73.81750716255      -12.37       -6.58    5.1    5.93s
 14   -73.81750716255      -12.38       -6.81    5.1    6.02s
 15   -73.81750716255      -12.70       -7.78    5.0    5.82s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.410994446751132e-8,-2.25475089783987e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.381751e+01     2.038124e-03
 * time: 253.76694798469543
┌ Warning: Negative ρcore detected: -3.3407355006201664e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80158927481                   -0.90    9.6    9.46s
  2   -73.81086190286       -2.03       -1.10    5.2    5.48s
  3   -73.81650393403       -2.25       -1.45    6.7    7.03s
  4   -73.81736069724       -3.07       -1.80    5.7    6.04s
  5   -73.81749922567       -3.86       -2.23    4.9    5.55s
  6   -73.81752074883       -4.67       -3.07    5.4    6.13s
  7   -73.81752077152       -7.64       -3.49    5.0    5.86s
  8   -73.81752077509       -8.45       -4.04    3.4    4.81s
  9   -73.81752077526       -9.78       -4.45    5.2    5.97s
 10   -73.81752077546       -9.69       -4.79    4.8    5.23s
 11   -73.81752077549      -10.53       -5.51    4.7    5.37s
 12   -73.81752077549      -12.06       -6.19    4.5    6.00s
 13   -73.81752077549      -13.85       -6.40    4.9    5.71s
 14   -73.81752077549   +  -12.57       -6.81    5.3    5.61s
 15   -73.81752077549   +  -13.07       -7.74    4.9    5.62s
┌ Warning: Negative ρcore detected: -3.3407355006201664e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80159706759                   -0.90    9.7    10.5s
  2   -73.81086586996       -2.03       -1.10    5.3    6.03s
  3   -73.81650362298       -2.25       -1.45    6.7    8.25s
  4   -73.81736013831       -3.07       -1.80    5.8    6.14s
  5   -73.81749948066       -3.86       -2.23    5.0    6.68s
  6   -73.81752074850       -4.67       -3.07    5.5    6.11s
  7   -73.81752077150       -7.64       -3.49    5.2    6.21s
  8   -73.81752077509       -8.45       -4.04    3.4    5.57s
  9   -73.81752077526       -9.75       -4.45    5.2    6.73s
 10   -73.81752077546       -9.71       -4.80    4.8    5.64s
 11   -73.81752077549      -10.53       -5.51    4.7    6.04s
 12   -73.81752077549      -12.09       -6.18    4.5    5.48s
 13   -73.81752077549      -13.55       -6.41    4.9    6.00s
 14   -73.81752077549   +  -12.70       -6.82    5.3    5.99s
 15   -73.81752077549   +  -12.94       -7.79    4.7    5.66s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.3407355006201664e-8,-8.26946857773339e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.381752e+01     2.473794e-05
 * time: 504.38376092910767
┌ Warning: Negative ρcore detected: -3.3420653265246154e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80160218843                   -0.90    9.7    10.6s
  2   -73.81085417363       -2.03       -1.10    5.3    5.51s
  3   -73.81650581448       -2.25       -1.45    6.7    8.06s
  4   -73.81736005865       -3.07       -1.80    5.7    6.03s
  5   -73.81749923752       -3.86       -2.23    5.0    5.68s
  6   -73.81752074910       -4.67       -3.07    5.4    6.97s
  7   -73.81752077333       -7.62       -3.49    5.2    5.80s
  8   -73.81752077711       -8.42       -4.05    3.8    4.66s
  9   -73.81752077722       -9.93       -4.47    5.2    5.75s
 10   -73.81752077744       -9.66       -4.80    4.9    5.21s
 11   -73.81752077748      -10.49       -5.52    4.7    5.54s
 12   -73.81752077748      -12.17       -6.20    4.6    5.37s
 13   -73.81752077748      -13.55       -6.53    5.0    5.64s
 14   -73.81752077748   +  -12.73       -6.79    5.1    5.53s
 15   -73.81752077748   +  -12.73       -7.83    5.0    5.97s
┌ Warning: Negative ρcore detected: -3.3420653265246154e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80159849574                   -0.90    9.6    10.7s
  2   -73.81085704400       -2.03       -1.10    5.2    5.81s
  3   -73.81650510530       -2.25       -1.45    6.7    7.56s
  4   -73.81736055496       -3.07       -1.80    5.7    6.10s
  5   -73.81749902390       -3.86       -2.23    4.9    5.68s
  6   -73.81752075194       -4.66       -3.07    5.4    6.38s
  7   -73.81752077343       -7.67       -3.49    5.1    5.80s
  8   -73.81752077707       -8.44       -4.05    3.6    4.62s
  9   -73.81752077723       -9.81       -4.44    5.2    6.47s
 10   -73.81752077745       -9.66       -4.77    4.7    5.07s
 11   -73.81752077748      -10.54       -5.49    4.5    5.16s
 12   -73.81752077748      -11.88       -6.19    4.6    5.38s
 13   -73.81752077748   +  -13.25       -6.40    4.9    5.70s
 14   -73.81752077748   +  -12.59       -6.79    5.4    5.59s
 15   -73.81752077748   +  -13.15       -7.71    4.9    5.47s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.3420653265246154e-8,-8.194040149324988e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.381752e+01     2.607097e-07
 * time: 750.0028140544891
 * Status: success

 * Candidate solution
    Final objective value:     -7.381752e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.62e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.84e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.99e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.69e-11 ≰ 0.0e+00
    |g(x)|                 = 2.61e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   750  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

V: 892.507622 seconds (588.06 M allocations: 280.109 GiB, 6.08% gc time, 0.01% compilation time)
