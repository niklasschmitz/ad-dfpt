┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-12T17:02:41.187
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.464800493113                   -0.96    7.0    12.1s
  2   -8.466554311171       -2.76       -1.73    1.9    4.80s
  3   -8.466621744047       -4.17       -2.76    3.7    1.98s
  4   -8.466623045505       -5.89       -3.79    4.4    1.98s
  5   -8.466623065509       -7.70       -4.41    4.7    2.40s
  6   -8.466623066389       -9.06       -5.39    4.5    2.06s
  7   -8.466623066400      -10.96       -6.13    4.2    1.70s
  8   -8.466623066400      -12.69       -7.45    3.7    1.84s
Iter     Function value   Gradient norm 
     0    -8.466623e+00     2.894069e-04
 * time: 4.601478576660156e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.464808842004                   -0.96    7.0    2.98s
  2   -8.466555054578       -2.76       -1.73    1.8    1.52s
  3   -8.466621678040       -4.18       -2.77    3.8    1.66s
  4   -8.466623126594       -5.84       -3.76    4.5    2.11s
  5   -8.466623146510       -7.70       -4.48    4.7    1.82s
  6   -8.466623147254       -9.13       -5.45    4.9    2.44s
  7   -8.466623147261      -11.14       -6.13    4.1    1.83s
  8   -8.466623147261      -12.69       -7.35    3.8    1.93s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.464795996100                   -0.96    7.1    2.65s
  2   -8.466554158493       -2.75       -1.73    1.9    1.38s
  3   -8.466621822019       -4.17       -2.77    3.7    1.63s
  4   -8.466623126802       -5.88       -3.78    4.5    2.06s
  5   -8.466623146482       -7.71       -4.45    4.7    1.83s
  6   -8.466623147252       -9.11       -5.42    4.6    1.94s
  7   -8.466623147261      -11.03       -6.13    4.1    1.97s
  8   -8.466623147261      -12.71       -7.42    3.8    2.18s
     1    -8.466623e+00     2.693976e-04
 * time: 44.92005705833435
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.464765374188                   -0.96    7.3    2.92s
  2   -8.466551517599       -2.75       -1.73    2.1    1.42s
  3   -8.466622413096       -4.15       -2.76    3.8    1.96s
  4   -8.466623652262       -5.91       -3.78    4.5    2.00s
  5   -8.466623670602       -7.74       -4.45    4.6    1.78s
  6   -8.466623671382       -9.11       -5.42    4.8    1.95s
  7   -8.466623671391      -11.04       -6.12    4.0    1.70s
  8   -8.466623671391      -12.65       -7.39    3.8    1.88s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.464762863514                   -0.96    7.2    2.64s
  2   -8.466554034961       -2.75       -1.73    2.2    1.62s
  3   -8.466622483747       -4.16       -2.76    3.8    1.90s
  4   -8.466623653063       -5.93       -3.78    4.6    2.20s
  5   -8.466623670584       -7.76       -4.44    4.7    1.80s
  6   -8.466623671382       -9.10       -5.45    4.7    1.95s
  7   -8.466623671391      -11.07       -6.15    4.4    2.15s
  8   -8.466623671391      -12.70       -7.44    3.8    1.99s
     2    -8.466624e+00     5.373450e-07
 * time: 88.72891592979431
 * Status: success

 * Candidate solution
    Final objective value:     -8.466624e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.90e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.77e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 5.24e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 6.19e-08 ≰ 0.0e+00
    |g(x)|                 = 5.37e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   89  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Si: 165.971833 seconds (247.76 M allocations: 43.490 GiB, 7.20% gc time, 32.63% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-12T17:05:27.830
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26088069817                   -1.15    8.5    20.0s
  2   -62.26561784223       -2.32       -1.21    2.7    8.49s
  3   -62.27011505953       -2.35       -2.05    3.8    11.3s
  4   -62.27014932441       -4.47       -2.93    3.6    10.7s
  5   -62.27014966216       -6.47       -3.59    4.0    11.1s
  6   -62.27014968980       -7.56       -4.27    3.8    10.1s
  7   -62.27014969039       -9.24       -4.92    4.1    10.5s
  8   -62.27014969042      -10.51       -6.66    4.0    10.5s
  9   -62.27014969042      -13.30       -7.18    4.5    11.4s
Iter     Function value   Gradient norm 
     0    -6.227015e+01     5.718290e-04
 * time: 3.695487976074219e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26087513378                   -1.15    8.9    17.7s
  2   -62.26560964265       -2.32       -1.21    2.7    8.15s
  3   -62.27011574883       -2.35       -2.05    4.0    9.78s
  4   -62.27014964620       -4.47       -2.94    3.6    10.1s
  5   -62.27014998761       -6.47       -3.63    4.1    11.0s
  6   -62.27015001356       -7.59       -4.31    3.6    9.72s
  7   -62.27015001409       -9.28       -4.97    4.0    10.6s
  8   -62.27015001412      -10.62       -6.49    4.0    10.2s
  9   -62.27015001412      -12.72       -7.10    4.2    11.2s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26087554209                   -1.15    8.9    17.7s
  2   -62.26559689422       -2.33       -1.21    2.7    7.38s
  3   -62.27011582976       -2.34       -2.05    4.0    9.87s
  4   -62.27014966624       -4.47       -2.97    3.5    9.92s
  5   -62.27014998977       -6.49       -3.67    4.0    10.9s
  6   -62.27015001367       -7.62       -4.35    3.5    9.43s
  7   -62.27015001410       -9.37       -4.99    4.0    10.8s
  8   -62.27015001412      -10.69       -6.42    3.9    11.4s
  9   -62.27015001412      -13.15       -7.10    4.2    11.2s
     1    -6.227015e+01     5.603792e-04
 * time: 231.52361297607422
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26079377269                   -1.15    8.8    19.0s
  2   -62.26552524051       -2.33       -1.21    2.8    8.40s
  3   -62.27012252557       -2.34       -2.04    4.0    10.5s
  4   -62.27015753779       -4.46       -2.93    3.5    9.20s
  5   -62.27015789208       -6.45       -3.59    4.0    10.6s
  6   -62.27015792050       -7.55       -4.27    3.5    9.42s
  7   -62.27015792106       -9.25       -4.92    3.9    10.7s
  8   -62.27015792109      -10.54       -6.31    3.8    10.4s
  9   -62.27015792109      -12.79       -7.15    4.4    11.4s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26079601256                   -1.15    8.8    18.3s
  2   -62.26552786059       -2.32       -1.21    2.7    7.66s
  3   -62.27012267872       -2.34       -2.05    4.0    10.8s
  4   -62.27015753951       -4.46       -2.93    3.5    9.77s
  5   -62.27015789271       -6.45       -3.60    4.0    11.4s
  6   -62.27015792052       -7.56       -4.28    3.7    11.2s
  7   -62.27015792106       -9.27       -4.92    4.0    10.9s
  8   -62.27015792109      -10.55       -6.40    3.9    12.6s
  9   -62.27015792109      -13.15       -7.22    4.3    12.4s
     2    -6.227016e+01     7.299490e-06
 * time: 471.39681696891785
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26079484702                   -1.15    8.9    17.7s
  2   -62.26550651225       -2.33       -1.20    2.7    8.13s
  3   -62.27012322019       -2.34       -2.05    4.0    10.5s
  4   -62.27015759827       -4.46       -2.98    3.6    10.1s
  5   -62.27015789856       -6.52       -3.68    4.1    11.2s
  6   -62.27015792202       -7.63       -4.36    3.4    9.60s
  7   -62.27015792243       -9.39       -4.98    4.0    12.2s
  8   -62.27015792245      -10.66       -6.49    3.9    11.5s
  9   -62.27015792245   +  -13.85       -7.50    4.3    11.8s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26079263243                   -1.15    8.8    18.1s
  2   -62.26550981333       -2.33       -1.21    2.7    7.82s
  3   -62.27012287094       -2.34       -2.05    3.9    10.1s
  4   -62.27015759905       -4.46       -2.98    3.5    9.23s
  5   -62.27015789831       -6.52       -3.67    4.1    11.6s
  6   -62.27015792197       -7.63       -4.34    3.5    9.38s
  7   -62.27015792242       -9.35       -4.96    3.9    10.2s
  8   -62.27015792245      -10.62       -6.57    3.9    10.7s
  9   -62.27015792245   +  -13.85       -7.18    4.4    12.8s
     3    -6.227016e+01     7.560149e-08
 * time: 709.7603919506073
 * Status: success

 * Candidate solution
    Final objective value:     -6.227016e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.69e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.43e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.36e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.18e-11 ≰ 0.0e+00
    |g(x)|                 = 7.56e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   710  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

NaCl: 839.511089 seconds (795.45 M allocations: 228.496 GiB, 5.21% gc time, 0.46% compilation time)
┌ Info: 2025-05-12T17:19:27.399
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317895735837                   -1.47    5.4    2.11s
  2   -2.317968538187       -4.14       -1.84    1.3    786ms
  3   -2.317984500784       -4.80       -3.57    3.2    1.61s
  4   -2.317984661796       -6.79       -4.00    4.5    1.69s
  5   -2.317984662331       -9.27       -4.25    2.2    1.35s
  6   -2.317984662513       -9.74       -5.01    2.7    1.15s
  7   -2.317984662518      -11.24       -5.74    2.7    1.44s
  8   -2.317984662519      -12.58       -6.30    2.8    1.20s
  9   -2.317984662519      -14.21       -6.78    2.1    959ms
 10   -2.317984662519      -15.35       -7.59    2.4    1.98s
Iter     Function value   Gradient norm 
     0    -2.317985e+00     1.091612e-05
 * time: 3.504753112792969e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317895583404                   -1.47    5.5    2.12s
  2   -2.317968799873       -4.14       -1.84    1.4    780ms
  3   -2.317984466848       -4.81       -3.57    3.2    1.58s
  4   -2.317984661900       -6.71       -4.01    4.6    1.66s
  5   -2.317984662440       -9.27       -4.25    2.2    1.34s
  6   -2.317984662629       -9.72       -5.00    2.6    1.09s
  7   -2.317984662635      -11.19       -5.71    2.7    1.47s
  8   -2.317984662635      -12.54       -6.27    2.8    1.15s
  9   -2.317984662635      -14.12       -6.70    2.1    1.12s
 10   -2.317984662635   +    -Inf       -7.51    2.0    1.40s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317892200141                   -1.47    5.6    2.08s
  2   -2.317968773160       -4.12       -1.84    1.4    794ms
  3   -2.317984495933       -4.80       -3.57    3.2    1.57s
  4   -2.317984661936       -6.78       -4.02    4.5    1.88s
  5   -2.317984662437       -9.30       -4.25    2.2    1.55s
  6   -2.317984662628       -9.72       -5.02    2.7    1.33s
  7   -2.317984662635      -11.18       -5.68    2.8    1.51s
  8   -2.317984662635      -12.47       -6.26    2.7    1.18s
  9   -2.317984662635      -14.10       -6.74    2.1    970ms
 10   -2.317984662635   +    -Inf       -7.46    2.4    1.36s
     1    -2.317985e+00     1.046717e-05
 * time: 60.053871870040894
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317898457674                   -1.47    5.4    2.51s
  2   -2.317968468216       -4.15       -1.84    1.3    897ms
  3   -2.317984446285       -4.80       -3.55    3.1    2.23s
  4   -2.317984663182       -6.66       -3.99    4.5    2.52s
  5   -2.317984663762       -9.24       -4.23    2.2    1.86s
  6   -2.317984663962       -9.70       -4.97    2.6    1.40s
  7   -2.317984663971      -11.08       -5.76    2.7    1.57s
  8   -2.317984663971      -12.53       -6.13    2.7    1.31s
  9   -2.317984663971      -13.60       -6.73    2.2    1.33s
 10   -2.317984663971      -15.05       -7.37    2.6    1.48s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317894012746                   -1.47    5.3    2.06s
  2   -2.317968716169       -4.13       -1.84    1.3    1.05s
  3   -2.317984432359       -4.80       -3.57    3.2    1.26s
  4   -2.317984663216       -6.64       -3.99    4.6    1.99s
  5   -2.317984663771       -9.26       -4.24    2.1    1.18s
  6   -2.317984663963       -9.72       -4.99    2.6    1.75s
  7   -2.317984663971      -11.13       -5.71    2.6    1.09s
  8   -2.317984663971      -12.60       -6.49    2.7    1.10s
  9   -2.317984663971      -14.18       -6.78    2.8    1.41s
 10   -2.317984663971      -15.35       -7.46    1.9    1.25s
     2    -2.317985e+00     2.493336e-08
 * time: 123.2008810043335
 * Status: success

 * Candidate solution
    Final objective value:     -2.317985e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.55e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.33e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.34e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 5.76e-10 ≰ 0.0e+00
    |g(x)|                 = 2.49e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   123  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Al: 158.786172 seconds (121.27 M allocations: 28.683 GiB, 6.54% gc time, 0.00% compilation time)
┌ Info: 2025-05-12T17:22:06.186
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80928485323                   -0.90    9.6    9.28s
  2   -73.81882312224       -2.02       -1.09    5.2    6.08s
  3   -73.82460276784       -2.24       -1.45    6.6    7.44s
  4   -73.82549522469       -3.05       -1.79    5.7    5.87s
  5   -73.82563796937       -3.85       -2.23    5.0    5.61s
  6   -73.82565993675       -4.66       -3.07    5.5    6.32s
  7   -73.82565995881       -7.66       -3.50    5.1    5.77s
  8   -73.82565996275       -8.40       -4.04    3.8    4.65s
  9   -73.82565996284      -10.04       -4.44    5.5    5.89s
 10   -73.82565996318       -9.47       -4.79    5.0    5.27s
 11   -73.82565996321      -10.52       -5.52    4.6    5.30s
 12   -73.82565996322      -11.74       -6.24    4.6    5.36s
 13   -73.82565996322      -12.64       -6.51    4.9    5.98s
 14   -73.82565996322      -13.55       -6.77    5.0    5.62s
 15   -73.82565996322      -12.94       -7.71    4.9    5.41s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.382566e+01     4.148224e-03
 * time: 4.887580871582031e-5
┌ Warning: Negative ρcore detected: -3.406403663021476e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80936720647                   -0.90    9.7    10.1s
  2   -73.81886793491       -2.02       -1.09    5.2    5.43s
  3   -73.82462016574       -2.24       -1.45    6.7    7.23s
  4   -73.82551209582       -3.05       -1.79    5.8    6.27s
  5   -73.82565449911       -3.85       -2.23    5.0    5.47s
  6   -73.82567584556       -4.67       -3.07    5.6    6.34s
  7   -73.82567586628       -7.68       -3.50    5.2    5.84s
  8   -73.82567587035       -8.39       -4.04    4.0    4.87s
  9   -73.82567587045       -9.98       -4.42    5.5    6.01s
 10   -73.82567587084       -9.41       -4.77    5.1    5.48s
 11   -73.82567587087      -10.53       -5.49    4.6    5.45s
 12   -73.82567587087      -11.71       -6.22    4.6    5.55s
 13   -73.82567587087      -12.67       -6.40    4.9    5.84s
 14   -73.82567587087   +  -13.07       -6.79    5.3    5.68s
 15   -73.82567587087   +  -13.07       -7.63    4.7    5.60s
┌ Warning: Negative ρcore detected: -3.406403663021476e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80936367301                   -0.90    9.7    9.89s
  2   -73.81887170382       -2.02       -1.09    5.1    5.65s
  3   -73.82461948557       -2.24       -1.45    6.7    7.38s
  4   -73.82551294451       -3.05       -1.79    5.7    6.10s
  5   -73.82565405125       -3.85       -2.23    4.9    5.66s
  6   -73.82567584496       -4.66       -3.07    5.5    6.81s
  7   -73.82567586651       -7.67       -3.50    5.1    6.73s
  8   -73.82567587039       -8.41       -4.05    3.8    4.75s
  9   -73.82567587046      -10.18       -4.42    5.5    6.00s
 10   -73.82567587084       -9.42       -4.78    5.1    5.38s
 11   -73.82567587087      -10.52       -5.51    4.7    5.35s
 12   -73.82567587087      -11.78       -6.23    4.6    5.40s
 13   -73.82567587087      -13.55       -6.52    4.9    5.83s
 14   -73.82567587087   +  -13.85       -6.78    5.0    5.51s
 15   -73.82567587087   +  -13.07       -7.70    5.1    5.62s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.406403663021476e-8,-3.0031111276142454e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.382568e+01     3.520515e-03
 * time: 246.2891240119934
┌ Warning: Negative ρcore detected: -3.2134045969960906e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80983344163                   -0.90    9.7    10.0s
  2   -73.81906594707       -2.03       -1.10    5.2    5.61s
  3   -73.82466411033       -2.25       -1.45    6.7    7.49s
  4   -73.82556596954       -3.04       -1.81    5.6    6.11s
  5   -73.82569663720       -3.88       -2.25    4.9    5.86s
  6   -73.82571613451       -4.71       -3.08    5.5    6.65s
  7   -73.82571615723       -7.64       -3.53    4.2    5.86s
  8   -73.82571616282       -8.25       -4.02    4.7    5.60s
  9   -73.82571616240   +   -9.37       -4.51    5.4    5.70s
 10   -73.82571616305       -9.19       -4.77    5.6    5.74s
 11   -73.82571616309      -10.39       -5.46    4.7    5.35s
 12   -73.82571616309      -11.13       -6.16    4.5    5.62s
 13   -73.82571616309      -12.42       -6.31    4.8    5.56s
 14   -73.82571616309      -11.96       -6.86    5.4    5.59s
 15   -73.82571616309      -12.53       -7.85    4.9    5.78s
┌ Warning: Negative ρcore detected: -3.2134045969960906e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80983717248                   -0.90    9.7    11.0s
  2   -73.81905486649       -2.04       -1.10    5.2    6.16s
  3   -73.82466359531       -2.25       -1.45    6.7    7.54s
  4   -73.82556667023       -3.04       -1.81    5.7    6.02s
  5   -73.82569671947       -3.89       -2.26    4.9    5.56s
  6   -73.82571613659       -4.71       -3.09    5.5    6.56s
  7   -73.82571615718       -7.69       -3.53    4.3    6.64s
  8   -73.82571616281       -8.25       -4.03    4.8    6.18s
  9   -73.82571616237   +   -9.36       -4.49    5.4    6.12s
 10   -73.82571616305       -9.17       -4.76    5.6    5.97s
 11   -73.82571616308      -10.41       -5.44    4.7    5.82s
 12   -73.82571616309      -11.07       -6.16    4.6    5.74s
 13   -73.82571616309      -12.45       -6.31    4.8    5.65s
 14   -73.82571616309      -11.94       -6.86    5.4    5.60s
 15   -73.82571616309      -12.59       -7.82    4.9    5.50s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.2134045969960906e-8,-1.3863200755047058e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.382572e+01     7.833228e-05
 * time: 498.256973028183
┌ Warning: Negative ρcore detected: -3.220360494322807e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80981951737                   -0.90    9.6    9.68s
  2   -73.81905577359       -2.03       -1.10    5.2    5.70s
  3   -73.82466514967       -2.25       -1.45    6.8    7.93s
  4   -73.82556602532       -3.05       -1.81    5.6    6.31s
  5   -73.82569609461       -3.89       -2.25    4.9    6.38s
  6   -73.82571615528       -4.70       -3.08    5.5    6.65s
  7   -73.82571617580       -7.69       -3.53    4.4    5.58s
  8   -73.82571619017       -7.84       -4.03    4.8    5.86s
  9   -73.82571618998   +   -9.72       -4.51    5.4    6.25s
 10   -73.82571619053       -9.26       -4.77    5.5    5.96s
 11   -73.82571619057      -10.42       -5.45    4.7    5.60s
 12   -73.82571619057      -11.83       -6.16    4.5    5.81s
 13   -73.82571619057      -13.55       -6.31    4.7    6.05s
 14   -73.82571619057   +  -12.30       -6.86    5.3    5.74s
 15   -73.82571619057   +  -13.07       -7.83    4.9    5.58s
┌ Warning: Negative ρcore detected: -3.220360494322807e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80981793215                   -0.90    9.7    10.5s
  2   -73.81906241651       -2.03       -1.10    5.1    5.86s
  3   -73.82466399987       -2.25       -1.45    6.6    6.95s
  4   -73.82556600025       -3.04       -1.80    5.7    6.73s
  5   -73.82569659675       -3.88       -2.25    5.0    6.27s
  6   -73.82571615576       -4.71       -3.08    5.5    6.44s
  7   -73.82571617645       -7.68       -3.54    4.4    5.34s
  8   -73.82571619020       -7.86       -4.03    4.8    5.39s
  9   -73.82571618995   +   -9.59       -4.49    5.4    5.84s
 10   -73.82571619053       -9.23       -4.76    5.5    5.80s
 11   -73.82571619057      -10.42       -5.45    4.7    5.32s
 12   -73.82571619057      -11.80       -6.16    4.6    5.38s
 13   -73.82571619057      -13.15       -6.31    4.6    5.48s
 14   -73.82571619057   +  -12.29       -6.87    5.3    5.59s
 15   -73.82571619057   +  -13.07       -7.81    5.0    5.71s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.220360494322807e-8,-1.3609338782607796e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.382572e+01     1.423499e-06
 * time: 746.7985730171204
┌ Warning: Negative ρcore detected: -3.2202374772807364e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80981799557                   -0.90    9.7    9.89s
  2   -73.81906483067       -2.03       -1.10    5.2    6.57s
  3   -73.82466110430       -2.25       -1.45    6.8    9.05s
  4   -73.82556694745       -3.04       -1.81    5.7    6.25s
  5   -73.82569642125       -3.89       -2.25    4.9    6.53s
  6   -73.82571615526       -4.70       -3.08    5.6    6.49s
  7   -73.82571617580       -7.69       -3.54    4.3    5.46s
  8   -73.82571619015       -7.84       -4.04    4.8    6.44s
  9   -73.82571618991   +   -9.61       -4.49    5.5    6.90s
 10   -73.82571619054       -9.20       -4.77    5.7    6.00s
 11   -73.82571619057      -10.43       -5.45    4.6    5.59s
 12   -73.82571619057      -11.83       -6.17    4.6    5.94s
 13   -73.82571619057   +    -Inf       -6.31    4.7    5.98s
 14   -73.82571619057   +  -12.33       -6.86    5.4    5.76s
 15   -73.82571619057   +  -12.94       -7.85    5.0    5.96s
┌ Warning: Negative ρcore detected: -3.2202374772807364e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80981637292                   -0.90    9.6    9.66s
  2   -73.81906696988       -2.03       -1.10    5.2    5.35s
  3   -73.82466161046       -2.25       -1.45    6.7    7.13s
  4   -73.82556660380       -3.04       -1.81    5.6    5.96s
  5   -73.82569650800       -3.89       -2.25    4.9    5.61s
  6   -73.82571615517       -4.71       -3.08    5.5    5.97s
  7   -73.82571617636       -7.67       -3.53    4.3    5.19s
  8   -73.82571619019       -7.86       -4.03    4.7    5.29s
  9   -73.82571618995   +   -9.62       -4.48    5.4    5.85s
 10   -73.82571619054       -9.23       -4.76    5.6    5.82s
 11   -73.82571619057      -10.42       -5.44    4.6    5.34s
 12   -73.82571619057      -11.86       -6.16    4.6    5.66s
 13   -73.82571619057      -13.15       -6.32    4.7    6.54s
 14   -73.82571619057   +  -12.33       -6.87    5.4    5.85s
 15   -73.82571619057   +  -13.07       -7.80    4.9    5.72s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.2202374772807364e-8,-1.3613863025476536e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     4    -7.382572e+01     4.679142e-10
 * time: 1000.1546819210052
 * Status: success

 * Candidate solution
    Final objective value:     -7.382572e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 9.04e-06 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.59e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 5.61e-12 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 7.60e-14 ≰ 0.0e+00
    |g(x)|                 = 4.68e-10 ≤ 1.0e-06

 * Work counters
    Seconds run:   1000  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

V: 1133.188736 seconds (756.12 M allocations: 362.458 GiB, 6.08% gc time, 0.01% compilation time)
