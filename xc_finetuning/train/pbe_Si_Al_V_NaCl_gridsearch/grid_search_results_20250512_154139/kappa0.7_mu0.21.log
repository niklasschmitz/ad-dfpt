┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-12T16:24:12.097
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.455859632002                   -0.96    6.9    11.5s
  2   -8.457668083779       -2.74       -1.75    2.2    5.05s
  3   -8.457731070497       -4.20       -2.79    3.8    1.62s
  4   -8.457732183484       -5.95       -3.79    4.4    1.96s
  5   -8.457732197054       -7.87       -4.49    4.6    1.75s
  6   -8.457732197589       -9.27       -5.48    4.5    1.87s
  7   -8.457732197595      -11.19       -6.15    4.1    1.99s
  8   -8.457732197595      -12.76       -7.46    3.5    1.52s
Iter     Function value   Gradient norm 
     0    -8.457732e+00     1.724753e-03
 * time: 3.790855407714844e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.455868858341                   -0.96    7.1    2.55s
  2   -8.457670919232       -2.74       -1.75    2.1    1.42s
  3   -8.457734143156       -4.20       -2.78    3.8    1.61s
  4   -8.457735054475       -6.04       -3.81    4.6    1.99s
  5   -8.457735068943       -7.84       -4.42    4.6    1.76s
  6   -8.457735069637       -9.16       -5.43    4.5    1.83s
  7   -8.457735069647      -11.04       -6.19    4.3    1.69s
  8   -8.457735069647      -12.86       -7.60    3.6    1.78s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.455868062036                   -0.96    7.3    2.56s
  2   -8.457668078932       -2.74       -1.75    1.9    1.37s
  3   -8.457733924201       -4.18       -2.79    3.8    1.60s
  4   -8.457735054938       -5.95       -3.80    4.5    2.07s
  5   -8.457735069046       -7.85       -4.46    4.6    1.78s
  6   -8.457735069638       -9.23       -5.43    4.5    1.86s
  7   -8.457735069646      -11.06       -6.13    4.2    1.70s
  8   -8.457735069647      -12.69       -7.47    3.7    1.78s
     1    -8.457735e+00     1.605610e-03
 * time: 42.31473398208618
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.455863125839                   -0.96    7.3    2.61s
  2   -8.457686645167       -2.74       -1.75    2.0    1.12s
  3   -8.457752587005       -4.18       -2.78    3.8    1.97s
  4   -8.457753562608       -6.01       -3.81    4.4    2.01s
  5   -8.457753574103       -7.94       -4.46    4.6    1.74s
  6   -8.457753574681       -9.24       -5.44    4.7    1.89s
  7   -8.457753574689      -11.11       -6.13    4.2    1.70s
  8   -8.457753574689      -12.72       -7.50    3.7    1.81s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.455862075088                   -0.96    7.3    2.64s
  2   -8.457689713874       -2.74       -1.75    2.1    1.43s
  3   -8.457752584966       -4.20       -2.78    3.9    1.67s
  4   -8.457753563258       -6.01       -3.79    4.4    2.02s
  5   -8.457753574162       -7.96       -4.48    4.6    1.75s
  6   -8.457753574683       -9.28       -5.49    4.8    1.97s
  7   -8.457753574689      -11.22       -6.18    4.1    1.71s
  8   -8.457753574689      -12.81       -7.43    3.7    1.83s
     2    -8.457754e+00     1.933090e-05
 * time: 84.1005129814148
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.455853377165                   -0.96    7.6    3.00s
  2   -8.457688261221       -2.74       -1.75    2.1    1.22s
  3   -8.457752773074       -4.19       -2.77    4.0    1.94s
  4   -8.457753564912       -6.10       -3.82    4.5    1.70s
  5   -8.457753576666       -7.93       -4.42    4.7    1.99s
  6   -8.457753577324       -9.18       -5.43    4.6    1.62s
  7   -8.457753577333      -11.08       -6.16    4.3    1.94s
  8   -8.457753577333      -12.81       -7.61    3.8    1.55s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.455852812537                   -0.96    7.5    2.72s
  2   -8.457688547863       -2.74       -1.75    2.3    1.18s
  3   -8.457752701268       -4.19       -2.78    4.1    1.99s
  4   -8.457753565439       -6.06       -3.81    4.4    1.75s
  5   -8.457753576725       -7.95       -4.45    4.8    2.10s
  6   -8.457753577326       -9.22       -5.46    4.7    1.68s
  7   -8.457753577333      -11.17       -6.16    4.2    1.96s
  8   -8.457753577333      -12.82       -7.54    3.7    1.55s
     3    -8.457754e+00     2.112914e-07
 * time: 125.93969702720642
 * Status: success

 * Candidate solution
    Final objective value:     -8.457754e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.77e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.68e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.64e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.13e-10 ≰ 0.0e+00
    |g(x)|                 = 2.11e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   126  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 200.478557 seconds (308.61 M allocations: 59.152 GiB, 7.48% gc time, 26.13% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-12T16:27:33.223
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19719481827                   -1.16    8.4    19.1s
  2   -62.20147318381       -2.37       -1.22    2.6    8.20s
  3   -62.20576357134       -2.37       -2.06    4.0    10.6s
  4   -62.20579490655       -4.50       -2.90    3.7    9.59s
  5   -62.20579538886       -6.32       -3.59    4.0    10.1s
  6   -62.20579541112       -7.65       -4.36    3.8    10.0s
  7   -62.20579541148       -9.44       -5.04    3.9    10.5s
  8   -62.20579541150      -10.79       -6.48    4.0    10.4s
  9   -62.20579541150      -13.85       -7.28    4.4    11.1s
Iter     Function value   Gradient norm 
     0    -6.220580e+01     1.115839e-03
 * time: 3.0040740966796875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19720216498                   -1.16    8.4    16.8s
  2   -62.20146754633       -2.37       -1.22    2.8    7.69s
  3   -62.20576529405       -2.37       -2.06    4.0    10.4s
  4   -62.20579614652       -4.51       -2.91    3.7    10.2s
  5   -62.20579662312       -6.32       -3.61    4.0    10.5s
  6   -62.20579664424       -7.68       -4.39    3.6    9.57s
  7   -62.20579664456       -9.49       -5.01    4.0    10.9s
  8   -62.20579664458      -10.74       -6.38    3.9    10.4s
  9   -62.20579664458      -13.19       -7.39    4.3    11.4s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19720269053                   -1.16    8.5    17.0s
  2   -62.20147201505       -2.37       -1.22    2.7    7.45s
  3   -62.20576502413       -2.37       -2.06    4.0    10.5s
  4   -62.20579613487       -4.51       -2.90    3.7    9.90s
  5   -62.20579662184       -6.31       -3.58    4.0    10.5s
  6   -62.20579664419       -7.65       -4.35    3.9    10.3s
  7   -62.20579664456       -9.43       -4.98    4.0    11.0s
  8   -62.20579664458      -10.69       -6.46    3.9    10.4s
  9   -62.20579664458      -13.19       -7.16    4.4    12.6s
     1    -6.220580e+01     1.094318e-03
 * time: 232.31560707092285
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19740738354                   -1.16    8.6    17.1s
  2   -62.20169233027       -2.37       -1.23    2.7    7.45s
  3   -62.20579727133       -2.39       -2.07    4.1    10.2s
  4   -62.20582656452       -4.53       -2.89    3.7    9.71s
  5   -62.20582704813       -6.32       -3.58    3.9    10.5s
  6   -62.20582707067       -7.65       -4.35    3.9    10.0s
  7   -62.20582707103       -9.45       -4.99    4.0    10.4s
  8   -62.20582707105      -10.71       -6.52    4.0    10.6s
  9   -62.20582707105      -12.94       -7.35    4.4    11.5s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19741034294                   -1.16    8.7    17.7s
  2   -62.20168365243       -2.37       -1.22    2.9    7.59s
  3   -62.20579761011       -2.39       -2.07    4.1    10.0s
  4   -62.20582660472       -4.54       -2.91    3.7    9.85s
  5   -62.20582705028       -6.35       -3.61    4.0    10.4s
  6   -62.20582707073       -7.69       -4.40    3.8    10.0s
  7   -62.20582707103       -9.52       -5.02    4.1    10.6s
  8   -62.20582707105      -10.78       -6.50    3.8    9.90s
  9   -62.20582707105      -13.25       -7.29    4.5    11.3s
     2    -6.220583e+01     3.273802e-05
 * time: 462.01966309547424
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19740886151                   -1.16    8.4    18.6s
  2   -62.20168272793       -2.37       -1.22    2.7    7.34s
  3   -62.20579710361       -2.39       -2.07    4.0    10.1s
  4   -62.20582663701       -4.53       -2.91    3.7    9.77s
  5   -62.20582707518       -6.36       -3.59    4.0    10.4s
  6   -62.20582709693       -7.66       -4.36    3.8    9.90s
  7   -62.20582709726       -9.49       -4.99    4.1    11.3s
  8   -62.20582709728      -10.71       -6.58    4.0    11.0s
  9   -62.20582709728      -12.92       -7.54    4.5    11.9s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19740758177                   -1.16    8.5    18.0s
  2   -62.20169427424       -2.37       -1.23    2.6    7.25s
  3   -62.20579694701       -2.39       -2.07    3.8    9.58s
  4   -62.20582661788       -4.53       -2.89    3.8    10.4s
  5   -62.20582707400       -6.34       -3.57    3.9    10.5s
  6   -62.20582709689       -7.64       -4.34    3.6    9.61s
  7   -62.20582709726       -9.43       -5.08    3.9    10.3s
  8   -62.20582709728      -10.84       -6.48    4.0    10.6s
  9   -62.20582709728   +    -Inf       -7.08    4.4    11.1s
     3    -6.220583e+01     9.206991e-07
 * time: 692.0040171146393
 * Status: success

 * Candidate solution
    Final objective value:     -6.220583e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.65e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.54e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.62e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 4.22e-10 ≰ 0.0e+00
    |g(x)|                 = 9.21e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   692  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

NaCl: 816.759466 seconds (798.30 M allocations: 228.344 GiB, 5.21% gc time, 0.41% compilation time)
┌ Info: 2025-05-12T16:41:10.015
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316681365132                   -1.46    5.5    2.04s
  2   -2.316759455522       -4.11       -1.84    1.4    779ms
  3   -2.316777754131       -4.74       -3.58    3.2    1.51s
  4   -2.316777973214       -6.66       -4.08    4.7    1.68s
  5   -2.316777973708       -9.31       -4.39    2.4    1.31s
  6   -2.316777973837       -9.89       -5.02    2.7    1.14s
  7   -2.316777973841      -11.38       -5.84    2.4    1.33s
  8   -2.316777973842      -12.87       -6.44    2.7    1.09s
  9   -2.316777973842      -14.31       -7.26    2.1    945ms
Iter     Function value   Gradient norm 
     0    -2.316778e+00     6.818479e-04
 * time: 3.695487976074219e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316680222542                   -1.46    5.3    1.81s
  2   -2.316759754942       -4.10       -1.84    1.3    1.08s
  3   -2.316778237694       -4.73       -3.57    3.1    1.28s
  4   -2.316778428636       -6.72       -4.08    4.5    2.00s
  5   -2.316778429144       -9.29       -4.39    2.5    1.09s
  6   -2.316778429275       -9.88       -5.02    2.8    1.45s
  7   -2.316778429279      -11.42       -5.81    2.5    1.07s
  8   -2.316778429279      -12.97       -6.39    2.7    1.41s
  9   -2.316778429279      -14.45       -7.30    2.0    923ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316680526117                   -1.46    5.4    2.05s
  2   -2.316759590001       -4.10       -1.84    1.3    778ms
  3   -2.316778257160       -4.73       -3.58    3.3    1.57s
  4   -2.316778428652       -6.77       -4.08    4.5    1.67s
  5   -2.316778429148       -9.30       -4.39    2.4    1.33s
  6   -2.316778429275       -9.90       -5.03    2.7    1.10s
  7   -2.316778429279      -11.37       -5.83    2.4    1.37s
  8   -2.316778429279      -12.87       -6.47    2.7    1.12s
  9   -2.316778429279      -14.57       -7.27    2.2    1.00s
     1    -2.316778e+00     6.540478e-04
 * time: 54.23754286766052
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316690111505                   -1.46    5.5    1.80s
  2   -2.316766046800       -4.12       -1.84    1.3    1.07s
  3   -2.316783506968       -4.76       -3.57    3.2    1.31s
  4   -2.316783721284       -6.67       -4.02    4.6    1.99s
  5   -2.316783721899       -9.21       -4.33    2.4    1.07s
  6   -2.316783722076       -9.75       -4.94    2.7    1.36s
  7   -2.316783722082      -11.21       -5.62    2.4    1.04s
  8   -2.316783722082      -12.63       -6.33    2.7    1.39s
  9   -2.316783722082      -14.07       -7.09    2.4    1.03s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316684113427                   -1.46    5.4    1.99s
  2   -2.316765899046       -4.09       -1.84    1.4    1.04s
  3   -2.316783472487       -4.76       -3.58    3.2    1.25s
  4   -2.316783721348       -6.60       -4.05    4.5    1.96s
  5   -2.316783721914       -9.25       -4.36    2.4    1.01s
  6   -2.316783722077       -9.79       -4.97    2.7    1.42s
  7   -2.316783722082      -11.25       -5.62    2.4    998ms
  8   -2.316783722082      -12.64       -6.37    2.6    1.37s
  9   -2.316783722082      -13.97       -7.09    2.6    1.07s
     2    -2.316784e+00     7.543012e-06
 * time: 107.85905289649963
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316683714491                   -1.46    5.5    2.15s
  2   -2.316765340645       -4.09       -1.84    1.3    804ms
  3   -2.316783509764       -4.74       -3.58    3.4    1.68s
  4   -2.316783722072       -6.67       -4.05    4.6    2.03s
  5   -2.316783722628       -9.25       -4.36    2.4    1.12s
  6   -2.316783722786       -9.80       -4.97    2.6    1.59s
  7   -2.316783722792      -11.26       -5.62    2.4    1.09s
  8   -2.316783722792      -12.65       -6.30    2.6    1.19s
  9   -2.316783722792      -13.92       -7.09    2.4    1.44s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316683809662                   -1.46    5.5    2.08s
  2   -2.316765475358       -4.09       -1.84    1.3    780ms
  3   -2.316783523990       -4.74       -3.57    3.3    1.61s
  4   -2.316783722066       -6.70       -4.05    4.5    1.69s
  5   -2.316783722630       -9.25       -4.37    2.4    1.31s
  6   -2.316783722787       -9.81       -4.97    2.8    1.14s
  7   -2.316783722792      -11.29       -5.63    2.5    1.35s
  8   -2.316783722792      -12.72       -6.37    2.5    1.08s
  9   -2.316783722792      -13.95       -7.09    2.7    1.13s
     3    -2.316784e+00     3.444876e-08
 * time: 162.51270294189453
 * Status: success

 * Candidate solution
    Final objective value:     -2.316784e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.87e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.45e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 7.09e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.06e-10 ≰ 0.0e+00
    |g(x)|                 = 3.44e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   163  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Al: 194.722801 seconds (156.17 M allocations: 36.914 GiB, 6.45% gc time, 0.00% compilation time)
┌ Info: 2025-05-12T16:44:24.738
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76524203916                   -0.87    9.6    9.54s
  2   -73.77624389667       -1.96       -1.07    5.3    5.90s
  3   -73.78256361013       -2.20       -1.42    6.7    7.62s
  4   -73.78359773473       -2.99       -1.77    5.8    6.59s
  5   -73.78375273384       -3.81       -2.24    5.0    5.60s
  6   -73.78377352525       -4.68       -3.07    5.4    7.00s
  7   -73.78377354331       -7.74       -3.51    4.8    6.04s
  8   -73.78377354785       -8.34       -4.08    4.4    5.04s
  9   -73.78377354762   +   -9.63       -4.42    5.4    5.74s
 10   -73.78377354814       -9.28       -4.76    5.5    5.71s
 11   -73.78377354816      -10.69       -5.60    4.2    5.23s
 12   -73.78377354816      -12.29       -6.38    4.7    5.72s
 13   -73.78377354816      -13.37       -6.61    4.1    4.84s
 14   -73.78377354816   +  -12.94       -6.96    5.0    5.22s
 15   -73.78377354816   +  -13.15       -7.73    5.1    5.56s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.378377e+01     7.825033e-03
 * time: 3.409385681152344e-5
┌ Warning: Negative ρcore detected: -3.3924220245952054e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76543782159                   -0.87    9.6    10.1s
  2   -73.77633252343       -1.96       -1.07    5.3    5.88s
  3   -73.78263020701       -2.20       -1.42    6.7    7.45s
  4   -73.78365383845       -2.99       -1.77    5.9    5.92s
  5   -73.78380868209       -3.81       -2.23    5.0    5.65s
  6   -73.78383016030       -4.67       -3.07    5.5    6.13s
  7   -73.78383017902       -7.73       -3.50    4.9    5.65s
  8   -73.78383018316       -8.38       -4.07    4.3    5.00s
  9   -73.78383018296   +   -9.70       -4.42    5.3    6.07s
 10   -73.78383018343       -9.33       -4.77    5.3    6.47s
 11   -73.78383018346      -10.64       -5.57    4.5    5.17s
 12   -73.78383018346      -11.72       -6.36    4.7    5.45s
 13   -73.78383018346      -13.15       -6.60    4.7    5.39s
 14   -73.78383018346      -13.00       -6.96    5.0    5.35s
 15   -73.78383018346   +  -13.07       -7.77    5.2    5.61s
┌ Warning: Negative ρcore detected: -3.3924220245952054e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76543882092                   -0.87    9.7    9.27s
  2   -73.77632499528       -1.96       -1.07    5.3    5.38s
  3   -73.78263032462       -2.20       -1.42    6.8    6.93s
  4   -73.78365429111       -2.99       -1.77    5.8    5.75s
  5   -73.78380860482       -3.81       -2.23    5.0    5.34s
  6   -73.78383016028       -4.67       -3.07    5.5    5.85s
  7   -73.78383017880       -7.73       -3.50    5.0    5.58s
  8   -73.78383018313       -8.36       -4.07    4.3    4.89s
  9   -73.78383018294   +   -9.72       -4.42    5.4    5.78s
 10   -73.78383018343       -9.31       -4.78    5.4    5.60s
 11   -73.78383018346      -10.62       -5.57    4.6    5.96s
 12   -73.78383018346      -11.69       -6.35    4.6    5.82s
 13   -73.78383018346      -13.25       -6.59    4.8    5.94s
 14   -73.78383018346      -13.15       -6.95    5.1    6.19s
 15   -73.78383018346   +    -Inf       -7.79    5.2    5.72s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.3924220245952054e-8,-4.609167088528662e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.378383e+01     6.648836e-03
 * time: 245.02078914642334
┌ Warning: Negative ρcore detected: -3.135994455220115e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76650239397                   -0.88    9.8    9.64s
  2   -73.77678038683       -1.99       -1.08    5.3    5.78s
  3   -73.78279032270       -2.22       -1.42    6.8    7.19s
  4   -73.78381761758       -2.99       -1.79    5.8    5.98s
  5   -73.78395464140       -3.86       -2.27    5.0    6.38s
  6   -73.78397271798       -4.74       -3.09    5.6    6.82s
  7   -73.78397274941       -7.50       -3.56    4.4    5.53s
  8   -73.78397275845       -8.04       -4.04    5.2    5.79s
  9   -73.78397275786   +   -9.23       -4.49    5.6    6.44s
 10   -73.78397275875       -9.05       -4.79    5.6    7.33s
 11   -73.78397275879      -10.41       -5.47    5.0    5.61s
 12   -73.78397275880      -11.41       -6.21    4.8    5.63s
 13   -73.78397275880      -13.55       -6.35    4.8    5.69s
 14   -73.78397275880   +    -Inf       -6.92    5.2    5.54s
 15   -73.78397275880   +  -13.37       -7.78    5.0    5.77s
┌ Warning: Negative ρcore detected: -3.135994455220115e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76650217181                   -0.88    9.8    9.61s
  2   -73.77677792125       -1.99       -1.08    5.3    5.54s
  3   -73.78279009688       -2.22       -1.42    6.8    7.07s
  4   -73.78381762844       -2.99       -1.79    5.8    5.91s
  5   -73.78395505771       -3.86       -2.28    5.0    5.55s
  6   -73.78397271615       -4.75       -3.09    5.5    6.21s
  7   -73.78397275076       -7.46       -3.56    4.5    5.75s
  8   -73.78397275849       -8.11       -4.03    5.1    5.37s
  9   -73.78397275791   +   -9.24       -4.49    5.5    5.79s
 10   -73.78397275875       -9.08       -4.79    5.6    5.93s
 11   -73.78397275879      -10.40       -5.48    5.0    5.60s
 12   -73.78397275880      -11.44       -6.22    4.8    5.52s
 13   -73.78397275880      -13.00       -6.37    4.3    5.27s
 14   -73.78397275880   +  -13.37       -6.94    5.2    6.32s
 15   -73.78397275880      -13.25       -7.80    5.0    5.94s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.135994455220115e-8,-2.7199921787232504e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.378397e+01     2.817574e-04
 * time: 494.8192141056061
┌ Warning: Negative ρcore detected: -3.140197243476756e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76646659256                   -0.88    9.9    9.08s
  2   -73.77676974145       -1.99       -1.08    5.4    5.78s
  3   -73.78278837945       -2.22       -1.42    6.9    7.08s
  4   -73.78381770015       -2.99       -1.79    5.9    5.91s
  5   -73.78395415403       -3.87       -2.26    5.1    6.01s
  6   -73.78397296371       -4.73       -3.09    5.7    6.87s
  7   -73.78397299430       -7.51       -3.56    4.3    5.93s
  8   -73.78397300318       -8.05       -4.03    5.2    5.69s
  9   -73.78397300264   +   -9.27       -4.49    5.6    6.07s
 10   -73.78397300349       -9.07       -4.79    5.7    6.07s
 11   -73.78397300352      -10.42       -5.48    5.0    5.64s
 12   -73.78397300353      -11.39       -6.22    4.8    5.58s
 13   -73.78397300353   +  -13.00       -6.35    4.4    5.49s
 14   -73.78397300353      -12.85       -6.92    5.3    6.27s
 15   -73.78397300353      -13.55       -7.82    5.2    5.91s
┌ Warning: Negative ρcore detected: -3.140197243476756e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76646763411                   -0.88    9.9    10.2s
  2   -73.77676963779       -1.99       -1.08    5.3    6.45s
  3   -73.78278771049       -2.22       -1.42    6.8    7.65s
  4   -73.78381790272       -2.99       -1.79    5.9    6.01s
  5   -73.78395443179       -3.86       -2.27    5.0    5.87s
  6   -73.78397296338       -4.73       -3.09    5.7    7.35s
  7   -73.78397299487       -7.50       -3.56    4.4    5.42s
  8   -73.78397300323       -8.08       -4.04    5.3    5.61s
  9   -73.78397300263   +   -9.22       -4.50    5.6    6.21s
 10   -73.78397300349       -9.07       -4.80    5.7    6.47s
 11   -73.78397300352      -10.41       -5.49    5.0    5.50s
 12   -73.78397300353      -11.44       -6.22    4.8    5.46s
 13   -73.78397300353   +  -13.25       -6.35    4.6    5.45s
 14   -73.78397300353      -13.00       -6.93    5.2    5.60s
 15   -73.78397300353      -13.55       -7.79    4.9    5.90s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.140197243476756e-8,-1.9559998485817266e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.378397e+01     9.057112e-06
 * time: 747.0230040550232
┌ Warning: Negative ρcore detected: -3.1400870120442284e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76646121374                   -0.88    9.9    9.47s
  2   -73.77677457999       -1.99       -1.08    5.4    6.46s
  3   -73.78278925019       -2.22       -1.42    6.9    8.08s
  4   -73.78381707768       -2.99       -1.79    5.9    7.30s
  5   -73.78395464403       -3.86       -2.27    5.0    7.08s
  6   -73.78397296222       -4.74       -3.09    5.7    6.59s
  7   -73.78397299589       -7.47       -3.56    4.5    6.12s
  8   -73.78397300351       -8.12       -4.03    5.2    5.80s
  9   -73.78397300290   +   -9.22       -4.49    5.4    6.01s
 10   -73.78397300375       -9.07       -4.79    5.6    6.01s
 11   -73.78397300379      -10.42       -5.49    5.0    5.64s
 12   -73.78397300379      -11.49       -6.24    4.8    5.65s
 13   -73.78397300379      -13.00       -6.35    4.6    5.60s
 14   -73.78397300380      -12.94       -6.93    5.2    5.60s
 15   -73.78397300380      -13.55       -7.81    5.1    5.83s
┌ Warning: Negative ρcore detected: -3.1400870120442284e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.76646748202                   -0.88    9.9    9.66s
  2   -73.77676947858       -1.99       -1.08    5.5    6.64s
  3   -73.78279002136       -2.22       -1.42    6.9    7.38s
  4   -73.78381721211       -2.99       -1.79    6.0    6.05s
  5   -73.78395425059       -3.86       -2.26    5.0    5.92s
  6   -73.78397296430       -4.73       -3.09    5.7    6.10s
  7   -73.78397299442       -7.52       -3.56    4.4    5.19s
  8   -73.78397300346       -8.04       -4.03    5.3    5.89s
  9   -73.78397300289   +   -9.25       -4.49    5.6    6.53s
 10   -73.78397300375       -9.06       -4.80    5.7    5.99s
 11   -73.78397300379      -10.42       -5.48    5.1    5.55s
 12   -73.78397300379      -11.42       -6.21    4.8    5.56s
 13   -73.78397300379      -13.07       -6.33    4.8    5.52s
 14   -73.78397300380      -13.07       -6.92    5.2    5.50s
 15   -73.78397300380      -13.25       -7.78    5.2    5.76s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1400870120442284e-8,-1.9796334363624317e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     4    -7.378397e+01     1.064289e-08
 * time: 1000.0031261444092
 * Status: success

 * Candidate solution
    Final objective value:     -7.378397e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 5.60e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 9.91e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.67e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.62e-12 ≰ 0.0e+00
    |g(x)|                 = 1.06e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   1000  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

V: 1133.409879 seconds (762.16 M allocations: 366.162 GiB, 5.93% gc time, 0.01% compilation time)
