┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-12T19:06:35.156
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.451393300724                   -0.96    6.8    11.9s
  2   -8.453041104911       -2.78       -1.75    1.7    4.74s
  3   -8.453118948506       -4.11       -2.76    3.9    1.98s
  4   -8.453121470016       -5.60       -3.59    4.7    1.83s
  5   -8.453121557674       -7.06       -4.41    4.8    2.01s
  6   -8.453121561002       -8.48       -5.35    5.1    2.16s
  7   -8.453121561030      -10.55       -6.35    4.4    1.70s
  8   -8.453121561031      -12.66       -7.15    4.3    2.27s
Iter     Function value   Gradient norm 
     0    -8.453122e+00     1.345886e-03
 * time: 5.1975250244140625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.451397636608                   -0.96    7.0    2.95s
  2   -8.453040633627       -2.78       -1.75    2.0    1.44s
  3   -8.453120954377       -4.10       -2.76    3.8    2.04s
  4   -8.453123218041       -5.65       -3.61    4.8    2.09s
  5   -8.453123306591       -7.05       -4.35    4.8    1.75s
  6   -8.453123310298       -8.43       -5.27    5.1    2.02s
  7   -8.453123310337      -10.40       -6.10    4.3    1.72s
  8   -8.453123310338      -12.48       -7.13    3.9    1.89s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.451406612092                   -0.96    7.1    2.52s
  2   -8.453044355508       -2.79       -1.75    1.8    1.75s
  3   -8.453120956493       -4.12       -2.76    3.8    1.90s
  4   -8.453123219308       -5.65       -3.61    4.7    2.04s
  5   -8.453123306834       -7.06       -4.38    4.8    1.76s
  6   -8.453123310300       -8.46       -5.32    5.0    2.61s
  7   -8.453123310337      -10.43       -6.11    4.4    2.27s
  8   -8.453123310338      -12.54       -7.16    3.9    2.12s
     1    -8.453123e+00     1.253571e-03
 * time: 46.19778800010681
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.451385130300                   -0.96    7.1    2.90s
  2   -8.453053895768       -2.78       -1.75    2.0    1.45s
  3   -8.453132358192       -4.11       -2.76    3.9    2.05s
  4   -8.453134609303       -5.65       -3.61    4.6    1.85s
  5   -8.453134685980       -7.12       -4.35    4.7    2.02s
  6   -8.453134689721       -8.43       -5.32    5.0    1.81s
  7   -8.453134689753      -10.50       -6.15    4.4    2.41s
  8   -8.453134689753      -12.62       -7.05    3.9    1.61s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.451369066554                   -0.96    7.2    2.64s
  2   -8.453053576684       -2.77       -1.75    1.8    1.13s
  3   -8.453132481398       -4.10       -2.76    3.8    1.98s
  4   -8.453134611008       -5.67       -3.61    4.6    1.83s
  5   -8.453134686047       -7.12       -4.36    4.8    2.08s
  6   -8.453134689721       -8.43       -5.35    5.3    1.88s
  7   -8.453134689753      -10.50       -6.16    4.3    2.09s
  8   -8.453134689753      -12.59       -7.05    4.0    1.63s
     2    -8.453135e+00     1.199856e-05
 * time: 90.52068185806274
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.451388997503                   -0.96    7.7    2.93s
  2   -8.453056680263       -2.78       -1.75    2.3    1.51s
  3   -8.453132632461       -4.12       -2.76    4.0    1.71s
  4   -8.453134611276       -5.70       -3.63    5.0    2.68s
  5   -8.453134687018       -7.12       -4.34    5.1    2.56s
  6   -8.453134690750       -8.43       -5.31    5.1    2.47s
  7   -8.453134690783      -10.49       -6.10    4.6    2.16s
  8   -8.453134690783      -12.56       -7.10    3.9    1.89s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.451389777265                   -0.96    7.6    2.75s
  2   -8.453054926376       -2.78       -1.75    2.2    1.54s
  3   -8.453132533477       -4.11       -2.76    4.0    1.85s
  4   -8.453134612126       -5.68       -3.62    4.8    2.13s
  5   -8.453134687045       -7.13       -4.35    5.0    1.85s
  6   -8.453134690755       -8.43       -5.33    5.2    2.10s
  7   -8.453134690783      -10.55       -6.15    4.6    1.85s
  8   -8.453134690783      -12.59       -7.06    4.0    1.92s
     3    -8.453135e+00     1.044255e-07
 * time: 136.66549682617188
 * Status: success

 * Candidate solution
    Final objective value:     -8.453135e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.73e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.68e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.03e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.22e-10 ≰ 0.0e+00
    |g(x)|                 = 1.04e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   137  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 215.104092 seconds (309.93 M allocations: 59.982 GiB, 7.40% gc time, 25.68% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-12T19:10:10.990
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.21175166515                   -1.13    8.5    19.5s
  2   -62.21714439421       -2.27       -1.22    2.6    7.63s
  3   -62.22107589494       -2.41       -2.04    3.7    8.85s
  4   -62.22112341673       -4.32       -2.84    3.1    8.55s
  5   -62.22112420553       -6.10       -3.41    4.0    10.6s
  6   -62.22112445420       -6.60       -4.05    3.6    9.74s
  7   -62.22112445883       -8.33       -4.58    3.8    9.93s
  8   -62.22112445917       -9.47       -6.20    3.7    11.8s
  9   -62.22112445917      -11.48       -6.38    4.9    12.0s
 10   -62.22112445917      -12.97       -7.84    3.6    9.43s
Iter     Function value   Gradient norm 
     0    -6.222112e+01     4.711621e-03
 * time: 3.910064697265625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.21175832500                   -1.13    8.8    16.9s
  2   -62.21714341975       -2.27       -1.22    2.7    7.16s
  3   -62.22109824152       -2.40       -2.04    3.8    9.72s
  4   -62.22114538091       -4.33       -2.83    3.1    9.39s
  5   -62.22114617545       -6.10       -3.40    3.9    11.1s
  6   -62.22114642659       -6.60       -4.07    3.6    10.7s
  7   -62.22114643117       -8.34       -4.65    3.9    11.0s
  8   -62.22114643143       -9.60       -6.18    3.7    11.6s
  9   -62.22114643143      -11.49       -6.52    4.8    12.2s
 10   -62.22114643143      -13.30       -7.84    3.7    9.94s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.21176136247                   -1.13    8.9    18.8s
  2   -62.21714835126       -2.27       -1.22    2.7    10.3s
  3   -62.22109811993       -2.40       -2.04    3.8    10.4s
  4   -62.22114539914       -4.33       -2.85    3.2    8.63s
  5   -62.22114618252       -6.11       -3.41    3.9    10.5s
  6   -62.22114642651       -6.61       -4.06    3.6    10.5s
  7   -62.22114643111       -8.34       -4.59    4.0    10.9s
  8   -62.22114643143       -9.50       -6.20    3.7    10.1s
  9   -62.22114643143      -11.47       -6.42    5.1    13.7s
 10   -62.22114643143      -12.97       -7.81    3.9    9.71s
     1    -6.222115e+01     4.615269e-03
 * time: 257.47835302352905
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.21137973964                   -1.12    8.8    21.5s
  2   -62.21692251298       -2.26       -1.19    2.8    9.42s
  3   -62.22164248470       -2.33       -2.01    3.8    12.0s
  4   -62.22170046358       -4.24       -2.87    2.7    11.5s
  5   -62.22170133757       -6.06       -3.46    3.9    14.8s
  6   -62.22170159918       -6.58       -4.10    3.5    11.8s
  7   -62.22170160395       -8.32       -4.63    3.8    12.6s
  8   -62.22170160425       -9.51       -6.11    3.5    13.1s
  9   -62.22170160426      -11.29       -6.48    4.8    14.6s
 10   -62.22170160426      -13.19       -7.78    3.3    11.8s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.21137760673                   -1.12    8.7    21.7s
  2   -62.21691455452       -2.26       -1.19    2.7    10.7s
  3   -62.22164294271       -2.33       -2.01    3.7    11.6s
  4   -62.22170048692       -4.24       -2.92    2.8    9.76s
  5   -62.22170136865       -6.05       -3.52    4.0    12.4s
  6   -62.22170160001       -6.64       -4.17    3.5    11.3s
  7   -62.22170160395       -8.41       -4.65    3.9    14.4s
  8   -62.22170160425       -9.51       -6.17    3.5    11.8s
  9   -62.22170160426      -11.35       -6.32    4.9    17.2s
 10   -62.22170160426      -12.69       -7.87    3.3    12.9s
     2    -6.222170e+01     4.722451e-04
 * time: 561.3163459300995
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.21127357755                   -1.12    8.2    21.8s
  2   -62.21687490081       -2.25       -1.19    2.6    9.67s
  3   -62.22164630404       -2.32       -2.00    3.5    11.3s
  4   -62.22170708851       -4.22       -2.81    3.0    10.6s
  5   -62.22170804853       -6.02       -3.37    3.8    13.3s
  6   -62.22170835141       -6.52       -4.00    3.5    11.3s
  7   -62.22170835754       -8.21       -4.52    3.9    12.9s
  8   -62.22170835802       -9.32       -6.11    3.5    13.2s
  9   -62.22170835802      -11.22       -6.38    4.9    15.4s
 10   -62.22170835802      -13.15       -7.71    3.3    10.9s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.21127008439                   -1.12    8.2    20.2s
  2   -62.21687005657       -2.25       -1.19    2.6    8.75s
  3   -62.22164687379       -2.32       -2.00    3.6    11.3s
  4   -62.22170711796       -4.22       -2.81    2.8    10.0s
  5   -62.22170805157       -6.03       -3.37    3.8    13.8s
  6   -62.22170835157       -6.52       -4.01    3.5    12.2s
  7   -62.22170835764       -8.22       -4.56    3.9    12.4s
  8   -62.22170835802       -9.42       -6.06    3.5    12.3s
  9   -62.22170835802      -11.22       -6.29    4.8    14.9s
 10   -62.22170835802      -13.15       -7.72    2.9    10.3s
     3    -6.222171e+01     5.452916e-05
 * time: 857.2061340808868
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.21125435081                   -1.12    8.6    21.1s
  2   -62.21684124453       -2.25       -1.19    2.5    8.79s
  3   -62.22164711220       -2.32       -2.00    3.7    10.9s
  4   -62.22170719744       -4.22       -2.84    2.8    10.1s
  5   -62.22170815921       -6.02       -3.40    3.9    12.3s
  6   -62.22170844439       -6.54       -4.01    3.4    11.3s
  7   -62.22170845022       -8.23       -4.49    3.9    14.5s
  8   -62.22170845079       -9.25       -6.01    3.4    11.8s
  9   -62.22170845080      -11.15       -6.43    4.8    15.1s
 10   -62.22170845080      -12.89       -7.81    3.4    12.8s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.21125832690                   -1.12    8.6    21.8s
  2   -62.21687025079       -2.25       -1.19    2.5    9.11s
  3   -62.22164657676       -2.32       -2.00    3.7    12.6s
  4   -62.22170721153       -4.22       -2.82    3.0    11.1s
  5   -62.22170814455       -6.03       -3.37    4.0    14.2s
  6   -62.22170844423       -6.52       -3.99    3.5    11.8s
  7   -62.22170845034       -8.21       -4.52    3.8    12.1s
  8   -62.22170845079       -9.34       -5.99    3.5    12.3s
  9   -62.22170845080      -11.14       -6.28    4.8    14.7s
 10   -62.22170845080      -12.92       -7.72    3.1    10.4s
     4    -6.222171e+01     7.498750e-07
 * time: 1152.865338087082
 * Status: success

 * Candidate solution
    Final objective value:     -6.222171e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.36e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.05e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 9.28e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.49e-09 ≰ 0.0e+00
    |g(x)|                 = 7.50e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   1153  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

NaCl: 1286.075011 seconds (1.15 G allocations: 326.555 GiB, 4.90% gc time, 0.26% compilation time)
┌ Info: 2025-05-12T19:31:37.134
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315726423613                   -1.46    5.5    2.62s
  2   -2.315812822494       -4.06       -1.84    1.4    877ms
  3   -2.315832593836       -4.70       -3.58    3.3    1.88s
  4   -2.315832816881       -6.65       -4.16    4.6    2.22s
  5   -2.315832817222       -9.47       -4.61    2.5    1.54s
  6   -2.315832817280      -10.24       -5.29    2.8    1.22s
  7   -2.315832817282      -11.66       -5.92    2.9    1.60s
  8   -2.315832817282      -13.49       -6.50    2.2    1.03s
  9   -2.315832817282      -14.65       -7.51    2.4    1.10s
Iter     Function value   Gradient norm 
     0    -2.315833e+00     1.159987e-03
 * time: 4.00543212890625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315727614745                   -1.46    5.5    1.90s
  2   -2.315813784275       -4.06       -1.84    1.4    1.18s
  3   -2.315833859687       -4.70       -3.59    3.3    1.44s
  4   -2.315834135318       -6.56       -4.15    4.6    2.05s
  5   -2.315834135671       -9.45       -4.60    2.6    1.13s
  6   -2.315834135730      -10.23       -5.28    2.8    1.46s
  7   -2.315834135732      -11.60       -5.89    2.9    1.20s
  8   -2.315834135732      -13.36       -6.50    2.3    1.10s
  9   -2.315834135732      -14.45       -7.38    2.5    1.36s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315730740947                   -1.46    5.5    2.22s
  2   -2.315813890513       -4.08       -1.84    1.4    856ms
  3   -2.315833915016       -4.70       -3.57    3.3    1.72s
  4   -2.315834135300       -6.66       -4.14    4.6    1.83s
  5   -2.315834135671       -9.43       -4.60    2.5    1.47s
  6   -2.315834135730      -10.23       -5.28    2.9    1.23s
  7   -2.315834135732      -11.61       -5.88    2.9    1.59s
  8   -2.315834135732      -13.36       -6.48    2.3    1.09s
  9   -2.315834135732      -14.45       -7.44    2.4    1.12s
     1    -2.315834e+00     1.113238e-03
 * time: 57.6601779460907
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315749578030                   -1.45    5.5    1.94s
  2   -2.315830686828       -4.09       -1.83    1.4    1.18s
  3   -2.315849328672       -4.73       -3.56    3.3    1.39s
  4   -2.315849568232       -6.62       -4.12    4.6    2.26s
  5   -2.315849568621       -9.41       -4.60    2.6    1.18s
  6   -2.315849568677      -10.25       -5.40    2.8    1.55s
  7   -2.315849568679      -11.70       -5.93    3.2    1.55s
  8   -2.315849568679      -13.49       -6.64    2.1    1.38s
  9   -2.315849568679      -14.88       -7.28    2.8    1.56s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315750676913                   -1.45    5.5    2.35s
  2   -2.315830520028       -4.10       -1.83    1.4    1.03s
  3   -2.315849336506       -4.73       -3.55    3.3    1.68s
  4   -2.315849568193       -6.64       -4.10    4.6    1.86s
  5   -2.315849568615       -9.37       -4.58    2.6    1.71s
  6   -2.315849568677      -10.21       -5.33    2.8    1.26s
  7   -2.315849568679      -11.61       -5.79    3.2    1.86s
  8   -2.315849568679      -13.20       -6.50    2.2    1.14s
  9   -2.315849568679      -14.57       -7.09    2.6    1.11s
     2    -2.315850e+00     1.994134e-08
 * time: 116.74058294296265
 * Status: success

 * Candidate solution
    Final objective value:     -2.315850e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.76e-02 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.63e-03 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.54e-05 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 6.66e-06 ≰ 0.0e+00
    |g(x)|                 = 1.99e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   117  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Al: 151.952470 seconds (113.85 M allocations: 27.000 GiB, 6.35% gc time, 0.00% compilation time)
┌ Info: 2025-05-12T19:34:09.087
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.75195585274                   -0.88    9.6    9.83s
  2   -73.76274163171       -1.97       -1.08    5.3    5.62s
  3   -73.76877456112       -2.22       -1.43    6.9    7.95s
  4   -73.76973713823       -3.02       -1.79    5.7    6.58s
  5   -73.76987927227       -3.85       -2.25    5.0    6.08s
  6   -73.76989903409       -4.70       -3.10    5.5    6.51s
  7   -73.76989905971       -7.59       -3.52    4.4    5.81s
  8   -73.76989906251       -8.55       -4.08    4.4    6.20s
  9   -73.76989906278       -9.57       -4.65    3.9    4.99s
 10   -73.76989906298       -9.70       -4.87    5.5    5.93s
 11   -73.76989906299      -10.88       -5.82    4.6    5.27s
 12   -73.76989906299      -12.53       -6.47    4.8    5.70s
 13   -73.76989906299   +    -Inf       -6.64    4.1    4.96s
 14   -73.76989906299      -13.55       -7.05    4.9    5.34s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.376990e+01     3.372493e-03
 * time: 4.696846008300781e-5
┌ Warning: Negative ρcore detected: -3.4086038500130065e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.75203090686                   -0.88    9.7    9.31s
  2   -73.76277203742       -1.97       -1.09    5.4    5.98s
  3   -73.76878815386       -2.22       -1.43    6.7    7.43s
  4   -73.76974617471       -3.02       -1.79    5.7    6.12s
  5   -73.76988937559       -3.84       -2.24    5.1    6.04s
  6   -73.76990954838       -4.70       -3.09    5.6    6.78s
  7   -73.76990957548       -7.57       -3.51    4.5    6.32s
  8   -73.76990957830       -8.55       -4.07    4.2    5.13s
  9   -73.76990957860       -9.52       -4.60    3.9    5.19s
 10   -73.76990957879       -9.73       -4.82    5.3    5.77s
 11   -73.76990957881      -10.78       -5.79    4.6    5.24s
 12   -73.76990957881      -12.49       -6.45    4.9    6.25s
 13   -73.76990957881      -13.55       -6.68    4.5    5.33s
 14   -73.76990957881      -13.00       -7.18    5.1    5.37s
┌ Warning: Negative ρcore detected: -3.4086038500130065e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.75202717883                   -0.88    9.6    9.49s
  2   -73.76277445382       -1.97       -1.09    5.4    5.60s
  3   -73.76878894357       -2.22       -1.43    6.8    7.23s
  4   -73.76974626464       -3.02       -1.79    5.7    5.95s
  5   -73.76988930349       -3.84       -2.24    5.1    5.72s
  6   -73.76990954867       -4.69       -3.09    5.5    7.20s
  7   -73.76990957541       -7.57       -3.52    4.5    6.11s
  8   -73.76990957834       -8.53       -4.07    4.4    5.74s
  9   -73.76990957857       -9.63       -4.63    3.9    5.26s
 10   -73.76990957879       -9.66       -4.86    5.4    5.93s
 11   -73.76990957881      -10.80       -5.78    4.6    5.21s
 12   -73.76990957881      -12.70       -6.45    4.6    5.47s
 13   -73.76990957881      -13.00       -6.55    4.2    5.06s
 14   -73.76990957881   +  -13.15       -6.95    4.8    5.77s
 15   -73.76990957881   +    -Inf       -7.97    4.8    5.43s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4086038500130065e-8,-2.6696021197689714e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.376991e+01     2.863337e-03
 * time: 241.99092197418213
┌ Warning: Negative ρcore detected: -3.277362977577975e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.75245817735                   -0.88    9.6    9.17s
  2   -73.76281310516       -1.98       -1.09    5.3    5.63s
  3   -73.76884106134       -2.22       -1.44    6.9    6.88s
  4   -73.76976649580       -3.03       -1.79    5.7    6.16s
  5   -73.76991547193       -3.83       -2.23    5.1    5.56s
  6   -73.76993644633       -4.68       -3.07    5.5    5.87s
  7   -73.76993646604       -7.71       -3.48    4.7    5.99s
  8   -73.76993646948       -8.46       -4.07    3.3    4.73s
  9   -73.76993646958      -10.01       -4.43    4.8    5.61s
 10   -73.76993646969       -9.93       -4.75    4.5    4.88s
 11   -73.76993646972      -10.57       -5.56    4.7    5.78s
 12   -73.76993646972      -11.64       -6.25    4.5    5.52s
 13   -73.76993646972      -12.81       -6.62    5.0    5.74s
 14   -73.76993646972   +  -13.37       -6.85    5.4    5.67s
 15   -73.76993646972      -13.85       -7.92    5.1    5.46s
┌ Warning: Negative ρcore detected: -3.277362977577975e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.75244573500                   -0.88    9.7    9.25s
  2   -73.76281383970       -1.98       -1.09    5.3    5.48s
  3   -73.76884262963       -2.22       -1.44    6.9    7.81s
  4   -73.76976637108       -3.03       -1.79    5.7    6.10s
  5   -73.76991560866       -3.83       -2.23    5.0    6.27s
  6   -73.76993644460       -4.68       -3.07    5.6    6.39s
  7   -73.76993646626       -7.66       -3.49    5.0    5.61s
  8   -73.76993646950       -8.49       -4.09    3.2    4.27s
  9   -73.76993646953      -10.51       -4.45    5.0    5.55s
 10   -73.76993646970       -9.78       -4.77    4.8    4.99s
 11   -73.76993646972      -10.65       -5.56    4.5    4.90s
 12   -73.76993646972      -11.65       -6.26    4.7    5.36s
 13   -73.76993646972      -13.15       -6.65    5.1    6.22s
 14   -73.76993646972      -13.37       -6.99    5.4    6.20s
 15   -73.76993646972   +  -13.85       -7.94    5.3    5.57s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.277362977577975e-8,-1.135373346795061e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.376994e+01     3.954285e-05
 * time: 487.84381198883057
┌ Warning: Negative ρcore detected: -3.2802799762893067e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.75244701584                   -0.88    9.6    9.14s
  2   -73.76281511228       -1.98       -1.09    5.2    5.65s
  3   -73.76883978798       -2.22       -1.44    6.8    6.97s
  4   -73.76976702894       -3.03       -1.79    5.7    5.98s
  5   -73.76991574336       -3.83       -2.23    5.1    5.89s
  6   -73.76993644959       -4.68       -3.07    5.5    5.95s
  7   -73.76993647124       -7.66       -3.49    5.0    5.48s
  8   -73.76993647453       -8.48       -4.08    3.4    4.94s
  9   -73.76993647458      -10.33       -4.45    5.0    5.77s
 10   -73.76993647475       -9.77       -4.77    4.8    5.11s
 11   -73.76993647477      -10.64       -5.56    4.5    5.00s
 12   -73.76993647478      -11.66       -6.26    4.6    5.36s
 13   -73.76993647478      -13.25       -6.65    5.1    5.69s
 14   -73.76993647478      -13.15       -6.99    5.4    5.61s
 15   -73.76993647478   +  -13.07       -7.97    5.2    5.80s
┌ Warning: Negative ρcore detected: -3.2802799762893067e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.75245199681                   -0.88    9.7    10.0s
  2   -73.76282092305       -1.98       -1.09    5.3    5.69s
  3   -73.76884047168       -2.22       -1.44    6.8    7.18s
  4   -73.76976643553       -3.03       -1.79    5.8    5.94s
  5   -73.76991561635       -3.83       -2.23    5.0    6.43s
  6   -73.76993645155       -4.68       -3.07    5.5    6.43s
  7   -73.76993647106       -7.71       -3.48    4.7    5.80s
  8   -73.76993647452       -8.46       -4.07    3.5    5.05s
  9   -73.76993647463       -9.99       -4.45    4.7    5.56s
 10   -73.76993647475       -9.92       -4.77    4.7    5.12s
 11   -73.76993647477      -10.58       -5.57    4.6    5.28s
 12   -73.76993647478      -11.69       -6.25    4.6    5.62s
 13   -73.76993647478      -13.07       -6.63    4.9    5.72s
 14   -73.76993647478      -13.85       -7.00    5.4    5.84s
 15   -73.76993647478   +  -13.37       -7.97    5.4    5.79s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.2802799762893067e-8,-1.1228066883096153e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.376994e+01     4.979320e-07
 * time: 731.2021050453186
 * Status: success

 * Candidate solution
    Final objective value:     -7.376994e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.58e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.55e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 5.05e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 6.85e-11 ≰ 0.0e+00
    |g(x)|                 = 4.98e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   731  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

V: 861.004020 seconds (581.17 M allocations: 275.084 GiB, 6.21% gc time, 0.01% compilation time)
