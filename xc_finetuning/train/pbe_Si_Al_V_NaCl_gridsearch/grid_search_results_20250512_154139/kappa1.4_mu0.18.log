┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-12T19:05:02.796
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.447071892861                   -0.96    7.0    11.5s
  2   -8.448738538896       -2.78       -1.75    1.8    4.90s
  3   -8.448817057844       -4.11       -2.77    3.8    1.68s
  4   -8.448819267055       -5.66       -3.61    4.8    2.06s
  5   -8.448819346998       -7.10       -4.39    4.7    2.08s
  6   -8.448819350120       -8.51       -5.34    5.1    1.85s
  7   -8.448819350148      -10.56       -6.18    4.3    2.04s
  8   -8.448819350148      -12.59       -7.10    3.9    2.02s
Iter     Function value   Gradient norm 
     0    -8.448819e+00     2.022878e-03
 * time: 4.792213439941406e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.447083421715                   -0.96    7.3    3.03s
  2   -8.448742191682       -2.78       -1.75    2.0    1.70s
  3   -8.448821206879       -4.10       -2.77    3.9    1.73s
  4   -8.448823219336       -5.70       -3.62    4.8    2.17s
  5   -8.448823298416       -7.10       -4.34    4.9    1.84s
  6   -8.448823301939       -8.45       -5.27    5.1    2.09s
  7   -8.448823301975      -10.44       -6.16    4.4    1.76s
  8   -8.448823301975      -12.61       -7.12    3.7    2.10s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.447087334314                   -0.96    7.3    2.64s
  2   -8.448742021959       -2.78       -1.75    2.1    1.45s
  3   -8.448821125687       -4.10       -2.77    4.0    1.70s
  4   -8.448823220660       -5.68       -3.62    4.7    2.13s
  5   -8.448823298580       -7.11       -4.37    4.9    1.82s
  6   -8.448823301944       -8.47       -5.32    5.1    2.10s
  7   -8.448823301975      -10.51       -6.16    4.5    1.85s
  8   -8.448823301975      -12.64       -7.13    3.8    1.98s
     1    -8.448823e+00     1.884199e-03
 * time: 46.54022288322449
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.447051663043                   -0.96    7.0    2.52s
  2   -8.448765216652       -2.77       -1.75    1.9    1.12s
  3   -8.448846815752       -4.09       -2.76    3.7    1.90s
  4   -8.448848869225       -5.69       -3.63    4.7    2.05s
  5   -8.448848935885       -7.18       -4.33    4.7    1.75s
  6   -8.448848939424       -8.45       -5.27    4.9    2.02s
  7   -8.448848939457      -10.48       -6.07    4.2    1.78s
  8   -8.448848939458      -12.53       -7.12    3.7    1.90s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.447048393146                   -0.96    6.9    2.88s
  2   -8.448763492223       -2.77       -1.75    1.8    1.57s
  3   -8.448846508617       -4.08       -2.77    3.8    1.63s
  4   -8.448848869631       -5.63       -3.61    4.7    2.08s
  5   -8.448848935945       -7.18       -4.36    4.7    1.75s
  6   -8.448848939430       -8.46       -5.31    4.9    2.15s
  7   -8.448848939457      -10.57       -6.20    4.4    1.94s
  8   -8.448848939458      -12.73       -7.08    3.8    2.09s
     2    -8.448849e+00     2.700149e-05
 * time: 90.9096999168396
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.447061058091                   -0.96    7.4    2.71s
  2   -8.448765442053       -2.77       -1.75    2.0    1.17s
  3   -8.448846995831       -4.09       -2.77    4.0    2.13s
  4   -8.448848874619       -5.73       -3.63    4.8    2.52s
  5   -8.448848941066       -7.18       -4.35    4.8    2.49s
  6   -8.448848944599       -8.45       -5.30    5.0    2.05s
  7   -8.448848944630      -10.51       -6.14    4.3    1.78s
  8   -8.448848944630      -12.67       -7.16    3.8    2.31s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.447061926071                   -0.96    7.4    3.07s
  2   -8.448768753168       -2.77       -1.75    2.2    1.86s
  3   -8.448846950939       -4.11       -2.77    3.9    2.26s
  4   -8.448848873531       -5.72       -3.63    4.9    2.43s
  5   -8.448848941361       -7.17       -4.37    4.8    1.79s
  6   -8.448848944607       -8.49       -5.33    5.2    2.07s
  7   -8.448848944630      -10.63       -6.26    4.5    1.76s
  8   -8.448848944630      -12.79       -7.08    4.0    1.88s
     3    -8.448849e+00     3.522608e-07
 * time: 137.8021697998047
 * Status: success

 * Candidate solution
    Final objective value:     -8.448849e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.88e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.76e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 5.17e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 6.12e-10 ≰ 0.0e+00
    |g(x)|                 = 3.52e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   138  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 217.072921 seconds (310.10 M allocations: 59.711 GiB, 7.42% gc time, 25.88% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-12T19:08:40.548
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18248849449                   -1.14    8.5    21.9s
  2   -62.18766016914       -2.29       -1.23    2.5    9.16s
  3   -62.19152203218       -2.41       -2.05    3.8    9.36s
  4   -62.19156779534       -4.34       -2.87    3.2    8.55s
  5   -62.19156854105       -6.13       -3.44    3.9    10.8s
  6   -62.19156877342       -6.63       -4.12    3.6    11.0s
  7   -62.19156877710       -8.43       -4.65    3.9    12.5s
  8   -62.19156877735       -9.60       -6.23    3.7    12.5s
  9   -62.19156877735      -11.56       -6.78    4.9    12.7s
 10   -62.19156877735      -12.87       -7.60    4.0    9.59s
Iter     Function value   Gradient norm 
     0    -6.219157e+01     4.163064e-03
 * time: 3.910064697265625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18249348848                   -1.14    8.6    18.1s
  2   -62.18768568585       -2.28       -1.23    2.6    8.31s
  3   -62.19153822624       -2.41       -2.04    3.7    9.26s
  4   -62.19158485356       -4.33       -2.82    3.2    9.06s
  5   -62.19158566430       -6.09       -3.36    3.9    10.1s
  6   -62.19158592934       -6.58       -4.04    3.6    9.84s
  7   -62.19158593383       -8.35       -4.60    3.9    10.4s
  8   -62.19158593415       -9.50       -6.21    3.7    11.2s
  9   -62.19158593415      -11.52       -6.45    4.9    14.0s
 10   -62.19158593415      -12.92       -7.78    3.6    10.3s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18249306939                   -1.14    8.6    18.6s
  2   -62.18768224948       -2.28       -1.23    2.8    7.33s
  3   -62.19153858399       -2.41       -2.04    3.9    9.26s
  4   -62.19158488916       -4.33       -2.84    3.1    8.53s
  5   -62.19158567648       -6.10       -3.39    3.9    10.1s
  6   -62.19158592959       -6.60       -4.06    3.7    9.74s
  7   -62.19158593383       -8.37       -4.58    3.9    11.0s
  8   -62.19158593415       -9.50       -6.21    3.8    11.3s
  9   -62.19158593415      -11.50       -6.34    5.0    13.8s
 10   -62.19158593415      -13.00       -7.74    3.5    9.21s
     1    -6.219159e+01     4.079358e-03
 * time: 254.60725808143616
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18211566618                   -1.13    8.2    18.1s
  2   -62.18746596346       -2.27       -1.20    2.5    8.09s
  3   -62.19196651654       -2.35       -2.01    3.4    10.4s
  4   -62.19202270796       -4.25       -2.82    3.0    9.92s
  5   -62.19202359685       -6.05       -3.37    3.8    12.2s
  6   -62.19202388738       -6.54       -4.04    3.5    10.1s
  7   -62.19202389241       -8.30       -4.59    3.8    10.9s
  8   -62.19202389273       -9.49       -6.16    3.7    10.4s
  9   -62.19202389273      -11.36       -6.41    5.0    13.8s
 10   -62.19202389273      -13.19       -7.77    3.6    12.5s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18211221522                   -1.13    8.3    19.5s
  2   -62.18747586752       -2.27       -1.20    2.4    7.53s
  3   -62.19196603012       -2.35       -2.01    3.5    11.3s
  4   -62.19202268598       -4.25       -2.83    2.7    8.47s
  5   -62.19202359579       -6.04       -3.38    3.9    12.4s
  6   -62.19202388693       -6.54       -4.06    3.4    10.5s
  7   -62.19202389238       -8.26       -4.62    3.8    12.5s
  8   -62.19202389273       -9.46       -5.93    3.4    10.5s
  9   -62.19202389273      -11.21       -6.31    4.6    12.9s
 10   -62.19202389273   +  -13.55       -7.80    3.1    9.27s
     2    -6.219202e+01     3.798584e-04
 * time: 522.8636140823364
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18203213454                   -1.13    8.6    18.9s
  2   -62.18738686655       -2.27       -1.20    2.6    9.64s
  3   -62.19197027697       -2.34       -2.01    3.6    11.8s
  4   -62.19202707330       -4.25       -2.85    2.9    9.23s
  5   -62.19202796908       -6.05       -3.42    4.0    12.3s
  6   -62.19202824444       -6.56       -4.08    3.5    9.93s
  7   -62.19202824914       -8.33       -4.56    3.8    11.1s
  8   -62.19202824953       -9.41       -6.06    3.5    10.3s
  9   -62.19202824954      -11.26       -6.43    4.7    14.6s
 10   -62.19202824954      -12.89       -7.72    3.1    9.22s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18203451584                   -1.13    8.4    18.7s
  2   -62.18739683609       -2.27       -1.20    2.5    7.94s
  3   -62.19196997033       -2.34       -2.01    3.5    10.4s
  4   -62.19202708146       -4.24       -2.84    3.0    9.33s
  5   -62.19202796412       -6.05       -3.40    3.9    10.9s
  6   -62.19202824471       -6.55       -4.06    3.5    10.0s
  7   -62.19202824919       -8.35       -4.57    4.0    11.3s
  8   -62.19202824953       -9.47       -6.15    3.7    10.6s
  9   -62.19202824954      -11.35       -6.36    4.9    13.5s
 10   -62.19202824954      -12.66       -7.73    3.8    10.3s
     3    -6.219203e+01     3.956415e-05
 * time: 792.526515007019
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18202029757                   -1.13    9.1    22.6s
  2   -62.18737998327       -2.27       -1.20    2.7    8.84s
  3   -62.19196990788       -2.34       -2.01    3.7    10.4s
  4   -62.19202710208       -4.24       -2.84    2.8    8.55s
  5   -62.19202800990       -6.04       -3.40    3.9    11.2s
  6   -62.19202829249       -6.55       -4.05    3.4    10.2s
  7   -62.19202829759       -8.29       -4.55    3.9    11.7s
  8   -62.19202829799       -9.39       -6.09    3.5    10.1s
  9   -62.19202829800      -11.25       -6.49    4.8    13.0s
 10   -62.19202829800      -13.03       -7.64    3.2    9.29s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.18202053506                   -1.13    9.1    20.0s
  2   -62.18738273660       -2.27       -1.20    2.8    8.49s
  3   -62.19196980650       -2.34       -2.01    3.7    12.2s
  4   -62.19202712323       -4.24       -2.83    2.9    9.71s
  5   -62.19202800802       -6.05       -3.40    3.9    11.3s
  6   -62.19202829271       -6.55       -4.07    3.6    10.0s
  7   -62.19202829770       -8.30       -4.62    3.9    11.1s
  8   -62.19202829799       -9.53       -6.16    3.8    11.5s
  9   -62.19202829800      -11.35       -6.39    4.8    14.7s
 10   -62.19202829800      -12.83       -7.75    3.7    10.1s
     4    -6.219203e+01     4.494532e-07
 * time: 1068.6771681308746
 * Status: success

 * Candidate solution
    Final objective value:     -6.219203e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.42e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.21e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 4.85e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 7.79e-10 ≰ 0.0e+00
    |g(x)|                 = 4.49e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   1069  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

NaCl: 1215.020840 seconds (1.16 G allocations: 328.662 GiB, 5.33% gc time, 0.29% compilation time)
┌ Info: 2025-05-12T19:28:55.604
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315125354661                   -1.45    5.5    1.91s
  2   -2.315218743778       -4.03       -1.84    1.4    966ms
  3   -2.315240653359       -4.66       -3.56    3.3    1.56s
  4   -2.315240870570       -6.66       -4.17    4.6    2.27s
  5   -2.315240870841       -9.57       -4.71    2.5    1.11s
  6   -2.315240870869      -10.55       -5.96    2.8    1.47s
  7   -2.315240870870      -12.24       -6.38    3.8    1.45s
  8   -2.315240870870      -14.31       -6.86    1.9    1.28s
  9   -2.315240870870      -15.35       -7.28    2.4    1.04s
Iter     Function value   Gradient norm 
     0    -2.315241e+00     1.487757e-03
 * time: 3.314018249511719e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315132548365                   -1.45    5.6    2.05s
  2   -2.315221694721       -4.05       -1.84    1.4    1.08s
  3   -2.315242789337       -4.68       -3.57    3.3    1.32s
  4   -2.315243039373       -6.60       -4.15    4.5    1.98s
  5   -2.315243039681       -9.51       -4.67    2.6    1.10s
  6   -2.315243039716      -10.46       -5.70    2.9    1.47s
  7   -2.315243039716      -12.09       -6.10    3.3    1.31s
  8   -2.315243039716      -13.61       -6.76    2.4    1.34s
  9   -2.315243039716      -14.65       -7.31    2.6    1.09s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315131365459                   -1.45    5.6    2.23s
  2   -2.315221287473       -4.05       -1.84    1.4    1.15s
  3   -2.315242808843       -4.67       -3.56    3.3    1.40s
  4   -2.315243039386       -6.64       -4.15    4.6    2.31s
  5   -2.315243039681       -9.53       -4.67    2.6    1.10s
  6   -2.315243039716      -10.46       -5.84    2.9    1.61s
  7   -2.315243039716      -12.13       -6.26    3.7    1.66s
  8   -2.315243039716      -13.95       -6.83    2.2    1.53s
  9   -2.315243039716      -15.05       -7.28    2.5    1.33s
     1    -2.315243e+00     1.427847e-03
 * time: 59.600335121154785
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315160486852                   -1.45    5.4    2.11s
  2   -2.315247095948       -4.06       -1.83    1.4    1.09s
  3   -2.315268081833       -4.68       -3.53    3.3    1.31s
  4   -2.315268285507       -6.69       -4.13    4.5    1.92s
  5   -2.315268285830       -9.49       -4.70    2.6    1.10s
  6   -2.315268285858      -10.56       -6.00    2.9    1.47s
  7   -2.315268285858      -12.32       -6.40    3.8    1.47s
  8   -2.315268285858      -14.12       -7.26    2.2    1.27s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315158377386                   -1.45    5.4    2.09s
  2   -2.315246172513       -4.06       -1.83    1.3    752ms
  3   -2.315268052336       -4.66       -3.53    3.4    1.59s
  4   -2.315268285507       -6.63       -4.14    4.5    1.66s
  5   -2.315268285830       -9.49       -4.70    2.6    1.62s
  6   -2.315268285858      -10.56       -5.99    2.9    1.57s
  7   -2.315268285858      -12.26       -6.41    3.8    2.69s
  8   -2.315268285858      -14.31       -7.20    2.2    1.65s
     2    -2.315268e+00     1.829238e-05
 * time: 115.9381799697876
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315161180040                   -1.45    5.5    2.18s
  2   -2.315246886610       -4.07       -1.83    1.4    1.12s
  3   -2.315268081560       -4.67       -3.54    3.3    1.69s
  4   -2.315268289448       -6.68       -4.15    4.6    2.54s
  5   -2.315268289749       -9.52       -4.71    2.7    1.35s
  6   -2.315268289776      -10.57       -5.99    2.9    2.01s
  7   -2.315268289776      -12.23       -6.36    3.8    1.84s
  8   -2.315268289776      -14.12       -7.16    2.2    1.52s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315160146190                   -1.45    5.6    2.08s
  2   -2.315247276545       -4.06       -1.83    1.4    792ms
  3   -2.315268066454       -4.68       -3.55    3.4    1.64s
  4   -2.315268289465       -6.65       -4.16    4.5    1.66s
  5   -2.315268289750       -9.54       -4.72    2.7    1.39s
  6   -2.315268289776      -10.59       -6.02    2.9    1.16s
  7   -2.315268289776      -12.39       -6.35    3.9    1.75s
  8   -2.315268289776      -13.97       -7.00    2.1    944ms
  9   -2.315268289776   +  -15.05       -7.54    2.7    1.38s
     3    -2.315268e+00     8.178463e-07
 * time: 173.42173099517822
 * Status: success

 * Candidate solution
    Final objective value:     -2.315268e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 4.49e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 5.90e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 3.92e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.69e-09 ≰ 0.0e+00
    |g(x)|                 = 8.18e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   173  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Al: 207.125663 seconds (154.31 M allocations: 36.844 GiB, 6.46% gc time, 0.00% compilation time)
┌ Info: 2025-05-12T19:32:22.730
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73083611769                   -0.87    9.6    10.5s
  2   -73.74242076320       -1.94       -1.08    5.4    5.74s
  3   -73.74866330127       -2.20       -1.42    6.8    7.70s
  4   -73.74969495409       -2.99       -1.79    5.7    6.30s
  5   -73.74983681792       -3.85       -2.23    5.0    5.67s
  6   -73.74985784455       -4.68       -3.09    5.5    6.24s
  7   -73.74985787548       -7.51       -3.53    4.5    5.71s
  8   -73.74985787949       -8.40       -4.13    4.9    5.62s
  9   -73.74985787968       -9.73       -4.63    3.8    4.90s
 10   -73.74985788002       -9.47       -4.99    5.3    5.94s
 11   -73.74985788003      -11.04       -5.90    5.0    6.39s
 12   -73.74985788003   +  -12.89       -6.49    5.2    5.95s
 13   -73.74985788003   +  -13.37       -6.63    3.9    5.46s
 14   -73.74985788003      -12.89       -7.17    4.9    5.20s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.374986e+01     4.954160e-03
 * time: 3.0994415283203125e-5
┌ Warning: Negative ρcore detected: -3.403843089819388e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73098119109                   -0.87    9.8    10.3s
  2   -73.74246205381       -1.94       -1.08    5.4    6.78s
  3   -73.74869113090       -2.21       -1.42    6.8    7.74s
  4   -73.74971649981       -2.99       -1.79    5.8    6.25s
  5   -73.74986048769       -3.84       -2.24    5.1    5.93s
  6   -73.74988053702       -4.70       -3.09    5.6    6.56s
  7   -73.74988057278       -7.45       -3.53    4.7    6.56s
  8   -73.74988057602       -8.49       -4.10    4.8    5.60s
  9   -73.74988057627       -9.61       -4.65    3.8    6.26s
 10   -73.74988057657       -9.53       -4.90    5.5    5.95s
 11   -73.74988057658      -10.91       -5.81    4.8    6.51s
 12   -73.74988057658      -12.89       -6.47    4.7    5.49s
 13   -73.74988057658   +  -13.00       -6.64    3.9    6.32s
 14   -73.74988057658      -13.85       -7.05    4.9    5.76s
┌ Warning: Negative ρcore detected: -3.403843089819388e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73097647522                   -0.87    9.8    11.0s
  2   -73.74246625587       -1.94       -1.08    5.4    5.72s
  3   -73.74869034378       -2.21       -1.42    6.8    7.30s
  4   -73.74971658312       -2.99       -1.79    5.8    6.65s
  5   -73.74986096307       -3.84       -2.25    5.0    6.41s
  6   -73.74988053661       -4.71       -3.10    5.5    6.88s
  7   -73.74988057271       -7.44       -3.53    4.8    5.58s
  8   -73.74988057605       -8.48       -4.09    4.9    5.54s
  9   -73.74988057626       -9.68       -4.65    3.9    5.46s
 10   -73.74988057657       -9.52       -4.88    5.5    6.40s
 11   -73.74988057658      -10.92       -5.86    4.7    5.63s
 12   -73.74988057658      -13.00       -6.47    4.9    6.12s
 13   -73.74988057658   +  -13.07       -6.70    3.6    4.48s
 14   -73.74988057658      -13.00       -7.30    4.9    5.64s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.403843089819388e-8,-3.3515771380696765e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.374988e+01     4.207548e-03
 * time: 246.5971930027008
┌ Warning: Negative ρcore detected: -3.130149368433121e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73169376597                   -0.87    9.8    10.0s
  2   -73.74255803623       -1.96       -1.08    5.4    5.73s
  3   -73.74878645955       -2.21       -1.42    6.8    7.68s
  4   -73.74976390232       -3.01       -1.78    5.7    6.23s
  5   -73.74991840812       -3.81       -2.24    5.1    5.68s
  6   -73.74993844811       -4.70       -3.07    5.5    7.01s
  7   -73.74993846730       -7.72       -3.49    4.6    6.95s
  8   -73.74993847043       -8.50       -4.09    3.6    5.54s
  9   -73.74993847035   +  -10.12       -4.46    4.7    6.23s
 10   -73.74993847059       -9.62       -4.77    4.8    6.68s
 11   -73.74993847062      -10.57       -5.57    4.7    5.34s
 12   -73.74993847062      -11.21       -6.24    4.6    5.73s
 13   -73.74993847062      -12.03       -6.64    5.1    5.50s
 14   -73.74993847063      -12.36       -7.00    5.3    6.65s
┌ Warning: Negative ρcore detected: -3.130149368433121e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73167955108                   -0.87    9.8    9.56s
  2   -73.74256047951       -1.96       -1.08    5.5    6.02s
  3   -73.74878699269       -2.21       -1.42    6.8    7.34s
  4   -73.74976377177       -3.01       -1.78    5.8    6.04s
  5   -73.74991806045       -3.81       -2.23    5.2    6.00s
  6   -73.74993844733       -4.69       -3.06    5.5    6.06s
  7   -73.74993846735       -7.70       -3.49    4.8    5.67s
  8   -73.74993847047       -8.51       -4.10    3.4    4.44s
  9   -73.74993847031   +   -9.78       -4.45    5.0    5.70s
 10   -73.74993847059       -9.54       -4.77    4.8    5.45s
 11   -73.74993847062      -10.63       -5.57    4.6    5.32s
 12   -73.74993847062      -11.22       -6.26    4.6    5.41s
 13   -73.74993847062      -12.18       -6.51    5.1    5.70s
 14   -73.74993847063      -12.11       -6.89    5.5    5.41s
 15   -73.74993847063      -12.64       -7.89    4.9    5.33s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.130149368433121e-8,-1.66488858634248e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.374994e+01     8.595463e-05
 * time: 490.44388699531555
┌ Warning: Negative ρcore detected: -3.139374136749623e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73167311487                   -0.87    9.7    11.4s
  2   -73.74254949256       -1.96       -1.08    5.3    6.15s
  3   -73.74878893457       -2.20       -1.42    6.9    6.97s
  4   -73.74976322565       -3.01       -1.78    5.7    5.61s
  5   -73.74991810284       -3.81       -2.23    5.1    5.42s
  6   -73.74993847071       -4.69       -3.07    5.5    6.70s
  7   -73.74993849026       -7.71       -3.49    4.7    6.25s
  8   -73.74993849339       -8.50       -4.09    3.5    4.90s
  9   -73.74993849327   +   -9.93       -4.46    4.9    6.81s
 10   -73.74993849352       -9.61       -4.77    4.8    5.48s
 11   -73.74993849355      -10.60       -5.56    4.6    5.26s
 12   -73.74993849355      -11.16       -6.25    4.6    5.58s
 13   -73.74993849355      -12.13       -6.51    5.0    5.81s
 14   -73.74993849356      -12.05       -6.89    5.5    5.64s
 15   -73.74993849356      -12.70       -7.92    5.0    5.58s
┌ Warning: Negative ρcore detected: -3.139374136749623e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73166752059                   -0.87    9.6    9.45s
  2   -73.74256445297       -1.96       -1.08    5.4    5.59s
  3   -73.74878670007       -2.21       -1.42    6.8    7.73s
  4   -73.74976323961       -3.01       -1.78    5.7    5.80s
  5   -73.74991849933       -3.81       -2.24    5.1    5.65s
  6   -73.74993847061       -4.70       -3.06    5.5    6.68s
  7   -73.74993849025       -7.71       -3.49    4.7    5.70s
  8   -73.74993849339       -8.50       -4.09    3.4    4.62s
  9   -73.74993849324   +   -9.83       -4.46    5.0    6.24s
 10   -73.74993849352       -9.55       -4.77    4.9    5.47s
 11   -73.74993849355      -10.64       -5.57    4.6    5.85s
 12   -73.74993849355      -11.16       -6.26    4.6    5.39s
 13   -73.74993849355      -12.06       -6.63    5.0    6.26s
 14   -73.74993849356      -12.21       -7.00    5.4    6.31s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.139374136749623e-8,-1.6359639296093736e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.374994e+01     1.696353e-06
 * time: 732.9132900238037
┌ Warning: Negative ρcore detected: -3.13919713430569e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73167575720                   -0.87    9.6    10.3s
  2   -73.74254334955       -1.96       -1.08    5.4    5.80s
  3   -73.74878890033       -2.20       -1.42    6.9    8.13s
  4   -73.74976343687       -3.01       -1.78    5.7    7.03s
  5   -73.74991830699       -3.81       -2.23    5.0    6.26s
  6   -73.74993847089       -4.70       -3.07    5.4    6.27s
  7   -73.74993849023       -7.71       -3.49    4.6    5.26s
  8   -73.74993849340       -8.50       -4.09    3.5    5.06s
  9   -73.74993849333   +  -10.14       -4.47    4.8    5.72s
 10   -73.74993849354       -9.67       -4.77    4.8    5.29s
 11   -73.74993849357      -10.54       -5.56    4.7    6.24s
 12   -73.74993849358      -11.17       -6.24    4.6    5.60s
 13   -73.74993849358      -12.01       -6.64    5.1    5.90s
 14   -73.74993849358      -12.26       -7.00    5.4    6.02s
┌ Warning: Negative ρcore detected: -3.13919713430569e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73168456265                   -0.87    9.7    10.1s
  2   -73.74254710227       -1.96       -1.08    5.3    5.40s
  3   -73.74878663617       -2.20       -1.42    6.8    7.02s
  4   -73.74976427556       -3.01       -1.78    5.7    6.39s
  5   -73.74991798975       -3.81       -2.23    5.0    5.52s
  6   -73.74993847020       -4.69       -3.06    5.4    5.98s
  7   -73.74993849028       -7.70       -3.49    5.0    5.51s
  8   -73.74993849342       -8.50       -4.09    3.5    4.52s
  9   -73.74993849327   +   -9.80       -4.46    5.0    5.74s
 10   -73.74993849355       -9.55       -4.76    4.8    5.47s
 11   -73.74993849357      -10.64       -5.55    4.5    5.33s
 12   -73.74993849358      -11.14       -6.25    4.6    5.46s
 13   -73.74993849358      -12.14       -6.51    5.1    5.81s
 14   -73.74993849358      -12.04       -6.86    5.4    6.30s
 15   -73.74993849358      -12.70       -7.86    5.0    5.76s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.13919713430569e-8,-1.636522844997192e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     4    -7.374994e+01     7.108879e-08
 * time: 976.026209115982
 * Status: success

 * Candidate solution
    Final objective value:     -7.374994e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.08e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.91e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.09e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.83e-13 ≰ 0.0e+00
    |g(x)|                 = 7.11e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   976  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

V: 1107.848542 seconds (728.98 M allocations: 345.206 GiB, 6.22% gc time, 0.01% compilation time)
