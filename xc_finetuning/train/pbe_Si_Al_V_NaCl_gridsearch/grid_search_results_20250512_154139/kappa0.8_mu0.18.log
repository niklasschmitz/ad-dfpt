┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-12T16:27:30.942
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.444747358809                   -0.96    7.0    11.4s
  2   -8.446524290461       -2.75       -1.76    1.9    4.90s
  3   -8.446593776421       -4.16       -2.80    3.8    2.07s
  4   -8.446594967083       -5.92       -3.74    4.5    1.89s
  5   -8.446594989482       -7.65       -4.43    4.7    2.09s
  6   -8.446594990452       -9.01       -5.37    4.7    2.11s
  7   -8.446594990464      -10.92       -6.14    4.2    1.74s
  8   -8.446594990464      -12.68       -7.34    3.7    1.84s
Iter     Function value   Gradient norm 
     0    -8.446595e+00     3.015629e-03
 * time: 4.9114227294921875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.444752589634                   -0.96    7.5    2.70s
  2   -8.446534194402       -2.75       -1.76    2.2    1.22s
  3   -8.446602689606       -4.16       -2.80    4.0    2.14s
  4   -8.446603749966       -5.97       -3.75    4.5    2.23s
  5   -8.446603770745       -7.68       -4.43    4.8    1.83s
  6   -8.446603771696       -9.02       -5.39    4.8    2.17s
  7   -8.446603771707      -10.96       -6.18    4.4    1.77s
  8   -8.446603771707      -12.79       -7.40    3.8    1.94s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.444755124481                   -0.96    7.4    2.60s
  2   -8.446538570369       -2.75       -1.76    2.1    1.43s
  3   -8.446602727983       -4.19       -2.80    4.0    1.73s
  4   -8.446603749762       -5.99       -3.75    4.7    2.10s
  5   -8.446603770783       -7.68       -4.45    4.8    1.78s
  6   -8.446603771695       -9.04       -5.43    4.7    2.08s
  7   -8.446603771707      -10.95       -6.21    4.2    1.70s
  8   -8.446603771707      -12.85       -7.41    3.8    1.89s
     1    -8.446604e+00     2.808092e-03
 * time: 44.397727966308594
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.444732560777                   -0.96    7.2    2.54s
  2   -8.446590607668       -2.73       -1.76    2.1    1.14s
  3   -8.446659056602       -4.16       -2.79    3.8    1.94s
  4   -8.446660204138       -5.94       -3.74    4.5    2.04s
  5   -8.446660222924       -7.73       -4.46    4.5    1.97s
  6   -8.446660223765       -9.07       -5.42    4.8    1.93s
  7   -8.446660223774      -11.04       -6.15    4.0    1.63s
  8   -8.446660223774      -12.78       -7.33    3.6    1.85s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.444740110530                   -0.96    7.2    2.75s
  2   -8.446587710263       -2.73       -1.76    2.0    1.55s
  3   -8.446659185479       -4.15       -2.79    3.9    1.94s
  4   -8.446660203714       -5.99       -3.75    4.5    2.02s
  5   -8.446660222903       -7.72       -4.45    4.6    1.79s
  6   -8.446660223765       -9.06       -5.41    4.7    2.04s
  7   -8.446660223774      -11.03       -6.17    4.0    1.75s
  8   -8.446660223774      -12.76       -7.35    3.8    1.87s
     2    -8.446660e+00     5.966056e-05
 * time: 87.30646395683289
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.444737337279                   -0.96    7.1    2.58s
  2   -8.446588685594       -2.73       -1.76    2.0    1.15s
  3   -8.446659135492       -4.15       -2.79    3.8    2.00s
  4   -8.446660228293       -5.96       -3.74    4.5    2.10s
  5   -8.446660247713       -7.71       -4.44    4.6    1.82s
  6   -8.446660248600       -9.05       -5.40    4.8    2.09s
  7   -8.446660248610      -11.01       -6.14    4.0    1.71s
  8   -8.446660248610      -12.75       -7.33    3.7    1.88s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.444753114892                   -0.96    7.1    2.64s
  2   -8.446591334173       -2.74       -1.76    2.0    1.49s
  3   -8.446659200509       -4.17       -2.79    3.9    1.71s
  4   -8.446660229965       -5.99       -3.75    4.5    2.08s
  5   -8.446660247723       -7.75       -4.46    4.7    1.78s
  6   -8.446660248601       -9.06       -5.43    4.8    2.03s
  7   -8.446660248610      -11.06       -6.22    4.2    1.76s
  8   -8.446660248610      -12.88       -7.39    3.6    1.88s
     3    -8.446660e+00     1.142060e-06
 * time: 129.93590593338013
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.444756086638                   -0.96    7.2    2.56s
  2   -8.446594308433       -2.74       -1.76    1.9    1.14s
  3   -8.446659109333       -4.19       -2.81    4.0    1.98s
  4   -8.446660222795       -5.95       -3.71    4.5    2.11s
  5   -8.446660247849       -7.60       -4.52    4.7    1.76s
  6   -8.446660248612       -9.12       -5.40    4.8    2.02s
  7   -8.446660248619      -11.15       -6.28    3.8    1.64s
  8   -8.446660248619      -12.92       -7.33    3.9    1.93s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.444736505149                   -0.96    7.1    2.62s
  2   -8.446590258935       -2.73       -1.76    2.0    1.44s
  3   -8.446659142902       -4.16       -2.79    3.8    1.67s
  4   -8.446660229783       -5.96       -3.74    4.3    2.03s
  5   -8.446660247788       -7.74       -4.47    4.5    1.77s
  6   -8.446660248611       -9.08       -5.45    4.9    2.01s
  7   -8.446660248619      -11.07       -6.20    4.1    1.73s
  8   -8.446660248619      -12.91       -7.36    3.6    1.84s
     4    -8.446660e+00     1.546429e-09
 * time: 172.24722599983215
 * Status: success

 * Candidate solution
    Final objective value:     -8.446660e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.59e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.55e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 9.03e-12 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.07e-12 ≰ 0.0e+00
    |g(x)|                 = 1.55e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   172  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

Si: 248.510639 seconds (368.50 M allocations: 74.348 GiB, 8.12% gc time, 21.39% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-12T16:31:40.105
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13816389922                   -1.16    8.3    18.9s
  2   -62.14244497105       -2.37       -1.23    2.5    7.81s
  3   -62.14643416654       -2.40       -2.07    3.8    9.86s
  4   -62.14646538376       -4.51       -2.86    3.5    9.19s
  5   -62.14646596862       -6.23       -3.52    4.0    10.5s
  6   -62.14646601866       -7.30       -4.33    3.6    9.37s
  7   -62.14646601919       -9.28       -4.94    4.1    10.2s
  8   -62.14646601922      -10.53       -6.25    3.9    10.2s
  9   -62.14646601922      -12.81       -7.15    4.5    11.2s
Iter     Function value   Gradient norm 
     0    -6.214647e+01     5.686377e-04
 * time: 3.504753112792969e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13816718411                   -1.16    8.3    17.3s
  2   -62.14244993232       -2.37       -1.23    2.5    7.72s
  3   -62.14643397718       -2.40       -2.07    3.9    9.86s
  4   -62.14646568615       -4.50       -2.85    3.6    9.26s
  5   -62.14646628743       -6.22       -3.52    3.9    10.2s
  6   -62.14646633893       -7.29       -4.31    3.7    9.43s
  7   -62.14646633949       -9.25       -4.93    4.0    10.3s
  8   -62.14646633952      -10.48       -6.26    3.9    9.85s
  9   -62.14646633952      -12.56       -7.24    4.4    10.9s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13816769667                   -1.16    8.4    16.6s
  2   -62.14244287794       -2.37       -1.23    2.5    7.03s
  3   -62.14643451058       -2.40       -2.07    3.8    9.32s
  4   -62.14646571859       -4.51       -2.87    3.5    9.44s
  5   -62.14646628947       -6.24       -3.53    4.0    10.0s
  6   -62.14646633900       -7.31       -4.33    3.7    9.80s
  7   -62.14646633949       -9.31       -4.93    4.1    10.2s
  8   -62.14646633952      -10.51       -6.29    3.9    9.92s
  9   -62.14646633952      -12.79       -7.21    4.4    11.8s
     1    -6.214647e+01     5.578280e-04
 * time: 224.6821780204773
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13827465118                   -1.16    8.5    16.4s
  2   -62.14253505959       -2.37       -1.23    2.5    6.95s
  3   -62.14644372293       -2.41       -2.07    3.8    9.49s
  4   -62.14647387339       -4.52       -2.89    3.5    8.88s
  5   -62.14647438053       -6.29       -3.56    4.0    10.0s
  6   -62.14647442695       -7.33       -4.39    3.5    9.26s
  7   -62.14647442735       -9.40       -4.98    4.1    10.1s
  8   -62.14647442737      -10.64       -6.32    3.8    9.71s
  9   -62.14647442737      -12.69       -7.43    4.6    11.5s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13827270490                   -1.16    8.5    16.8s
  2   -62.14254060888       -2.37       -1.23    2.5    6.93s
  3   -62.14644349603       -2.41       -2.07    3.8    9.53s
  4   -62.14647383919       -4.52       -2.87    3.5    9.16s
  5   -62.14647437851       -6.27       -3.53    3.9    9.93s
  6   -62.14647442688       -7.32       -4.34    3.6    9.34s
  7   -62.14647442734       -9.33       -4.94    4.0    10.4s
  8   -62.14647442737      -10.55       -6.26    3.9    10.1s
  9   -62.14647442737      -12.69       -7.20    4.4    11.1s
     2    -6.214647e+01     9.491434e-06
 * time: 443.12604784965515
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13827059485                   -1.16    8.2    16.0s
  2   -62.14253654228       -2.37       -1.23    2.4    6.79s
  3   -62.14644377962       -2.41       -2.07    3.7    9.30s
  4   -62.14647388695       -4.52       -2.90    3.4    9.04s
  5   -62.14647438301       -6.30       -3.56    3.8    9.57s
  6   -62.14647442920       -7.34       -4.38    3.6    9.00s
  7   -62.14647442962       -9.39       -4.97    4.1    10.3s
  8   -62.14647442964      -10.61       -6.36    3.9    10.8s
  9   -62.14647442964      -12.70       -7.20    4.4    11.1s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13827495370                   -1.16    8.2    15.8s
  2   -62.14254429631       -2.37       -1.23    2.4    6.75s
  3   -62.14644341732       -2.41       -2.07    3.8    9.42s
  4   -62.14647385090       -4.52       -2.87    3.5    8.78s
  5   -62.14647438081       -6.28       -3.54    4.0    10.0s
  6   -62.14647442914       -7.32       -4.35    3.4    8.86s
  7   -62.14647442961       -9.32       -4.97    4.0    10.0s
  8   -62.14647442964      -10.59       -6.32    3.8    9.86s
  9   -62.14647442964      -12.89       -7.30    4.3    11.7s
     3    -6.214647e+01     1.544140e-07
 * time: 657.2189528942108
 * Status: success

 * Candidate solution
    Final objective value:     -6.214647e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 4.91e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.58e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.27e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.65e-11 ≰ 0.0e+00
    |g(x)|                 = 1.54e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   657  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

NaCl: 779.403197 seconds (797.21 M allocations: 226.287 GiB, 5.32% gc time, 0.45% compilation time)
┌ Info: 2025-05-12T16:44:39.539
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314989004359                   -1.45    5.4    2.06s
  2   -2.315084822701       -4.02       -1.84    1.4    803ms
  3   -2.315107304594       -4.65       -3.57    3.3    1.74s
  4   -2.315107611145       -6.51       -4.17    4.6    2.13s
  5   -2.315107611414       -9.57       -4.70    2.7    1.37s
  6   -2.315107611443      -10.54       -5.70    2.8    1.12s
  7   -2.315107611444      -12.11       -6.10    3.3    1.52s
  8   -2.315107611444      -13.55       -6.77    2.3    978ms
  9   -2.315107611444      -14.75       -7.35    2.7    1.43s
Iter     Function value   Gradient norm 
     0    -2.315108e+00     1.586830e-03
 * time: 2.8133392333984375e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314994333695                   -1.45    5.6    2.58s
  2   -2.315087228892       -4.03       -1.84    1.5    766ms
  3   -2.315109905650       -4.64       -3.57    3.4    1.76s
  4   -2.315110078255       -6.76       -4.16    4.7    1.64s
  5   -2.315110078550       -9.53       -4.70    2.6    1.30s
  6   -2.315110078581      -10.51       -5.71    2.9    1.12s
  7   -2.315110078582      -12.13       -6.11    3.4    1.52s
  8   -2.315110078582      -13.52       -6.69    2.7    1.05s
  9   -2.315110078582      -15.05       -7.31    2.3    1.33s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314992506853                   -1.45    5.5    2.06s
  2   -2.315086808745       -4.03       -1.84    1.5    769ms
  3   -2.315109870922       -4.64       -3.56    3.4    1.55s
  4   -2.315110078234       -6.68       -4.15    4.7    1.63s
  5   -2.315110078547       -9.50       -4.69    2.6    1.34s
  6   -2.315110078581      -10.47       -5.62    2.9    1.12s
  7   -2.315110078582      -12.06       -6.04    3.2    1.49s
  8   -2.315110078582      -13.37       -6.66    2.7    1.19s
  9   -2.315110078582      -15.05       -7.29    2.4    1.26s
     1    -2.315110e+00     1.522699e-03
 * time: 54.850914001464844
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315027838068                   -1.45    5.5    2.03s
  2   -2.315116250747       -4.05       -1.83    1.4    764ms
  3   -2.315138479643       -4.65       -3.53    3.3    1.49s
  4   -2.315138700761       -6.66       -4.13    4.4    1.54s
  5   -2.315138701116       -9.45       -4.69    2.7    1.31s
  6   -2.315138701147      -10.51       -5.84    2.9    1.11s
  7   -2.315138701148      -12.12       -6.21    3.6    1.59s
  8   -2.315138701148      -14.10       -6.66    2.0    906ms
  9   -2.315138701148      -14.65       -7.43    2.2    982ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315025035948                   -1.45    5.4    2.02s
  2   -2.315115706449       -4.04       -1.83    1.4    755ms
  3   -2.315138477786       -4.64       -3.52    3.3    1.74s
  4   -2.315138700728       -6.65       -4.11    4.5    1.92s
  5   -2.315138701114       -9.41       -4.69    2.6    1.44s
  6   -2.315138701147      -10.48       -5.77    2.9    1.18s
  7   -2.315138701148      -12.18       -6.18    3.6    1.72s
  8   -2.315138701148      -14.27       -6.61    2.0    1.17s
  9   -2.315138701148      -14.45       -7.54    2.1    1.10s
     2    -2.315139e+00     1.995943e-05
 * time: 110.41514611244202
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315027537023                   -1.45    5.4    2.14s
  2   -2.315115928972       -4.05       -1.83    1.4    797ms
  3   -2.315138507961       -4.65       -3.51    3.3    1.57s
  4   -2.315138705337       -6.70       -4.10    4.5    1.64s
  5   -2.315138705738       -9.40       -4.68    2.6    1.36s
  6   -2.315138705773      -10.46       -5.80    2.9    1.23s
  7   -2.315138705773      -12.14       -6.20    3.6    1.72s
  8   -2.315138705773      -14.24       -6.69    2.0    967ms
  9   -2.315138705773      -14.65       -7.60    2.3    1.51s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315026831652                   -1.45    5.3    2.49s
  2   -2.315116036108       -4.05       -1.83    1.4    1.07s
  3   -2.315138469260       -4.65       -3.51    3.3    1.68s
  4   -2.315138705354       -6.63       -4.12    4.5    1.89s
  5   -2.315138705737       -9.42       -4.68    2.6    1.37s
  6   -2.315138705773      -10.45       -5.80    3.0    1.15s
  7   -2.315138705773      -12.12       -6.19    3.6    2.00s
  8   -2.315138705773      -14.45       -6.63    2.0    918ms
  9   -2.315138705773      -14.65       -7.55    2.1    980ms
     3    -2.315139e+00     9.701999e-07
 * time: 168.23435401916504
 * Status: success

 * Candidate solution
    Final objective value:     -2.315139e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 4.87e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 6.41e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 4.63e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.00e-09 ≰ 0.0e+00
    |g(x)|                 = 9.70e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   168  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Al: 202.812705 seconds (157.41 M allocations: 37.606 GiB, 6.62% gc time, 0.00% compilation time)
┌ Info: 2025-05-12T16:48:02.352
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71417586570                   -0.85    9.6    11.0s
  2   -73.72686787351       -1.90       -1.06    5.3    5.92s
  3   -73.73350970564       -2.18       -1.39    6.7    8.13s
  4   -73.73467720456       -2.93       -1.78    5.8    7.36s
  5   -73.73482837465       -3.82       -2.25    5.1    7.48s
  6   -73.73484809140       -4.71       -3.09    5.5    7.62s
  7   -73.73484813497       -7.36       -3.55    4.7    6.14s
  8   -73.73484814196       -8.16       -4.15    5.3    5.96s
  9   -73.73484814174   +   -9.65       -4.57    4.8    5.54s
 10   -73.73484814240       -9.18       -4.92    5.5    5.99s
 11   -73.73484814241      -11.16       -5.83    4.3    5.20s
 12   -73.73484814241      -13.15       -6.45    4.9    5.79s
 13   -73.73484814241   +  -13.55       -6.66    3.5    5.45s
 14   -73.73484814241      -13.07       -7.27    4.8    6.53s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.373485e+01     9.511873e-03
 * time: 3.0040740966796875e-5
┌ Warning: Negative ρcore detected: -3.3840151170989e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71452736759                   -0.85    9.6    9.88s
  2   -73.72695128005       -1.91       -1.06    5.4    6.10s
  3   -73.73360742428       -2.18       -1.40    6.8    7.39s
  4   -73.73475771220       -2.94       -1.77    5.9    5.94s
  5   -73.73491362012       -3.81       -2.26    5.0    6.30s
  6   -73.73493182594       -4.74       -3.09    5.6    6.55s
  7   -73.73493185972       -7.47       -3.54    4.6    6.24s
  8   -73.73493186430       -8.34       -4.11    5.1    6.71s
  9   -73.73493186412   +   -9.74       -4.55    4.8    6.51s
 10   -73.73493186467       -9.25       -4.82    5.6    6.24s
 11   -73.73493186468      -10.88       -5.73    4.3    5.82s
 12   -73.73493186468      -12.85       -6.39    4.7    6.41s
 13   -73.73493186468      -13.25       -6.52    3.8    5.30s
 14   -73.73493186468   +    -Inf       -7.00    5.1    5.32s
┌ Warning: Negative ρcore detected: -3.3840151170989e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71451614065                   -0.85    9.7    9.71s
  2   -73.72695711749       -1.91       -1.06    5.4    5.70s
  3   -73.73360775998       -2.18       -1.40    6.7    7.18s
  4   -73.73475811975       -2.94       -1.77    5.9    6.00s
  5   -73.73491248567       -3.81       -2.25    5.0    6.00s
  6   -73.73493182517       -4.71       -3.08    5.5    6.92s
  7   -73.73493185916       -7.47       -3.54    4.4    6.19s
  8   -73.73493186436       -8.28       -4.13    5.1    5.49s
  9   -73.73493186408   +   -9.56       -4.55    5.0    5.53s
 10   -73.73493186467       -9.23       -4.82    5.6    5.94s
 11   -73.73493186468      -10.91       -5.74    4.0    4.87s
 12   -73.73493186468      -12.73       -6.39    4.7    5.57s
 13   -73.73493186468   +  -13.07       -6.56    2.9    4.02s
 14   -73.73493186468      -13.15       -6.99    5.1    5.56s
 15   -73.73493186468      -13.37       -7.90    4.8    5.77s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.3840151170989e-8,-5.359940867152288e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.373493e+01     8.088916e-03
 * time: 244.93757700920105
┌ Warning: Negative ρcore detected: -3.075405015682096e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71607026862                   -0.86    9.7    11.3s
  2   -73.72736596564       -1.95       -1.06    5.3    6.15s
  3   -73.73387158015       -2.19       -1.40    6.7    7.34s
  4   -73.73497209490       -2.96       -1.77    5.8    6.38s
  5   -73.73512416931       -3.82       -2.26    5.0    5.69s
  6   -73.73514298655       -4.73       -3.09    5.4    6.35s
  7   -73.73514300840       -7.66       -3.54    4.2    5.38s
  8   -73.73514301256       -8.38       -4.04    4.8    6.14s
  9   -73.73514301221   +   -9.46       -4.55    5.1    7.44s
 10   -73.73514301274       -9.28       -4.80    5.5    7.68s
 11   -73.73514301278      -10.41       -5.52    4.8    6.03s
 12   -73.73514301279      -11.14       -6.26    4.6    5.75s
 13   -73.73514301279      -12.08       -6.58    4.6    5.62s
 14   -73.73514301279      -12.14       -7.03    5.2    6.28s
┌ Warning: Negative ρcore detected: -3.075405015682096e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71606867781                   -0.86    9.6    9.93s
  2   -73.72735428328       -1.95       -1.06    5.3    6.70s
  3   -73.73387246920       -2.19       -1.40    6.7    7.27s
  4   -73.73497257152       -2.96       -1.77    5.8    5.79s
  5   -73.73512401767       -3.82       -2.25    5.0    5.48s
  6   -73.73514298688       -4.72       -3.09    5.4    6.00s
  7   -73.73514300845       -7.67       -3.54    4.3    5.08s
  8   -73.73514301256       -8.39       -4.03    4.8    5.56s
  9   -73.73514301223   +   -9.48       -4.55    5.1    5.68s
 10   -73.73514301274       -9.29       -4.80    5.5    6.35s
 11   -73.73514301278      -10.42       -5.52    4.9    5.53s
 12   -73.73514301279      -11.15       -6.26    4.5    5.42s
 13   -73.73514301279      -12.06       -6.59    4.6    5.56s
 14   -73.73514301279      -12.16       -7.03    5.2    6.33s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.075405015682096e-8,-7.867369861287405e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.373514e+01     3.984020e-04
 * time: 491.4042329788208
┌ Warning: Negative ρcore detected: -3.093883134001709e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71599467941                   -0.86    9.9    10.2s
  2   -73.72733858419       -1.95       -1.06    5.5    5.62s
  3   -73.73387214643       -2.18       -1.40    6.9    7.42s
  4   -73.73497194199       -2.96       -1.77    5.9    6.48s
  5   -73.73512466439       -3.82       -2.26    5.2    6.42s
  6   -73.73514348128       -4.73       -3.09    5.6    6.55s
  7   -73.73514350105       -7.70       -3.54    4.4    5.21s
  8   -73.73514350568       -8.33       -4.04    4.9    5.50s
  9   -73.73514350552   +   -9.78       -4.53    5.3    5.91s
 10   -73.73514350594       -9.37       -4.79    5.5    6.40s
 11   -73.73514350598      -10.46       -5.51    4.9    5.94s
 12   -73.73514350598      -11.73       -6.26    4.7    6.20s
 13   -73.73514350598   +  -12.85       -6.58    4.8    5.72s
 14   -73.73514350598      -13.85       -7.04    5.1    6.37s
┌ Warning: Negative ρcore detected: -3.093883134001709e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71600408909                   -0.86    9.9    11.3s
  2   -73.72734776543       -1.95       -1.06    5.5    6.64s
  3   -73.73387083461       -2.19       -1.40    6.8    7.79s
  4   -73.73497159895       -2.96       -1.77    5.9    6.85s
  5   -73.73512413417       -3.82       -2.25    5.0    5.44s
  6   -73.73514348194       -4.71       -3.09    5.6    5.96s
  7   -73.73514350052       -7.73       -3.54    4.4    5.14s
  8   -73.73514350568       -8.29       -4.05    4.9    5.60s
  9   -73.73514350546   +   -9.65       -4.52    5.4    6.10s
 10   -73.73514350595       -9.31       -4.80    5.5    6.24s
 11   -73.73514350598      -10.48       -5.50    4.8    6.60s
 12   -73.73514350598      -11.75       -6.27    4.6    5.86s
 13   -73.73514350598   +  -12.94       -6.59    4.9    5.70s
 14   -73.73514350598   +  -13.37       -7.03    5.2    5.69s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.093883134001709e-8,-6.696474942631626e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.373514e+01     1.608084e-05
 * time: 739.640643119812
┌ Warning: Negative ρcore detected: -3.093221492557418e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71599782842                   -0.86    9.9    10.5s
  2   -73.72735047685       -1.94       -1.06    5.5    5.85s
  3   -73.73387235653       -2.19       -1.40    6.9    7.75s
  4   -73.73497145337       -2.96       -1.77    5.9    5.82s
  5   -73.73512440791       -3.82       -2.25    5.1    6.09s
  6   -73.73514348189       -4.72       -3.09    5.5    6.70s
  7   -73.73514350166       -7.70       -3.55    4.4    5.34s
  8   -73.73514350647       -8.32       -4.05    5.0    5.74s
  9   -73.73514350622   +   -9.59       -4.53    5.3    7.10s
 10   -73.73514350671       -9.30       -4.80    5.5    6.78s
 11   -73.73514350675      -10.46       -5.51    4.9    6.11s
 12   -73.73514350675      -11.81       -6.28    4.6    5.94s
 13   -73.73514350675   +  -13.25       -6.59    4.7    6.42s
 14   -73.73514350675   +  -13.85       -7.03    5.2    6.40s
┌ Warning: Negative ρcore detected: -3.093221492557418e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.71599758276                   -0.86    9.8    9.76s
  2   -73.72735041530       -1.94       -1.06    5.4    7.50s
  3   -73.73387112825       -2.19       -1.40    6.9    8.08s
  4   -73.73497147766       -2.96       -1.77    5.9    6.52s
  5   -73.73512462363       -3.81       -2.26    5.0    5.76s
  6   -73.73514348289       -4.72       -3.09    5.5    6.18s
  7   -73.73514350158       -7.73       -3.55    4.5    5.29s
  8   -73.73514350647       -8.31       -4.06    5.0    5.82s
  9   -73.73514350619   +   -9.55       -4.52    5.4    5.94s
 10   -73.73514350671       -9.28       -4.81    5.7    6.37s
 11   -73.73514350675      -10.47       -5.51    4.9    6.74s
 12   -73.73514350675      -11.78       -6.28    4.6    6.37s
 13   -73.73514350675   +  -13.55       -6.59    4.8    5.85s
 14   -73.73514350675   +  -13.07       -7.02    5.3    6.50s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.093221492557418e-8,-6.74151152547234e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     4    -7.373514e+01     3.257542e-08
 * time: 989.8030560016632
 * Status: success

 * Candidate solution
    Final objective value:     -7.373514e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 9.85e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.75e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 7.70e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.04e-11 ≰ 0.0e+00
    |g(x)|                 = 3.26e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   990  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

V: 1128.212433 seconds (727.64 M allocations: 344.230 GiB, 5.96% gc time, 0.01% compilation time)
