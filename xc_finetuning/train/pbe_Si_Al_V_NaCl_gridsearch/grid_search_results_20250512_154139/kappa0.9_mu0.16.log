┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-12T17:03:36.942
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.437029880662                   -0.97    7.0    12.1s
  2   -8.438824520639       -2.75       -1.77    1.9    5.21s
  3   -8.438894610522       -4.15       -2.80    3.8    2.32s
  4   -8.438895726526       -5.95       -3.72    4.6    2.09s
  5   -8.438895754755       -7.55       -4.43    4.7    2.20s
  6   -8.438895755967       -8.92       -5.38    4.8    2.37s
  7   -8.438895755980      -10.87       -6.23    4.2    1.87s
  8   -8.438895755980      -12.80       -7.34    3.7    1.92s
Iter     Function value   Gradient norm 
     0    -8.438896e+00     3.999890e-03
 * time: 4.1961669921875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.437001558436                   -0.96    7.2    3.20s
  2   -8.438835304451       -2.74       -1.77    2.3    1.59s
  3   -8.438910023445       -4.13       -2.80    3.8    1.96s
  4   -8.438911178856       -5.94       -3.73    4.6    2.06s
  5   -8.438911204983       -7.58       -4.41    4.6    1.76s
  6   -8.438911206183       -8.92       -5.37    4.8    2.24s
  7   -8.438911206198      -10.82       -6.22    4.3    2.08s
  8   -8.438911206198      -12.87       -7.36    3.7    2.05s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.437013117132                   -0.96    7.2    2.57s
  2   -8.438830743898       -2.74       -1.77    2.0    1.19s
  3   -8.438909939967       -4.10       -2.80    4.0    1.92s
  4   -8.438911178439       -5.91       -3.73    4.5    2.09s
  5   -8.438911204935       -7.58       -4.40    4.6    1.81s
  6   -8.438911206181       -8.90       -5.34    4.9    2.34s
  7   -8.438911206198      -10.79       -6.16    4.1    1.70s
  8   -8.438911206198      -12.69       -7.35    3.7    1.85s
     1    -8.438911e+00     3.725255e-03
 * time: 45.79331183433533
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.437030484633                   -0.96    7.1    2.57s
  2   -8.438934059212       -2.72       -1.77    2.0    1.20s
  3   -8.439009073899       -4.12       -2.81    3.9    2.36s
  4   -8.439010263018       -5.92       -3.69    4.4    2.14s
  5   -8.439010292483       -7.53       -4.49    4.9    2.14s
  6   -8.439010293418       -9.03       -5.37    4.8    2.08s
  7   -8.439010293427      -11.06       -6.23    3.8    1.91s
  8   -8.439010293427      -12.84       -7.29    3.7    1.56s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.437044593262                   -0.96    7.0    2.58s
  2   -8.438937078689       -2.72       -1.77    1.9    1.20s
  3   -8.439009180708       -4.14       -2.81    3.9    1.94s
  4   -8.439010264277       -5.97       -3.70    4.6    1.80s
  5   -8.439010292446       -7.55       -4.48    4.8    2.05s
  6   -8.439010293418       -9.01       -5.36    4.9    1.74s
  7   -8.439010293427      -11.07       -6.27    3.8    1.96s
  8   -8.439010293427      -12.90       -7.30    3.8    1.64s
     2    -8.439010e+00     1.056828e-04
 * time: 88.83788895606995
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.437053453872                   -0.96    7.1    2.57s
  2   -8.438935963470       -2.73       -1.77    2.0    1.42s
  3   -8.439009206607       -4.14       -2.81    4.0    1.67s
  4   -8.439010340205       -5.95       -3.70    4.4    2.01s
  5   -8.439010369539       -7.53       -4.48    4.6    1.75s
  6   -8.439010370490       -9.02       -5.35    4.8    1.97s
  7   -8.439010370498      -11.08       -6.25    3.8    1.61s
  8   -8.439010370498      -12.84       -7.29    3.8    1.88s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.437049699507                   -0.96    6.9    2.57s
  2   -8.438937059149       -2.72       -1.77    2.0    1.46s
  3   -8.439009126364       -4.14       -2.81    4.0    1.71s
  4   -8.439010341283       -5.92       -3.70    4.5    2.12s
  5   -8.439010369490       -7.55       -4.49    4.6    1.82s
  6   -8.439010370491       -9.00       -5.39    4.8    2.35s
  7   -8.439010370498      -11.17       -6.34    3.8    2.06s
  8   -8.439010370498      -12.97       -7.29    3.9    2.20s
     3    -8.439010e+00     2.669491e-06
 * time: 132.20023894309998
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.437044994663                   -0.96    7.0    2.52s
  2   -8.438934737389       -2.72       -1.77    2.0    1.13s
  3   -8.439009232004       -4.13       -2.81    3.9    1.93s
  4   -8.439010339548       -5.96       -3.70    4.5    1.72s
  5   -8.439010369570       -7.52       -4.48    4.7    2.25s
  6   -8.439010370538       -9.01       -5.34    5.0    1.81s
  7   -8.439010370547      -11.02       -6.26    3.8    1.85s
  8   -8.439010370547      -12.86       -7.28    3.9    1.59s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.437046392224                   -0.96    7.1    2.55s
  2   -8.438933643673       -2.72       -1.77    2.0    1.09s
  3   -8.439009165496       -4.12       -2.81    3.9    1.92s
  4   -8.439010340303       -5.93       -3.70    4.6    1.77s
  5   -8.439010369567       -7.53       -4.49    4.6    2.01s
  6   -8.439010370540       -9.01       -5.38    4.9    1.74s
  7   -8.439010370547      -11.16       -6.30    3.7    1.89s
  8   -8.439010370547      -12.98       -7.27    3.8    1.60s
     4    -8.439010e+00     2.396471e-10
 * time: 173.58657002449036
 * Status: success

 * Candidate solution
    Final objective value:     -8.439010e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.69e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.58e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 4.93e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 5.85e-12 ≰ 0.0e+00
    |g(x)|                 = 2.40e-10 ≤ 1.0e-06

 * Work counters
    Seconds run:   174  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

Si: 255.220534 seconds (367.66 M allocations: 74.024 GiB, 7.87% gc time, 21.80% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-12T17:07:52.819
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.09496139606                   -1.16    8.4    19.7s
  2   -62.09919566455       -2.37       -1.24    2.5    8.26s
  3   -62.10296246078       -2.42       -2.07    3.8    11.0s
  4   -62.10299412587       -4.50       -2.83    3.5    10.4s
  5   -62.10299480046       -6.17       -3.48    3.9    13.4s
  6   -62.10299488432       -7.08       -4.29    3.6    10.1s
  7   -62.10299488513       -9.09       -4.88    3.9    10.9s
  8   -62.10299488518      -10.27       -6.29    3.8    9.94s
  9   -62.10299488518      -12.46       -7.12    4.4    13.8s
Iter     Function value   Gradient norm 
     0    -6.210299e+01     3.092727e-04
 * time: 4.00543212890625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.09496058265                   -1.16    8.6    18.3s
  2   -62.09918498533       -2.37       -1.24    2.6    8.43s
  3   -62.10296258083       -2.42       -2.07    3.9    10.0s
  4   -62.10299419377       -4.50       -2.83    3.6    10.8s
  5   -62.10299489516       -6.15       -3.47    4.0    10.5s
  6   -62.10299497907       -7.08       -4.27    3.7    9.91s
  7   -62.10299497988       -9.09       -4.82    4.0    11.1s
  8   -62.10299497995      -10.20       -6.33    3.9    11.4s
  9   -62.10299497995      -12.42       -7.08    4.7    12.5s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.09496066901                   -1.16    8.6    17.8s
  2   -62.09918251946       -2.37       -1.24    2.5    7.35s
  3   -62.10296277376       -2.42       -2.07    3.9    10.8s
  4   -62.10299422722       -4.50       -2.84    3.4    9.40s
  5   -62.10299489788       -6.17       -3.49    4.0    10.5s
  6   -62.10299497917       -7.09       -4.31    3.7    10.1s
  7   -62.10299497989       -9.14       -4.86    4.1    12.6s
  8   -62.10299497995      -10.29       -6.35    3.9    11.3s
  9   -62.10299497995      -12.54       -7.10    4.4    12.0s
     1    -6.210299e+01     3.034805e-04
 * time: 242.43672919273376
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.09502054565                   -1.16    8.3    17.5s
  2   -62.09923015430       -2.38       -1.24    2.5    7.32s
  3   -62.10296615427       -2.43       -2.08    3.8    9.70s
  4   -62.10299674554       -4.51       -2.86    3.5    9.88s
  5   -62.10299734391       -6.22       -3.52    3.9    12.3s
  6   -62.10299741996       -7.12       -4.36    3.5    11.0s
  7   -62.10299742058       -9.21       -4.94    4.1    10.7s
  8   -62.10299742061      -10.46       -6.25    3.8    10.9s
  9   -62.10299742061      -12.48       -7.13    4.4    12.1s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.09502485143                   -1.16    8.3    18.3s
  2   -62.09922137279       -2.38       -1.24    2.5    7.98s
  3   -62.10296641567       -2.43       -2.08    3.7    9.62s
  4   -62.10299678595       -4.52       -2.89    3.5    9.91s
  5   -62.10299734676       -6.25       -3.54    3.9    10.5s
  6   -62.10299741998       -7.14       -4.39    3.5    9.63s
  7   -62.10299742058       -9.23       -4.93    4.0    10.6s
  8   -62.10299742061      -10.47       -6.29    3.7    10.2s
  9   -62.10299742061      -12.50       -7.09    4.4    13.1s
     2    -6.210300e+01     3.167672e-06
 * time: 479.45112705230713
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.09502191321                   -1.16    8.1    16.7s
  2   -62.09922670945       -2.38       -1.24    2.4    7.01s
  3   -62.10296629238       -2.43       -2.08    3.9    9.59s
  4   -62.10299678011       -4.52       -2.88    3.5    9.68s
  5   -62.10299734586       -6.25       -3.53    3.9    10.5s
  6   -62.10299742024       -7.13       -4.38    3.4    9.10s
  7   -62.10299742083       -9.23       -4.94    4.0    11.4s
  8   -62.10299742087      -10.47       -6.21    3.7    11.4s
  9   -62.10299742087      -12.45       -7.39    4.3    11.7s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.09502134277                   -1.16    8.2    18.5s
  2   -62.09922455445       -2.38       -1.24    2.5    7.36s
  3   -62.10296626607       -2.43       -2.08    3.9    11.3s
  4   -62.10299677032       -4.52       -2.88    3.4    10.8s
  5   -62.10299734477       -6.24       -3.53    3.8    11.6s
  6   -62.10299742022       -7.12       -4.37    3.5    10.5s
  7   -62.10299742083       -9.21       -4.91    4.0    13.0s
  8   -62.10299742087      -10.41       -6.28    3.7    11.6s
  9   -62.10299742087      -12.50       -7.08    4.4    12.9s
     3    -6.210300e+01     2.280609e-08
 * time: 715.8692610263824
 * Status: success

 * Candidate solution
    Final objective value:     -6.210300e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.67e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.56e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.55e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 4.11e-12 ≰ 0.0e+00
    |g(x)|                 = 2.28e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   716  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

NaCl: 849.681274 seconds (799.37 M allocations: 226.131 GiB, 5.21% gc time, 0.39% compilation time)
┌ Info: 2025-05-12T17:22:02.531
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.313845138311                   -1.45    5.5    2.13s
  2   -2.313950869589       -3.98       -1.83    1.4    954ms
  3   -2.313977391916       -4.58       -3.51    3.4    1.68s
  4   -2.313977613454       -6.65       -4.10    4.5    1.84s
  5   -2.313977613707       -9.60       -4.64    2.5    1.42s
  6   -2.313977613726      -10.73       -5.25    2.7    1.16s
  7   -2.313977613730      -11.42       -5.99    2.9    1.50s
  8   -2.313977613730      -13.29       -6.47    2.8    1.20s
  9   -2.313977613730      -14.45       -7.24    2.2    1.05s
Iter     Function value   Gradient norm 
     0    -2.313978e+00     2.201013e-03
 * time: 3.814697265625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.313848621530                   -1.45    5.5    2.16s
  2   -2.313956002906       -3.97       -1.84    1.5    829ms
  3   -2.313982152559       -4.58       -3.54    3.4    1.66s
  4   -2.313982360115       -6.68       -4.13    4.6    1.69s
  5   -2.313982360314       -9.70       -4.67    2.5    1.41s
  6   -2.313982360329      -10.83       -5.26    2.5    1.16s
  7   -2.313982360333      -11.44       -6.02    2.9    1.77s
  8   -2.313982360333      -13.13       -6.67    2.9    1.43s
  9   -2.313982360333      -14.88       -7.21    2.7    1.49s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.313846379867                   -1.45    5.4    2.16s
  2   -2.313955123964       -3.96       -1.84    1.5    814ms
  3   -2.313982153179       -4.57       -3.52    3.4    1.60s
  4   -2.313982360086       -6.68       -4.10    4.5    1.78s
  5   -2.313982360311       -9.65       -4.64    2.5    1.74s
  6   -2.313982360328      -10.76       -5.24    2.5    1.21s
  7   -2.313982360333      -11.39       -6.01    2.8    1.46s
  8   -2.313982360333      -13.06       -6.64    2.9    1.19s
  9   -2.313982360333      -15.05       -7.18    2.7    1.20s
     1    -2.313982e+00     2.112116e-03
 * time: 57.93098306655884
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.313918798281                   -1.44    5.4    2.64s
  2   -2.314011838968       -4.03       -1.83    1.3    1.02s
  3   -2.314036087813       -4.62       -3.50    3.4    1.96s
  4   -2.314036343046       -6.59       -4.22    4.4    1.65s
  5   -2.314036343202       -9.80       -4.83    2.7    1.41s
  6   -2.314036343209      -11.14       -5.38    2.7    1.50s
  7   -2.314036343212      -11.67       -6.24    3.1    1.51s
  8   -2.314036343212      -13.51       -6.77    2.9    1.55s
  9   -2.314036343212      -14.40       -7.86    2.9    1.81s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.313916890581                   -1.44    5.3    2.25s
  2   -2.314011609470       -4.02       -1.83    1.4    805ms
  3   -2.314036155151       -4.61       -3.50    3.4    1.63s
  4   -2.314036343039       -6.73       -4.22    4.5    1.79s
  5   -2.314036343202       -9.79       -4.83    2.7    1.44s
  6   -2.314036343210      -11.12       -5.39    2.7    1.15s
  7   -2.314036343212      -11.68       -6.27    3.0    1.56s
  8   -2.314036343212      -13.49       -6.83    3.1    1.35s
  9   -2.314036343212      -14.88       -7.81    2.9    1.85s
     2    -2.314036e+00     1.041367e-04
 * time: 118.35937905311584
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.313910052931                   -1.44    5.4    2.58s
  2   -2.314010708485       -4.00       -1.83    1.4    888ms
  3   -2.314036238452       -4.59       -3.50    3.4    1.66s
  4   -2.314036458766       -6.66       -4.18    4.5    1.66s
  5   -2.314036458941       -9.76       -4.79    2.7    1.43s
  6   -2.314036458951      -11.01       -5.34    2.7    1.13s
  7   -2.314036458954      -11.60       -6.25    3.1    1.51s
  8   -2.314036458954      -13.53       -6.78    3.2    1.32s
  9   -2.314036458954      -14.88       -7.80    2.6    1.41s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.313907987030                   -1.44    5.4    2.06s
  2   -2.314010697820       -3.99       -1.83    1.3    768ms
  3   -2.314036262973       -4.59       -3.52    3.3    1.60s
  4   -2.314036458800       -6.71       -4.22    4.5    1.64s
  5   -2.314036458941       -9.85       -4.79    2.6    1.43s
  6   -2.314036458951      -10.98       -5.33    2.6    1.10s
  7   -2.314036458954      -11.58       -6.27    3.1    1.50s
  8   -2.314036458954      -13.44       -6.79    3.1    1.25s
  9   -2.314036458954      -14.65       -7.74    3.0    1.51s
     3    -2.314036e+00     9.714635e-06
 * time: 175.47959518432617
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.313910355548                   -1.44    5.5    2.24s
  2   -2.314011276202       -4.00       -1.83    1.4    860ms
  3   -2.314036235711       -4.60       -3.51    3.3    1.73s
  4   -2.314036459829       -6.65       -4.23    4.6    1.78s
  5   -2.314036459966       -9.86       -4.81    2.6    1.51s
  6   -2.314036459975      -11.02       -5.35    2.7    1.21s
  7   -2.314036459978      -11.61       -6.26    3.1    1.59s
  8   -2.314036459978      -13.43       -6.76    3.1    1.33s
  9   -2.314036459978      -14.45       -7.77    3.0    1.61s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.313909837479                   -1.44    5.5    2.26s
  2   -2.314010982119       -4.00       -1.83    1.4    818ms
  3   -2.314036240130       -4.60       -3.51    3.4    1.69s
  4   -2.314036459817       -6.66       -4.20    4.4    1.68s
  5   -2.314036459963       -9.84       -4.77    2.7    1.45s
  6   -2.314036459975      -10.92       -5.30    2.6    1.13s
  7   -2.314036459978      -11.52       -6.23    3.1    1.58s
  8   -2.314036459978      -13.40       -6.77    3.1    1.29s
  9   -2.314036459978      -14.88       -7.90    2.7    1.47s
     4    -2.314036e+00     5.110011e-08
 * time: 232.94442701339722
 * Status: success

 * Candidate solution
    Final objective value:     -2.314036e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.10e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.76e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.02e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 4.43e-10 ≰ 0.0e+00
    |g(x)|                 = 5.11e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   233  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

Al: 266.774955 seconds (203.20 M allocations: 48.558 GiB, 6.61% gc time, 0.00% compilation time)
┌ Info: 2025-05-12T17:26:29.307
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.67800732378                   -0.84    9.7    11.3s
  2   -73.69197035207       -1.86       -1.05    5.4    5.95s
  3   -73.69890802769       -2.16       -1.38    6.8    7.32s
  4   -73.70018212939       -2.89       -1.77    5.9    6.32s
  5   -73.70032861252       -3.83       -2.19    4.9    5.37s
  6   -73.70035364856       -4.60       -3.07    5.5    5.98s
  7   -73.70035368568       -7.43       -3.54    4.4    5.22s
  8   -73.70035369438       -8.06       -4.19    5.5    5.72s
  9   -73.70035369443      -10.27       -4.54    4.0    4.94s
 10   -73.70035369504       -9.22       -5.13    5.4    5.93s
 11   -73.70035369504      -11.37       -5.97    5.4    6.98s
 12   -73.70035369504      -12.28       -6.57    5.6    6.30s
 13   -73.70035369504   +  -13.55       -6.97    3.0    3.96s
 14   -73.70035369504      -12.94       -7.47    5.4    5.90s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.370035e+01     1.107789e-02
 * time: 3.218650817871094e-5
┌ Warning: Negative ρcore detected: -3.375070465649383e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.67841901471                   -0.84    9.7    9.56s
  2   -73.69210411568       -1.86       -1.05    5.4    5.67s
  3   -73.69904552019       -2.16       -1.38    6.8    7.04s
  4   -73.70029502551       -2.90       -1.77    5.9    5.96s
  5   -73.70044620914       -3.82       -2.23    4.9    5.46s
  6   -73.70046721034       -4.68       -3.08    5.5    5.93s
  7   -73.70046725531       -7.35       -3.54    4.7    5.33s
  8   -73.70046726194       -8.18       -4.18    5.4    5.63s
  9   -73.70046726183   +   -9.98       -4.59    4.6    5.46s
 10   -73.70046726239       -9.26       -4.96    5.4    5.88s
 11   -73.70046726240      -11.04       -5.89    5.0    5.78s
 12   -73.70046726240   +    -Inf       -6.44    5.1    5.96s
 13   -73.70046726240   +  -13.25       -6.57    3.5    4.68s
 14   -73.70046726240      -13.37       -7.20    4.9    5.20s
┌ Warning: Negative ρcore detected: -3.375070465649383e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.67840204297                   -0.84    9.9    9.37s
  2   -73.69211736674       -1.86       -1.05    5.5    5.49s
  3   -73.69904578518       -2.16       -1.38    6.8    7.00s
  4   -73.70029492834       -2.90       -1.77    5.8    5.97s
  5   -73.70044585518       -3.82       -2.22    5.0    5.50s
  6   -73.70046720815       -4.67       -3.08    5.5    6.33s
  7   -73.70046725418       -7.34       -3.54    4.7    6.77s
  8   -73.70046726186       -8.11       -4.17    5.4    5.95s
  9   -73.70046726176   +  -10.00       -4.56    4.6    5.41s
 10   -73.70046726239       -9.20       -4.99    5.3    5.73s
 11   -73.70046726240      -10.98       -5.95    5.2    6.03s
 12   -73.70046726240   +  -12.81       -6.51    5.2    6.48s
 13   -73.70046726240   +  -13.85       -6.61    2.4    3.62s
 14   -73.70046726240      -12.77       -7.39    5.1    5.37s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.375070465649383e-8,-6.064773780472325e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.370047e+01     9.422400e-03
 * time: 231.06186318397522
┌ Warning: Negative ρcore detected: -3.154712818995848e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.68045227155                   -0.85    9.7    9.31s
  2   -73.69257246797       -1.92       -1.05    5.4    5.69s
  3   -73.69940890071       -2.17       -1.39    6.9    8.63s
  4   -73.70057533095       -2.93       -1.76    5.8    6.25s
  5   -73.70073471954       -3.80       -2.25    5.0    5.46s
  6   -73.70075350002       -4.73       -3.09    5.5    5.99s
  7   -73.70075352055       -7.69       -3.54    4.2    5.07s
  8   -73.70075352497       -8.35       -4.05    4.8    5.41s
  9   -73.70075352481   +   -9.79       -4.56    5.2    5.80s
 10   -73.70075352521       -9.39       -4.82    5.5    5.93s
 11   -73.70075352525      -10.45       -5.53    5.0    5.59s
 12   -73.70075352525      -11.72       -6.30    4.6    5.62s
 13   -73.70075352525   +  -13.55       -6.62    4.7    5.51s
 14   -73.70075352525      -13.07       -7.07    5.2    6.23s
┌ Warning: Negative ρcore detected: -3.154712818995848e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.68043563615                   -0.85    9.7    9.29s
  2   -73.69257275595       -1.92       -1.05    5.5    5.48s
  3   -73.69941002620       -2.17       -1.39    6.8    7.00s
  4   -73.70057580905       -2.93       -1.76    5.8    5.78s
  5   -73.70073490294       -3.80       -2.25    5.0    5.42s
  6   -73.70075350080       -4.73       -3.09    5.5    6.57s
  7   -73.70075352086       -7.70       -3.54    4.3    5.45s
  8   -73.70075352497       -8.39       -4.05    4.8    5.71s
  9   -73.70075352482   +   -9.84       -4.54    5.2    6.12s
 10   -73.70075352522       -9.41       -4.80    5.5    5.81s
 11   -73.70075352525      -10.48       -5.51    5.0    5.46s
 12   -73.70075352525      -11.65       -6.28    4.6    5.43s
 13   -73.70075352525      -12.89       -6.64    4.9    5.65s
 14   -73.70075352525   +  -13.25       -7.11    5.2    5.63s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.154712818995848e-8,1.4743514405048201e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.370075e+01     5.020580e-04
 * time: 465.5773811340332
┌ Warning: Negative ρcore detected: -3.1058407165499604e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.68036238417                   -0.85    9.6    8.95s
  2   -73.69254727804       -1.91       -1.05    5.3    5.63s
  3   -73.69940982348       -2.16       -1.39    6.8    7.82s
  4   -73.70057502165       -2.93       -1.76    5.8    6.11s
  5   -73.70073553274       -3.79       -2.25    5.1    5.57s
  6   -73.70075426509       -4.73       -3.08    5.5    6.40s
  7   -73.70075428365       -7.73       -3.54    4.3    5.20s
  8   -73.70075428784       -8.38       -4.07    4.9    5.36s
  9   -73.70075428763   +   -9.68       -4.54    5.2    5.81s
 10   -73.70075428805       -9.38       -4.81    5.6    5.89s
 11   -73.70075428808      -10.48       -5.54    4.8    5.48s
 12   -73.70075428808      -11.67       -6.35    4.8    5.88s
 13   -73.70075428808   +  -13.15       -6.63    4.0    5.02s
 14   -73.70075428808      -13.07       -7.08    5.0    5.66s
┌ Warning: Negative ρcore detected: -3.1058407165499604e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.68036264272                   -0.85    9.7    10.3s
  2   -73.69254802074       -1.91       -1.05    5.4    5.94s
  3   -73.69940925368       -2.16       -1.39    6.8    8.26s
  4   -73.70057500389       -2.93       -1.76    5.8    6.78s
  5   -73.70073551160       -3.79       -2.25    5.0    6.19s
  6   -73.70075426493       -4.73       -3.08    5.5    5.97s
  7   -73.70075428397       -7.72       -3.54    4.2    5.01s
  8   -73.70075428782       -8.41       -4.06    4.7    5.48s
  9   -73.70075428766   +   -9.81       -4.53    5.1    6.95s
 10   -73.70075428805       -9.41       -4.80    5.6    6.29s
 11   -73.70075428808      -10.48       -5.54    4.9    6.70s
 12   -73.70075428808      -11.68       -6.34    4.8    5.50s
 13   -73.70075428808   +  -13.55       -6.64    4.5    6.28s
 14   -73.70075428808      -13.07       -7.10    5.0    6.12s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1058407165499604e-8,1.589435249841917e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.370075e+01     2.364400e-05
 * time: 705.7123401165009
┌ Warning: Negative ρcore detected: -3.108117175960053e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.68035422765                   -0.85    9.7    9.04s
  2   -73.69254749446       -1.91       -1.05    5.4    5.51s
  3   -73.69941084126       -2.16       -1.39    6.9    7.37s
  4   -73.70057443027       -2.93       -1.76    5.9    5.83s
  5   -73.70073576524       -3.79       -2.25    5.2    5.43s
  6   -73.70075426744       -4.73       -3.09    5.5    5.87s
  7   -73.70075428544       -7.74       -3.54    4.3    4.90s
  8   -73.70075428951       -8.39       -4.07    4.8    5.27s
  9   -73.70075428930   +   -9.68       -4.53    5.2    5.71s
 10   -73.70075428973       -9.38       -4.80    5.5    5.66s
 11   -73.70075428976      -10.49       -5.53    4.8    5.22s
 12   -73.70075428976      -11.64       -6.36    4.8    5.55s
 13   -73.70075428976   +  -13.37       -6.63    4.5    5.41s
 14   -73.70075428976      -13.25       -7.08    5.1    6.43s
┌ Warning: Negative ρcore detected: -3.108117175960053e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.68036879990                   -0.85    9.8    10.0s
  2   -73.69255201746       -1.91       -1.05    5.4    6.85s
  3   -73.69940867359       -2.16       -1.39    6.9    7.85s
  4   -73.70057490495       -2.93       -1.76    5.9    6.14s
  5   -73.70073630210       -3.79       -2.26    5.1    5.51s
  6   -73.70075426756       -4.75       -3.09    5.5    6.28s
  7   -73.70075428552       -7.75       -3.55    4.3    5.60s
  8   -73.70075428951       -8.40       -4.07    4.8    6.42s
  9   -73.70075428929   +   -9.66       -4.53    5.3    6.18s
 10   -73.70075428973       -9.36       -4.80    5.6    5.79s
 11   -73.70075428976      -10.48       -5.54    4.8    5.38s
 12   -73.70075428976      -11.67       -6.36    4.7    5.61s
 13   -73.70075428976      -13.55       -6.64    4.4    5.28s
 14   -73.70075428976   +  -13.37       -7.08    5.1    5.40s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.108117175960053e-8,1.5843439745813766e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     4    -7.370075e+01     6.173301e-08
 * time: 939.5104081630707
 * Status: success

 * Candidate solution
    Final objective value:     -7.370075e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.43e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.55e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.68e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.28e-11 ≰ 0.0e+00
    |g(x)|                 = 6.17e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   940  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

V: 1070.919151 seconds (720.98 M allocations: 340.388 GiB, 5.90% gc time, 0.01% compilation time)
