┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-12T16:27:35.021
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.448789721646                   -0.96    7.0    11.3s
  2   -8.450569260007       -2.75       -1.76    1.9    5.26s
  3   -8.450635889267       -4.18       -2.79    3.7    1.92s
  4   -8.450636947267       -5.98       -3.75    4.5    1.82s
  5   -8.450636968993       -7.66       -4.42    4.6    2.01s
  6   -8.450636969994       -9.00       -5.41    4.7    1.91s
  7   -8.450636970005      -10.93       -6.19    4.4    1.76s
  8   -8.450636970005      -12.79       -7.41    3.6    1.92s
Iter     Function value   Gradient norm 
     0    -8.450637e+00     2.445927e-03
 * time: 4.315376281738281e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.448799974650                   -0.96    7.2    2.62s
  2   -8.450574398415       -2.75       -1.76    1.9    1.38s
  3   -8.450641450705       -4.17       -2.79    3.8    1.66s
  4   -8.450642724827       -5.89       -3.75    4.7    2.17s
  5   -8.450642745713       -7.68       -4.45    4.7    2.06s
  6   -8.450642746600       -9.05       -5.43    4.8    2.04s
  7   -8.450642746610      -11.01       -6.17    4.3    1.72s
  8   -8.450642746610      -12.78       -7.37    3.6    1.86s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.448808028595                   -0.96    7.2    2.58s
  2   -8.450576173776       -2.75       -1.76    2.0    1.42s
  3   -8.450641599678       -4.18       -2.79    3.9    1.62s
  4   -8.450642725243       -5.95       -3.75    4.5    2.04s
  5   -8.450642745721       -7.69       -4.45    4.7    1.77s
  6   -8.450642746600       -9.06       -5.43    4.8    1.94s
  7   -8.450642746610      -11.02       -6.17    4.3    1.73s
  8   -8.450642746610      -12.81       -7.41    3.8    1.80s
     1    -8.450643e+00     2.277454e-03
 * time: 43.92338013648987
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.448765621519                   -0.96    7.0    2.59s
  2   -8.450607812880       -2.73       -1.76    2.1    1.14s
  3   -8.450678881295       -4.15       -2.78    3.8    1.88s
  4   -8.450679932262       -5.98       -3.75    4.6    1.73s
  5   -8.450679951630       -7.71       -4.46    4.5    2.06s
  6   -8.450679952472       -9.08       -5.44    4.9    1.80s
  7   -8.450679952481      -11.05       -6.16    4.2    2.04s
  8   -8.450679952481      -12.77       -7.36    3.7    1.55s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.448770660904                   -0.96    7.0    2.54s
  2   -8.450611717852       -2.73       -1.76    2.0    1.30s
  3   -8.450678801284       -4.17       -2.78    3.8    2.09s
  4   -8.450679933161       -5.95       -3.73    4.4    1.80s
  5   -8.450679951672       -7.73       -4.49    4.7    2.32s
  6   -8.450679952474       -9.10       -5.50    4.8    1.77s
  7   -8.450679952481      -11.20       -6.29    4.3    2.03s
  8   -8.450679952481      -12.99       -7.30    3.7    1.55s
     2    -8.450680e+00     3.915191e-05
 * time: 86.52191400527954
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.448757954958                   -0.96    7.0    2.55s
  2   -8.450603944260       -2.73       -1.76    1.8    1.14s
  3   -8.450678788592       -4.13       -2.79    3.7    1.91s
  4   -8.450679942454       -5.94       -3.75    4.4    2.10s
  5   -8.450679962328       -7.70       -4.45    4.6    1.75s
  6   -8.450679963239       -9.04       -5.41    4.7    2.02s
  7   -8.450679963249      -11.01       -6.19    4.1    1.70s
  8   -8.450679963249      -12.81       -7.37    3.7    1.85s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.448778062103                   -0.96    6.9    3.04s
  2   -8.450613156477       -2.74       -1.76    1.9    1.18s
  3   -8.450678828280       -4.18       -2.78    3.7    1.87s
  4   -8.450679944109       -5.95       -3.74    4.4    2.06s
  5   -8.450679962422       -7.74       -4.47    4.4    1.73s
  6   -8.450679963240       -9.09       -5.48    4.7    2.01s
  7   -8.450679963249      -11.05       -6.19    4.2    1.74s
  8   -8.450679963249      -12.84       -7.36    3.6    1.82s
     3    -8.450680e+00     6.116339e-07
 * time: 128.70383501052856
 * Status: success

 * Candidate solution
    Final objective value:     -8.450680e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 5.59e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 5.42e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.08e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.27e-09 ≰ 0.0e+00
    |g(x)|                 = 6.12e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   129  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 204.273426 seconds (308.52 M allocations: 58.872 GiB, 7.55% gc time, 25.90% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-12T16:30:59.942
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.16348820849                   -1.16    8.4    19.3s
  2   -62.16786161942       -2.36       -1.22    2.6    7.71s
  3   -62.17195574956       -2.39       -2.06    3.8    9.60s
  4   -62.17198809895       -4.49       -2.89    3.6    9.20s
  5   -62.17198856532       -6.33       -3.54    4.0    10.4s
  6   -62.17198861036       -7.35       -4.30    3.6    9.58s
  7   -62.17198861088       -9.29       -4.91    4.0    10.2s
  8   -62.17198861091      -10.48       -6.34    3.9    10.6s
  9   -62.17198861091      -12.54       -7.24    4.5    11.5s
Iter     Function value   Gradient norm 
     0    -6.217199e+01     2.930626e-04
 * time: 3.504753112792969e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.16348652668                   -1.16    9.0    17.6s
  2   -62.16785650840       -2.36       -1.22    2.6    7.27s
  3   -62.17195585798       -2.39       -2.06    3.8    9.33s
  4   -62.17198814991       -4.49       -2.88    3.5    9.73s
  5   -62.17198865023       -6.30       -3.54    4.0    10.5s
  6   -62.17198869540       -7.35       -4.31    3.9    10.1s
  7   -62.17198869594       -9.27       -4.89    4.1    10.7s
  8   -62.17198869598      -10.43       -6.44    4.0    10.2s
  9   -62.17198869598      -12.57       -7.20    4.5    12.3s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.16348883645                   -1.16    8.9    17.9s
  2   -62.16784561789       -2.36       -1.22    2.7    7.52s
  3   -62.17195618773       -2.39       -2.06    3.9    9.45s
  4   -62.17198817695       -4.49       -2.89    3.7    10.1s
  5   -62.17198865204       -6.32       -3.56    4.1    10.5s
  6   -62.17198869547       -7.36       -4.33    3.8    9.92s
  7   -62.17198869595       -9.32       -4.93    4.1    11.6s
  8   -62.17198869598      -10.54       -6.37    3.9    10.3s
  9   -62.17198869598      -12.72       -7.33    4.6    11.7s
     1    -6.217199e+01     2.874196e-04
 * time: 227.50598311424255
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.16354517505                   -1.16    8.5    16.8s
  2   -62.16790215419       -2.36       -1.22    2.5    7.17s
  3   -62.17195878381       -2.39       -2.07    3.8    9.22s
  4   -62.17199030175       -4.50       -2.89    3.6    9.45s
  5   -62.17199078468       -6.32       -3.55    4.0    10.4s
  6   -62.17199082886       -7.35       -4.33    3.6    9.81s
  7   -62.17199082936       -9.29       -4.94    4.0    10.4s
  8   -62.17199082939      -10.56       -6.31    3.9    9.92s
  9   -62.17199082939      -12.83       -7.26    4.4    11.4s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.16354339809                   -1.16    8.5    16.8s
  2   -62.16790413970       -2.36       -1.23    2.6    7.26s
  3   -62.17195898980       -2.39       -2.07    3.8    9.25s
  4   -62.17199032738       -4.50       -2.90    3.5    9.21s
  5   -62.17199078729       -6.34       -3.58    4.0    10.2s
  6   -62.17199082895       -7.38       -4.37    3.6    9.36s
  7   -62.17199082937       -9.38       -4.98    4.1    10.6s
  8   -62.17199082939      -10.63       -6.44    3.8    9.71s
  9   -62.17199082939      -12.72       -7.17    4.4    11.3s
     2    -6.217199e+01     2.357751e-06
 * time: 450.50092816352844
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.16354688494                   -1.16    9.0    17.2s
  2   -62.16791842833       -2.36       -1.23    2.6    7.22s
  3   -62.17195871468       -2.39       -2.06    3.9    9.10s
  4   -62.17199031929       -4.50       -2.89    3.6    8.89s
  5   -62.17199078515       -6.33       -3.54    4.0    10.2s
  6   -62.17199082902       -7.36       -4.32    3.6    9.00s
  7   -62.17199082950       -9.32       -4.96    4.0    9.93s
  8   -62.17199082953      -10.57       -6.26    3.9    10.0s
  9   -62.17199082953      -12.67       -7.06    4.5    10.9s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.16354569278                   -1.16    9.0    17.3s
  2   -62.16790412916       -2.36       -1.23    2.7    7.83s
  3   -62.17195879470       -2.39       -2.06    3.9    9.54s
  4   -62.17199033181       -4.50       -2.90    3.6    9.25s
  5   -62.17199078650       -6.34       -3.56    4.0    9.80s
  6   -62.17199082907       -7.37       -4.35    3.7    9.25s
  7   -62.17199082950       -9.36       -4.94    4.0    11.1s
  8   -62.17199082953      -10.58       -6.37    4.0    10.0s
  9   -62.17199082953      -12.73       -7.22    4.6    11.6s
     3    -6.217199e+01     1.217979e-09
 * time: 672.0951590538025
 * Status: success

 * Candidate solution
    Final objective value:     -6.217199e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.21e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.13e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.39e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.23e-12 ≰ 0.0e+00
    |g(x)|                 = 1.22e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   672  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

NaCl: 795.976792 seconds (795.68 M allocations: 228.337 GiB, 5.24% gc time, 0.43% compilation time)
┌ Info: 2025-05-12T16:44:15.952
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315574820835                   -1.46    5.4    2.14s
  2   -2.315663317939       -4.05       -1.84    1.4    789ms
  3   -2.315684575632       -4.67       -3.56    3.3    2.07s
  4   -2.315684784528       -6.68       -4.13    4.6    2.33s
  5   -2.315684784930       -9.40       -4.58    2.6    1.48s
  6   -2.315684784996      -10.18       -5.22    2.8    1.18s
  7   -2.315684784999      -11.54       -5.90    2.8    1.58s
  8   -2.315684784999      -13.31       -6.55    2.5    1.19s
  9   -2.315684784999      -14.45       -7.47    2.6    1.58s
Iter     Function value   Gradient norm 
     0    -2.315685e+00     1.270080e-03
 * time: 3.1948089599609375e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315576908828                   -1.46    5.5    2.26s
  2   -2.315664995076       -4.06       -1.84    1.4    864ms
  3   -2.315686160520       -4.67       -3.55    3.3    1.99s
  4   -2.315686364973       -6.69       -4.12    4.6    2.14s
  5   -2.315686365383       -9.39       -4.57    2.5    1.39s
  6   -2.315686365450      -10.17       -5.21    2.9    1.17s
  7   -2.315686365453      -11.52       -5.89    2.8    1.67s
  8   -2.315686365453      -13.35       -6.57    2.5    1.29s
  9   -2.315686365453      -14.51       -7.46    2.6    1.28s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315576891108                   -1.46    5.5    2.04s
  2   -2.315665162162       -4.05       -1.84    1.4    820ms
  3   -2.315686139395       -4.68       -3.58    3.2    1.69s
  4   -2.315686365067       -6.65       -4.16    4.6    1.91s
  5   -2.315686365399       -9.48       -4.62    2.6    1.35s
  6   -2.315686365451      -10.28       -5.29    2.7    1.11s
  7   -2.315686365453      -11.63       -5.94    2.8    1.43s
  8   -2.315686365453      -13.50       -6.53    2.4    1.06s
  9   -2.315686365453      -14.57       -7.43    2.4    1.07s
     1    -2.315686e+00     1.218678e-03
 * time: 56.90630483627319
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315602097109                   -1.45    5.3    1.95s
  2   -2.315684854797       -4.08       -1.83    1.3    759ms
  3   -2.315704595190       -4.70       -3.55    3.4    1.55s
  4   -2.315704797794       -6.69       -4.11    4.5    1.61s
  5   -2.315704798225       -9.37       -4.59    2.6    1.30s
  6   -2.315704798283      -10.23       -5.30    2.9    1.14s
  7   -2.315704798286      -11.62       -5.85    3.1    1.49s
  8   -2.315704798286      -13.34       -6.53    2.3    1.01s
  9   -2.315704798286      -14.65       -7.39    2.6    1.41s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315602517765                   -1.45    5.3    2.20s
  2   -2.315685278846       -4.08       -1.83    1.4    753ms
  3   -2.315704599442       -4.71       -3.56    3.3    1.51s
  4   -2.315704797833       -6.70       -4.13    4.5    1.61s
  5   -2.315704798223       -9.41       -4.60    2.6    1.31s
  6   -2.315704798284      -10.21       -5.30    2.8    1.09s
  7   -2.315704798286      -11.64       -5.87    3.0    1.44s
  8   -2.315704798286      -13.33       -6.50    2.2    999ms
  9   -2.315704798286      -14.45       -7.32    2.5    1.09s
     2    -2.315705e+00     3.221551e-07
 * time: 111.6476149559021
 * Status: success

 * Candidate solution
    Final objective value:     -2.315705e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.01e-02 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.96e-03 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.84e-05 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 7.96e-06 ≰ 0.0e+00
    |g(x)|                 = 3.22e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   112  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Al: 147.717051 seconds (112.62 M allocations: 26.796 GiB, 6.32% gc time, 0.00% compilation time)
┌ Info: 2025-05-12T16:46:43.670
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73364788892                   -0.86    9.7    9.39s
  2   -73.74557146238       -1.92       -1.07    5.3    6.00s
  3   -73.75207014153       -2.19       -1.40    6.8    7.28s
  4   -73.75317079036       -2.96       -1.78    5.8    5.83s
  5   -73.75332384604       -3.82       -2.25    5.0    5.65s
  6   -73.75334327603       -4.71       -3.09    5.5    7.15s
  7   -73.75334330594       -7.52       -3.53    4.4    5.13s
  8   -73.75334331024       -8.37       -4.11    4.9    5.37s
  9   -73.75334331010   +   -9.87       -4.56    4.8    5.87s
 10   -73.75334331056       -9.34       -4.81    5.6    6.42s
 11   -73.75334331057      -10.86       -5.76    4.4    5.98s
 12   -73.75334331057      -12.85       -6.37    4.7    5.69s
 13   -73.75334331057   +  -13.37       -6.58    3.2    4.21s
 14   -73.75334331057      -13.25       -7.01    4.9    5.66s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.375334e+01     8.350522e-03
 * time: 3.504753112792969e-5
┌ Warning: Negative ρcore detected: -3.389938773420521e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73391180320                   -0.86    9.7    9.06s
  2   -73.74564170251       -1.93       -1.07    5.4    5.67s
  3   -73.75214637255       -2.19       -1.41    6.8    7.04s
  4   -73.75323225296       -2.96       -1.77    5.8    5.77s
  5   -73.75338802637       -3.81       -2.24    5.0    5.45s
  6   -73.75340779881       -4.70       -3.08    5.5    6.95s
  7   -73.75340782161       -7.64       -3.51    4.3    5.65s
  8   -73.75340782548       -8.41       -4.09    4.6    5.14s
  9   -73.75340782530   +   -9.74       -4.49    5.0    5.61s
 10   -73.75340782572       -9.38       -4.76    5.5    5.58s
 11   -73.75340782574      -10.71       -5.69    4.4    4.98s
 12   -73.75340782574      -12.30       -6.31    4.8    5.94s
 13   -73.75340782574   +  -13.55       -6.55    4.4    5.15s
 14   -73.75340782574      -13.85       -6.91    5.1    5.28s
 15   -73.75340782574   +    -Inf       -7.85    4.8    5.59s
┌ Warning: Negative ρcore detected: -3.389938773420521e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73391181515                   -0.86    9.6    10.1s
  2   -73.74564569147       -1.93       -1.07    5.3    6.06s
  3   -73.75214628234       -2.19       -1.41    6.8    7.26s
  4   -73.75323247839       -2.96       -1.77    5.9    6.61s
  5   -73.75338838269       -3.81       -2.25    5.1    5.61s
  6   -73.75340779916       -4.71       -3.08    5.6    6.62s
  7   -73.75340782136       -7.65       -3.52    4.2    5.22s
  8   -73.75340782549       -8.38       -4.09    4.7    5.54s
  9   -73.75340782526   +   -9.64       -4.50    5.1    5.90s
 10   -73.75340782572       -9.34       -4.78    5.5    7.13s
 11   -73.75340782574      -10.75       -5.68    4.3    5.01s
 12   -73.75340782574      -12.26       -6.30    4.9    6.24s
 13   -73.75340782574   +  -13.55       -6.52    3.9    4.80s
 14   -73.75340782574   +  -13.25       -6.91    5.1    5.55s
 15   -73.75340782574   +  -13.07       -7.85    4.8    5.47s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.389938773420521e-8,-4.842110696072856e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.375341e+01     7.098942e-03
 * time: 244.7936351299286
┌ Warning: Negative ρcore detected: -3.123164422534395e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73516878390                   -0.87    9.5    10.0s
  2   -73.74599825566       -1.97       -1.07    5.3    6.08s
  3   -73.75234985577       -2.20       -1.41    6.7    7.55s
  4   -73.75340289851       -2.98       -1.78    5.7    6.70s
  5   -73.75355179452       -3.83       -2.25    5.0    5.76s
  6   -73.75357071201       -4.72       -3.08    5.5    6.10s
  7   -73.75357074005       -7.55       -3.54    4.3    5.16s
  8   -73.75357074465       -8.34       -4.05    4.7    5.33s
  9   -73.75357074448   +   -9.76       -4.53    5.2    6.27s
 10   -73.75357074491       -9.36       -4.79    5.4    7.14s
 11   -73.75357074495      -10.42       -5.49    4.8    6.04s
 12   -73.75357074495      -11.84       -6.23    4.5    6.98s
 13   -73.75357074495   +  -12.81       -6.56    4.7    5.58s
 14   -73.75357074495   +  -12.85       -7.01    5.1    5.48s
┌ Warning: Negative ρcore detected: -3.123164422534395e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73516448453                   -0.87    9.6    9.01s
  2   -73.74602326626       -1.96       -1.07    5.2    5.35s
  3   -73.75234602523       -2.20       -1.41    6.7    6.87s
  4   -73.75340365476       -2.98       -1.78    5.7    5.74s
  5   -73.75355179942       -3.83       -2.26    5.0    5.31s
  6   -73.75357071227       -4.72       -3.09    5.5    6.01s
  7   -73.75357073933       -7.57       -3.55    4.4    5.25s
  8   -73.75357074465       -8.27       -4.06    4.9    5.47s
  9   -73.75357074435   +   -9.52       -4.52    5.3    6.24s
 10   -73.75357074492       -9.25       -4.80    5.6    6.95s
 11   -73.75357074495      -10.45       -5.50    4.8    6.37s
 12   -73.75357074495      -11.86       -6.26    4.6    5.55s
 13   -73.75357074495   +  -13.00       -6.57    4.6    5.60s
 14   -73.75357074495   +  -12.73       -6.99    5.2    5.68s
 15   -73.75357074495   +  -12.89       -7.75    5.3    5.94s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.123164422534395e-8,-4.3059308987852374e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.375357e+01     3.116584e-04
 * time: 488.6665241718292
┌ Warning: Negative ρcore detected: -3.130873373280371e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73510466407                   -0.87    9.9    10.1s
  2   -73.74602397444       -1.96       -1.07    5.4    6.27s
  3   -73.75234532178       -2.20       -1.41    6.8    8.04s
  4   -73.75340212026       -2.98       -1.78    5.8    6.18s
  5   -73.75355154669       -3.83       -2.25    5.0    5.55s
  6   -73.75357102011       -4.71       -3.09    5.6    6.32s
  7   -73.75357103900       -7.72       -3.55    4.3    5.17s
  8   -73.75357104404       -8.30       -4.05    4.8    5.63s
  9   -73.75357104378   +   -9.59       -4.51    5.4    5.81s
 10   -73.75357104430       -9.28       -4.80    5.6    5.70s
 11   -73.75357104434      -10.48       -5.50    4.8    6.22s
 12   -73.75357104434      -11.90       -6.26    4.7    5.45s
 13   -73.75357104434   +  -12.89       -6.57    4.8    5.52s
 14   -73.75357104434   +  -12.85       -7.01    5.2    5.57s
┌ Warning: Negative ρcore detected: -3.130873373280371e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73511191380                   -0.87    9.9    9.44s
  2   -73.74602898326       -1.96       -1.07    5.4    5.47s
  3   -73.75234424195       -2.20       -1.41    6.8    6.74s
  4   -73.75340231067       -2.98       -1.78    5.8    5.66s
  5   -73.75355180849       -3.83       -2.25    5.0    5.41s
  6   -73.75357101944       -4.72       -3.09    5.6    6.14s
  7   -73.75357103912       -7.71       -3.55    4.4    5.27s
  8   -73.75357104405       -8.31       -4.05    4.9    5.62s
  9   -73.75357104378   +   -9.58       -4.52    5.4    5.97s
 10   -73.75357104430       -9.28       -4.80    5.5    5.99s
 11   -73.75357104434      -10.49       -5.51    4.9    5.50s
 12   -73.75357104434      -11.97       -6.28    4.6    5.50s
 13   -73.75357104434   +  -13.25       -6.56    4.7    5.57s
 14   -73.75357104434   +  -12.77       -6.99    5.2    5.54s
 15   -73.75357104434   +  -13.07       -7.76    5.3    5.74s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.130873373280371e-8,-3.4364179714646254e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.375357e+01     1.109433e-05
 * time: 729.503032207489
┌ Warning: Negative ρcore detected: -3.1306370516069145e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73509836238                   -0.87    9.6    9.43s
  2   -73.74601351922       -1.96       -1.07    5.3    5.65s
  3   -73.75234849843       -2.20       -1.41    6.6    7.12s
  4   -73.75340197965       -2.98       -1.78    5.8    5.89s
  5   -73.75355136861       -3.83       -2.25    4.9    5.50s
  6   -73.75357102001       -4.71       -3.08    5.5    6.27s
  7   -73.75357103943       -7.71       -3.54    4.3    5.17s
  8   -73.75357104441       -8.30       -4.05    4.8    5.46s
  9   -73.75357104421   +   -9.70       -4.53    5.3    5.89s
 10   -73.75357104468       -9.33       -4.79    5.5    5.84s
 11   -73.75357104471      -10.47       -5.50    4.8    5.51s
 12   -73.75357104471      -11.93       -6.26    4.6    5.46s
 13   -73.75357104471   +  -13.85       -6.56    4.7    5.60s
 14   -73.75357104471   +  -12.57       -7.00    5.1    5.57s
 15   -73.75357104471   +  -12.94       -7.76    5.2    5.64s
┌ Warning: Negative ρcore detected: -3.1306370516069145e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.73511212588                   -0.87    9.6    9.64s
  2   -73.74601478160       -1.96       -1.07    5.3    5.45s
  3   -73.75234736317       -2.20       -1.41    6.6    6.95s
  4   -73.75340204860       -2.98       -1.78    5.7    5.82s
  5   -73.75355140250       -3.83       -2.25    4.9    5.34s
  6   -73.75357101900       -4.71       -3.08    5.4    5.92s
  7   -73.75357103963       -7.69       -3.54    4.3    5.16s
  8   -73.75357104440       -8.32       -4.04    4.7    5.28s
  9   -73.75357104424   +   -9.78       -4.54    5.2    5.73s
 10   -73.75357104468       -9.36       -4.80    5.5    6.15s
 11   -73.75357104471      -10.46       -5.51    4.8    5.95s
 12   -73.75357104471      -12.08       -6.27    4.6    5.64s
 13   -73.75357104471      -13.55       -6.56    4.6    6.34s
 14   -73.75357104471   +  -12.77       -7.00    5.2    6.60s
 15   -73.75357104471   +  -12.81       -7.76    5.3    6.29s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1306370516069145e-8,-3.4660909389684544e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     4    -7.375357e+01     1.404187e-08
 * time: 973.3141300678253
 * Status: success

 * Candidate solution
    Final objective value:     -7.375357e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 6.85e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.21e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 3.74e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 5.07e-12 ≰ 0.0e+00
    |g(x)|                 = 1.40e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   973  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

V: 1102.205168 seconds (743.50 M allocations: 354.221 GiB, 5.97% gc time, 0.01% compilation time)
