┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-12T16:27:27.070
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.440669879480                   -0.96    7.0    11.1s
  2   -8.442466850465       -2.75       -1.77    1.8    4.74s
  3   -8.442534072927       -4.17       -2.81    3.9    2.02s
  4   -8.442535278059       -5.92       -3.72    4.5    1.91s
  5   -8.442535299779       -7.66       -4.50    4.5    2.17s
  6   -8.442535300592       -9.09       -5.47    4.7    1.86s
  7   -8.442535300600      -11.11       -6.23    4.2    2.13s
  8   -8.442535300600      -12.90       -7.36    3.7    1.68s
Iter     Function value   Gradient norm 
     0    -8.442535e+00     3.597802e-03
 * time: 4.792213439941406e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.440640520833                   -0.96    7.2    2.71s
  2   -8.442472989519       -2.74       -1.77    1.9    1.18s
  3   -8.442546654827       -4.13       -2.80    3.8    2.02s
  4   -8.442547777501       -5.95       -3.75    4.6    2.29s
  5   -8.442547799029       -7.67       -4.43    4.5    1.84s
  6   -8.442547799978       -9.02       -5.40    4.6    2.13s
  7   -8.442547799989      -10.93       -6.19    4.4    1.79s
  8   -8.442547799990      -12.78       -7.40    3.8    1.93s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.440647958196                   -0.96    7.1    2.67s
  2   -8.442470037274       -2.74       -1.77    2.0    1.46s
  3   -8.442546749040       -4.12       -2.80    3.9    1.69s
  4   -8.442547776164       -5.99       -3.76    4.6    2.05s
  5   -8.442547798847       -7.64       -4.37    4.7    1.80s
  6   -8.442547799974       -8.95       -5.32    4.6    1.95s
  7   -8.442547799989      -10.82       -6.17    4.2    1.71s
  8   -8.442547799990      -12.69       -7.40    3.7    1.88s
     1    -8.442548e+00     3.350405e-03
 * time: 43.66940784454346
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.440662960798                   -0.96    6.9    2.50s
  2   -8.442553470111       -2.72       -1.77    2.0    1.11s
  3   -8.442626881106       -4.13       -2.81    3.8    1.90s
  4   -8.442627969205       -5.96       -3.74    4.5    1.73s
  5   -8.442627993281       -7.62       -4.43    4.6    2.03s
  6   -8.442627994179       -9.05       -5.28    4.7    1.71s
  7   -8.442627994191      -10.92       -6.21    3.7    1.88s
  8   -8.442627994191      -12.75       -7.35    3.8    1.61s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.440655068328                   -0.96    6.9    3.10s
  2   -8.442551493119       -2.72       -1.77    2.1    1.15s
  3   -8.442626967106       -4.12       -2.81    3.9    2.03s
  4   -8.442627968865       -6.00       -3.74    4.5    1.78s
  5   -8.442627993242       -7.61       -4.42    4.8    2.09s
  6   -8.442627994179       -9.03       -5.27    4.4    1.64s
  7   -8.442627994191      -10.92       -6.21    3.7    1.88s
  8   -8.442627994191      -12.73       -7.36    3.9    1.65s
     2    -8.442628e+00     8.519693e-05
 * time: 86.82907485961914
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.440681298436                   -0.96    7.1    2.62s
  2   -8.442555641513       -2.73       -1.77    2.0    1.60s
  3   -8.442626824981       -4.15       -2.81    3.9    1.71s
  4   -8.442628019158       -5.92       -3.73    4.7    2.18s
  5   -8.442628043572       -7.61       -4.44    4.7    1.81s
  6   -8.442628044470       -9.05       -5.28    4.7    2.05s
  7   -8.442628044481      -10.94       -6.23    3.8    1.71s
  8   -8.442628044481      -12.76       -7.33    3.8    2.20s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.440675716253                   -0.96    7.1    2.65s
  2   -8.442557035800       -2.73       -1.77    2.1    1.47s
  3   -8.442626973479       -4.16       -2.81    3.9    2.05s
  4   -8.442628021004       -5.98       -3.74    4.6    2.13s
  5   -8.442628043645       -7.65       -4.47    4.7    1.92s
  6   -8.442628044472       -9.08       -5.35    4.9    2.43s
  7   -8.442628044481      -11.05       -6.23    3.8    1.75s
  8   -8.442628044481      -12.80       -7.37    3.9    1.95s
     3    -8.442628e+00     1.937048e-06
 * time: 130.62140798568726
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.440673108623                   -0.96    7.3    2.73s
  2   -8.442557953538       -2.72       -1.77    2.1    1.18s
  3   -8.442626827822       -4.16       -2.81    3.9    1.94s
  4   -8.442628021095       -5.92       -3.72    4.5    1.80s
  5   -8.442628043750       -7.64       -4.50    4.7    2.09s
  6   -8.442628044500       -9.13       -5.39    4.9    1.75s
  7   -8.442628044507      -11.12       -6.22    3.7    1.89s
  8   -8.442628044508      -12.87       -7.32    3.8    1.60s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.440665980633                   -0.96    7.2    2.60s
  2   -8.442553810907       -2.72       -1.77    2.0    1.15s
  3   -8.442626841796       -4.14       -2.81    3.9    1.99s
  4   -8.442628020874       -5.93       -3.73    4.5    1.83s
  5   -8.442628043708       -7.64       -4.48    4.6    2.02s
  6   -8.442628044498       -9.10       -5.36    4.8    1.72s
  7   -8.442628044507      -11.05       -6.20    3.8    1.91s
  8   -8.442628044508      -12.79       -7.35    3.6    1.55s
     4    -8.442628e+00     1.371347e-09
 * time: 173.42280888557434
 * Status: success

 * Candidate solution
    Final objective value:     -8.442628e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.69e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.61e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.60e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.08e-12 ≰ 0.0e+00
    |g(x)|                 = 1.37e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   173  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

Si: 248.377128 seconds (367.96 M allocations: 74.040 GiB, 7.95% gc time, 20.80% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-12T16:31:36.119
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.11242141322                   -1.17    8.3    19.4s
  2   -62.11660723772       -2.38       -1.23    2.5    8.24s
  3   -62.12049062021       -2.41       -2.07    3.8    9.54s
  4   -62.12052069991       -4.52       -2.84    3.5    9.25s
  5   -62.12052138995       -6.16       -3.51    4.0    10.5s
  6   -62.12052144594       -7.25       -4.32    3.7    9.53s
  7   -62.12052144649       -9.26       -4.92    4.1    10.6s
  8   -62.12052144652      -10.46       -6.30    3.9    10.0s
  9   -62.12052144652      -13.03       -7.19    4.5    12.6s
Iter     Function value   Gradient norm 
     0    -6.212052e+01     8.725700e-04
 * time: 3.695487976074219e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.11242788474                   -1.17    8.2    16.7s
  2   -62.11660747759       -2.38       -1.23    2.4    7.07s
  3   -62.12049078939       -2.41       -2.07    3.9    9.87s
  4   -62.12052148225       -4.51       -2.84    3.5    9.63s
  5   -62.12052214321       -6.18       -3.50    3.9    10.2s
  6   -62.12052220020       -7.24       -4.32    3.7    9.64s
  7   -62.12052220075       -9.26       -4.93    4.0    11.1s
  8   -62.12052220078      -10.46       -6.28    3.8    10.1s
  9   -62.12052220078      -12.59       -7.22    4.3    11.8s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.11243082807                   -1.17    8.3    17.0s
  2   -62.11660106863       -2.38       -1.23    2.4    7.06s
  3   -62.12049116286       -2.41       -2.07    3.8    10.3s
  4   -62.12052146599       -4.52       -2.84    3.6    9.39s
  5   -62.12052214472       -6.17       -3.51    4.0    10.4s
  6   -62.12052220027       -7.26       -4.34    3.8    9.77s
  7   -62.12052220075       -9.32       -4.93    4.1    10.3s
  8   -62.12052220078      -10.48       -6.27    4.1    10.5s
  9   -62.12052220078      -12.77       -7.18    4.5    11.2s
     1    -6.212052e+01     8.561507e-04
 * time: 222.95347499847412
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.11258873405                   -1.17    8.2    16.5s
  2   -62.11675138530       -2.38       -1.24    2.4    7.09s
  3   -62.12051186663       -2.42       -2.08    3.9    10.1s
  4   -62.12054075997       -4.54       -2.87    3.6    9.62s
  5   -62.12054132587       -6.25       -3.53    3.9    10.5s
  6   -62.12054137886       -7.28       -4.36    3.6    10.3s
  7   -62.12054137930       -9.36       -4.94    4.1    10.6s
  8   -62.12054137934      -10.49       -6.37    3.8    10.7s
  9   -62.12054137934      -12.73       -7.27    4.5    11.5s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.11258864742                   -1.17    8.2    16.6s
  2   -62.11674636755       -2.38       -1.24    2.4    6.96s
  3   -62.12051191469       -2.42       -2.08    3.7    9.71s
  4   -62.12054074239       -4.54       -2.86    3.6    9.12s
  5   -62.12054132595       -6.23       -3.53    3.9    10.1s
  6   -62.12054137885       -7.28       -4.36    3.6    9.55s
  7   -62.12054137930       -9.35       -4.92    4.0    10.2s
  8   -62.12054137934      -10.49       -6.37    3.8    9.78s
  9   -62.12054137934      -12.63       -7.24    4.4    11.3s
     2    -6.212054e+01     2.000242e-05
 * time: 444.05640602111816
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.11259049024                   -1.17    8.3    16.0s
  2   -62.11674778334       -2.38       -1.24    2.6    7.26s
  3   -62.12051208864       -2.42       -2.08    3.9    9.40s
  4   -62.12054072800       -4.54       -2.86    3.5    9.34s
  5   -62.12054133639       -6.22       -3.53    3.8    9.61s
  6   -62.12054138897       -7.28       -4.36    3.7    9.40s
  7   -62.12054138942       -9.34       -4.93    4.0    11.0s
  8   -62.12054138945      -10.52       -6.36    3.8    9.75s
  9   -62.12054138945      -12.62       -7.25    4.4    11.1s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.11258963026                   -1.17    8.2    16.2s
  2   -62.11676866398       -2.38       -1.24    2.5    6.93s
  3   -62.12051163408       -2.43       -2.08    3.8    9.23s
  4   -62.12054070943       -4.54       -2.84    3.5    8.76s
  5   -62.12054133261       -6.21       -3.50    3.8    9.80s
  6   -62.12054138881       -7.25       -4.29    3.8    9.43s
  7   -62.12054138941       -9.23       -4.91    3.9    9.78s
  8   -62.12054138945      -10.38       -6.30    3.9    9.70s
  9   -62.12054138945      -12.67       -7.19    4.3    10.9s
     3    -6.212054e+01     4.510926e-07
 * time: 659.4980821609497
 * Status: success

 * Candidate solution
    Final objective value:     -6.212054e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.04e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 9.71e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.01e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.63e-10 ≰ 0.0e+00
    |g(x)|                 = 4.51e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   659  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

NaCl: 784.076592 seconds (790.21 M allocations: 224.521 GiB, 5.19% gc time, 0.43% compilation time)
┌ Info: 2025-05-12T16:44:40.226
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314400955787                   -1.45    5.5    2.15s
  2   -2.314504524615       -3.98       -1.84    1.4    795ms
  3   -2.314529243548       -4.61       -3.55    3.4    1.87s
  4   -2.314529505237       -6.58       -4.15    4.6    1.67s
  5   -2.314529505474       -9.62       -4.72    2.5    1.44s
  6   -2.314529505493      -10.73       -5.73    2.7    1.17s
  7   -2.314529505494      -12.15       -6.12    3.3    1.56s
  8   -2.314529505494      -13.28       -6.79    2.7    1.15s
  9   -2.314529505494      -15.35       -7.30    2.5    1.06s
Iter     Function value   Gradient norm 
     0    -2.314530e+00     1.903920e-03
 * time: 3.600120544433594e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314407743891                   -1.45    5.4    2.03s
  2   -2.314508621582       -4.00       -1.84    1.4    1.05s
  3   -2.314532824591       -4.62       -3.56    3.3    1.26s
  4   -2.314533056910       -6.63       -4.14    4.5    1.87s
  5   -2.314533057150       -9.62       -4.71    2.5    1.04s
  6   -2.314533057167      -10.77       -5.70    2.7    1.34s
  7   -2.314533057168      -12.08       -6.10    3.2    1.23s
  8   -2.314533057168      -13.25       -6.77    2.5    1.03s
  9   -2.314533057168      -15.35       -7.30    2.6    1.37s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314409129182                   -1.45    5.3    2.05s
  2   -2.314508217250       -4.00       -1.84    1.4    756ms
  3   -2.314532865749       -4.61       -3.54    3.4    1.52s
  4   -2.314533056879       -6.72       -4.12    4.6    1.74s
  5   -2.314533057148       -9.57       -4.70    2.6    1.35s
  6   -2.314533057167      -10.72       -5.68    2.8    1.12s
  7   -2.314533057168      -12.09       -6.09    3.2    1.53s
  8   -2.314533057168      -13.26       -6.76    2.6    1.04s
  9   -2.314533057168      -15.05       -7.22    2.6    1.10s
     1    -2.314533e+00     1.827008e-03
 * time: 55.18829011917114
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314454318472                   -1.45    5.4    1.99s
  2   -2.314550482889       -4.02       -1.83    1.4    731ms
  3   -2.314573708195       -4.63       -3.54    3.4    1.47s
  4   -2.314573896546       -6.73       -4.24    4.5    1.52s
  5   -2.314573896710       -9.79       -4.86    2.7    1.07s
  6   -2.314573896717      -11.17       -5.57    2.9    1.30s
  7   -2.314573896718      -12.02       -6.28    3.0    1.23s
  8   -2.314573896718      -14.01       -6.77    2.6    1.50s
  9   -2.314573896718      -15.05       -7.55    2.2    945ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314453333424                   -1.45    5.4    2.00s
  2   -2.314550491618       -4.01       -1.83    1.4    1.14s
  3   -2.314573765582       -4.63       -3.54    3.4    1.27s
  4   -2.314573896549       -6.88       -4.24    4.4    2.07s
  5   -2.314573896710       -9.79       -4.85    2.7    1.27s
  6   -2.314573896716      -11.16       -5.50    2.8    1.39s
  7   -2.314573896718      -11.93       -6.27    3.0    1.13s
  8   -2.314573896718      -13.91       -6.73    2.6    1.03s
  9   -2.314573896718   +    -Inf       -7.54    2.2    1.26s
     2    -2.314574e+00     5.518834e-05
 * time: 109.65650010108948
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314456756659                   -1.45    5.5    2.10s
  2   -2.314550940400       -4.03       -1.83    1.5    793ms
  3   -2.314573746760       -4.64       -3.54    3.4    2.02s
  4   -2.314573930442       -6.74       -4.23    4.5    2.07s
  5   -2.314573930610       -9.78       -4.83    2.7    1.68s
  6   -2.314573930617      -11.17       -5.52    2.8    1.42s
  7   -2.314573930618      -11.92       -6.24    3.0    1.69s
  8   -2.314573930618      -13.91       -6.73    2.7    1.25s
  9   -2.314573930618      -15.05       -7.47    2.2    1.14s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314455576937                   -1.45    5.4    2.30s
  2   -2.314550657869       -4.02       -1.83    1.4    981ms
  3   -2.314573695007       -4.64       -3.54    3.4    1.98s
  4   -2.314573930421       -6.63       -4.21    4.6    2.31s
  5   -2.314573930609       -9.73       -4.82    2.6    1.36s
  6   -2.314573930617      -11.10       -5.53    2.9    1.13s
  7   -2.314573930618      -11.95       -6.23    3.0    1.84s
  8   -2.314573930618      -13.95       -6.72    2.7    1.09s
  9   -2.314573930618      -15.35       -7.48    2.3    975ms
     3    -2.314574e+00     3.997267e-06
 * time: 169.14512491226196
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314456519479                   -1.45    5.5    2.56s
  2   -2.314550312062       -4.03       -1.83    1.3    781ms
  3   -2.314573738394       -4.63       -3.54    3.4    1.61s
  4   -2.314573930602       -6.72       -4.21    4.5    1.60s
  5   -2.314573930789       -9.73       -4.84    2.7    1.43s
  6   -2.314573930796      -11.13       -5.58    2.9    1.15s
  7   -2.314573930797      -12.03       -6.25    3.2    1.50s
  8   -2.314573930797      -13.99       -6.76    2.6    1.03s
  9   -2.314573930797   +    -Inf       -7.54    2.4    1.01s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314456428703                   -1.45    5.5    2.01s
  2   -2.314550398274       -4.03       -1.83    1.5    773ms
  3   -2.314573727157       -4.63       -3.52    3.3    1.26s
  4   -2.314573930581       -6.69       -4.19    4.5    1.86s
  5   -2.314573930786       -9.69       -4.81    2.7    1.10s
  6   -2.314573930796      -10.98       -5.55    2.8    1.43s
  7   -2.314573930797      -11.98       -6.25    3.1    1.21s
  8   -2.314573930797      -13.99       -6.73    2.6    1.33s
  9   -2.314573930797   +    -Inf       -7.59    2.3    973ms
     4    -2.314574e+00     1.089620e-08
 * time: 224.29040098190308
 * Status: success

 * Candidate solution
    Final objective value:     -2.314574e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 8.96e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.18e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.80e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 7.76e-11 ≰ 0.0e+00
    |g(x)|                 = 1.09e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   224  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

Al: 257.902063 seconds (203.55 M allocations: 48.380 GiB, 6.33% gc time, 0.00% compilation time)
┌ Info: 2025-05-12T16:48:58.129
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69450807513                   -0.84    9.7    9.90s
  2   -73.70794444905       -1.87       -1.05    5.4    5.65s
  3   -73.71477701214       -2.17       -1.38    6.9    7.51s
  4   -73.71600848662       -2.91       -1.78    5.9    6.38s
  5   -73.71615820907       -3.82       -2.22    5.1    5.79s
  6   -73.71618013307       -4.66       -3.08    5.5    6.39s
  7   -73.71618017694       -7.36       -3.54    4.6    6.02s
  8   -73.71618018521       -8.08       -4.17    5.5    6.93s
  9   -73.71618018515   +  -10.19       -4.55    4.3    5.54s
 10   -73.71618018582       -9.17       -5.03    5.4    7.26s
 11   -73.71618018583      -11.07       -5.95    5.3    6.40s
 12   -73.71618018583   +  -12.64       -6.53    5.4    6.32s
 13   -73.71618018583      -13.85       -6.74    2.6    3.71s
 14   -73.71618018583      -12.94       -7.56    5.1    5.79s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.371618e+01     1.072172e-02
 * time: 4.887580871582031e-5
┌ Warning: Negative ρcore detected: -3.377201867335714e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69490321800                   -0.85    9.8    9.85s
  2   -73.70808059993       -1.88       -1.05    5.5    6.17s
  3   -73.71490157667       -2.17       -1.39    6.8    7.68s
  4   -73.71611302455       -2.92       -1.77    5.8    6.42s
  5   -73.71626719524       -3.81       -2.25    5.1    6.99s
  6   -73.71628651920       -4.71       -3.08    5.5    6.28s
  7   -73.71628656923       -7.30       -3.54    4.8    6.04s
  8   -73.71628657639       -8.15       -4.14    5.3    5.90s
  9   -73.71628657611   +   -9.55       -4.57    5.0    6.04s
 10   -73.71628657678       -9.17       -4.88    5.6    6.66s
 11   -73.71628657679      -11.03       -5.78    4.4    6.31s
 12   -73.71628657679      -12.89       -6.44    4.4    5.50s
 13   -73.71628657679      -13.55       -6.59    3.8    4.53s
 14   -73.71628657679      -13.07       -7.15    4.9    5.50s
┌ Warning: Negative ρcore detected: -3.377201867335714e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69491681978                   -0.85    9.8    12.3s
  2   -73.70806451399       -1.88       -1.05    5.4    8.17s
  3   -73.71490301694       -2.17       -1.39    6.8    8.35s
  4   -73.71611276321       -2.92       -1.77    5.9    6.52s
  5   -73.71626667569       -3.81       -2.24    5.0    6.66s
  6   -73.71628652307       -4.70       -3.08    5.5    7.40s
  7   -73.71628656995       -7.33       -3.54    4.8    6.18s
  8   -73.71628657638       -8.19       -4.14    5.3    6.26s
  9   -73.71628657618   +   -9.69       -4.58    4.8    6.65s
 10   -73.71628657677       -9.22       -4.87    5.6    6.84s
 11   -73.71628657679      -10.94       -5.79    4.6    5.85s
 12   -73.71628657679      -12.81       -6.44    4.5    6.48s
 13   -73.71628657679   +  -13.00       -6.59    3.9    4.97s
 14   -73.71628657679      -12.94       -7.15    5.0    6.14s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.377201867335714e-8,-5.9038058403690504e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.371629e+01     9.120481e-03
 * time: 253.5827820301056
┌ Warning: Negative ρcore detected: -3.119257241161162e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69678205706                   -0.85    9.7    9.81s
  2   -73.70854998391       -1.93       -1.05    5.4    6.09s
  3   -73.71523582369       -2.17       -1.39    6.8    7.43s
  4   -73.71638109325       -2.94       -1.77    5.8    6.07s
  5   -73.71653591126       -3.81       -2.26    5.1    5.68s
  6   -73.71655446032       -4.73       -3.09    5.5    6.14s
  7   -73.71655448289       -7.65       -3.56    4.3    5.30s
  8   -73.71655448738       -8.35       -4.04    4.9    5.69s
  9   -73.71655448701   +   -9.43       -4.55    5.2    5.74s
 10   -73.71655448757       -9.25       -4.80    5.6    5.86s
 11   -73.71655448760      -10.47       -5.52    4.9    5.43s
 12   -73.71655448761      -11.12       -6.31    4.8    5.52s
 13   -73.71655448761   +  -12.89       -6.60    3.7    4.90s
 14   -73.71655448761      -12.21       -7.05    5.0    5.37s
┌ Warning: Negative ρcore detected: -3.119257241161162e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69678160444                   -0.85    9.8    10.0s
  2   -73.70855236586       -1.93       -1.05    5.3    5.93s
  3   -73.71523516322       -2.18       -1.39    6.8    7.38s
  4   -73.71638114536       -2.94       -1.77    5.9    6.28s
  5   -73.71653595578       -3.81       -2.26    5.1    5.85s
  6   -73.71655445771       -4.73       -3.09    5.5    6.12s
  7   -73.71655448328       -7.59       -3.55    4.4    5.26s
  8   -73.71655448735       -8.39       -4.03    4.8    5.42s
  9   -73.71655448705   +   -9.53       -4.55    5.1    5.61s
 10   -73.71655448756       -9.29       -4.81    5.5    6.01s
 11   -73.71655448760      -10.42       -5.53    4.8    5.69s
 12   -73.71655448761      -11.24       -6.27    4.6    5.40s
 13   -73.71655448761      -12.10       -6.60    4.6    5.38s
 14   -73.71655448761      -12.32       -7.06    5.2    5.48s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.119257241161162e-8,1.5590722026585002e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.371655e+01     4.987808e-04
 * time: 486.88252997398376
┌ Warning: Negative ρcore detected: -3.0681134980325796e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69669985092                   -0.85    9.6    10.3s
  2   -73.70852234794       -1.93       -1.05    5.5    6.19s
  3   -73.71523583389       -2.17       -1.39    6.9    8.63s
  4   -73.71637982720       -2.94       -1.77    5.9    6.94s
  5   -73.71653655341       -3.80       -2.26    5.1    6.09s
  6   -73.71655522197       -4.73       -3.09    5.6    7.32s
  7   -73.71655524280       -7.68       -3.55    4.2    5.35s
  8   -73.71655524749       -8.33       -4.04    4.8    5.93s
  9   -73.71655524728   +   -9.68       -4.54    5.2    6.38s
 10   -73.71655524774       -9.34       -4.81    5.6    7.82s
 11   -73.71655524777      -10.46       -5.51    5.0    6.25s
 12   -73.71655524778      -11.75       -6.29    4.7    5.69s
 13   -73.71655524778      -13.55       -6.60    4.9    6.35s
 14   -73.71655524778      -13.55       -7.05    5.1    6.37s
┌ Warning: Negative ρcore detected: -3.0681134980325796e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69670072274                   -0.85    9.7    9.51s
  2   -73.70852296342       -1.93       -1.05    5.4    5.50s
  3   -73.71523576985       -2.17       -1.39    6.9    7.04s
  4   -73.71638024383       -2.94       -1.77    6.0    5.95s
  5   -73.71653652509       -3.81       -2.26    5.1    5.55s
  6   -73.71655522257       -4.73       -3.09    5.6    6.70s
  7   -73.71655524315       -7.69       -3.55    4.3    5.20s
  8   -73.71655524750       -8.36       -4.05    5.0    5.65s
  9   -73.71655524727   +   -9.64       -4.54    5.2    6.35s
 10   -73.71655524774       -9.32       -4.79    5.6    6.04s
 11   -73.71655524777      -10.46       -5.53    4.9    5.58s
 12   -73.71655524778      -11.76       -6.34    4.8    5.89s
 13   -73.71655524778      -13.25       -6.61    3.6    5.30s
 14   -73.71655524778   +    -Inf       -7.03    5.1    5.44s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0681134980325796e-8,1.670470088585779e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.371656e+01     2.250578e-05
 * time: 732.8986449241638
┌ Warning: Negative ρcore detected: -3.070394013028838e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69669709175                   -0.85    9.9    10.8s
  2   -73.70852928936       -1.93       -1.05    5.6    6.04s
  3   -73.71523556135       -2.17       -1.39    7.1    7.57s
  4   -73.71638027669       -2.94       -1.77    6.0    6.36s
  5   -73.71653635293       -3.81       -2.25    5.2    5.76s
  6   -73.71655522465       -4.72       -3.09    5.7    6.31s
  7   -73.71655524387       -7.72       -3.56    4.5    5.43s
  8   -73.71655524903       -8.29       -4.06    5.1    5.53s
  9   -73.71655524870   +   -9.49       -4.53    5.4    5.79s
 10   -73.71655524925       -9.26       -4.81    5.7    5.92s
 11   -73.71655524929      -10.49       -5.52    4.9    5.46s
 12   -73.71655524929      -11.71       -6.37    4.8    5.75s
 13   -73.71655524929   +  -13.55       -6.62    3.9    5.04s
 14   -73.71655524929      -13.37       -7.03    5.1    5.65s
┌ Warning: Negative ρcore detected: -3.070394013028838e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69670424627                   -0.85   10.0    11.5s
  2   -73.70852959451       -1.93       -1.05    5.6    6.96s
  3   -73.71523456075       -2.17       -1.39    7.0    7.51s
  4   -73.71638063813       -2.94       -1.77    6.0    6.19s
  5   -73.71653655210       -3.81       -2.26    5.2    5.95s
  6   -73.71655522490       -4.73       -3.09    5.7    8.82s
  7   -73.71655524391       -7.72       -3.56    4.4    6.98s
  8   -73.71655524902       -8.29       -4.06    5.0    6.38s
  9   -73.71655524871   +   -9.50       -4.53    5.4    6.32s
 10   -73.71655524925       -9.26       -4.81    5.7    7.48s
 11   -73.71655524929      -10.49       -5.51    5.0    5.64s
 12   -73.71655524929      -11.67       -6.35    4.8    5.73s
 13   -73.71655524929   +  -13.37       -6.62    4.0    5.21s
 14   -73.71655524929   +    -Inf       -7.03    5.1    6.14s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.070394013028838e-8,1.6657408914915504e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     4    -7.371656e+01     4.348902e-08
 * time: 980.711492061615
 * Status: success

 * Candidate solution
    Final objective value:     -7.371656e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.37e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.43e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.51e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.05e-11 ≰ 0.0e+00
    |g(x)|                 = 4.35e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   981  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

V: 1114.374943 seconds (722.60 M allocations: 341.747 GiB, 5.82% gc time, 0.01% compilation time)
