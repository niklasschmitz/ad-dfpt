┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-12T19:12:44.732
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.464329945617                   -0.96    6.9    12.1s
  2   -8.465920321684       -2.80       -1.73    1.8    5.38s
  3   -8.466000573354       -4.10       -2.74    3.8    1.87s
  4   -8.466003392539       -5.55       -3.59    4.7    2.38s
  5   -8.466003500054       -6.97       -4.38    5.1    2.24s
  6   -8.466003504197       -8.38       -5.33    5.3    1.92s
  7   -8.466003504235      -10.42       -6.17    4.7    2.73s
  8   -8.466003504236      -12.41       -7.01    4.2    1.76s
Iter     Function value   Gradient norm 
     0    -8.466004e+00     6.338143e-04
 * time: 4.410743713378906e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.464329587521                   -0.96    6.8    2.55s
  2   -8.465915797772       -2.80       -1.73    1.9    1.44s
  3   -8.466000972538       -4.07       -2.74    3.7    1.94s
  4   -8.466003772678       -5.55       -3.61    4.7    2.42s
  5   -8.466003887383       -6.94       -4.32    4.9    2.11s
  6   -8.466003892092       -8.33       -5.24    4.9    2.25s
  7   -8.466003892140      -10.32       -6.01    4.3    2.05s
  8   -8.466003892141      -12.24       -7.06    4.0    1.95s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.464328507097                   -0.96    6.9    3.75s
  2   -8.465919106191       -2.80       -1.73    1.7    1.94s
  3   -8.466000758641       -4.09       -2.74    3.9    1.64s
  4   -8.466003776126       -5.52       -3.58    4.8    2.76s
  5   -8.466003888148       -6.95       -4.40    4.8    2.55s
  6   -8.466003892103       -8.40       -5.33    5.1    2.34s
  7   -8.466003892141      -10.43       -6.12    4.5    1.82s
  8   -8.466003892141      -12.39       -6.97    4.2    2.21s
  9   -8.466003892141      -13.97       -7.70    4.1    1.62s
     1    -8.466004e+00     5.902411e-04
 * time: 50.47362017631531
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.464363119058                   -0.96    7.0    2.76s
  2   -8.465918765594       -2.81       -1.72    1.8    1.09s
  3   -8.466003315589       -4.07       -2.74    3.7    1.89s
  4   -8.466006315549       -5.52       -3.59    4.9    2.69s
  5   -8.466006429728       -6.94       -4.39    5.0    1.79s
  6   -8.466006434082       -8.36       -5.34    5.1    2.08s
  7   -8.466006434122      -10.40       -6.20    4.6    1.79s
  8   -8.466006434122      -12.43       -7.05    4.4    1.96s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.464356746896                   -0.96    7.0    3.11s
  2   -8.465920770310       -2.81       -1.73    1.9    1.45s
  3   -8.466003291534       -4.08       -2.74    3.7    1.75s
  4   -8.466006319929       -5.52       -3.59    4.7    2.15s
  5   -8.466006430020       -6.96       -4.40    4.8    1.78s
  6   -8.466006434084       -8.39       -5.34    5.2    2.11s
  7   -8.466006434122      -10.43       -6.23    4.5    1.79s
  8   -8.466006434122      -12.47       -7.05    4.3    2.00s
     2    -8.466006e+00     2.736762e-06
 * time: 94.82206296920776
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.464370791640                   -0.96    6.9    2.51s
  2   -8.465924850941       -2.81       -1.73    1.9    1.10s
  3   -8.466003413618       -4.10       -2.74    3.7    1.86s
  4   -8.466006321540       -5.54       -3.60    4.7    1.90s
  5   -8.466006429960       -6.96       -4.39    4.9    2.44s
  6   -8.466006434140       -8.38       -5.33    5.1    1.87s
  7   -8.466006434176      -10.44       -6.25    4.6    2.12s
  8   -8.466006434177      -12.51       -7.04    4.3    1.77s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.464353890906                   -0.96    6.9    2.63s
  2   -8.465920560643       -2.81       -1.73    1.9    1.12s
  3   -8.466003467514       -4.08       -2.74    3.7    2.11s
  4   -8.466006321480       -5.54       -3.61    4.8    1.88s
  5   -8.466006429789       -6.97       -4.36    4.8    2.11s
  6   -8.466006434134       -8.36       -5.30    5.3    1.84s
  7   -8.466006434176      -10.37       -6.13    4.6    2.07s
  8   -8.466006434177      -12.36       -7.06    4.2    1.65s
     3    -8.466006e+00     6.640848e-09
 * time: 138.94903302192688
 * Status: success

 * Candidate solution
    Final objective value:     -8.466006e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 4.00e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.86e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 5.44e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 6.43e-12 ≰ 0.0e+00
    |g(x)|                 = 6.64e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   139  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 217.847891 seconds (311.67 M allocations: 60.349 GiB, 7.58% gc time, 24.91% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-12T19:16:23.249
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.29762795373                   -1.11    8.6    22.0s
  2   -62.30363765902       -2.22       -1.21    2.7    8.63s
  3   -62.30783179679       -2.38       -2.03    3.7    10.0s
  4   -62.30788164919       -4.30       -2.87    3.2    9.70s
  5   -62.30788242725       -6.11       -3.53    4.0    11.2s
  6   -62.30788262680       -6.70       -4.06    3.8    11.5s
  7   -62.30788263189       -8.29       -4.70    3.7    10.3s
  8   -62.30788263214       -9.60       -6.16    3.8    11.5s
  9   -62.30788263214      -11.58       -6.45    5.0    13.3s
 10   -62.30788263214      -12.94       -7.75    3.6    9.60s
Iter     Function value   Gradient norm 
     0    -6.230788e+01     6.160396e-03
 * time: 3.886222839355469e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.29764081154                   -1.11    8.4    18.3s
  2   -62.30364661203       -2.22       -1.21    2.6    7.39s
  3   -62.30786956519       -2.37       -2.03    3.7    9.47s
  4   -62.30791920263       -4.30       -2.91    3.0    8.79s
  5   -62.30791999158       -6.10       -3.58    4.0    10.6s
  6   -62.30792017126       -6.75       -4.11    3.7    9.73s
  7   -62.30792017594       -8.33       -4.72    3.7    10.6s
  8   -62.30792017620       -9.59       -6.07    3.8    10.7s
  9   -62.30792017620      -11.44       -6.82    4.7    12.2s
 10   -62.30792017620      -14.15       -8.02    3.9    11.2s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.29764171444                   -1.11    8.4    17.0s
  2   -62.30366163614       -2.22       -1.21    2.6    7.20s
  3   -62.30786863935       -2.38       -2.02    3.6    10.1s
  4   -62.30791915681       -4.30       -2.87    3.1    8.65s
  5   -62.30791996742       -6.09       -3.52    3.9    10.3s
  6   -62.30792017051       -6.69       -4.05    3.7    9.46s
  7   -62.30792017592       -8.27       -4.69    3.7    10.0s
  8   -62.30792017620       -9.55       -6.12    3.7    9.69s
  9   -62.30792017620      -11.45       -6.46    4.9    12.5s
 10   -62.30792017620      -13.85       -7.85    3.6    9.89s
     1    -6.230792e+01     6.028570e-03
 * time: 246.46667003631592
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.29731276518                   -1.10    8.8    21.4s
  2   -62.30355431131       -2.20       -1.17    2.8    8.27s
  3   -62.30877317022       -2.28       -1.99    3.7    10.6s
  4   -62.30883834028       -4.19       -2.87    2.8    9.01s
  5   -62.30883919306       -6.07       -3.50    3.9    11.5s
  6   -62.30883942569       -6.63       -4.03    3.5    10.1s
  7   -62.30883943152       -8.23       -4.60    3.6    11.9s
  8   -62.30883943190       -9.42       -6.10    3.6    10.6s
  9   -62.30883943190      -11.19       -6.60    4.8    14.7s
 10   -62.30883943190      -12.56       -7.55    3.9    10.8s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.29731076492                   -1.10    8.7    19.6s
  2   -62.30354067513       -2.21       -1.17    2.9    8.87s
  3   -62.30877394330       -2.28       -1.99    3.8    10.0s
  4   -62.30883833612       -4.19       -2.88    2.7    8.35s
  5   -62.30883920529       -6.06       -3.53    4.0    11.2s
  6   -62.30883942598       -6.66       -4.06    3.5    10.5s
  7   -62.30883943150       -8.26       -4.60    3.7    11.5s
  8   -62.30883943190       -9.41       -6.07    3.5    10.7s
  9   -62.30883943190      -11.16       -6.49    4.7    13.0s
 10   -62.30883943190   +    -Inf       -7.62    3.3    10.9s
     2    -6.230884e+01     7.432314e-04
 * time: 518.1996970176697
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.29712742836                   -1.10    8.1    18.3s
  2   -62.30340710390       -2.20       -1.17    2.7    8.35s
  3   -62.30878841597       -2.27       -1.98    3.5    9.52s
  4   -62.30885511876       -4.18       -2.87    2.7    8.94s
  5   -62.30885593847       -6.09       -3.52    4.0    11.4s
  6   -62.30885616950       -6.64       -4.08    3.4    10.9s
  7   -62.30885617524       -8.24       -4.73    3.7    11.9s
  8   -62.30885617549       -9.60       -6.17    3.7    11.2s
  9   -62.30885617549      -11.29       -6.77    4.8    13.6s
 10   -62.30885617549      -12.54       -7.58    3.9    11.2s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.29712717962                   -1.10    8.1    19.3s
  2   -62.30344310718       -2.20       -1.17    2.6    7.60s
  3   -62.30878617852       -2.27       -1.98    3.5    9.42s
  4   -62.30885501100       -4.16       -2.83    2.8    9.59s
  5   -62.30885590195       -6.05       -3.43    3.8    11.5s
  6   -62.30885616819       -6.57       -3.98    3.4    10.1s
  7   -62.30885617509       -8.16       -4.58    3.7    10.8s
  8   -62.30885617549       -9.40       -6.01    3.5    10.2s
  9   -62.30885617549      -11.11       -6.40    4.6    12.6s
 10   -62.30885617549      -13.07       -7.72    3.2    10.9s
     3    -6.230886e+01     1.060303e-04
 * time: 781.4283490180969
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.29709438711                   -1.10    8.6    18.8s
  2   -62.30336574387       -2.20       -1.17    2.8    7.83s
  3   -62.30878848916       -2.27       -1.98    3.6    9.69s
  4   -62.30885551835       -4.17       -2.89    3.0    8.76s
  5   -62.30885631441       -6.10       -3.56    4.1    11.4s
  6   -62.30885652685       -6.67       -4.10    3.5    10.1s
  7   -62.30885653202       -8.29       -4.72    3.6    11.7s
  8   -62.30885653226       -9.62       -6.10    3.6    10.9s
  9   -62.30885653226      -11.34       -6.87    4.6    14.5s
 10   -62.30885653226   +  -13.85       -7.84    3.0    10.4s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.29709557303                   -1.10    8.5    18.6s
  2   -62.30339437631       -2.20       -1.17    2.8    8.14s
  3   -62.30878770724       -2.27       -1.98    3.5    9.38s
  4   -62.30885542355       -4.17       -2.86    2.8    9.03s
  5   -62.30885628774       -6.06       -3.49    4.0    11.5s
  6   -62.30885652573       -6.62       -4.03    3.5    11.2s
  7   -62.30885653186       -8.21       -4.60    3.5    11.4s
  8   -62.30885653226       -9.40       -6.06    3.7    10.7s
  9   -62.30885653226      -11.12       -6.53    4.8    12.7s
 10   -62.30885653226      -12.92       -7.71    3.4    10.1s
     4    -6.230886e+01     2.297290e-06
 * time: 1048.1675980091095
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.29709359176                   -1.10    8.5    18.5s
  2   -62.30337976367       -2.20       -1.17    2.7    7.80s
  3   -62.30878826228       -2.27       -1.98    3.7    10.1s
  4   -62.30885542366       -4.17       -2.88    2.6    9.18s
  5   -62.30885630163       -6.06       -3.53    3.9    11.3s
  6   -62.30885652634       -6.65       -4.08    3.5    10.6s
  7   -62.30885653210       -8.24       -4.68    3.6    11.0s
  8   -62.30885653243       -9.49       -6.08    3.7    12.2s
  9   -62.30885653243      -11.15       -6.53    4.6    12.2s
 10   -62.30885653243      -13.55       -7.70    3.3    9.91s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.29709271071                   -1.10    8.5    19.2s
  2   -62.30340438197       -2.20       -1.17    2.7    7.85s
  3   -62.30878693994       -2.27       -1.98    3.6    9.32s
  4   -62.30885539098       -4.16       -2.84    2.7    8.74s
  5   -62.30885627373       -6.05       -3.47    3.9    10.7s
  6   -62.30885652532       -6.60       -4.03    3.4    10.5s
  7   -62.30885653208       -8.17       -4.64    3.7    10.9s
  8   -62.30885653243       -9.46       -6.03    3.7    10.5s
  9   -62.30885653243      -11.06       -6.48    4.5    13.2s
 10   -62.30885653243      -13.07       -7.68    3.4    11.0s
     5    -6.230886e+01     4.342718e-09
 * time: 1310.0759599208832
 * Status: success

 * Candidate solution
    Final objective value:     -6.230886e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.46e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.32e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.70e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.72e-12 ≰ 0.0e+00
    |g(x)|                 = 4.34e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   1310  (vs limit Inf)
    Iterations:    5
    f(x) calls:    6
    ∇f(x) calls:   6

NaCl: 1456.790394 seconds (1.42 G allocations: 400.720 GiB, 5.21% gc time, 0.24% compilation time)
┌ Info: 2025-05-12T19:40:40.069
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317516241892                   -1.47    5.5    2.14s
  2   -2.317590918884       -4.13       -1.84    1.3    784ms
  3   -2.317607474060       -4.78       -3.56    3.1    1.79s
  4   -2.317607686362       -6.67       -4.06    4.6    1.69s
  5   -2.317607686871       -9.29       -4.33    2.3    1.34s
  6   -2.317607687020       -9.83       -5.00    2.7    1.14s
  7   -2.317607687025      -11.34       -5.71    2.5    1.34s
  8   -2.317607687025      -12.62       -6.49    2.6    1.14s
  9   -2.317607687025      -14.27       -6.78    2.8    1.19s
 10   -2.317607687025   +    -Inf       -7.46    2.0    1.41s
Iter     Function value   Gradient norm 
     0    -2.317608e+00     1.776340e-04
 * time: 3.0040740966796875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317520737001                   -1.47    5.4    2.05s
  2   -2.317591538470       -4.15       -1.84    1.2    768ms
  3   -2.317607473091       -4.80       -3.57    3.1    1.57s
  4   -2.317607717226       -6.61       -4.03    4.6    1.71s
  5   -2.317607717771       -9.26       -4.31    2.3    1.31s
  6   -2.317607717933       -9.79       -4.98    2.6    1.11s
  7   -2.317607717938      -11.27       -5.73    2.4    1.11s
  8   -2.317607717938      -12.59       -6.57    2.6    1.39s
  9   -2.317607717939      -14.12       -7.04    3.1    1.26s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317521835067                   -1.47    5.4    2.27s
  2   -2.317591890072       -4.15       -1.84    1.3    873ms
  3   -2.317607414609       -4.81       -3.57    3.1    1.59s
  4   -2.317607717250       -6.52       -4.04    4.5    1.98s
  5   -2.317607717770       -9.28       -4.31    2.3    1.00s
  6   -2.317607717933       -9.79       -4.97    2.6    1.37s
  7   -2.317607717938      -11.30       -5.73    2.4    1.02s
  8   -2.317607717938      -12.63       -6.56    2.7    1.41s
  9   -2.317607717939      -14.24       -7.05    3.1    1.19s
     1    -2.317608e+00     1.704163e-04
 * time: 55.78033113479614
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317520609205                   -1.47    5.5    2.01s
  2   -2.317592340034       -4.14       -1.84    1.3    1.03s
  3   -2.317607864407       -4.81       -3.58    3.2    1.29s
  4   -2.317608075800       -6.67       -4.05    4.6    1.94s
  5   -2.317608076311       -9.29       -4.32    2.4    1.06s
  6   -2.317608076471       -9.80       -4.99    2.7    1.39s
  7   -2.317608076476      -11.32       -5.68    2.4    1.03s
  8   -2.317608076476      -12.60       -6.28    2.7    1.12s
  9   -2.317608076476      -14.24       -6.82    2.2    1.25s
 10   -2.317608076476      -15.05       -7.35    2.5    1.07s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317521006799                   -1.47    5.6    2.28s
  2   -2.317592295906       -4.15       -1.84    1.3    786ms
  3   -2.317607850564       -4.81       -3.57    3.2    1.31s
  4   -2.317608075744       -6.65       -4.04    4.6    1.92s
  5   -2.317608076290       -9.26       -4.30    2.3    1.02s
  6   -2.317608076471       -9.74       -4.96    2.7    1.42s
  7   -2.317608076476      -11.33       -5.60    2.4    980ms
  8   -2.317608076476      -12.45       -6.33    2.7    1.40s
  9   -2.317608076476      -13.91       -6.88    2.6    1.07s
 10   -2.317608076476   +  -14.65       -7.38    2.4    1.25s
     2    -2.317608e+00     7.646281e-07
 * time: 113.04525995254517
 * Status: success

 * Candidate solution
    Final objective value:     -2.317608e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 4.19e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 5.49e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 3.59e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.55e-07 ≰ 0.0e+00
    |g(x)|                 = 7.65e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   113  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Al: 148.218509 seconds (118.06 M allocations: 28.028 GiB, 6.52% gc time, 0.00% compilation time)
┌ Info: 2025-05-12T19:43:08.288
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.81427317941                   -0.91    9.5    9.54s
  2   -73.82305055744       -2.06       -1.11    5.2    5.98s
  3   -73.82843498412       -2.27       -1.48    6.7    8.11s
  4   -73.82920578395       -3.11       -1.81    5.6    6.21s
  5   -73.82933851753       -3.88       -2.22    5.0    5.83s
  6   -73.82936106056       -4.65       -3.07    5.4    6.25s
  7   -73.82936109003       -7.53       -3.48    5.2    5.97s
  8   -73.82936109340       -8.47       -4.04    3.1    4.31s
  9   -73.82936109363       -9.63       -4.47    4.2    5.23s
 10   -73.82936109367      -10.43       -4.84    3.7    4.50s
 11   -73.82936109369      -10.71       -5.58    4.8    5.24s
 12   -73.82936109369      -11.96       -6.27    4.6    5.46s
 13   -73.82936109369      -13.55       -6.67    5.1    5.73s
 14   -73.82936109369   +  -13.15       -7.02    5.4    5.84s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.382936e+01     1.146240e-03
 * time: 3.1948089599609375e-5
┌ Warning: Negative ρcore detected: -3.416337576954142e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.81425779269                   -0.91    9.7    10.1s
  2   -73.82304970996       -2.06       -1.11    5.2    5.72s
  3   -73.82843446968       -2.27       -1.47    6.8    7.54s
  4   -73.82920713172       -3.11       -1.81    5.6    6.14s
  5   -73.82933978579       -3.88       -2.22    5.0    5.69s
  6   -73.82936227812       -4.65       -3.07    5.5    6.91s
  7   -73.82936230411       -7.59       -3.47    5.1    5.90s
  8   -73.82936230773       -8.44       -4.04    3.6    4.80s
  9   -73.82936230799       -9.60       -4.45    4.2    5.92s
 10   -73.82936230801      -10.63       -4.81    3.1    4.52s
 11   -73.82936230803      -10.73       -5.56    4.8    5.91s
 12   -73.82936230803      -11.83       -6.25    4.7    6.15s
 13   -73.82936230803      -13.55       -6.66    5.1    6.28s
 14   -73.82936230803   +    -Inf       -6.88    5.4    5.76s
 15   -73.82936230803   +  -12.85       -7.87    5.1    5.59s
┌ Warning: Negative ρcore detected: -3.416337576954142e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.81426233408                   -0.91    9.8    10.1s
  2   -73.82304412190       -2.06       -1.11    5.2    5.70s
  3   -73.82843607028       -2.27       -1.48    6.8    7.49s
  4   -73.82920649819       -3.11       -1.81    5.6    5.97s
  5   -73.82933976414       -3.88       -2.22    5.0    5.74s
  6   -73.82936227402       -4.65       -3.07    5.5    6.13s
  7   -73.82936230427       -7.52       -3.47    5.2    5.93s
  8   -73.82936230775       -8.46       -4.05    3.2    4.43s
  9   -73.82936230798       -9.65       -4.47    4.5    5.40s
 10   -73.82936230801      -10.50       -4.84    3.2    4.69s
 11   -73.82936230803      -10.74       -5.56    4.7    5.80s
 12   -73.82936230803      -11.83       -6.27    4.6    6.46s
 13   -73.82936230803   +  -13.85       -6.68    5.0    5.67s
 14   -73.82936230803   +  -13.07       -6.89    5.4    6.82s
 15   -73.82936230803   +  -13.37       -7.95    5.1    6.09s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.416337576954142e-8,-7.639148678944097e-9)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.382936e+01     9.723268e-04
 * time: 250.4936878681183
┌ Warning: Negative ρcore detected: -3.412853243566408e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.81415894515                   -0.91    9.7    10.3s
  2   -73.82303155632       -2.05       -1.11    5.3    6.04s
  3   -73.82843134818       -2.27       -1.47    6.8    7.53s
  4   -73.82921155799       -3.11       -1.81    5.7    6.51s
  5   -73.82934289019       -3.88       -2.22    5.0    6.86s
  6   -73.82936540368       -4.65       -3.08    5.6    7.28s
  7   -73.82936542858       -7.60       -3.48    5.1    7.84s
  8   -73.82936543212       -8.45       -4.04    3.4    5.33s
  9   -73.82936543238       -9.59       -4.47    4.1    7.76s
 10   -73.82936543240      -10.58       -4.82    3.8    5.22s
 11   -73.82936543242      -10.79       -5.62    4.7    6.01s
 12   -73.82936543242      -12.04       -6.38    4.7    6.09s
 13   -73.82936543242      -13.25       -6.76    5.2    5.87s
 14   -73.82936543242   +    -Inf       -7.07    5.3    5.84s
┌ Warning: Negative ρcore detected: -3.412853243566408e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.81414922391                   -0.91    9.7    9.88s
  2   -73.82302325201       -2.05       -1.11    5.4    5.69s
  3   -73.82843601648       -2.27       -1.47    7.0    7.59s
  4   -73.82921030869       -3.11       -1.81    5.6    5.98s
  5   -73.82934286465       -3.88       -2.22    5.1    5.78s
  6   -73.82936540379       -4.65       -3.08    5.5    6.26s
  7   -73.82936542856       -7.61       -3.48    5.1    6.67s
  8   -73.82936543213       -8.45       -4.05    3.4    4.70s
  9   -73.82936543238       -9.61       -4.48    4.1    5.09s
 10   -73.82936543240      -10.61       -4.83    4.1    4.70s
 11   -73.82936543242      -10.79       -5.62    4.8    5.28s
 12   -73.82936543242      -12.05       -6.38    4.8    5.40s
 13   -73.82936543242      -12.94       -6.76    5.3    5.83s
 14   -73.82936543242   +  -13.25       -7.07    5.3    5.74s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.412853243566408e-8,1.830035488323082e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.382937e+01     3.810151e-06
 * time: 494.5733449459076
┌ Warning: Negative ρcore detected: -3.4128070087321323e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.81415820840                   -0.91    9.7    9.05s
  2   -73.82302267738       -2.05       -1.11    5.4    5.50s
  3   -73.82843340143       -2.27       -1.47    6.9    7.37s
  4   -73.82921066176       -3.11       -1.81    5.7    5.87s
  5   -73.82934297566       -3.88       -2.22    5.0    5.61s
  6   -73.82936540409       -4.65       -3.08    5.5    5.99s
  7   -73.82936542863       -7.61       -3.48    5.2    5.72s
  8   -73.82936543219       -8.45       -4.04    3.3    4.42s
  9   -73.82936543243       -9.61       -4.48    4.0    5.81s
 10   -73.82936543246      -10.63       -4.82    3.8    4.91s
 11   -73.82936543247      -10.81       -5.61    4.6    5.58s
 12   -73.82936543247      -12.02       -6.39    4.7    6.04s
 13   -73.82936543247      -13.25       -6.76    5.2    6.33s
 14   -73.82936543247   +  -13.55       -7.07    5.3    6.11s
┌ Warning: Negative ρcore detected: -3.4128070087321323e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.81415113360                   -0.91    9.7    9.36s
  2   -73.82303422175       -2.05       -1.11    5.3    5.44s
  3   -73.82843233612       -2.27       -1.47    6.8    7.07s
  4   -73.82921083308       -3.11       -1.81    5.7    5.87s
  5   -73.82934267332       -3.88       -2.22    5.0    5.52s
  6   -73.82936540524       -4.64       -3.08    5.5    6.06s
  7   -73.82936542853       -7.63       -3.48    4.9    5.63s
  8   -73.82936543215       -8.44       -4.03    3.5    4.56s
  9   -73.82936543243       -9.55       -4.49    4.1    5.04s
 10   -73.82936543246      -10.56       -4.83    4.3    5.04s
 11   -73.82936543247      -10.80       -5.63    4.8    5.40s
 12   -73.82936543247      -12.02       -6.39    4.8    5.56s
 13   -73.82936543247   +  -13.37       -6.78    5.4    5.86s
 14   -73.82936543247   +  -13.55       -7.07    5.3    5.66s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4128070087321323e-8,1.8399878849617046e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.382937e+01     1.475723e-08
 * time: 721.998438835144
 * Status: success

 * Candidate solution
    Final objective value:     -7.382937e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.52e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.42e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 5.28e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 7.15e-13 ≰ 0.0e+00
    |g(x)|                 = 1.48e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   722  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

V: 849.140025 seconds (566.74 M allocations: 267.775 GiB, 6.12% gc time, 0.01% compilation time)
