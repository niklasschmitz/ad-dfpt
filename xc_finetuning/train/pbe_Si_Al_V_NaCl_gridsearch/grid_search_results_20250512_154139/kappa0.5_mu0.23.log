┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-12T15:41:57.994
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460213919357                   -0.96    6.9    11.6s
  2   -8.462167595334       -2.71       -1.75    2.0    5.06s
  3   -8.462227075960       -4.23       -2.79    3.7    2.22s
  4   -8.462227766265       -6.16       -3.91    4.1    1.77s
  5   -8.462227773407       -8.15       -4.42    4.3    2.17s
  6   -8.462227773837       -9.37       -5.47    3.8    1.65s
  7   -8.462227773844      -11.13       -6.13    4.3    2.15s
  8   -8.462227773845      -12.60       -7.74    3.7    1.62s
Iter     Function value   Gradient norm 
     0    -8.462228e+00     1.968347e-03
 * time: 4.57763671875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460221348073                   -0.96    7.3    2.64s
  2   -8.462172285766       -2.71       -1.75    2.0    1.46s
  3   -8.462230827713       -4.23       -2.79    4.0    1.70s
  4   -8.462231506639       -6.17       -3.91    4.2    2.06s
  5   -8.462231513434       -8.17       -4.43    4.4    1.86s
  6   -8.462231513847       -9.38       -5.49    4.0    1.88s
  7   -8.462231513853      -11.19       -6.11    4.5    1.75s
  8   -8.462231513854      -12.56       -7.68    3.9    1.84s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460219742981                   -0.96    7.3    2.69s
  2   -8.462172361500       -2.71       -1.75    2.1    1.21s
  3   -8.462230832620       -4.23       -2.79    3.9    1.97s
  4   -8.462231505903       -6.17       -3.91    4.3    2.08s
  5   -8.462231513371       -8.13       -4.41    4.5    1.84s
  6   -8.462231513846       -9.32       -5.50    3.9    1.86s
  7   -8.462231513853      -11.16       -6.11    4.5    1.79s
  8   -8.462231513854      -12.59       -7.76    3.8    1.81s
     1    -8.462232e+00     1.831763e-03
 * time: 42.66653299331665
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460191552882                   -0.96    7.1    2.56s
  2   -8.462190980344       -2.70       -1.74    2.3    1.18s
  3   -8.462254783407       -4.20       -2.77    3.7    1.94s
  4   -8.462255456773       -6.17       -3.92    4.1    1.71s
  5   -8.462255463712       -8.16       -4.43    4.3    2.09s
  6   -8.462255464085       -9.43       -5.50    3.9    1.53s
  7   -8.462255464091      -11.19       -6.11    4.4    2.04s
  8   -8.462255464091      -12.59       -7.74    3.6    1.50s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460198067722                   -0.96    7.2    2.55s
  2   -8.462195752142       -2.70       -1.75    2.3    1.20s
  3   -8.462254721055       -4.23       -2.77    3.7    1.94s
  4   -8.462255459150       -6.13       -3.90    4.1    1.71s
  5   -8.462255463842       -8.33       -4.49    4.2    2.06s
  6   -8.462255464086       -9.61       -5.55    4.1    1.58s
  7   -8.462255464091      -11.33       -6.17    4.4    2.03s
  8   -8.462255464091      -12.77       -7.65    3.7    1.51s
     2    -8.462255e+00     2.499397e-05
 * time: 83.79496693611145
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460210027000                   -0.96    7.5    3.21s
  2   -8.462201256850       -2.70       -1.75    2.3    1.22s
  3   -8.462254714670       -4.27       -2.77    3.8    1.98s
  4   -8.462255464544       -6.13       -3.88    4.3    2.00s
  5   -8.462255468300       -8.43       -4.53    4.2    1.75s
  6   -8.462255468474       -9.76       -5.62    4.4    1.90s
  7   -8.462255468478      -11.50       -6.22    4.6    1.78s
  8   -8.462255468478      -12.90       -7.57    3.9    1.83s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460206359968                   -0.96    7.5    2.66s
  2   -8.462198868323       -2.70       -1.75    2.2    1.51s
  3   -8.462254824603       -4.25       -2.77    3.8    1.72s
  4   -8.462255463700       -6.19       -3.90    4.3    2.12s
  5   -8.462255468233       -8.34       -4.50    4.5    1.81s
  6   -8.462255468473       -9.62       -5.56    4.2    1.88s
  7   -8.462255468478      -11.34       -6.15    4.5    1.78s
  8   -8.462255468478      -12.66       -7.85    3.9    2.00s
     3    -8.462255e+00     3.089629e-07
 * time: 126.92741084098816
 * Status: success

 * Candidate solution
    Final objective value:     -8.462255e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.55e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.44e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 4.39e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 5.18e-10 ≰ 0.0e+00
    |g(x)|                 = 3.09e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   127  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 200.152704 seconds (308.11 M allocations: 58.736 GiB, 7.80% gc time, 25.10% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-12T15:45:18.766
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19397604964                   -1.18    8.5    19.6s
  2   -62.19763296311       -2.44       -1.22    2.8    8.16s
  3   -62.20197373108       -2.36       -2.08    4.3    9.75s
  4   -62.20199980777       -4.58       -2.84    4.0    10.0s
  5   -62.20200089705       -5.96       -3.65    4.1    10.4s
  6   -62.20200090426       -8.14       -4.55    4.2    10.3s
  7   -62.20200090452       -9.59       -5.29    4.2    10.5s
  8   -62.20200090453      -10.90       -6.71    4.1    10.4s
  9   -62.20200090453      -13.11       -8.01    4.6    11.5s
Iter     Function value   Gradient norm 
     0    -6.220200e+01     4.154950e-03
 * time: 4.100799560546875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19400517416                   -1.18    8.8    17.9s
  2   -62.19764785142       -2.44       -1.22    3.0    8.37s
  3   -62.20199111939       -2.36       -2.08    4.4    10.3s
  4   -62.20201697750       -4.59       -2.85    4.0    9.94s
  5   -62.20201800207       -5.99       -3.66    4.1    10.5s
  6   -62.20201800895       -8.16       -4.55    4.2    10.4s
  7   -62.20201800919       -9.61       -5.19    4.2    10.8s
  8   -62.20201800921      -10.72       -6.89    4.0    10.7s
  9   -62.20201800921   +  -13.11       -8.02    4.8    12.2s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19400863678                   -1.18    8.7    18.2s
  2   -62.19765629480       -2.44       -1.22    2.9    8.16s
  3   -62.20199113795       -2.36       -2.08    4.2    10.7s
  4   -62.20201697790       -4.59       -2.85    4.0    10.6s
  5   -62.20201800244       -5.99       -3.67    4.2    10.7s
  6   -62.20201800896       -8.19       -4.58    4.0    10.2s
  7   -62.20201800920       -9.62       -5.31    4.2    10.7s
  8   -62.20201800921      -10.86       -6.82    4.0    10.6s
  9   -62.20201800921   +  -13.37       -8.06    4.6    11.7s
     1    -6.220202e+01     4.078390e-03
 * time: 235.60603308677673
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19500222763                   -1.19    7.9    15.8s
  2   -62.19870850478       -2.43       -1.25    2.8    7.53s
  3   -62.20240858491       -2.43       -2.10    4.0    9.85s
  4   -62.20242994625       -4.67       -2.90    4.0    10.0s
  5   -62.20243060676       -6.18       -3.67    4.0    10.2s
  6   -62.20243061208       -8.27       -4.55    3.9    10.4s
  7   -62.20243061224       -9.79       -5.33    4.0    10.4s
  8   -62.20243061225      -11.22       -6.95    4.0    10.4s
  9   -62.20243061225   +  -13.25       -7.99    4.5    11.3s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19500140323                   -1.19    8.0    15.7s
  2   -62.19869953028       -2.43       -1.24    2.8    7.76s
  3   -62.20240885122       -2.43       -2.11    4.1    9.83s
  4   -62.20242998623       -4.67       -2.92    4.0    9.78s
  5   -62.20243060733       -6.21       -3.70    4.0    10.7s
  6   -62.20243061210       -8.32       -4.59    3.9    9.83s
  7   -62.20243061224       -9.85       -5.26    4.0    10.1s
  8   -62.20243061225      -11.05       -7.19    3.9    9.76s
     2    -6.220243e+01     5.297418e-04
 * time: 443.56816387176514
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19494843195                   -1.19    8.4    16.2s
  2   -62.19864655181       -2.43       -1.24    2.7    7.38s
  3   -62.20241410333       -2.42       -2.10    4.3    10.0s
  4   -62.20243588054       -4.66       -2.89    3.9    9.64s
  5   -62.20243659623       -6.15       -3.67    4.0    9.73s
  6   -62.20243660194       -8.24       -4.54    4.0    10.1s
  7   -62.20243660211       -9.77       -5.27    4.1    10.3s
  8   -62.20243660212      -11.12       -6.97    4.0    10.1s
  9   -62.20243660212      -13.55       -8.04    4.7    11.5s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19494735031                   -1.19    8.2    16.1s
  2   -62.19864775854       -2.43       -1.24    2.9    8.07s
  3   -62.20241416181       -2.42       -2.10    4.2    10.1s
  4   -62.20243591097       -4.66       -2.90    4.0    9.92s
  5   -62.20243659680       -6.16       -3.68    4.1    10.5s
  6   -62.20243660197       -8.29       -4.56    4.0    10.0s
  7   -62.20243660211       -9.84       -5.23    4.2    10.7s
  8   -62.20243660212      -11.07       -7.19    4.0    10.3s
     3    -6.220244e+01     5.635184e-05
 * time: 654.155641078949
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19495000071                   -1.19    8.4    16.1s
  2   -62.19865046777       -2.43       -1.24    2.9    7.56s
  3   -62.20241425801       -2.42       -2.10    4.2    9.86s
  4   -62.20243599185       -4.66       -2.91    3.9    10.1s
  5   -62.20243666667       -6.17       -3.69    4.1    10.1s
  6   -62.20243667168       -8.30       -4.58    4.1    10.1s
  7   -62.20243667184       -9.81       -5.29    4.1    11.6s
  8   -62.20243667185      -11.09       -6.97    3.9    10.6s
  9   -62.20243667185      -13.85       -8.04    4.7    11.9s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19494906066                   -1.19    8.4    16.8s
  2   -62.19865378139       -2.43       -1.24    2.9    7.65s
  3   -62.20241403549       -2.42       -2.10    4.3    10.1s
  4   -62.20243594744       -4.66       -2.89    3.9    9.85s
  5   -62.20243666603       -6.14       -3.67    4.1    10.4s
  6   -62.20243667166       -8.25       -4.54    4.0    10.1s
  7   -62.20243667184       -9.75       -5.38    4.1    10.3s
  8   -62.20243667185      -11.27       -6.75    4.1    10.8s
  9   -62.20243667185      -13.19       -7.96    4.3    11.1s
     4    -6.220244e+01     6.533077e-07
 * time: 881.7610309123993
 * Status: success

 * Candidate solution
    Final objective value:     -6.220244e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.45e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.32e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 6.97e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.12e-09 ≰ 0.0e+00
    |g(x)|                 = 6.53e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   882  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

NaCl: 1008.089534 seconds (983.30 M allocations: 284.639 GiB, 5.17% gc time, 0.32% compilation time)
┌ Info: 2025-05-12T16:02:06.885
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317599376619                   -1.47    5.5    1.75s
  2   -2.317681014999       -4.09       -1.84    1.4    859ms
  3   -2.317698281797       -4.76       -3.58    3.2    1.63s
  4   -2.317698477236       -6.71       -4.00    4.6    2.04s
  5   -2.317698477770       -9.27       -4.25    2.1    1.21s
  6   -2.317698477955       -9.73       -5.04    2.6    1.38s
  7   -2.317698477962      -11.16       -5.80    2.8    1.50s
  8   -2.317698477963      -12.75       -6.42    2.7    1.19s
  9   -2.317698477963      -14.18       -6.91    2.3    1.29s
 10   -2.317698477963   +    -Inf       -7.70    2.2    986ms
Iter     Function value   Gradient norm 
     0    -2.317698e+00     2.228150e-04
 * time: 3.814697265625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317605843486                   -1.47    5.3    2.03s
  2   -2.317681147098       -4.12       -1.84    1.3    780ms
  3   -2.317698337189       -4.76       -3.56    3.1    1.55s
  4   -2.317698525809       -6.72       -3.99    4.5    1.68s
  5   -2.317698526385       -9.24       -4.24    2.2    1.28s
  6   -2.317698526574       -9.72       -5.03    2.5    1.05s
  7   -2.317698526581      -11.16       -5.84    2.9    1.20s
  8   -2.317698526582      -12.68       -6.32    2.7    1.51s
  9   -2.317698526582      -14.03       -7.00    2.3    1.08s
 10   -2.317698526582      -15.05       -7.59    2.7    1.40s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317602546741                   -1.47    5.3    1.96s
  2   -2.317681645609       -4.10       -1.84    1.3    754ms
  3   -2.317698320273       -4.78       -3.58    3.2    1.51s
  4   -2.317698525854       -6.69       -4.00    4.5    2.03s
  5   -2.317698526387       -9.27       -4.24    2.2    1.37s
  6   -2.317698526575       -9.73       -5.05    2.6    997ms
  7   -2.317698526581      -11.17       -5.80    2.7    1.39s
  8   -2.317698526582      -12.77       -6.46    2.7    1.07s
  9   -2.317698526582      -14.27       -6.87    2.3    970ms
 10   -2.317698526582   +  -15.35       -7.60    2.0    1.16s
     1    -2.317699e+00     2.135910e-04
 * time: 55.93031716346741
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317606250775                   -1.47    5.4    2.00s
  2   -2.317682169614       -4.12       -1.84    1.4    747ms
  3   -2.317698858707       -4.78       -3.56    3.2    1.54s
  4   -2.317699079127       -6.66       -3.98    4.6    1.62s
  5   -2.317699079745       -9.21       -4.22    2.2    1.23s
  6   -2.317699079961       -9.66       -4.98    2.6    1.02s
  7   -2.317699079968      -11.19       -5.73    2.7    1.11s
  8   -2.317699079968      -12.55       -6.25    2.8    1.33s
  9   -2.317699079968      -14.24       -6.81    1.9    837ms
 10   -2.317699079968      -14.65       -7.40    2.3    1.20s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317607008243                   -1.47    5.6    1.96s
  2   -2.317682419830       -4.12       -1.84    1.4    745ms
  3   -2.317698836970       -4.78       -3.58    3.3    1.54s
  4   -2.317699079173       -6.62       -3.99    4.5    1.59s
  5   -2.317699079748       -9.24       -4.23    2.2    1.30s
  6   -2.317699079961       -9.67       -4.99    2.7    1.07s
  7   -2.317699079968      -11.15       -5.72    2.9    1.17s
  8   -2.317699079968      -12.58       -6.10    2.9    1.38s
  9   -2.317699079968      -13.94       -6.73    1.8    841ms
 10   -2.317699079968      -15.05       -7.30    2.4    1.28s
     2    -2.317699e+00     1.319433e-06
 * time: 110.19028210639954
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317604181166                   -1.47    5.5    2.00s
  2   -2.317681875254       -4.11       -1.84    1.4    758ms
  3   -2.317698837402       -4.77       -3.58    3.3    1.55s
  4   -2.317699079223       -6.62       -3.99    4.6    1.65s
  5   -2.317699079786       -9.25       -4.24    2.3    1.25s
  6   -2.317699079983       -9.71       -5.00    2.6    1.03s
  7   -2.317699079989      -11.19       -5.74    2.7    1.35s
  8   -2.317699079989      -12.62       -6.29    2.7    1.09s
  9   -2.317699079989      -14.12       -6.78    2.2    964ms
 10   -2.317699079989      -15.05       -7.48    2.3    1.20s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317603862560                   -1.47    5.5    2.34s
  2   -2.317681718401       -4.11       -1.84    1.4    985ms
  3   -2.317698895557       -4.77       -3.57    3.2    1.87s
  4   -2.317699079194       -6.74       -3.98    4.7    1.93s
  5   -2.317699079777       -9.23       -4.23    2.2    1.40s
  6   -2.317699079982       -9.69       -5.00    2.7    1.28s
  7   -2.317699079989      -11.13       -5.73    2.8    1.51s
  8   -2.317699079989      -12.57       -6.26    2.7    1.19s
  9   -2.317699079989      -14.21       -6.83    2.0    1.04s
 10   -2.317699079989      -14.75       -7.60    2.4    1.30s
     3    -2.317699e+00     8.350325e-09
 * time: 166.12687611579895
 * Status: success

 * Candidate solution
    Final objective value:     -2.317699e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.21e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.20e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.14e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 9.21e-12 ≰ 0.0e+00
    |g(x)|                 = 8.35e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   166  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Al: 200.201725 seconds (166.64 M allocations: 39.651 GiB, 6.51% gc time, 0.00% compilation time)
┌ Info: 2025-05-12T16:05:27.088
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77891013871                   -0.87    9.6    9.31s
  2   -73.79012690584       -1.95       -1.06    5.3    5.74s
  3   -73.79662586700       -2.19       -1.40    6.6    6.87s
  4   -73.79772429736       -2.96       -1.77    5.9    5.85s
  5   -73.79788081142       -3.81       -2.24    4.9    5.50s
  6   -73.79790189263       -4.68       -3.07    5.5    6.06s
  7   -73.79790190718       -7.84       -3.52    4.9    5.65s
  8   -73.79790191489       -8.11       -4.05    4.9    5.37s
  9   -73.79790191461   +   -9.55       -4.41    5.7    6.07s
 10   -73.79790191552       -9.04       -4.79    5.7    5.74s
 11   -73.79790191555      -10.46       -5.49    4.9    5.62s
 12   -73.79790191555      -11.87       -6.34    4.7    5.49s
 13   -73.79790191555   +  -13.37       -6.54    4.6    5.57s
 14   -73.79790191555   +  -12.85       -6.89    5.0    5.35s
 15   -73.79790191555   +  -13.00       -7.62    5.2    5.53s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.379790e+01     1.118130e-02
 * time: 2.8848648071289062e-5
┌ Warning: Negative ρcore detected: -3.374440828491556e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77925139910                   -0.87    9.8    9.39s
  2   -73.79030364848       -1.96       -1.07    5.2    5.42s
  3   -73.79674933298       -2.19       -1.40    6.7    6.88s
  4   -73.79784377855       -2.96       -1.77    5.9    6.05s
  5   -73.79799724464       -3.81       -2.25    5.0    5.51s
  6   -73.79801754862       -4.69       -3.08    5.5    6.02s
  7   -73.79801756271       -7.85       -3.54    5.0    5.58s
  8   -73.79801757203       -8.03       -4.05    5.1    5.36s
  9   -73.79801757174   +   -9.54       -4.43    5.8    5.97s
 10   -73.79801757272       -9.01       -4.79    5.8    5.97s
 11   -73.79801757276      -10.42       -5.46    4.9    5.51s
 12   -73.79801757276      -11.94       -6.28    4.7    5.44s
 13   -73.79801757276   +  -13.15       -6.52    4.7    5.52s
 14   -73.79801757276   +  -12.89       -6.90    5.1    5.48s
 15   -73.79801757276   +  -12.64       -7.65    5.2    5.70s
┌ Warning: Negative ρcore detected: -3.374440828491556e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77926196740                   -0.87    9.8    9.28s
  2   -73.79028963358       -1.96       -1.07    5.2    5.42s
  3   -73.79675030799       -2.19       -1.40    6.6    6.97s
  4   -73.79784386596       -2.96       -1.77    5.8    6.24s
  5   -73.79799709226       -3.81       -2.24    5.0    5.77s
  6   -73.79801754792       -4.69       -3.08    5.5    6.18s
  7   -73.79801756513       -7.76       -3.53    4.6    5.47s
  8   -73.79801757228       -8.15       -4.04    4.9    5.40s
  9   -73.79801757191   +   -9.44       -4.45    5.7    6.04s
 10   -73.79801757272       -9.09       -4.79    5.7    6.09s
 11   -73.79801757276      -10.37       -5.48    5.0    5.74s
 12   -73.79801757276      -12.15       -6.28    4.7    5.55s
 13   -73.79801757276   +  -13.37       -6.51    4.7    5.73s
 14   -73.79801757276   +  -12.67       -6.91    5.1    5.67s
 15   -73.79801757276   +  -12.85       -7.66    5.2    5.76s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.374440828491556e-8,-6.111584249049466e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.379802e+01     9.501348e-03
 * time: 240.35979795455933
┌ Warning: Negative ρcore detected: -3.158982014790512e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.78079133071                   -0.87    9.5    8.98s
  2   -73.79112562451       -1.99       -1.07    5.1    5.46s
  3   -73.79709314879       -2.22       -1.41    6.5    7.30s
  4   -73.79816330453       -2.97       -1.81    5.8    5.98s
  5   -73.79829318278       -3.89       -2.34    4.9    5.51s
  6   -73.79830534964       -4.91       -3.12    5.5    6.38s
  7   -73.79830534854   +   -8.96       -3.56    4.8    5.50s
  8   -73.79830538264       -7.47       -4.01    5.2    5.74s
  9   -73.79830538297       -9.47       -4.32    5.5    6.07s
 10   -73.79830538535       -8.62       -4.89    5.5    5.98s
 11   -73.79830538538      -10.54       -5.36    5.0    5.75s
 12   -73.79830538540      -10.84       -6.08    5.0    5.78s
 13   -73.79830538540      -12.21       -6.53    5.3    5.94s
 14   -73.79830538540      -13.85       -6.99    4.8    5.39s
 15   -73.79830538540      -13.85       -7.94    5.2    5.75s
┌ Warning: Negative ρcore detected: -3.158982014790512e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.78078429796                   -0.87    9.5    8.93s
  2   -73.79113009709       -1.99       -1.07    5.1    5.73s
  3   -73.79709184921       -2.22       -1.41    6.6    6.99s
  4   -73.79816378847       -2.97       -1.81    5.7    5.97s
  5   -73.79829330524       -3.89       -2.34    5.0    5.71s
  6   -73.79830535035       -4.92       -3.12    5.6    6.39s
  7   -73.79830534681   +   -8.45       -3.56    4.8    5.61s
  8   -73.79830538248       -7.45       -4.01    5.2    5.75s
  9   -73.79830538290       -9.38       -4.32    5.6    6.08s
 10   -73.79830538535       -8.61       -4.89    5.6    5.98s
 11   -73.79830538538      -10.54       -5.36    5.1    6.07s
 12   -73.79830538540      -10.84       -6.07    5.1    6.02s
 13   -73.79830538540      -12.18       -6.53    5.3    5.96s
 14   -73.79830538540   +    -Inf       -6.98    4.8    5.38s
 15   -73.79830538540      -13.85       -7.93    5.2    5.65s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.158982014790512e-8,1.463669378064015e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.379831e+01     5.548542e-04
 * time: 483.52844500541687
┌ Warning: Negative ρcore detected: -3.105698365570358e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.78073796547                   -0.87    9.6    9.27s
  2   -73.79109416455       -1.98       -1.07    5.2    5.43s
  3   -73.79708860296       -2.22       -1.41    6.7    7.08s
  4   -73.79816282801       -2.97       -1.80    5.8    6.55s
  5   -73.79829400714       -3.88       -2.34    5.0    5.60s
  6   -73.79830627489       -4.91       -3.11    5.6    6.37s
  7   -73.79830626977   +   -8.29       -3.56    4.9    5.76s
  8   -73.79830630592       -7.44       -4.00    5.2    5.82s
  9   -73.79830630645       -9.28       -4.31    5.6    6.16s
 10   -73.79830630895       -8.60       -4.88    5.5    5.96s
 11   -73.79830630898      -10.53       -5.35    5.1    5.86s
 12   -73.79830630900      -10.81       -6.06    5.0    5.80s
 13   -73.79830630900      -12.16       -6.58    5.4    5.98s
 14   -73.79830630900      -13.25       -6.95    4.7    5.43s
 15   -73.79830630900   +  -13.25       -7.88    5.3    5.68s
┌ Warning: Negative ρcore detected: -3.105698365570358e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.78073949846                   -0.87    9.7    9.48s
  2   -73.79110190855       -1.98       -1.07    5.1    6.83s
  3   -73.79708744167       -2.22       -1.41    6.7    7.14s
  4   -73.79816267370       -2.97       -1.80    5.9    5.92s
  5   -73.79829371947       -3.88       -2.34    5.0    5.50s
  6   -73.79830626796       -4.90       -3.11    5.5    6.02s
  7   -73.79830627381       -8.23       -3.56    4.6    5.31s
  8   -73.79830630638       -7.49       -4.00    5.2    5.76s
  9   -73.79830630643      -10.26       -4.31    5.5    6.04s
 10   -73.79830630895       -8.60       -4.87    5.5    5.99s
 11   -73.79830630898      -10.54       -5.35    5.0    5.79s
 12   -73.79830630900      -10.83       -6.09    5.0    5.71s
 13   -73.79830630900      -12.19       -6.51    5.4    5.94s
 14   -73.79830630900      -13.55       -6.93    4.8    5.73s
 15   -73.79830630900   +  -13.85       -7.87    5.2    5.60s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.105698365570358e-8,1.589752466312768e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.379831e+01     2.490030e-05
 * time: 728.431431055069
┌ Warning: Negative ρcore detected: -3.1080768774304016e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.78074076353                   -0.87    9.6    9.38s
  2   -73.79110198920       -1.98       -1.07    5.2    5.88s
  3   -73.79708892005       -2.22       -1.41    6.7    7.37s
  4   -73.79816243508       -2.97       -1.80    5.9    6.10s
  5   -73.79829377594       -3.88       -2.34    5.0    6.58s
  6   -73.79830627113       -4.90       -3.12    5.7    6.57s
  7   -73.79830627462       -8.46       -3.56    4.7    5.50s
  8   -73.79830630817       -7.47       -4.00    5.3    6.00s
  9   -73.79830630832       -9.82       -4.31    5.6    6.22s
 10   -73.79830631083       -8.60       -4.88    5.5    6.02s
 11   -73.79830631086      -10.56       -5.35    5.0    5.82s
 12   -73.79830631087      -10.82       -6.09    5.1    5.68s
 13   -73.79830631087      -12.36       -6.51    5.4    5.90s
 14   -73.79830631087      -13.07       -6.95    4.8    5.38s
 15   -73.79830631087      -13.85       -7.88    5.2    5.82s
┌ Warning: Negative ρcore detected: -3.1080768774304016e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.78074074551                   -0.87    9.6    9.50s
  2   -73.79110733904       -1.98       -1.07    5.2    5.48s
  3   -73.79708809948       -2.22       -1.41    6.7    7.04s
  4   -73.79816275647       -2.97       -1.80    5.9    6.13s
  5   -73.79829385542       -3.88       -2.34    5.0    5.59s
  6   -73.79830627357       -4.91       -3.11    5.6    6.23s
  7   -73.79830627072   +   -8.55       -3.56    4.8    5.65s
  8   -73.79830630788       -7.43       -4.00    5.2    5.79s
  9   -73.79830630834       -9.34       -4.31    5.6    6.17s
 10   -73.79830631083       -8.60       -4.90    5.5    5.92s
 11   -73.79830631086      -10.58       -5.36    5.1    5.71s
 12   -73.79830631087      -10.82       -6.07    5.1    5.65s
 13   -73.79830631087      -12.17       -6.58    5.5    5.92s
 14   -73.79830631087   +  -13.37       -7.00    4.7    5.39s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1080768774304016e-8,1.5844342843680746e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     4    -7.379831e+01     1.928780e-07
 * time: 969.1512520313263
 * Status: success

 * Candidate solution
    Final objective value:     -7.379831e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.50e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.66e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.87e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.54e-11 ≰ 0.0e+00
    |g(x)|                 = 1.93e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   969  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

V: 1100.045375 seconds (755.85 M allocations: 365.000 GiB, 5.97% gc time, 0.01% compilation time)
