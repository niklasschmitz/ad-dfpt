┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-12T16:22:39.132
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.469596532754                   -0.96    7.0    11.6s
  2   -8.471486071941       -2.72       -1.73    2.1    4.99s
  3   -8.471544784103       -4.23       -2.77    3.7    1.91s
  4   -8.471545583074       -6.10       -3.90    4.1    1.69s
  5   -8.471545591391       -8.08       -4.42    4.5    2.04s
  6   -8.471545591856       -9.33       -5.46    3.9    1.76s
  7   -8.471545591864      -11.14       -6.16    4.3    1.70s
  8   -8.471545591864      -12.68       -7.72    3.9    1.85s
Iter     Function value   Gradient norm 
     0    -8.471546e+00     4.094824e-04
 * time: 5.1021575927734375e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.469580849660                   -0.96    7.1    2.51s
  2   -8.471487223900       -2.72       -1.73    2.1    1.41s
  3   -8.471544831177       -4.24       -2.76    3.7    1.57s
  4   -8.471545746685       -6.04       -3.89    4.2    1.99s
  5   -8.471545753386       -8.17       -4.49    4.4    1.72s
  6   -8.471545753712       -9.49       -5.51    4.2    1.81s
  7   -8.471545753718      -11.28       -6.20    4.3    1.67s
  8   -8.471545753718      -12.75       -7.64    3.8    1.87s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.469596176194                   -0.96    7.2    2.47s
  2   -8.471486237414       -2.72       -1.73    2.2    1.41s
  3   -8.471544865634       -4.23       -2.76    3.7    1.57s
  4   -8.471545745650       -6.06       -3.89    4.3    1.98s
  5   -8.471545753300       -8.12       -4.44    4.3    1.73s
  6   -8.471545753711       -9.39       -5.48    4.1    1.80s
  7   -8.471545753717      -11.19       -6.16    4.2    1.69s
  8   -8.471545753718      -12.73       -7.64    3.7    1.83s
     1    -8.471546e+00     3.810492e-04
 * time: 42.06778407096863
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.469540845225                   -0.96    7.1    2.60s
  2   -8.471479458002       -2.71       -1.73    2.1    1.14s
  3   -8.471545807848       -4.18       -2.76    3.9    1.93s
  4   -8.471546788739       -6.01       -3.90    4.2    1.70s
  5   -8.471546796691       -8.10       -4.43    4.5    2.10s
  6   -8.471546797138       -9.35       -5.44    4.0    1.55s
  7   -8.471546797146      -11.10       -6.12    4.4    2.00s
  8   -8.471546797146      -12.57       -7.71    4.0    1.70s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.469550483553                   -0.96    7.0    2.45s
  2   -8.471481507926       -2.71       -1.73    2.3    1.15s
  3   -8.471545868130       -4.19       -2.76    3.7    2.04s
  4   -8.471546789413       -6.04       -3.90    4.3    1.71s
  5   -8.471546796741       -8.13       -4.45    4.5    2.37s
  6   -8.471546797139       -9.40       -5.47    4.2    1.70s
  7   -8.471546797146      -11.16       -6.14    4.3    2.10s
  8   -8.471546797146      -12.61       -7.73    3.8    1.62s
     2    -8.471547e+00     1.097686e-06
 * time: 83.50402808189392
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.469558016808                   -0.96    7.0    2.42s
  2   -8.471484329448       -2.72       -1.73    2.3    1.40s
  3   -8.471545953563       -4.21       -2.76    3.7    1.53s
  4   -8.471546789013       -6.08       -3.89    4.2    1.93s
  5   -8.471546796690       -8.11       -4.42    4.5    1.73s
  6   -8.471546797147       -9.34       -5.47    4.2    1.80s
  7   -8.471546797155      -11.12       -6.14    4.4    1.72s
  8   -8.471546797155      -12.64       -7.72    3.8    1.81s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.469534611410                   -0.96    7.0    2.50s
  2   -8.471480351409       -2.71       -1.73    2.2    1.40s
  3   -8.471545937570       -4.18       -2.76    3.7    1.58s
  4   -8.471546788617       -6.07       -3.90    4.2    1.99s
  5   -8.471546796650       -8.10       -4.41    4.5    1.77s
  6   -8.471546797147       -9.30       -5.45    4.0    1.82s
  7   -8.471546797155      -11.12       -6.13    4.4    1.72s
  8   -8.471546797155      -12.59       -7.66    3.9    1.87s
     3    -8.471547e+00     2.791655e-09
 * time: 124.4353358745575
 * Status: success

 * Candidate solution
    Final objective value:     -8.471547e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.58e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.52e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 8.65e-12 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.02e-12 ≰ 0.0e+00
    |g(x)|                 = 2.79e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   124  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 198.877551 seconds (308.16 M allocations: 58.554 GiB, 7.59% gc time, 26.31% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-12T16:25:58.688
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26291462734                   -1.17    8.5    18.7s
  2   -62.26702215307       -2.39       -1.21    2.8    7.84s
  3   -62.27163987624       -2.34       -2.06    4.2    9.94s
  4   -62.27167096624       -4.51       -2.93    3.8    9.71s
  5   -62.27167146057       -6.31       -3.67    4.0    9.93s
  6   -62.27167146928       -8.06       -4.46    3.8    9.32s
  7   -62.27167146962       -9.47       -5.22    4.0    10.5s
  8   -62.27167146963      -10.87       -6.69    3.9    10.0s
  9   -62.27167146963      -12.97       -7.83    4.4    10.9s
Iter     Function value   Gradient norm 
     0    -6.227167e+01     2.245409e-03
 * time: 3.409385681152344e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26292158275                   -1.17    8.5    16.5s
  2   -62.26702726145       -2.39       -1.21    2.8    7.46s
  3   -62.27164500030       -2.34       -2.06    4.1    9.79s
  4   -62.27167593641       -4.51       -2.93    3.8    9.86s
  5   -62.27167645310       -6.29       -3.66    4.1    10.0s
  6   -62.27167646248       -8.03       -4.45    3.9    9.72s
  7   -62.27167646286       -9.42       -5.18    4.0    10.2s
  8   -62.27167646288      -10.72       -6.77    3.8    9.53s
  9   -62.27167646288      -14.15       -7.87    4.6    11.3s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26292247018                   -1.17    8.6    16.6s
  2   -62.26702914237       -2.39       -1.21    2.8    7.32s
  3   -62.27164504280       -2.34       -2.06    4.1    9.74s
  4   -62.27167592138       -4.51       -2.92    3.8    10.4s
  5   -62.27167645284       -6.27       -3.65    4.1    10.6s
  6   -62.27167646249       -8.02       -4.44    3.9    9.83s
  7   -62.27167646286       -9.42       -5.20    3.9    10.0s
  8   -62.27167646288      -10.81       -6.77    4.1    10.5s
  9   -62.27167646288   +  -13.55       -7.90    4.4    11.4s
     1    -6.227168e+01     2.202090e-03
 * time: 222.07138895988464
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26338687839                   -1.17    8.6    17.0s
  2   -62.26751217576       -2.38       -1.22    2.8    8.62s
  3   -62.27176917017       -2.37       -2.08    4.1    10.6s
  4   -62.27179650059       -4.56       -2.97    3.9    9.66s
  5   -62.27179688320       -6.42       -3.70    4.1    10.5s
  6   -62.27179689013       -8.16       -4.48    3.8    9.48s
  7   -62.27179689039       -9.59       -5.15    4.1    10.2s
  8   -62.27179689040      -10.80       -6.87    3.8    10.2s
  9   -62.27179689040      -13.45       -7.88    4.7    11.6s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26339083767                   -1.17    8.6    16.9s
  2   -62.26752319125       -2.38       -1.22    2.9    7.66s
  3   -62.27176896082       -2.37       -2.07    4.1    10.0s
  4   -62.27179651450       -4.56       -2.97    3.9    9.88s
  5   -62.27179688340       -6.43       -3.70    4.2    11.1s
  6   -62.27179689014       -8.17       -4.48    3.9    10.7s
  7   -62.27179689039       -9.60       -5.20    4.0    11.0s
  8   -62.27179689040      -10.92       -6.85    4.0    10.3s
  9   -62.27179689040      -13.45       -7.96    4.5    11.3s
     2    -6.227180e+01     1.380402e-04
 * time: 452.7405860424042
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26336710045                   -1.17    8.8    17.7s
  2   -62.26750291815       -2.38       -1.22    2.9    7.50s
  3   -62.27176900088       -2.37       -2.07    4.2    9.88s
  4   -62.27179691257       -4.55       -2.95    3.9    10.1s
  5   -62.27179732050       -6.39       -3.67    4.1    10.2s
  6   -62.27179732807       -8.12       -4.44    3.8    9.59s
  7   -62.27179732835       -9.56       -5.16    4.0    10.2s
  8   -62.27179732836      -10.90       -6.67    4.0    9.91s
  9   -62.27179732836   +  -13.85       -7.88    4.5    10.9s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26337018331                   -1.17    8.7    16.9s
  2   -62.26749624459       -2.38       -1.22    2.8    7.42s
  3   -62.27176933579       -2.37       -2.07    4.3    10.2s
  4   -62.27179695124       -4.56       -2.98    3.8    9.88s
  5   -62.27179732168       -6.43       -3.71    4.1    10.4s
  6   -62.27179732812       -8.19       -4.50    3.8    9.45s
  7   -62.27179732834       -9.66       -5.12    4.0    10.2s
  8   -62.27179732836      -10.78       -6.90    3.8    9.79s
  9   -62.27179732836      -13.37       -7.89    4.7    12.0s
     3    -6.227180e+01     7.776357e-06
 * time: 675.2608289718628
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26336254212                   -1.17    8.7    17.1s
  2   -62.26750990936       -2.38       -1.22    2.8    7.48s
  3   -62.27176878939       -2.37       -2.07    4.1    10.0s
  4   -62.27179690549       -4.55       -2.94    3.9    10.0s
  5   -62.27179732174       -6.38       -3.66    4.1    10.3s
  6   -62.27179732949       -8.11       -4.43    3.9    10.4s
  7   -62.27179732975       -9.58       -5.14    4.0    10.3s
  8   -62.27179732976      -10.91       -6.72    3.9    10.5s
  9   -62.27179732976      -13.67       -7.90    4.5    11.1s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.26336963118                   -1.17    8.5    16.4s
  2   -62.26749240616       -2.38       -1.22    2.9    7.35s
  3   -62.27176945029       -2.37       -2.08    4.2    9.40s
  4   -62.27179695066       -4.56       -2.98    3.8    9.47s
  5   -62.27179732309       -6.43       -3.72    4.1    10.1s
  6   -62.27179732952       -8.19       -4.50    3.7    9.65s
  7   -62.27179732974       -9.65       -5.09    4.1    10.6s
  8   -62.27179732976      -10.73       -6.97    3.8    10.1s
  9   -62.27179732976   +  -13.67       -7.90    4.8    12.1s
     4    -6.227180e+01     2.766836e-08
 * time: 900.3930020332336
 * Status: success

 * Candidate solution
    Final objective value:     -6.227180e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.59e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.38e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.40e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.25e-11 ≰ 0.0e+00
    |g(x)|                 = 2.77e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   900  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

NaCl: 1022.187002 seconds (1.01 G allocations: 292.879 GiB, 5.14% gc time, 0.31% compilation time)
┌ Info: 2025-05-12T16:43:00.908
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318857045604                   -1.47    5.5    2.38s
  2   -2.318925841225       -4.16       -1.84    1.4    807ms
  3   -2.318940908361       -4.82       -3.53    3.2    1.56s
  4   -2.318941117011       -6.68       -3.92    4.5    1.66s
  5   -2.318941117601       -9.23       -4.12    2.1    1.20s
  6   -2.318941117858       -9.59       -4.96    2.5    1.05s
  7   -2.318941117874      -10.79       -5.73    3.1    1.43s
  8   -2.318941117874      -12.53       -5.96    2.7    1.05s
  9   -2.318941117874      -13.06       -6.61    2.3    992ms
 10   -2.318941117874      -14.27       -7.54    2.9    1.35s
Iter     Function value   Gradient norm 
     0    -2.318941e+00     4.715076e-04
 * time: 3.600120544433594e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318858533358                   -1.47    5.5    2.15s
  2   -2.318926861726       -4.17       -1.84    1.4    832ms
  3   -2.318941122382       -4.85       -3.54    3.2    1.60s
  4   -2.318941334728       -6.67       -3.93    4.5    1.71s
  5   -2.318941335303       -9.24       -4.13    2.2    1.28s
  6   -2.318941335551       -9.61       -4.99    2.6    1.11s
  7   -2.318941335564      -10.89       -5.73    3.0    1.51s
  8   -2.318941335564      -12.50       -5.96    2.6    1.10s
  9   -2.318941335564      -13.08       -6.52    2.2    995ms
 10   -2.318941335564      -14.27       -7.45    2.9    1.64s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318856285116                   -1.47    5.5    2.14s
  2   -2.318926276172       -4.15       -1.84    1.3    1.15s
  3   -2.318941105810       -4.83       -3.53    3.3    1.33s
  4   -2.318941334706       -6.64       -3.92    4.6    2.13s
  5   -2.318941335301       -9.23       -4.13    2.2    1.23s
  6   -2.318941335549       -9.60       -4.98    2.6    1.60s
  7   -2.318941335564      -10.85       -5.73    3.1    1.26s
  8   -2.318941335564      -12.43       -6.01    2.7    1.14s
  9   -2.318941335564      -13.16       -6.60    2.5    1.31s
 10   -2.318941335564      -14.51       -7.44    2.9    1.28s
     1    -2.318941e+00     4.518693e-04
 * time: 58.865350008010864
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318857878480                   -1.47    5.5    2.54s
  2   -2.318929412648       -4.15       -1.84    1.4    1.17s
  3   -2.318943560177       -4.85       -3.56    3.3    1.64s
  4   -2.318943763398       -6.69       -3.96    4.5    2.24s
  5   -2.318943763872       -9.32       -4.19    2.2    1.20s
  6   -2.318943764045       -9.76       -5.14    2.5    1.63s
  7   -2.318943764054      -11.07       -5.92    3.3    1.60s
  8   -2.318943764054      -12.86       -6.30    2.8    1.54s
  9   -2.318943764054      -13.73       -6.88    2.5    1.04s
 10   -2.318943764054      -14.65       -7.87    3.0    1.20s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318859909687                   -1.47    5.6    2.07s
  2   -2.318929334640       -4.16       -1.84    1.4    770ms
  3   -2.318943574850       -4.85       -3.55    3.3    1.57s
  4   -2.318943763351       -6.72       -3.95    4.5    1.63s
  5   -2.318943763868       -9.29       -4.19    2.3    1.28s
  6   -2.318943764044       -9.76       -5.10    2.6    1.06s
  7   -2.318943764054      -11.00       -5.93    3.4    1.57s
  8   -2.318943764054      -12.80       -6.29    2.8    1.30s
  9   -2.318943764054      -13.75       -6.93    2.3    1.02s
 10   -2.318943764054   +    -Inf       -7.79    3.1    1.44s
     2    -2.318944e+00     6.123627e-06
 * time: 119.61747002601624
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318858536464                   -1.47    5.7    2.13s
  2   -2.318929439367       -4.15       -1.84    1.5    1.11s
  3   -2.318943592660       -4.85       -3.55    3.3    1.32s
  4   -2.318943763852       -6.77       -3.97    4.5    1.95s
  5   -2.318943764313       -9.34       -4.19    2.2    977ms
  6   -2.318943764484       -9.77       -5.13    2.8    1.13s
  7   -2.318943764492      -11.06       -5.93    3.3    1.54s
  8   -2.318943764492      -12.81       -6.41    2.9    1.17s
  9   -2.318943764492      -13.89       -6.89    3.0    1.54s
 10   -2.318943764492      -14.65       -7.98    2.8    1.31s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318858774006                   -1.47    5.6    1.79s
  2   -2.318929439303       -4.15       -1.84    1.4    1.08s
  3   -2.318943524669       -4.85       -3.55    3.4    1.27s
  4   -2.318943763812       -6.62       -3.95    4.5    1.90s
  5   -2.318943764308       -9.31       -4.18    2.3    983ms
┌ Warning: Eigensolver not converged
│   n_iter =
│    195-element Vector{Int64}:
│     2
│     7
│     4
│     1
│     ⋮
│     1
│     2
│     1
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/scf/self_consistent_field.jl:76
  6   -2.318943764483       -9.75       -5.11    2.6    1.41s
  7   -2.318943764492      -11.06       -5.96    3.4    1.24s
  8   -2.318943764492      -12.86       -6.36    3.0    1.41s
  9   -2.318943764492      -13.91       -6.92    2.4    984ms
 10   -2.318943764492      -14.88       -7.54    3.0    1.17s
     3    -2.318944e+00     7.456369e-08
 * time: 176.54374599456787
 * Status: success

 * Candidate solution
    Final objective value:     -2.318944e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.45e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.90e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 4.39e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.89e-10 ≰ 0.0e+00
    |g(x)|                 = 7.46e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   177  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Al: 210.268556 seconds (170.50 M allocations: 40.827 GiB, 6.57% gc time, 0.16% compilation time)
┌ Info: 2025-05-12T16:46:31.177
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.82587470480                   -0.89    9.6    9.92s
  2   -73.83551807192       -2.02       -1.09    5.1    5.49s
  3   -73.84134900852       -2.23       -1.43    6.5    6.85s
  4   -73.84230353713       -3.02       -1.79    5.7    5.95s
  5   -73.84244185559       -3.86       -2.25    4.9    5.53s
  6   -73.84246210236       -4.69       -3.08    5.5    6.15s
  7   -73.84246211894       -7.78       -3.53    4.7    5.77s
  8   -73.84246212651       -8.12       -4.03    4.8    5.48s
  9   -73.84246212617   +   -9.46       -4.44    5.7    6.72s
 10   -73.84246212706       -9.05       -4.76    5.6    6.04s
 11   -73.84246212710      -10.36       -5.44    4.9    5.69s
 12   -73.84246212710      -11.40       -6.17    4.7    6.21s
 13   -73.84246212710      -12.77       -6.32    4.8    6.48s
 14   -73.84246212710      -12.89       -6.86    5.2    5.38s
 15   -73.84246212710      -13.25       -7.75    4.9    5.32s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.384246e+01     6.959311e-03
 * time: 2.9087066650390625e-5
┌ Warning: Negative ρcore detected: -3.396246819971951e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.82603547584                   -0.89    9.7    9.56s
  2   -73.83560744098       -2.02       -1.09    5.2    5.43s
  3   -73.84139740998       -2.24       -1.44    6.6    7.05s
  4   -73.84235207325       -3.02       -1.80    5.7    6.01s
  5   -73.84248732509       -3.87       -2.26    4.9    5.55s
  6   -73.84250686175       -4.71       -3.08    5.5    6.50s
  7   -73.84250688512       -7.63       -3.53    4.3    5.62s
  8   -73.84250689208       -8.16       -4.03    4.9    6.05s
  9   -73.84250689127   +   -9.09       -4.45    5.6    6.05s
 10   -73.84250689229       -8.99       -4.77    5.6    5.83s
 11   -73.84250689234      -10.31       -5.45    4.8    6.00s
 12   -73.84250689235      -10.99       -6.17    4.6    5.42s
 13   -73.84250689235      -12.36       -6.30    4.7    5.76s
 14   -73.84250689235      -11.76       -6.88    5.4    5.84s
 15   -73.84250689235      -12.36       -7.81    5.0    5.89s
┌ Warning: Negative ρcore detected: -3.396246819971951e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.82604812174                   -0.89    9.7    11.4s
  2   -73.83561034848       -2.02       -1.09    5.2    5.57s
  3   -73.84139567675       -2.24       -1.43    6.6    7.14s
  4   -73.84235290361       -3.02       -1.80    5.7    5.99s
  5   -73.84248707219       -3.87       -2.25    4.9    5.60s
  6   -73.84250685883       -4.70       -3.08    5.5    6.21s
  7   -73.84250688528       -7.58       -3.52    4.2    6.18s
  8   -73.84250689210       -8.17       -4.02    4.8    6.21s
  9   -73.84250689136   +   -9.13       -4.46    5.4    6.65s
 10   -73.84250689228       -9.03       -4.77    5.5    5.96s
 11   -73.84250689234      -10.27       -5.45    4.9    5.83s
 12   -73.84250689235      -11.04       -6.15    4.6    5.28s
 13   -73.84250689235      -12.27       -6.30    4.8    5.54s
 14   -73.84250689235      -11.78       -6.87    5.3    5.59s
 15   -73.84250689235      -12.37       -7.83    4.9    5.63s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.396246819971951e-8,-4.227258444201267e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.384251e+01     5.905833e-03
 * time: 249.96331191062927
┌ Warning: Negative ρcore detected: -3.144748845163636e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.82679999053                   -0.90    9.5    9.67s
  2   -73.83603385606       -2.03       -1.10    5.1    5.86s
  3   -73.84153634482       -2.26       -1.44    6.5    7.11s
  4   -73.84248392374       -3.02       -1.82    5.7    6.47s
  5   -73.84260452730       -3.92       -2.32    4.9    5.82s
  6   -73.84261905606       -4.84       -3.11    5.5    6.18s
  7   -73.84261906120       -8.29       -3.54    4.6    5.33s
  8   -73.84261909529       -7.47       -3.97    5.2    5.61s
  9   -73.84261909584       -9.25       -4.29    5.5    6.38s
 10   -73.84261909856       -8.57       -4.84    5.5    7.14s
 11   -73.84261909859      -10.59       -5.31    4.7    6.79s
 12   -73.84261909860      -10.78       -6.01    5.0    6.43s
 13   -73.84261909860      -12.07       -6.46    5.3    7.76s
 14   -73.84261909860      -12.89       -6.83    4.6    6.97s
 15   -73.84261909860   +  -13.85       -7.84    5.1    7.67s
┌ Warning: Negative ρcore detected: -3.144748845163636e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.82678551971                   -0.90    9.5    9.19s
  2   -73.83602374831       -2.03       -1.09    5.1    5.72s
  3   -73.84154041218       -2.26       -1.44    6.5    8.19s
  4   -73.84248316882       -3.03       -1.82    5.8    6.73s
  5   -73.84260405718       -3.92       -2.31    4.9    6.28s
  6   -73.84261905278       -4.82       -3.11    5.5    6.65s
  7   -73.84261906319       -7.98       -3.54    4.6    5.34s
  8   -73.84261909568       -7.49       -3.97    5.2    6.17s
  9   -73.84261909601       -9.48       -4.30    5.5    6.51s
 10   -73.84261909856       -8.59       -4.84    5.5    5.92s
 11   -73.84261909859      -10.56       -5.33    4.8    5.52s
 12   -73.84261909860      -10.82       -6.04    4.9    5.65s
 13   -73.84261909860      -12.17       -6.40    5.2    5.96s
 14   -73.84261909860      -12.77       -6.84    4.8    6.08s
 15   -73.84261909860   +  -13.37       -7.84    5.1    6.26s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.144748845163636e-8,-1.77592462492697e-9)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.384262e+01     2.143953e-04
 * time: 510.60301208496094
┌ Warning: Negative ρcore detected: -3.144612096152535e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.82676706165                   -0.90    9.9    11.0s
  2   -73.83602735947       -2.03       -1.10    5.3    6.11s
  3   -73.84153506629       -2.26       -1.44    6.8    8.78s
  4   -73.84248357715       -3.02       -1.82    5.8    5.89s
  5   -73.84260402609       -3.92       -2.31    5.0    5.66s
  6   -73.84261919194       -4.82       -3.11    5.5    6.15s
  7   -73.84261920432       -7.91       -3.54    4.5    5.75s
  8   -73.84261923812       -7.47       -3.97    5.3    5.91s
  9   -73.84261923817      -10.30       -4.30    5.6    5.98s
 10   -73.84261924082       -8.58       -4.85    5.5    6.71s
 11   -73.84261924085      -10.64       -5.34    4.7    5.94s
 12   -73.84261924086      -10.85       -6.06    5.0    5.78s
 13   -73.84261924086      -12.10       -6.40    5.3    7.40s
 14   -73.84261924086   +  -13.85       -6.86    4.7    6.51s
 15   -73.84261924086   +  -13.55       -7.86    5.1    6.65s
┌ Warning: Negative ρcore detected: -3.144612096152535e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.82677717099                   -0.90    9.9    10.3s
  2   -73.83602054049       -2.03       -1.09    5.3    5.86s
  3   -73.84153561529       -2.26       -1.44    6.7    8.13s
  4   -73.84248366951       -3.02       -1.82    5.8    6.14s
  5   -73.84260401604       -3.92       -2.31    5.0    6.24s
  6   -73.84261919424       -4.82       -3.11    5.6    6.53s
  7   -73.84261920565       -7.94       -3.54    4.5    5.50s
  8   -73.84261923797       -7.49       -3.98    5.3    6.19s
  9   -73.84261923823       -9.59       -4.30    5.6    6.46s
 10   -73.84261924083       -8.59       -4.84    5.5    6.75s
 11   -73.84261924085      -10.71       -5.32    4.5    5.45s
 12   -73.84261924086      -10.79       -6.05    5.0    5.87s
 13   -73.84261924086      -12.18       -6.38    5.3    6.21s
 14   -73.84261924086      -13.07       -6.86    4.8    5.39s
 15   -73.84261924086   +  -13.15       -7.82    5.2    5.75s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.144612096152535e-8,3.766804332745236e-9)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.384262e+01     6.095285e-06
 * time: 771.0815138816833
┌ Warning: Negative ρcore detected: -3.144626003793506e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.82678200454                   -0.90    9.5    10.3s
  2   -73.83602292726       -2.03       -1.09    5.0    6.13s
  3   -73.84153473055       -2.26       -1.44    6.5    7.26s
  4   -73.84248362756       -3.02       -1.82    5.7    6.46s
  5   -73.84260387651       -3.92       -2.31    4.8    5.67s
  6   -73.84261919140       -4.81       -3.11    5.5    6.15s
  7   -73.84261920533       -7.86       -3.53    4.2    5.16s
  8   -73.84261923813       -7.48       -3.97    5.2    6.54s
  9   -73.84261923832       -9.71       -4.30    5.5    6.60s
 10   -73.84261924093       -8.58       -4.83    5.4    6.55s
 11   -73.84261924096      -10.53       -5.34    4.9    5.98s
 12   -73.84261924098      -10.84       -6.05    4.9    6.10s
 13   -73.84261924098      -12.15       -6.38    5.3    6.01s
 14   -73.84261924098      -13.55       -6.85    4.8    5.41s
 15   -73.84261924098   +    -Inf       -7.84    5.0    5.94s
┌ Warning: Negative ρcore detected: -3.144626003793506e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.82678318488                   -0.90    9.5    9.79s
  2   -73.83602768445       -2.03       -1.09    5.1    6.82s
  3   -73.84153440888       -2.26       -1.44    6.5    8.63s
  4   -73.84248318596       -3.02       -1.82    5.7    7.02s
  5   -73.84260393955       -3.92       -2.31    4.8    5.78s
  6   -73.84261919222       -4.82       -3.11    5.5    6.10s
  7   -73.84261920411       -7.93       -3.53    4.3    5.14s
  8   -73.84261923798       -7.47       -3.97    5.2    5.61s
  9   -73.84261923827       -9.55       -4.30    5.5    5.87s
 10   -73.84261924093       -8.57       -4.83    5.5    5.92s
 11   -73.84261924096      -10.52       -5.33    4.8    5.70s
 12   -73.84261924098      -10.83       -6.03    4.9    5.59s
 13   -73.84261924098      -12.16       -6.37    5.3    6.23s
 14   -73.84261924098      -13.00       -6.85    4.8    5.48s
 15   -73.84261924098      -13.55       -7.85    5.1    5.84s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.144626003793506e-8,3.6144058102338103e-9)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     4    -7.384262e+01     6.504603e-09
 * time: 1026.4129769802094
 * Status: success

 * Candidate solution
    Final objective value:     -7.384262e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.78e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 6.68e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.16e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.57e-12 ≰ 0.0e+00
    |g(x)|                 = 6.50e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   1026  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

V: 1163.951771 seconds (757.26 M allocations: 365.129 GiB, 5.95% gc time, 0.01% compilation time)
