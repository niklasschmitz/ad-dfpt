┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-12T19:13:18.862
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.468614313779                   -0.96    7.0    11.4s
  2   -8.470199829056       -2.80       -1.72    1.8    5.04s
  3   -8.470284868430       -4.07       -2.73    3.8    1.95s
  4   -8.470287780693       -5.54       -3.60    4.7    1.98s
  5   -8.470287895339       -6.94       -4.36    5.0    2.45s
  6   -8.470287899890       -8.34       -5.29    5.1    2.12s
  7   -8.470287899940      -10.31       -6.09    4.6    1.86s
  8   -8.470287899940      -12.29       -7.07    4.2    1.90s
Iter     Function value   Gradient norm 
     0    -8.470288e+00     1.276041e-03
 * time: 4.1961669921875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.468635586916                   -0.96    7.4    2.66s
  2   -8.470206358905       -2.80       -1.72    2.0    1.42s
  3   -8.470286397921       -4.10       -2.73    3.9    1.65s
  4   -8.470289354903       -5.53       -3.59    4.9    2.12s
  5   -8.470289467942       -6.95       -4.40    5.3    1.87s
  6   -8.470289472158       -8.38       -5.34    5.3    2.17s
  7   -8.470289472196      -10.42       -6.31    4.9    2.33s
  8   -8.470289472196      -12.50       -7.08    4.8    2.46s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.468641416492                   -0.96    7.5    2.77s
  2   -8.470204064189       -2.81       -1.72    2.0    1.56s
  3   -8.470286286043       -4.09       -2.73    3.9    1.64s
  4   -8.470289353087       -5.51       -3.59    4.9    2.14s
  5   -8.470289467738       -6.94       -4.39    5.1    1.82s
  6   -8.470289472155       -8.35       -5.31    5.3    2.17s
  7   -8.470289472196      -10.39       -6.20    4.7    1.83s
  8   -8.470289472196      -12.36       -7.06    4.4    1.99s
     1    -8.470289e+00     1.188270e-03
 * time: 45.627378940582275
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.468660949361                   -0.96    7.2    2.56s
  2   -8.470210873359       -2.81       -1.72    2.1    1.14s
  3   -8.470296364051       -4.07       -2.74    3.9    1.92s
  4   -8.470299677351       -5.48       -3.59    4.8    2.13s
  5   -8.470299794237       -6.93       -4.42    5.0    1.96s
  6   -8.470299798349       -8.39       -5.37    5.3    2.23s
  7   -8.470299798388      -10.41       -6.31    5.0    1.92s
  8   -8.470299798388      -12.51       -7.10    4.8    2.24s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.468662102391                   -0.96    7.1    2.59s
  2   -8.470216023250       -2.81       -1.72    1.9    1.43s
  3   -8.470296634529       -4.09       -2.74    3.9    1.67s
  4   -8.470299680616       -5.52       -3.60    4.9    2.33s
  5   -8.470299794199       -6.94       -4.42    5.0    1.84s
  6   -8.470299798347       -8.38       -5.35    5.3    2.18s
  7   -8.470299798388      -10.39       -6.42    4.8    1.87s
  8   -8.470299798388      -12.62       -7.18    4.7    2.33s
     2    -8.470300e+00     1.050280e-05
 * time: 90.79880595207214
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.468660454834                   -0.96    7.1    2.60s
  2   -8.470211554979       -2.81       -1.72    1.9    1.14s
  3   -8.470296488780       -4.07       -2.74    3.9    1.93s
  4   -8.470299675139       -5.50       -3.59    4.8    2.11s
  5   -8.470299795096       -6.92       -4.44    5.1    1.84s
  6   -8.470299799165       -8.39       -5.38    5.2    2.19s
  7   -8.470299799201      -10.44       -6.35    4.9    1.86s
  8   -8.470299799202      -12.54       -7.15    4.3    2.00s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.468655735262                   -0.96    7.0    2.53s
  2   -8.470211616532       -2.81       -1.72    2.0    1.41s
  3   -8.470296432109       -4.07       -2.73    3.9    1.66s
  4   -8.470299678430       -5.49       -3.60    4.8    2.17s
  5   -8.470299794887       -6.93       -4.38    5.1    1.90s
  6   -8.470299799159       -8.37       -5.33    5.2    2.20s
  7   -8.470299799201      -10.37       -6.19    4.6    1.84s
  8   -8.470299799202      -12.40       -7.04    4.4    2.00s
     3    -8.470300e+00     8.718074e-08
 * time: 134.5061550140381
 * Status: success

 * Candidate solution
    Final objective value:     -8.470300e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.54e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.49e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 8.14e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 9.61e-11 ≰ 0.0e+00
    |g(x)|                 = 8.72e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   135  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 211.548066 seconds (310.68 M allocations: 60.765 GiB, 7.55% gc time, 25.19% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-12T19:16:51.103
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.32564329540                   -1.10    8.5    19.9s
  2   -62.33185960580       -2.21       -1.20    2.7    7.43s
  3   -62.33613843598       -2.37       -2.02    3.7    8.44s
  4   -62.33618909500       -4.30       -2.90    3.1    8.69s
  5   -62.33618989713       -6.10       -3.62    4.1    10.3s
  6   -62.33619005913       -6.79       -4.09    3.5    10.4s
  7   -62.33619006444       -8.28       -4.75    3.7    10.9s
  8   -62.33619006467       -9.63       -6.02    3.9    11.7s
  9   -62.33619006467      -11.58       -7.04    4.6    11.8s
Iter     Function value   Gradient norm 
     0    -6.233619e+01     6.584417e-03
 * time: 3.790855407714844e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.32565963422                   -1.10    8.2    17.5s
  2   -62.33185958327       -2.21       -1.20    2.7    7.05s
  3   -62.33618182612       -2.36       -2.02    3.8    8.97s
  4   -62.33623203080       -4.30       -2.94    3.0    9.20s
  5   -62.33623281699       -6.10       -3.65    4.2    11.2s
  6   -62.33623294410       -6.90       -4.15    3.3    11.1s
  7   -62.33623294850       -8.36       -4.65    3.8    12.2s
  8   -62.33623294877       -9.57       -5.68    3.5    10.9s
  9   -62.33623294877      -11.36       -6.80    4.2    10.8s
 10   -62.33623294877   +    -Inf       -7.60    4.2    11.9s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.32565799389                   -1.10    8.2    16.3s
  2   -62.33187799620       -2.21       -1.20    2.7    7.91s
  3   -62.33618135848       -2.37       -2.02    3.8    9.19s
  4   -62.33623200776       -4.30       -2.91    2.8    7.65s
  5   -62.33623278824       -6.11       -3.64    4.0    10.1s
  6   -62.33623294369       -6.81       -4.12    3.6    10.8s
  7   -62.33623294853       -8.32       -4.72    3.6    10.2s
  8   -62.33623294877       -9.61       -6.05    3.7    10.3s
  9   -62.33623294877      -11.42       -6.66    4.6    14.0s
 10   -62.33623294877      -13.00       -7.83    3.8    10.0s
     1    -6.233623e+01     6.441617e-03
 * time: 249.53378891944885
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.32534562176                   -1.09    9.2    20.8s
  2   -62.33180465223       -2.19       -1.17    2.9    8.38s
  3   -62.33720509572       -2.27       -1.98    3.8    10.3s
  4   -62.33727130573       -4.18       -2.91    2.8    8.34s
  5   -62.33727211108       -6.09       -3.62    4.1    11.8s
  6   -62.33727228977       -6.75       -4.12    3.7    10.3s
  7   -62.33727229492       -8.29       -4.72    3.7    10.9s
  8   -62.33727229518       -9.58       -5.99    3.7    10.9s
  9   -62.33727229519      -11.32       -6.77    4.5    13.6s
 10   -62.33727229519      -13.45       -7.76    3.8    10.8s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.32534755642                   -1.09    9.2    20.5s
  2   -62.33180494527       -2.19       -1.17    3.0    8.75s
  3   -62.33720588128       -2.27       -1.98    3.8    10.0s
  4   -62.33727133256       -4.18       -2.90    2.9    8.52s
  5   -62.33727210936       -6.11       -3.62    4.2    12.0s
  6   -62.33727228949       -6.74       -4.11    3.3    9.45s
  7   -62.33727229495       -8.26       -4.75    3.5    11.2s
  8   -62.33727229518       -9.62       -6.03    3.7    10.9s
  9   -62.33727229519      -11.45       -6.85    4.5    13.8s
 10   -62.33727229519      -13.67       -7.91    3.8    10.9s
     2    -6.233727e+01     8.278884e-04
 * time: 519.5715789794922
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.32514591746                   -1.09    8.8    19.0s
  2   -62.33165195250       -2.19       -1.16    2.6    7.78s
  3   -62.33722381363       -2.25       -1.97    3.6    9.56s
  4   -62.33729198207       -4.17       -2.91    2.7    8.78s
  5   -62.33729285555       -6.06       -3.62    4.0    11.7s
  6   -62.33729303578       -6.74       -4.14    3.4    10.4s
  7   -62.33729304085       -8.29       -4.72    3.5    10.5s
  8   -62.33729304112       -9.57       -6.05    3.5    10.0s
  9   -62.33729304113      -11.20       -6.48    4.5    13.5s
 10   -62.33729304113   +  -13.67       -7.44    3.4    10.2s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.32514692871                   -1.09    8.7    18.9s
  2   -62.33163353446       -2.19       -1.16    2.8    7.76s
  3   -62.33722332213       -2.25       -1.97    3.8    9.81s
  4   -62.33729199886       -4.16       -2.91    2.8    9.85s
  5   -62.33729285077       -6.07       -3.61    4.0    12.8s
  6   -62.33729303585       -6.73       -4.11    3.5    9.76s
  7   -62.33729304083       -8.30       -4.67    3.5    10.2s
  8   -62.33729304112       -9.53       -6.08    3.5    10.1s
  9   -62.33729304113      -11.22       -6.49    4.6    12.6s
 10   -62.33729304113   +  -13.85       -7.59    3.2    10.4s
     3    -6.233729e+01     1.241219e-04
 * time: 780.2706689834595
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.32510804317                   -1.09    8.8    20.6s
  2   -62.33159883774       -2.19       -1.16    2.7    8.53s
  3   -62.33722491230       -2.25       -1.97    3.7    10.7s
  4   -62.33729251163       -4.17       -2.93    2.7    8.34s
  5   -62.33729335711       -6.07       -3.64    4.0    11.1s
  6   -62.33729352633       -6.77       -4.17    3.4    9.78s
  7   -62.33729353131       -8.30       -4.73    3.8    10.6s
  8   -62.33729353156       -9.61       -5.92    3.6    10.8s
  9   -62.33729353156      -11.22       -6.52    4.3    12.0s
 10   -62.33729353156      -13.85       -7.40    3.8    11.1s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.32510850058                   -1.09    8.8    18.9s
  2   -62.33162198381       -2.19       -1.16    2.8    7.77s
  3   -62.33722396426       -2.25       -1.97    3.9    9.86s
  4   -62.33729250728       -4.16       -2.89    2.7    8.22s
  5   -62.33729332329       -6.09       -3.57    4.0    11.4s
  6   -62.33729352567       -6.69       -4.08    3.6    10.0s
  7   -62.33729353127       -8.25       -4.71    3.6    10.5s
  8   -62.33729353156       -9.53       -5.96    3.6    10.2s
  9   -62.33729353156      -11.16       -6.64    4.5    12.6s
 10   -62.33729353156      -13.85       -7.64    3.7    10.5s
     4    -6.233729e+01     2.964226e-06
 * time: 1039.2662398815155
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.32510775168                   -1.09    8.5    18.5s
  2   -62.33161064845       -2.19       -1.16    2.8    7.70s
  3   -62.33722431316       -2.25       -1.97    3.6    10.0s
  4   -62.33729255738       -4.17       -2.90    2.9    8.46s
  5   -62.33729333856       -6.11       -3.61    4.0    11.3s
  6   -62.33729352611       -6.73       -4.14    3.5    10.3s
  7   -62.33729353162       -8.26       -4.81    3.5    10.5s
  8   -62.33729353184       -9.66       -6.03    3.8    10.7s
  9   -62.33729353185      -11.40       -6.84    4.4    12.4s
 10   -62.33729353185   +  -13.45       -7.87    3.7    10.2s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.32510635422                   -1.09    8.5    19.8s
  2   -62.33158270059       -2.19       -1.16    2.8    8.16s
  3   -62.33722527606       -2.25       -1.98    3.7    10.5s
  4   -62.33729255340       -4.17       -2.93    2.9    9.04s
  5   -62.33729336572       -6.09       -3.65    4.0    11.4s
  6   -62.33729352667       -6.79       -4.17    3.4    9.18s
  7   -62.33729353159       -8.31       -4.68    3.7    10.6s
  8   -62.33729353184       -9.60       -5.79    3.5    10.0s
  9   -62.33729353185      -11.20       -6.54    4.2    11.7s
 10   -62.33729353185      -13.11       -7.24    4.0    11.1s
     5    -6.233729e+01     7.717553e-09
 * time: 1295.074189901352
 * Status: success

 * Candidate solution
    Final objective value:     -6.233729e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.89e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.70e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.83e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 4.54e-12 ≰ 0.0e+00
    |g(x)|                 = 7.72e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   1295  (vs limit Inf)
    Iterations:    5
    f(x) calls:    6
    ∇f(x) calls:   6

NaCl: 1420.195889 seconds (1.41 G allocations: 399.581 GiB, 5.39% gc time, 0.23% compilation time)
┌ Info: 2025-05-12T19:40:31.331
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318114971801                   -1.47    5.5    1.81s
  2   -2.318183490741       -4.16       -1.84    1.3    781ms
  3   -2.318198856336       -4.81       -3.56    3.1    1.27s
  4   -2.318199041489       -6.73       -4.00    4.6    1.97s
  5   -2.318199042041       -9.26       -4.25    2.3    1.01s
  6   -2.318199042222       -9.74       -4.99    2.6    1.41s
  7   -2.318199042229      -11.17       -5.70    2.7    1.10s
  8   -2.318199042229      -12.51       -6.44    2.6    1.40s
  9   -2.318199042229      -13.92       -6.68    3.1    1.20s
 10   -2.318199042229   +  -15.05       -7.51    1.7    839ms
Iter     Function value   Gradient norm 
     0    -2.318199e+00     1.487045e-04
 * time: 3.2901763916015625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318113743062                   -1.47    5.8    2.14s
  2   -2.318183572859       -4.16       -1.84    1.5    781ms
  3   -2.318198907649       -4.81       -3.56    3.2    1.54s
  4   -2.318199063160       -6.81       -4.01    4.6    1.65s
  5   -2.318199063698       -9.27       -4.25    2.4    1.32s
  6   -2.318199063883       -9.73       -4.98    2.6    1.05s
  7   -2.318199063890      -11.11       -5.69    2.7    1.11s
  8   -2.318199063891      -12.42       -6.38    2.9    1.46s
  9   -2.318199063891      -13.85       -6.77    2.8    1.16s
 10   -2.318199063891   +  -15.35       -7.56    2.2    1.32s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318116249772                   -1.47    5.8    2.13s
  2   -2.318184534391       -4.17       -1.84    1.5    808ms
  3   -2.318198893030       -4.84       -3.57    3.3    1.58s
  4   -2.318199063186       -6.77       -4.03    4.6    1.66s
  5   -2.318199063698       -9.29       -4.26    2.4    1.31s
  6   -2.318199063885       -9.73       -4.99    2.7    1.07s
  7   -2.318199063890      -11.24       -5.63    2.6    1.37s
  8   -2.318199063891      -12.38       -6.29    2.8    1.12s
  9   -2.318199063891      -14.03       -6.64    2.4    1.05s
 10   -2.318199063891      -15.35       -7.56    2.1    1.15s
     1    -2.318199e+00     1.426415e-04
 * time: 56.6976158618927
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318117315485                   -1.47    5.5    2.06s
  2   -2.318184972985       -4.17       -1.84    1.3    745ms
  3   -2.318199121145       -4.85       -3.56    3.2    1.53s
  4   -2.318199312042       -6.72       -4.03    4.5    1.64s
  5   -2.318199312541       -9.30       -4.28    2.4    1.31s
  6   -2.318199312705       -9.79       -5.01    2.8    1.09s
  7   -2.318199312711      -11.20       -5.74    2.7    1.42s
  8   -2.318199312712      -12.58       -6.49    2.9    1.16s
  9   -2.318199312712      -14.15       -6.77    2.9    1.44s
 10   -2.318199312712      -15.05       -7.50    1.9    869ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318119861190                   -1.47    5.6    2.09s
  2   -2.318184845147       -4.19       -1.84    1.3    760ms
  3   -2.318199118018       -4.85       -3.56    3.2    1.60s
  4   -2.318199312012       -6.71       -4.02    4.5    1.63s
  5   -2.318199312533       -9.28       -4.26    2.4    1.29s
  6   -2.318199312705       -9.76       -4.99    2.7    1.09s
  7   -2.318199312711      -11.16       -5.74    2.8    1.41s
  8   -2.318199312712      -12.54       -6.50    2.9    1.15s
  9   -2.318199312712      -14.15       -6.77    3.2    1.51s
 10   -2.318199312712      -15.05       -7.46    1.9    859ms
     2    -2.318199e+00     5.851754e-07
 * time: 113.3961980342865
 * Status: success

 * Candidate solution
    Final objective value:     -2.318199e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.50e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.58e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.49e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.07e-07 ≰ 0.0e+00
    |g(x)|                 = 5.85e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   113  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Al: 146.558733 seconds (121.43 M allocations: 29.012 GiB, 6.48% gc time, 0.00% compilation time)
┌ Info: 2025-05-12T19:42:57.890
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.83476560283                   -0.92    9.5    9.49s
  2   -73.84293261589       -2.09       -1.12    5.2    5.31s
  3   -73.84809607856       -2.29       -1.49    6.6    6.86s
  4   -73.84881648343       -3.14       -1.82    5.5    5.75s
  5   -73.84894257629       -3.90       -2.22    4.9    5.60s
  6   -73.84896484460       -4.65       -3.06    5.4    6.22s
  7   -73.84896488114       -7.44       -3.47    5.3    5.96s
  8   -73.84896488445       -8.48       -4.04    3.0    4.18s
  9   -73.84896488479       -9.46       -4.43    4.8    5.96s
 10   -73.84896488481      -10.65       -4.82    2.9    3.93s
 11   -73.84896488483      -10.73       -5.49    4.4    5.13s
 12   -73.84896488483      -11.73       -6.15    4.5    5.81s
 13   -73.84896488483   +  -13.85       -6.60    5.0    5.66s
 14   -73.84896488483   +  -13.07       -6.80    5.2    5.62s
 15   -73.84896488483   +  -12.64       -7.81    5.0    5.35s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.384896e+01     2.580450e-03
 * time: 2.9087066650390625e-5
┌ Warning: Negative ρcore detected: -3.4170081737860145e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.83471996958                   -0.92    9.7    9.83s
  2   -73.84293169916       -2.09       -1.12    5.3    6.21s
  3   -73.84810285337       -2.29       -1.49    6.7    7.44s
  4   -73.84882149742       -3.14       -1.82    5.6    6.38s
  5   -73.84894823282       -3.90       -2.22    4.9    5.77s
  6   -73.84897100079       -4.64       -3.06    5.5    6.45s
  7   -73.84897103288       -7.49       -3.46    5.3    6.15s
  8   -73.84897103660       -8.43       -4.03    3.4    4.46s
  9   -73.84897103688       -9.55       -4.43    4.1    5.05s
 10   -73.84897103689      -11.07       -4.83    2.5    3.77s
 11   -73.84897103691      -10.76       -5.50    4.6    5.15s
 12   -73.84897103691      -11.70       -6.18    4.6    5.53s
 13   -73.84897103691   +  -13.00       -6.62    5.1    5.77s
 14   -73.84897103691      -13.85       -6.82    5.4    5.79s
 15   -73.84897103691   +  -12.81       -7.78    5.1    5.42s
┌ Warning: Negative ρcore detected: -3.4170081737860145e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.83472667313                   -0.92    9.6    10.4s
  2   -73.84293953875       -2.09       -1.12    5.2    6.17s
  3   -73.84809917230       -2.29       -1.49    6.7    7.31s
  4   -73.84882260597       -3.14       -1.82    5.6    5.95s
  5   -73.84894859676       -3.90       -2.22    5.1    5.71s
  6   -73.84897099779       -4.65       -3.06    5.4    6.23s
  7   -73.84897103322       -7.45       -3.47    5.3    6.09s
  8   -73.84897103661       -8.47       -4.06    3.2    4.79s
  9   -73.84897103686       -9.60       -4.41    4.5    5.66s
 10   -73.84897103689      -10.63       -4.83    2.5    3.91s
 11   -73.84897103691      -10.74       -5.51    4.5    5.52s
 12   -73.84897103691      -11.75       -6.20    4.5    5.90s
 13   -73.84897103691   +  -13.07       -6.64    5.1    6.05s
 14   -73.84897103691   +  -13.37       -6.81    5.3    6.17s
 15   -73.84897103691   +  -12.77       -7.70    5.1    6.54s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4170081737860145e-8,-1.7230586072795124e-9)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.384897e+01     2.187721e-03
 * time: 245.054368019104
┌ Warning: Negative ρcore detected: -3.378638222592928e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.83449666680                   -0.92    9.5    10.2s
  2   -73.84287826382       -2.08       -1.12    5.2    5.42s
  3   -73.84811291061       -2.28       -1.49    6.7    7.01s
  4   -73.84883736659       -3.14       -1.82    5.6    5.81s
  5   -73.84896363144       -3.90       -2.21    4.9    6.35s
  6   -73.84898685496       -4.63       -3.08    5.4    7.62s
  7   -73.84898688344       -7.55       -3.47    5.2    7.11s
  8   -73.84898688736       -8.41       -4.04    3.4    4.81s
  9   -73.84898688767       -9.50       -4.52    4.1    5.12s
 10   -73.84898688768      -11.22       -4.89    3.3    4.41s
 11   -73.84898688769      -10.91       -5.62    4.7    5.34s
 12   -73.84898688769      -12.08       -6.45    4.9    5.63s
 13   -73.84898688769   +  -13.15       -6.85    5.3    5.96s
 14   -73.84898688769   +  -13.15       -7.08    5.2    5.70s
┌ Warning: Negative ρcore detected: -3.378638222592928e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.83449842704                   -0.92    9.6    9.67s
  2   -73.84288311835       -2.08       -1.12    5.1    5.52s
  3   -73.84811167305       -2.28       -1.49    6.7    7.03s
  4   -73.84883749626       -3.14       -1.82    5.4    5.76s
  5   -73.84896393240       -3.90       -2.22    4.9    5.56s
  6   -73.84898685635       -4.64       -3.08    5.5    6.28s
  7   -73.84898688304       -7.57       -3.47    5.0    5.77s
  8   -73.84898688737       -8.36       -4.05    3.8    4.81s
  9   -73.84898688767       -9.51       -4.49    4.2    5.14s
 10   -73.84898688768      -11.38       -4.87    3.0    4.10s
 11   -73.84898688769      -10.92       -5.61    4.6    5.25s
 12   -73.84898688769      -11.97       -6.43    4.8    5.73s
 13   -73.84898688769      -13.07       -6.85    5.3    6.09s
 14   -73.84898688769   +  -12.73       -7.08    5.3    5.81s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.378638222592928e-8,5.403668665429577e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.384899e+01     2.395604e-05
 * time: 477.3257110118866
┌ Warning: Negative ρcore detected: -3.377773631444659e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.83449436566                   -0.92    9.7    10.7s
  2   -73.84288870850       -2.08       -1.12    5.2    5.51s
  3   -73.84811082917       -2.28       -1.49    6.8    7.17s
  4   -73.84883786035       -3.14       -1.82    5.6    5.74s
  5   -73.84896358480       -3.90       -2.21    4.9    5.52s
  6   -73.84898686053       -4.63       -3.08    5.4    6.62s
  7   -73.84898688514       -7.61       -3.47    5.1    6.00s
  8   -73.84898688930       -8.38       -4.02    3.7    4.68s
  9   -73.84898688963       -9.48       -4.50    4.2    5.01s
 10   -73.84898688963      -11.39       -4.86    3.2    4.25s
 11   -73.84898688965      -10.90       -5.62    4.7    5.47s
 12   -73.84898688965      -12.08       -6.43    4.8    6.12s
 13   -73.84898688965      -13.37       -6.84    5.3    5.92s
 14   -73.84898688965   +  -13.85       -7.08    5.3    5.71s
┌ Warning: Negative ρcore detected: -3.377773631444659e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.83450021122                   -0.92    9.8    10.3s
  2   -73.84289835359       -2.08       -1.12    5.3    5.69s
  3   -73.84810874673       -2.28       -1.49    6.7    6.92s
  4   -73.84883821797       -3.14       -1.82    5.6    5.80s
  5   -73.84896364844       -3.90       -2.22    5.0    5.49s
  6   -73.84898686068       -4.63       -3.08    5.5    6.24s
  7   -73.84898688501       -7.61       -3.46    5.0    5.79s
  8   -73.84898688926       -8.37       -4.02    3.8    4.90s
  9   -73.84898688963       -9.44       -4.50    4.5    5.24s
 10   -73.84898688963      -11.38       -4.84    3.4    4.39s
 11   -73.84898688965      -10.86       -5.63    4.7    5.29s
 12   -73.84898688965      -12.11       -6.41    4.8    5.58s
 13   -73.84898688965   +  -13.85       -6.86    5.2    5.86s
 14   -73.84898688965      -13.00       -7.09    5.3    5.79s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.377773631444659e-8,5.461800467282626e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.384899e+01     2.204322e-07
 * time: 708.9407699108124
 * Status: success

 * Candidate solution
    Final objective value:     -7.384899e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.59e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.78e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.95e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.65e-11 ≰ 0.0e+00
    |g(x)|                 = 2.20e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   709  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

V: 838.102459 seconds (569.22 M allocations: 268.074 GiB, 6.19% gc time, 0.01% compilation time)
