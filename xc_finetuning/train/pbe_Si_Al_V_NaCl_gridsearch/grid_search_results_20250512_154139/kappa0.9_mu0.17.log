┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-12T17:03:48.300
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441177398983                   -0.96    7.0    12.4s
  2   -8.442955862155       -2.75       -1.77    1.9    5.37s
  3   -8.443028191036       -4.14       -2.80    3.9    1.74s
  4   -8.443029489716       -5.89       -3.71    4.4    2.09s
  5   -8.443029518673       -7.54       -4.43    4.7    1.79s
  6   -8.443029519924       -8.90       -5.39    4.7    2.00s
  7   -8.443029519937      -10.88       -6.20    4.3    1.77s
  8   -8.443029519938      -12.78       -7.28    3.7    1.96s
Iter     Function value   Gradient norm 
     0    -8.443030e+00     3.382241e-03
 * time: 4.601478576660156e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441185065738                   -0.96    7.2    2.78s
  2   -8.442966674463       -2.75       -1.77    2.2    1.70s
  3   -8.443039370877       -4.14       -2.80    3.8    1.71s
  4   -8.443040538012       -5.93       -3.72    4.6    2.65s
  5   -8.443040565486       -7.56       -4.42    4.7    2.06s
  6   -8.443040566685       -8.92       -5.38    4.8    2.32s
  7   -8.443040566698      -10.88       -6.19    4.3    1.83s
  8   -8.443040566699      -12.81       -7.32    3.6    2.00s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441182709817                   -0.96    7.2    2.62s
  2   -8.442971067989       -2.75       -1.77    2.1    1.43s
  3   -8.443039283033       -4.17       -2.80    3.9    2.41s
  4   -8.443040538348       -5.90       -3.71    4.7    2.22s
  5   -8.443040565601       -7.56       -4.46    4.6    1.74s
  6   -8.443040566689       -8.96       -5.43    5.0    2.07s
  7   -8.443040566698      -11.00       -6.21    4.4    1.80s
  8   -8.443040566699      -12.86       -7.30    3.8    1.90s
     1    -8.443041e+00     3.149847e-03
 * time: 45.823140144348145
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441187576998                   -0.96    6.9    2.80s
  2   -8.443044807301       -2.73       -1.77    2.1    1.76s
  3   -8.443110334476       -4.18       -2.81    3.8    1.69s
  4   -8.443111544682       -5.92       -3.69    4.5    2.06s
  5   -8.443111576021       -7.50       -4.53    4.7    1.77s
  6   -8.443111576898       -9.06       -5.44    5.0    2.08s
  7   -8.443111576904      -11.23       -6.31    3.7    1.65s
  8   -8.443111576904      -13.00       -7.28    3.8    1.92s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441182507686                   -0.96    7.0    2.62s
  2   -8.443036256818       -2.73       -1.77    2.0    1.20s
  3   -8.443110302126       -4.13       -2.81    3.9    1.98s
  4   -8.443111544637       -5.91       -3.71    4.5    2.14s
  5   -8.443111575817       -7.51       -4.46    4.7    1.76s
  6   -8.443111576893       -8.97       -5.32    4.9    2.00s
  7   -8.443111576904      -10.96       -6.25    3.9    1.66s
  8   -8.443111576904      -12.82       -7.29    3.8    1.91s
     2    -8.443112e+00     7.536727e-05
 * time: 88.8523371219635
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441177950666                   -0.96    7.1    2.57s
  2   -8.443035796137       -2.73       -1.77    1.9    1.11s
  3   -8.443110300203       -4.13       -2.81    3.9    1.99s
  4   -8.443111583176       -5.89       -3.69    4.6    1.81s
  5   -8.443111615339       -7.49       -4.48    4.7    2.06s
  6   -8.443111616390       -8.98       -5.38    4.8    1.82s
  7   -8.443111616398      -11.10       -6.28    3.9    1.97s
  8   -8.443111616398      -12.88       -7.29    3.8    1.67s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441176893638                   -0.96    6.9    2.69s
  2   -8.443037083673       -2.73       -1.77    2.0    1.29s
  3   -8.443110359295       -4.14       -2.80    3.8    2.00s
  4   -8.443111582722       -5.91       -3.70    4.7    1.96s
  5   -8.443111615291       -7.49       -4.45    4.7    2.12s
  6   -8.443111616386       -8.96       -5.29    4.9    1.79s
  7   -8.443111616398      -10.91       -6.20    3.7    1.84s
  8   -8.443111616398      -12.78       -7.26    3.8    1.59s
     3    -8.443112e+00     1.617990e-06
 * time: 131.84363913536072
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441185558047                   -0.96    7.0    2.59s
  2   -8.443036502692       -2.73       -1.77    1.9    1.12s
  3   -8.443110338607       -4.13       -2.80    3.8    1.92s
  4   -8.443111584105       -5.90       -3.70    4.5    1.77s
  5   -8.443111615325       -7.51       -4.45    4.7    2.00s
  6   -8.443111616405       -8.97       -5.30    4.9    1.72s
  7   -8.443111616417      -10.93       -6.20    3.7    1.92s
  8   -8.443111616417      -12.76       -7.26    3.6    1.54s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.441177865773                   -0.96    7.0    2.54s
  2   -8.443039260696       -2.73       -1.77    2.0    1.15s
  3   -8.443110367505       -4.15       -2.80    3.8    1.95s
  4   -8.443111584346       -5.91       -3.70    4.6    1.79s
  5   -8.443111615377       -7.51       -4.47    4.7    1.99s
  6   -8.443111616406       -8.99       -5.34    5.0    1.78s
  7   -8.443111616417      -10.99       -6.26    3.8    1.92s
  8   -8.443111616417      -12.86       -7.28    3.7    1.62s
     4    -8.443112e+00     5.859119e-11
 * time: 174.11066198349
 * Status: success

 * Candidate solution
    Final objective value:     -8.443112e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.25e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.19e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.83e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.17e-12 ≰ 0.0e+00
    |g(x)|                 = 5.86e-11 ≤ 1.0e-06

 * Work counters
    Seconds run:   174  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

Si: 251.846609 seconds (368.69 M allocations: 74.309 GiB, 7.75% gc time, 21.78% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-12T17:08:00.847
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.12199526342                   -1.16    8.4    23.9s
  2   -62.12635166617       -2.36       -1.23    2.5    8.38s
  3   -62.13022055180       -2.41       -2.07    3.8    10.2s
  4   -62.13025359664       -4.48       -2.84    3.4    9.62s
  5   -62.13025418262       -6.23       -3.47    3.9    11.1s
  6   -62.13025426262       -7.10       -4.24    3.6    10.1s
  7   -62.13025426347       -9.07       -4.82    4.0    11.0s
  8   -62.13025426353      -10.20       -6.32    3.8    11.9s
  9   -62.13025426353      -12.31       -7.09    4.5    12.8s
Iter     Function value   Gradient norm 
     0    -6.213025e+01     8.212230e-05
 * time: 3.314018249511719e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.12198871448                   -1.16    8.5    18.1s
  2   -62.12634858083       -2.36       -1.23    2.5    7.62s
  3   -62.13022123909       -2.41       -2.07    3.8    10.3s
  4   -62.13025361473       -4.49       -2.86    3.4    10.3s
  5   -62.13025419357       -6.24       -3.50    3.9    12.4s
  6   -62.13025426937       -7.12       -4.29    3.6    11.4s
  7   -62.13025427016       -9.10       -4.87    4.0    11.4s
  8   -62.13025427021      -10.28       -6.38    3.8    11.3s
  9   -62.13025427021      -12.39       -7.05    4.5    13.6s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.12199481767                   -1.16    8.3    18.1s
  2   -62.12635632454       -2.36       -1.23    2.4    7.92s
  3   -62.13022029184       -2.41       -2.07    3.8    10.3s
  4   -62.13025361136       -4.48       -2.85    3.5    10.1s
  5   -62.13025418927       -6.24       -3.48    3.9    11.8s
  6   -62.13025426928       -7.10       -4.26    3.5    10.1s
  7   -62.13025427015       -9.06       -4.85    4.0    11.3s
  8   -62.13025427021      -10.21       -6.24    3.8    12.2s
  9   -62.13025427021      -12.38       -7.08    4.3    13.3s
     1    -6.213025e+01     8.055102e-05
 * time: 247.02360916137695
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.12198343448                   -1.16    8.4    19.1s
  2   -62.12634767037       -2.36       -1.23    2.5    7.77s
  3   -62.13022081836       -2.41       -2.07    3.8    11.3s
  4   -62.13025376497       -4.48       -2.85    3.4    11.0s
  5   -62.13025436222       -6.22       -3.49    3.9    10.7s
  6   -62.13025443981       -7.11       -4.29    3.7    10.5s
  7   -62.13025444058       -9.12       -4.87    4.0    11.9s
  8   -62.13025444063      -10.26       -6.34    3.8    11.6s
  9   -62.13025444063      -12.46       -7.10    4.5    13.8s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.12197944156                   -1.16    8.5    19.7s
  2   -62.12635049276       -2.36       -1.23    2.5    7.67s
  3   -62.13022087951       -2.41       -2.06    3.9    10.3s
  4   -62.13025375930       -4.48       -2.84    3.5    10.2s
  5   -62.13025436100       -6.22       -3.48    3.8    11.1s
  6   -62.13025443979       -7.10       -4.27    3.7    10.4s
  7   -62.13025444058       -9.10       -4.91    3.9    11.3s
  8   -62.13025444063      -10.32       -6.26    3.9    10.8s
  9   -62.13025444063      -12.49       -7.10    4.5    12.6s
     2    -6.213025e+01     5.820341e-07
 * time: 497.5496141910553
 * Status: success

 * Candidate solution
    Final objective value:     -6.213025e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 4.21e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.92e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.70e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.74e-09 ≰ 0.0e+00
    |g(x)|                 = 5.82e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   498  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

NaCl: 634.507824 seconds (581.16 M allocations: 163.078 GiB, 4.90% gc time, 0.63% compilation time)
┌ Info: 2025-05-12T17:18:35.385
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314436348958                   -1.45    5.4    1.85s
  2   -2.314535525900       -4.00       -1.84    1.4    928ms
  3   -2.314559836597       -4.61       -3.56    3.3    1.76s
  4   -2.314560070680       -6.63       -4.15    4.6    1.71s
  5   -2.314560070918       -9.62       -4.71    2.5    1.45s
  6   -2.314560070933      -10.81       -5.63    2.7    1.16s
  7   -2.314560070934      -12.03       -6.05    3.1    1.44s
  8   -2.314560070934      -13.18       -6.75    2.6    1.79s
  9   -2.314560070934      -14.57       -7.31    2.7    1.13s
Iter     Function value   Gradient norm 
     0    -2.314560e+00     1.881240e-03
 * time: 3.409385681152344e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314436445822                   -1.45    5.4    2.17s
  2   -2.314538719403       -3.99       -1.84    1.4    797ms
  3   -2.314563267778       -4.61       -3.56    3.4    1.76s
  4   -2.314563538281       -6.57       -4.14    4.6    1.77s
  5   -2.314563538533       -9.60       -4.70    2.5    1.41s
  6   -2.314563538551      -10.73       -5.68    2.8    1.29s
  7   -2.314563538552      -12.05       -6.06    3.4    1.96s
  8   -2.314563538552      -13.19       -6.78    2.7    1.23s
  9   -2.314563538552      -14.88       -7.34    2.7    1.41s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314440968889                   -1.45    5.4    2.69s
  2   -2.314539062916       -4.01       -1.84    1.4    957ms
  3   -2.314563370773       -4.61       -3.55    3.4    1.67s
  4   -2.314563538294       -6.78       -4.16    4.5    1.66s
  5   -2.314563538533       -9.62       -4.72    2.6    1.55s
  6   -2.314563538551      -10.75       -5.70    2.7    1.14s
  7   -2.314563538552      -12.11       -6.09    3.2    1.57s
  8   -2.314563538552      -13.23       -6.76    2.5    1.08s
  9   -2.314563538552      -14.88       -7.25    2.7    1.37s
     1    -2.314564e+00     1.805305e-03
 * time: 58.53764200210571
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314484417547                   -1.45    5.5    1.83s
  2   -2.314580038668       -4.02       -1.83    1.4    1.09s
  3   -2.314603249317       -4.63       -3.54    3.4    1.33s
  4   -2.314603441606       -6.72       -4.20    4.5    2.01s
  5   -2.314603441794       -9.73       -4.82    2.6    1.13s
  6   -2.314603441802      -11.07       -5.51    2.8    1.27s
  7   -2.314603441804      -11.93       -6.24    2.9    1.46s
  8   -2.314603441804      -13.95       -6.72    2.7    1.11s
  9   -2.314603441804      -15.05       -7.58    2.3    1.34s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314486787716                   -1.45    5.5    2.22s
  2   -2.314580341610       -4.03       -1.83    1.4    812ms
  3   -2.314603256680       -4.64       -3.53    3.4    1.67s
  4   -2.314603441598       -6.73       -4.20    4.5    1.76s
  5   -2.314603441792       -9.71       -4.80    2.7    1.58s
  6   -2.314603441802      -10.98       -5.50    2.7    1.25s
  7   -2.314603441804      -11.90       -6.24    3.0    1.49s
  8   -2.314603441804      -13.85       -6.66    2.8    2.00s
  9   -2.314603441804   +  -15.35       -7.61    2.1    1.09s
     2    -2.314603e+00     5.431414e-05
 * time: 116.22368812561035
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314487506238                   -1.45    5.4    2.01s
  2   -2.314580155624       -4.03       -1.83    1.4    1.08s
  3   -2.314603255705       -4.64       -3.53    3.3    1.30s
  4   -2.314603474482       -6.66       -4.18    4.5    1.64s
  5   -2.314603474693       -9.68       -4.80    2.6    1.41s
  6   -2.314603474703      -11.02       -5.56    2.9    1.14s
  7   -2.314603474704      -11.99       -6.21    3.0    1.48s
  8   -2.314603474704      -13.89       -6.67    2.7    1.09s
  9   -2.314603474704      -14.75       -7.50    2.1    996ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314487758506                   -1.45    5.5    2.05s
  2   -2.314580135754       -4.03       -1.83    1.3    760ms
  3   -2.314603272808       -4.64       -3.52    3.4    1.57s
  4   -2.314603474491       -6.70       -4.19    4.5    1.62s
  5   -2.314603474694       -9.69       -4.81    2.6    1.36s
  6   -2.314603474703      -11.05       -5.55    2.8    1.10s
  7   -2.314603474704      -11.97       -6.23    3.0    1.22s
  8   -2.314603474704      -14.03       -6.75    2.5    1.27s
  9   -2.314603474704      -14.88       -7.54    2.3    996ms
     3    -2.314603e+00     3.881743e-06
 * time: 170.89407801628113
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314490369727                   -1.45    5.5    1.96s
  2   -2.314580550406       -4.04       -1.83    1.4    1.07s
  3   -2.314603263963       -4.64       -3.53    3.4    1.29s
  4   -2.314603474662       -6.68       -4.20    4.5    1.91s
  5   -2.314603474863       -9.70       -4.81    2.6    1.32s
  6   -2.314603474872      -11.02       -5.56    2.9    1.27s
  7   -2.314603474873      -11.99       -6.23    3.1    1.56s
  8   -2.314603474873      -13.94       -6.72    2.6    1.06s
  9   -2.314603474873      -15.05       -7.56    2.3    1.31s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.314486831473                   -1.45    5.4    2.07s
  2   -2.314579991138       -4.03       -1.83    1.4    760ms
  3   -2.314603318467       -4.63       -3.52    3.4    1.60s
  4   -2.314603474655       -6.81       -4.19    4.4    1.56s
  5   -2.314603474863       -9.68       -4.81    2.7    1.36s
  6   -2.314603474872      -11.02       -5.55    2.8    1.10s
  7   -2.314603474873      -11.97       -6.23    3.0    1.20s
  8   -2.314603474873      -13.95       -6.74    2.6    1.27s
  9   -2.314603474873      -14.75       -7.61    2.3    980ms
     4    -2.314603e+00     1.051266e-08
 * time: 225.4419391155243
 * Status: success

 * Candidate solution
    Final objective value:     -2.314603e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 8.71e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.15e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.70e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 7.33e-11 ≰ 0.0e+00
    |g(x)|                 = 1.05e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   225  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

Al: 259.728151 seconds (202.63 M allocations: 48.194 GiB, 6.23% gc time, 0.00% compilation time)
┌ Info: 2025-05-12T17:22:55.114
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69824990416                   -0.85    9.7    10.5s
  2   -73.71143210099       -1.88       -1.06    5.5    6.18s
  3   -73.71817456867       -2.17       -1.39    6.8    7.91s
  4   -73.71937449451       -2.92       -1.78    5.9    8.08s
  5   -73.71952166916       -3.83       -2.21    5.0    5.97s
  6   -73.71954482081       -4.64       -3.08    5.4    6.45s
  7   -73.71954486501       -7.35       -3.53    4.7    6.12s
  8   -73.71954487211       -8.15       -4.17    5.4    6.05s
  9   -73.71954487212      -10.98       -4.56    4.2    5.54s
 10   -73.71954487267       -9.25       -5.01    5.2    6.19s
 11   -73.71954487268      -11.05       -5.96    5.1    6.73s
 12   -73.71954487268   +  -12.70       -6.51    5.5    6.38s
 13   -73.71954487268   +  -13.00       -6.71    3.3    4.16s
 14   -73.71954487268      -13.07       -7.61    4.9    6.10s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.371954e+01     9.724451e-03
 * time: 3.218650817871094e-5
┌ Warning: Negative ρcore detected: -3.382865585878082e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69860402175                   -0.85    9.7    10.0s
  2   -73.71154631062       -1.89       -1.06    5.5    6.03s
  3   -73.71827573608       -2.17       -1.39    6.9    8.34s
  4   -73.71946146494       -2.93       -1.78    6.0    6.62s
  5   -73.71961302793       -3.82       -2.25    5.1    6.14s
  6   -73.71963232065       -4.71       -3.09    5.6    6.61s
  7   -73.71963237228       -7.29       -3.54    4.9    6.49s
  8   -73.71963237829       -8.22       -4.13    5.2    5.90s
  9   -73.71963237822   +  -10.18       -4.58    4.6    6.24s
 10   -73.71963237882       -9.23       -4.91    5.5    6.45s
 11   -73.71963237883      -10.95       -5.84    4.9    5.54s
 12   -73.71963237883   +    -Inf       -6.45    4.8    6.17s
 13   -73.71963237883   +  -13.85       -6.55    3.2    4.21s
 14   -73.71963237883      -13.00       -7.07    4.6    5.44s
┌ Warning: Negative ρcore detected: -3.382865585878082e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.69860726010                   -0.85    9.8    10.0s
  2   -73.71153161365       -1.89       -1.06    5.5    6.42s
  3   -73.71827753019       -2.17       -1.39    6.8    8.46s
  4   -73.71946094927       -2.93       -1.78    5.9    6.23s
  5   -73.71961271738       -3.82       -2.24    5.0    5.59s
  6   -73.71963232875       -4.71       -3.08    5.6    6.44s
  7   -73.71963237301       -7.35       -3.53    4.8    6.05s
  8   -73.71963237838       -8.27       -4.14    5.2    5.97s
  9   -73.71963237830   +  -10.09       -4.60    4.7    5.61s
 10   -73.71963237881       -9.29       -4.89    5.5    6.04s
 11   -73.71963237883      -10.93       -5.82    4.8    6.00s
 12   -73.71963237883      -12.81       -6.44    4.5    6.27s
 13   -73.71963237883   +  -13.37       -6.57    3.9    4.84s
 14   -73.71963237883      -13.25       -7.04    4.8    5.65s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.382865585878082e-8,-5.455175830057609e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.371963e+01     8.269622e-03
 * time: 244.3424551486969
┌ Warning: Negative ρcore detected: -3.0637809182832765e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70025159496                   -0.86   10.0    9.88s
  2   -73.71193004819       -1.93       -1.06    5.5    6.68s
  3   -73.71856121898       -2.18       -1.40    6.9    7.83s
  4   -73.71967702120       -2.95       -1.77    5.9    6.41s
  5   -73.71983461793       -3.80       -2.25    5.1    5.60s
  6   -73.71985338764       -4.73       -3.09    5.6    6.52s
  7   -73.71985340580       -7.74       -3.54    4.5    5.15s
  8   -73.71985340985       -8.39       -4.06    4.8    5.25s
  9   -73.71985340967   +   -9.73       -4.51    5.2    5.80s
 10   -73.71985341008       -9.38       -4.79    5.6    5.70s
 11   -73.71985341011      -10.50       -5.52    4.8    5.30s
 12   -73.71985341011      -11.70       -6.34    4.7    5.50s
 13   -73.71985341011   +  -13.55       -6.62    4.8    5.43s
 14   -73.71985341011   +    -Inf       -7.07    5.2    5.62s
┌ Warning: Negative ρcore detected: -3.0637809182832765e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70025618857                   -0.86    9.8    9.43s
  2   -73.71191311735       -1.93       -1.06    5.5    5.98s
  3   -73.71856183736       -2.18       -1.40    6.9    7.29s
  4   -73.71967806814       -2.95       -1.77    5.9    5.97s
  5   -73.71983504960       -3.80       -2.26    5.2    5.46s
  6   -73.71985338854       -4.74       -3.09    5.6    6.05s
  7   -73.71985340614       -7.75       -3.54    4.3    5.10s
  8   -73.71985340985       -8.43       -4.06    4.6    5.23s
  9   -73.71985340969   +   -9.79       -4.51    5.3    5.71s
 10   -73.71985341008       -9.41       -4.79    5.5    5.83s
 11   -73.71985341011      -10.48       -5.52    4.8    5.89s
 12   -73.71985341011      -11.65       -6.34    4.8    6.19s
 13   -73.71985341011   +  -13.07       -6.64    4.7    6.85s
 14   -73.71985341011   +    -Inf       -7.09    5.1    6.24s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0637809182832765e-8,-8.530566906880555e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.371985e+01     3.954095e-04
 * time: 481.7936120033264
┌ Warning: Negative ρcore detected: -3.0838118456710284e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70020003821                   -0.86    9.7    10.2s
  2   -73.71189879341       -1.93       -1.06    5.4    6.25s
  3   -73.71856129564       -2.18       -1.40    6.8    7.57s
  4   -73.71967675525       -2.95       -1.77    5.9    7.16s
  5   -73.71983480355       -3.80       -2.25    5.2    5.81s
  6   -73.71985386611       -4.72       -3.08    5.5    6.46s
  7   -73.71985388381       -7.75       -3.53    4.4    5.56s
  8   -73.71985388780       -8.40       -4.06    4.7    5.64s
  9   -73.71985388764   +   -9.81       -4.52    5.1    6.70s
 10   -73.71985388803       -9.42       -4.79    5.5    6.78s
 11   -73.71985388806      -10.50       -5.52    4.7    5.45s
 12   -73.71985388806      -11.67       -6.29    4.6    5.95s
 13   -73.71985388806      -13.37       -6.61    4.8    5.66s
 14   -73.71985388806      -13.55       -7.07    5.1    5.65s
┌ Warning: Negative ρcore detected: -3.0838118456710284e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70019668454                   -0.86    9.8    9.90s
  2   -73.71188840311       -1.93       -1.06    5.4    6.39s
  3   -73.71856309705       -2.18       -1.40    6.8    7.45s
  4   -73.71967634925       -2.95       -1.77    5.8    6.24s
  5   -73.71983464343       -3.80       -2.25    5.1    5.72s
  6   -73.71985386556       -4.72       -3.08    5.4    6.15s
  7   -73.71985388407       -7.73       -3.53    4.4    5.27s
  8   -73.71985388780       -8.43       -4.06    4.6    5.41s
  9   -73.71985388766   +   -9.88       -4.52    5.0    5.79s
 10   -73.71985388802       -9.45       -4.80    5.4    5.77s
 11   -73.71985388806      -10.45       -5.53    4.7    5.52s
 12   -73.71985388806      -11.68       -6.29    4.7    5.46s
 13   -73.71985388806   +  -13.85       -6.60    4.8    5.59s
 14   -73.71985388806      -13.85       -7.06    5.0    5.48s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0838118456710284e-8,-7.355235066674032e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.371985e+01     1.652200e-05
 * time: 720.8967380523682
┌ Warning: Negative ρcore detected: -3.083065346828979e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70020516498                   -0.86    9.6    11.4s
  2   -73.71189106777       -1.93       -1.06    5.3    6.40s
  3   -73.71856233851       -2.18       -1.40    6.8    9.17s
  4   -73.71967680851       -2.95       -1.77    5.7    6.37s
  5   -73.71983455793       -3.80       -2.25    5.0    6.15s
  6   -73.71985386666       -4.71       -3.08    5.5    6.49s
  7   -73.71985388438       -7.75       -3.54    4.5    5.50s
  8   -73.71985388863       -8.37       -4.08    4.7    5.56s
  9   -73.71985388845   +   -9.73       -4.53    5.1    6.01s
 10   -73.71985388885       -9.40       -4.81    5.4    6.08s
 11   -73.71985388888      -10.49       -5.53    4.7    5.50s
 12   -73.71985388888      -11.68       -6.31    4.6    6.27s
 13   -73.71985388888      -12.89       -6.59    4.8    5.75s
 14   -73.71985388888   +  -13.15       -7.05    5.1    5.36s
┌ Warning: Negative ρcore detected: -3.083065346828979e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.70021233452                   -0.86    9.7    9.17s
  2   -73.71188946002       -1.93       -1.06    5.3    5.85s
  3   -73.71856222918       -2.18       -1.40    6.7    7.06s
  4   -73.71967696055       -2.95       -1.77    5.7    6.16s
  5   -73.71983471583       -3.80       -2.25    5.0    6.17s
  6   -73.71985386701       -4.72       -3.08    5.5    6.18s
  7   -73.71985388448       -7.76       -3.53    4.5    5.51s
  8   -73.71985388862       -8.38       -4.07    4.6    5.97s
  9   -73.71985388846   +   -9.80       -4.51    5.3    7.67s
 10   -73.71985388885       -9.41       -4.80    5.3    6.59s
 11   -73.71985388888      -10.50       -5.51    4.7    5.82s
 12   -73.71985388888      -11.60       -6.28    4.6    6.13s
 13   -73.71985388888   +    -Inf       -6.61    4.8    5.92s
 14   -73.71985388888   +    -Inf       -7.08    5.1    5.47s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.083065346828979e-8,-7.401977893388526e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     4    -7.371985e+01     2.254165e-08
 * time: 966.2665190696716
 * Status: success

 * Candidate solution
    Final objective value:     -7.371985e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.01e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.79e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 8.20e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.11e-11 ≰ 0.0e+00
    |g(x)|                 = 2.25e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   966  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

V: 1102.182704 seconds (723.33 M allocations: 341.178 GiB, 5.83% gc time, 0.01% compilation time)
