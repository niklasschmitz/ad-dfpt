┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-12T15:41:58.479
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.446953852738                   -0.96    7.0    11.0s
  2   -8.448818733264       -2.73       -1.76    1.9    4.84s
  3   -8.448880831612       -4.21       -2.81    3.8    1.99s
  4   -8.448881666983       -6.08       -3.83    4.3    1.82s
  5   -8.448881677139       -7.99       -4.46    4.5    2.18s
  6   -8.448881677606       -9.33       -5.47    4.3    1.94s
  7   -8.448881677613      -11.15       -6.21    4.2    1.74s
  8   -8.448881677614      -12.87       -7.62    3.6    1.88s
Iter     Function value   Gradient norm 
     0    -8.448882e+00     3.167192e-03
 * time: 3.981590270996094e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.446970473390                   -0.96    7.5    2.80s
  2   -8.448831889576       -2.73       -1.76    2.3    1.48s
  3   -8.448890579323       -4.23       -2.80    4.0    1.69s
  4   -8.448891353929       -6.11       -3.82    4.5    2.09s
  5   -8.448891362299       -8.08       -4.51    4.6    1.82s
  6   -8.448891362692       -9.41       -5.54    4.6    2.20s
  7   -8.448891362697      -11.30       -6.20    4.4    1.75s
  8   -8.448891362697      -12.82       -7.59    3.7    1.77s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.446966583333                   -0.96    7.5    2.67s
  2   -8.448828517525       -2.73       -1.76    2.3    1.53s
  3   -8.448890599315       -4.21       -2.80    4.0    2.01s
  4   -8.448891352855       -6.12       -3.84    4.5    2.52s
  5   -8.448891362195       -8.03       -4.45    4.5    2.00s
  6   -8.448891362690       -9.31       -5.48    4.5    1.89s
  7   -8.448891362697      -11.15       -6.19    4.4    1.71s
  8   -8.448891362697      -12.79       -7.68    3.6    1.74s
     1    -8.448891e+00     2.948579e-03
 * time: 43.99832797050476
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.446945447260                   -0.96    7.1    2.60s
  2   -8.448888312016       -2.71       -1.76    2.1    1.16s
  3   -8.448952677297       -4.19       -2.79    3.8    1.94s
  4   -8.448953369618       -6.16       -3.83    4.3    2.04s
  5   -8.448953378100       -8.07       -4.47    4.3    1.69s
  6   -8.448953378522       -9.37       -5.48    4.5    1.86s
  7   -8.448953378528      -11.24       -6.14    4.2    1.67s
  8   -8.448953378528      -12.74       -7.59    3.6    1.74s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.446948974161                   -0.96    7.2    2.56s
  2   -8.448890128275       -2.71       -1.76    2.1    1.42s
  3   -8.448952434914       -4.21       -2.82    3.9    1.65s
  4   -8.448953367886       -6.03       -3.80    4.5    2.04s
  5   -8.448953378187       -7.99       -4.56    4.5    1.71s
  6   -8.448953378523       -9.47       -5.47    4.7    1.91s
  7   -8.448953378528      -11.29       -6.24    4.1    1.63s
  8   -8.448953378528      -12.86       -7.61    3.8    1.82s
     2    -8.448953e+00     6.551997e-05
 * time: 84.85151195526123
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.446960084774                   -0.96    7.2    2.56s
  2   -8.448893578565       -2.71       -1.76    2.1    1.15s
  3   -8.448952612912       -4.23       -2.79    3.8    1.96s
  4   -8.448953399478       -6.10       -3.82    4.3    2.01s
  5   -8.448953407988       -8.07       -4.51    4.4    1.82s
  6   -8.448953408333       -9.46       -5.53    4.6    1.91s
  7   -8.448953408338      -11.34       -6.21    4.2    1.70s
  8   -8.448953408338      -12.91       -7.54    3.6    1.77s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.446945493527                   -0.96    7.1    2.67s
  2   -8.448883625301       -2.71       -1.76    2.1    1.45s
  3   -8.448952448976       -4.16       -2.82    4.0    1.69s
  4   -8.448953396593       -6.02       -3.81    4.5    2.07s
  5   -8.448953407944       -7.94       -4.52    4.6    2.10s
  6   -8.448953408331       -9.41       -5.40    4.6    2.04s
  7   -8.448953408338      -11.17       -6.19    3.9    1.61s
  8   -8.448953408338      -12.71       -7.58    3.7    1.74s
     3    -8.448953e+00     1.308388e-06
 * time: 126.72904586791992
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.446950518992                   -0.96    7.2    2.56s
  2   -8.448891088909       -2.71       -1.76    2.2    1.17s
  3   -8.448952633109       -4.21       -2.79    3.8    1.93s
  4   -8.448953400030       -6.12       -3.82    4.2    2.06s
  5   -8.448953407962       -8.10       -4.49    4.4    1.72s
  6   -8.448953408345       -9.42       -5.52    4.5    1.88s
  7   -8.448953408350      -11.28       -6.20    4.1    1.77s
  8   -8.448953408350      -12.86       -7.59    3.6    1.79s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.446955408436                   -0.96    7.2    2.56s
  2   -8.448889483408       -2.71       -1.76    2.1    1.43s
  3   -8.448952547697       -4.20       -2.79    4.0    1.67s
  4   -8.448953400084       -6.07       -3.80    4.2    1.97s
  5   -8.448953407989       -8.10       -4.51    4.4    1.66s
  6   -8.448953408345       -9.45       -5.54    4.6    1.87s
  7   -8.448953408350      -11.32       -6.19    4.2    1.67s
  8   -8.448953408350      -12.84       -7.46    3.6    1.76s
     4    -8.448953e+00     4.414462e-09
 * time: 168.42553091049194
 * Status: success

 * Candidate solution
    Final objective value:     -8.448953e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.82e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.76e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.19e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.41e-12 ≰ 0.0e+00
    |g(x)|                 = 4.41e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   168  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

Si: 243.368557 seconds (367.80 M allocations: 74.073 GiB, 8.10% gc time, 20.84% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-12T15:46:02.473
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13318761612                   -1.17    8.4    19.2s
  2   -62.13705299508       -2.41       -1.23    2.6    8.35s
  3   -62.14112552220       -2.39       -2.08    4.0    10.0s
  4   -62.14115197572       -4.58       -2.83    3.7    9.64s
  5   -62.14115287029       -6.05       -3.58    4.0    10.5s
  6   -62.14115288896       -7.73       -4.43    4.1    10.2s
  7   -62.14115288922       -9.59       -5.12    4.1    10.8s
  8   -62.14115288923      -10.94       -6.63    4.0    10.8s
  9   -62.14115288923      -13.37       -7.57    4.4    11.5s
Iter     Function value   Gradient norm 
     0    -6.214115e+01     2.845480e-03
 * time: 4.8160552978515625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13320510728                   -1.17    8.3    17.1s
  2   -62.13707293932       -2.41       -1.23    2.6    7.50s
  3   -62.14113356959       -2.39       -2.08    3.8    9.86s
  4   -62.14116005329       -4.58       -2.84    3.8    10.4s
  5   -62.14116089305       -6.08       -3.60    3.9    10.5s
  6   -62.14116091085       -7.75       -4.46    3.9    10.0s
  7   -62.14116091106       -9.69       -5.14    3.9    10.8s
  8   -62.14116091107      -11.01       -6.59    4.0    10.6s
  9   -62.14116091107   +  -13.25       -7.56    4.4    12.2s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13320199231                   -1.17    8.3    16.7s
  2   -62.13707102854       -2.41       -1.23    2.7    7.46s
  3   -62.14113377170       -2.39       -2.08    4.0    10.0s
  4   -62.14116006220       -4.58       -2.85    3.6    9.90s
  5   -62.14116089346       -6.08       -3.60    3.9    10.1s
  6   -62.14116091085       -7.76       -4.47    4.0    10.1s
  7   -62.14116091106       -9.69       -5.13    4.0    10.5s
  8   -62.14116091107      -11.02       -6.81    4.0    10.2s
  9   -62.14116091107      -13.30       -7.59    4.6    11.9s
     1    -6.214116e+01     2.792809e-03
 * time: 229.22113513946533
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13383995640                   -1.18    8.4    16.9s
  2   -62.13768240596       -2.42       -1.24    2.7    7.52s
  3   -62.14133666061       -2.44       -2.10    4.0    10.0s
  4   -62.14135912304       -4.65       -2.91    3.8    9.78s
  5   -62.14135969441       -6.24       -3.65    4.0    10.5s
  6   -62.14135970906       -7.83       -4.57    3.8    9.74s
  7   -62.14135970919       -9.87       -5.18    4.0    11.1s
  8   -62.14135970920      -11.12       -6.78    3.8    10.3s
  9   -62.14135970920   +    -Inf       -7.63    4.5    11.8s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13383635468                   -1.18    8.3    17.0s
  2   -62.13770203106       -2.41       -1.25    2.7    7.76s
  3   -62.14133643156       -2.44       -2.10    4.0    10.0s
  4   -62.14135906543       -4.65       -2.89    3.7    9.92s
  5   -62.14135969320       -6.20       -3.62    3.9    10.0s
  6   -62.14135970903       -7.80       -4.51    3.9    9.83s
  7   -62.14135970919       -9.79       -5.20    4.1    10.7s
  8   -62.14135970920      -11.14       -6.72    4.0    10.2s
  9   -62.14135970920      -13.19       -7.54    4.5    11.4s
     2    -6.214136e+01     2.370869e-04
 * time: 456.3283791542053
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13380576514                   -1.18    8.3    17.9s
  2   -62.13765299837       -2.41       -1.24    2.7    8.65s
  3   -62.14133767887       -2.43       -2.10    4.0    10.6s
  4   -62.14136039193       -4.64       -2.90    3.8    10.6s
  5   -62.14136098686       -6.23       -3.64    4.0    10.3s
  6   -62.14136100183       -7.82       -4.54    4.0    10.1s
  7   -62.14136100197       -9.84       -5.14    4.0    10.8s
  8   -62.14136100198      -11.05       -6.71    3.8    10.1s
  9   -62.14136100198      -13.67       -7.61    4.5    11.6s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13380918248                   -1.18    8.3    17.3s
  2   -62.13766332728       -2.41       -1.24    2.6    7.51s
  3   -62.14133744810       -2.43       -2.10    3.9    10.3s
  4   -62.14136035131       -4.64       -2.89    3.8    10.4s
  5   -62.14136098582       -6.20       -3.62    3.9    10.3s
  6   -62.14136100181       -7.80       -4.50    3.9    10.0s
  7   -62.14136100197       -9.78       -5.15    4.1    10.5s
  8   -62.14136100198      -11.07       -6.71    3.9    10.7s
  9   -62.14136100198   +  -13.30       -7.57    4.5    11.5s
     3    -6.214136e+01     1.758140e-05
 * time: 685.9662091732025
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13380908719                   -1.18    8.0    17.2s
  2   -62.13767239732       -2.41       -1.24    2.5    7.87s
  3   -62.14133728692       -2.44       -2.10    3.8    9.69s
  4   -62.14136029712       -4.64       -2.86    3.7    9.89s
  5   -62.14136099164       -6.16       -3.59    3.9    10.0s
  6   -62.14136100897       -7.76       -4.45    4.0    10.1s
  7   -62.14136100917       -9.70       -5.12    4.0    10.8s
  8   -62.14136100918      -11.00       -6.74    4.0    10.3s
  9   -62.14136100918      -13.45       -7.44    4.6    11.7s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.13380717859                   -1.18    7.9    16.1s
  2   -62.13766645599       -2.41       -1.24    2.6    7.75s
  3   -62.14133756645       -2.44       -2.10    3.8    9.75s
  4   -62.14136031584       -4.64       -2.87    3.7    10.0s
  5   -62.14136099258       -6.17       -3.61    3.9    9.63s
  6   -62.14136100898       -7.79       -4.48    4.0    10.7s
  7   -62.14136100917       -9.71       -5.15    4.1    10.5s
  8   -62.14136100918      -11.04       -6.82    4.0    9.73s
  9   -62.14136100918   +  -13.25       -7.52    4.5    11.7s
     4    -6.214136e+01     1.001330e-07
 * time: 910.2833001613617
 * Status: success

 * Candidate solution
    Final objective value:     -6.214136e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 8.15e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 7.69e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 7.20e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.16e-10 ≰ 0.0e+00
    |g(x)|                 = 1.00e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   910  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

NaCl: 1037.344590 seconds (1.01 G allocations: 288.770 GiB, 5.29% gc time, 0.32% compilation time)
┌ Info: 2025-05-12T16:03:19.848
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315460543444                   -1.46    5.5    1.91s
  2   -2.315551144536       -4.04       -1.84    1.4    748ms
  3   -2.315572792083       -4.66       -3.58    3.3    1.50s
  4   -2.315573009854       -6.66       -4.16    4.7    1.63s
  5   -2.315573010203       -9.46       -4.60    2.6    1.29s
  6   -2.315573010262      -10.23       -5.23    2.9    1.09s
  7   -2.315573010265      -11.59       -5.99    2.8    1.37s
  8   -2.315573010265      -13.50       -6.56    2.5    1.05s
  9   -2.315573010265      -14.35       -7.40    2.5    1.31s
Iter     Function value   Gradient norm 
     0    -2.315573e+00     1.352860e-03
 * time: 2.5987625122070312e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315460722574                   -1.46    5.5    1.98s
  2   -2.315553167307       -4.03       -1.84    1.4    786ms
  3   -2.315574603414       -4.67       -3.59    3.3    1.54s
  4   -2.315574802952       -6.70       -4.17    4.6    1.64s
  5   -2.315574803278       -9.49       -4.62    2.6    1.40s
  6   -2.315574803331      -10.28       -5.25    2.8    1.12s
  7   -2.315574803333      -11.62       -5.97    2.8    1.40s
  8   -2.315574803333      -13.50       -6.51    2.6    1.09s
  9   -2.315574803333      -14.21       -7.41    2.5    1.06s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315462124354                   -1.46    5.5    1.94s
  2   -2.315552498807       -4.04       -1.84    1.4    740ms
  3   -2.315574594375       -4.66       -3.56    3.4    1.51s
  4   -2.315574802851       -6.68       -4.12    4.6    1.57s
  5   -2.315574803265       -9.38       -4.57    2.5    1.28s
  6   -2.315574803330      -10.19       -5.19    2.8    1.07s
  7   -2.315574803333      -11.47       -5.91    2.8    1.31s
  8   -2.315574803333      -13.43       -6.54    2.7    1.04s
  9   -2.315574803333      -14.27       -7.38    2.6    1.29s
     1    -2.315575e+00     1.297937e-03
 * time: 52.75829815864563
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315489553889                   -1.45    5.4    1.96s
  2   -2.315575071896       -4.07       -1.84    1.5    769ms
  3   -2.315595451040       -4.69       -3.57    3.3    1.54s
  4   -2.315595658434       -6.68       -4.13    4.5    1.61s
  5   -2.315595658820       -9.41       -4.61    2.6    1.36s
  6   -2.315595658875      -10.26       -5.28    2.9    1.14s
  7   -2.315595658877      -11.64       -5.91    3.0    1.42s
  8   -2.315595658878      -13.49       -6.53    2.5    1.05s
  9   -2.315595658878      -14.12       -7.31    2.6    1.34s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315491337367                   -1.45    5.4    1.92s
  2   -2.315574937366       -4.08       -1.84    1.3    734ms
  3   -2.315595422102       -4.69       -3.55    3.4    1.48s
  4   -2.315595658389       -6.63       -4.11    4.5    1.57s
  5   -2.315595658815       -9.37       -4.59    2.6    1.26s
  6   -2.315595658875      -10.22       -5.26    2.9    1.09s
  7   -2.315595658877      -11.59       -5.89    3.0    1.34s
  8   -2.315595658878      -13.40       -6.55    2.5    990ms
  9   -2.315595658878      -14.27       -7.35    2.6    1.27s
     2    -2.315596e+00     5.113124e-07
 * time: 104.80950808525085
 * Status: success

 * Candidate solution
    Final objective value:     -2.315596e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.20e-02 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.20e-03 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.09e-05 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 9.01e-06 ≰ 0.0e+00
    |g(x)|                 = 5.11e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   105  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Al: 143.254895 seconds (113.02 M allocations: 26.977 GiB, 6.28% gc time, 0.00% compilation time)
┌ Info: 2025-05-12T16:05:43.104
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.72080756190                   -0.85    9.6    9.35s
  2   -73.73356957130       -1.89       -1.05    5.4    5.45s
  3   -73.74037091851       -2.17       -1.39    6.7    6.93s
  4   -73.74157153490       -2.92       -1.77    5.9    5.89s
  5   -73.74172891924       -3.80       -2.25    5.0    5.31s
  6   -73.74174812055       -4.72       -3.09    5.5    5.97s
  7   -73.74174815571       -7.45       -3.53    4.4    5.94s
  8   -73.74174816339       -8.11       -4.13    5.1    5.45s
  9   -73.74174816279   +   -9.22       -4.49    5.3    5.72s
 10   -73.74174816363       -9.08       -4.80    5.6    5.76s
 11   -73.74174816365      -10.91       -5.70    3.6    4.32s
 12   -73.74174816365      -13.25       -6.36    4.5    5.10s
 13   -73.74174816365      -13.85       -6.52    3.1    3.95s
 14   -73.74174816365   +  -13.37       -6.98    5.1    5.41s
 15   -73.74174816365      -13.37       -7.85    4.8    5.16s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.374175e+01     1.155208e-02
 * time: 3.314018249511719e-5
┌ Warning: Negative ρcore detected: -3.372143598611121e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.72125710549                   -0.85    9.9    9.52s
  2   -73.73370380137       -1.90       -1.05    5.3    5.49s
  3   -73.74051070357       -2.17       -1.39    6.8    6.96s
  4   -73.74169077199       -2.93       -1.76    6.0    5.87s
  5   -73.74185256210       -3.79       -2.25    5.0    5.44s
  6   -73.74187164889       -4.72       -3.08    5.6    6.08s
  7   -73.74187166731       -7.73       -3.54    4.5    5.14s
  8   -73.74187168159       -7.85       -4.12    5.1    5.72s
  9   -73.74187168092   +   -9.18       -4.45    5.5    5.87s
 10   -73.74187168176       -9.08       -4.78    5.8    5.86s
 11   -73.74187168177      -10.79       -5.65    4.0    4.77s
 12   -73.74187168177      -12.50       -6.32    4.8    5.37s
 13   -73.74187168177   +    -Inf       -6.50    3.7    4.40s
 14   -73.74187168177   +    -Inf       -6.91    5.3    5.54s
 15   -73.74187168177   +  -13.15       -7.79    4.9    5.26s
┌ Warning: Negative ρcore detected: -3.372143598611121e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.72124558091                   -0.85    9.9    9.65s
  2   -73.73370078110       -1.90       -1.05    5.3    5.61s
  3   -73.74051230145       -2.17       -1.39    6.8    7.17s
  4   -73.74169103053       -2.93       -1.77    5.9    6.42s
  5   -73.74185197345       -3.79       -2.25    5.0    5.42s
  6   -73.74187164920       -4.71       -3.08    5.6    6.11s
  7   -73.74187166768       -7.73       -3.53    4.4    5.21s
  8   -73.74187168159       -7.86       -4.13    5.0    5.55s
  9   -73.74187168098   +   -9.21       -4.44    5.5    6.26s
 10   -73.74187168176       -9.11       -4.76    5.8    5.90s
 11   -73.74187168177      -10.78       -5.63    3.7    4.55s
 12   -73.74187168177      -12.23       -6.29    4.8    5.49s
 13   -73.74187168177   +  -13.55       -6.54    3.0    4.05s
 14   -73.74187168177   +  -13.15       -6.90    5.2    5.64s
 15   -73.74187168177   +  -13.37       -7.75    4.9    5.28s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.372143598611121e-8,-6.279686459048631e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.374187e+01     9.827456e-03
 * time: 236.04853296279907
┌ Warning: Negative ρcore detected: -3.200674467586896e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.72313071562                   -0.86    9.6    9.24s
  2   -73.73443176629       -1.95       -1.06    5.2    5.58s
  3   -73.74087032962       -2.19       -1.39    6.6    7.39s
  4   -73.74202192374       -2.94       -1.78    5.8    5.81s
  5   -73.74216447740       -3.85       -2.29    4.9    5.33s
  6   -73.74218044082       -4.80       -3.09    5.4    6.34s
  7   -73.74218048786       -7.33       -3.57    4.6    5.36s
  8   -73.74218049724       -8.03       -4.04    5.2    5.58s
  9   -73.74218049665   +   -9.23       -4.49    5.5    5.75s
 10   -73.74218049752       -9.06       -4.80    5.5    5.68s
 11   -73.74218049757      -10.29       -5.47    4.9    5.45s
 12   -73.74218049757      -11.47       -6.19    4.8    5.33s
 13   -73.74218049757      -13.37       -6.42    3.9    4.71s
 14   -73.74218049757      -13.85       -7.01    5.1    5.22s
┌ Warning: Negative ρcore detected: -3.200674467586896e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.72313779302                   -0.86    9.6    9.20s
  2   -73.73442036625       -1.95       -1.06    5.2    5.40s
  3   -73.74087225988       -2.19       -1.39    6.7    7.46s
  4   -73.74202167174       -2.94       -1.78    5.7    6.43s
  5   -73.74216423837       -3.85       -2.29    4.9    5.75s
  6   -73.74218044335       -4.79       -3.09    5.4    5.97s
  7   -73.74218048789       -7.35       -3.57    4.5    5.39s
  8   -73.74218049723       -8.03       -4.04    5.2    5.48s
  9   -73.74218049669   +   -9.27       -4.50    5.4    5.72s
 10   -73.74218049752       -9.08       -4.80    5.6    5.78s
 11   -73.74218049757      -10.29       -5.46    4.9    5.48s
 12   -73.74218049757      -11.41       -6.19    4.7    5.37s
 13   -73.74218049757      -13.37       -6.42    3.8    4.79s
 14   -73.74218049757   +  -13.25       -7.02    5.1    5.43s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.200674467586896e-8,1.3530120661392785e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.374218e+01     6.163035e-04
 * time: 462.74844312667847
┌ Warning: Negative ρcore detected: -3.145289475560467e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.72304813093                   -0.86    9.8    9.27s
  2   -73.73438316547       -1.95       -1.06    5.4    5.32s
  3   -73.74087005232       -2.19       -1.39    6.8    6.91s
  4   -73.74202087546       -2.94       -1.78    5.9    5.90s
  5   -73.74216553052       -3.84       -2.29    5.1    5.36s
  6   -73.74218159131       -4.79       -3.09    5.5    6.28s
  7   -73.74218163252       -7.38       -3.57    4.7    5.34s
  8   -73.74218163987       -8.13       -4.04    5.2    5.46s
  9   -73.74218163925   +   -9.21       -4.49    5.4    5.85s
 10   -73.74218164011       -9.07       -4.79    5.6    5.83s
 11   -73.74218164015      -10.32       -5.46    4.9    5.51s
 12   -73.74218164016      -11.43       -6.26    4.8    5.47s
 13   -73.74218164016      -12.73       -6.45    4.0    4.91s
 14   -73.74218164016      -13.37       -7.02    5.2    5.49s
┌ Warning: Negative ρcore detected: -3.145289475560467e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.72305470821                   -0.86    9.9    9.44s
  2   -73.73438186213       -1.95       -1.06    5.3    5.47s
  3   -73.74087073019       -2.19       -1.39    6.8    7.56s
  4   -73.74202022530       -2.94       -1.78    5.9    6.03s
  5   -73.74216567673       -3.84       -2.29    5.0    5.35s
  6   -73.74218159491       -4.80       -3.09    5.6    6.16s
  7   -73.74218163097       -7.44       -3.58    4.5    5.10s
  8   -73.74218163983       -8.05       -4.05    5.2    5.49s
  9   -73.74218163920   +   -9.20       -4.49    5.5    6.08s
 10   -73.74218164010       -9.04       -4.79    5.6    6.44s
 11   -73.74218164015      -10.32       -5.46    5.1    5.73s
 12   -73.74218164016      -11.37       -6.21    4.8    5.66s
 13   -73.74218164016      -12.85       -6.42    4.2    5.14s
 14   -73.74218164016   +  -12.85       -7.00    5.2    5.48s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.145289475560467e-8,1.4975467380426854e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.374218e+01     2.777732e-05
 * time: 690.9036979675293
┌ Warning: Negative ρcore detected: -3.1477931313213124e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.72304407418                   -0.86    9.8    9.35s
  2   -73.73439241192       -1.95       -1.06    5.3    5.42s
  3   -73.74087090358       -2.19       -1.39    6.8    6.91s
  4   -73.74202045696       -2.94       -1.78    5.8    5.81s
  5   -73.74216541752       -3.84       -2.29    5.1    5.39s
  6   -73.74218159420       -4.79       -3.09    5.5    5.94s
  7   -73.74218163348       -7.41       -3.57    4.7    5.51s
  8   -73.74218164214       -8.06       -4.04    5.3    5.67s
  9   -73.74218164155   +   -9.23       -4.49    5.5    5.91s
 10   -73.74218164242       -9.06       -4.80    5.6    5.96s
 11   -73.74218164246      -10.33       -5.46    5.0    5.65s
 12   -73.74218164247      -11.40       -6.24    4.8    5.59s
 13   -73.74218164247   +    -Inf       -6.44    3.9    5.21s
 14   -73.74218164247   +  -13.55       -7.01    5.2    6.07s
┌ Warning: Negative ρcore detected: -3.1477931313213124e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.72304346996                   -0.86    9.7    9.38s
  2   -73.73439975395       -1.94       -1.06    5.2    5.90s
  3   -73.74086867874       -2.19       -1.39    6.8    7.30s
  4   -73.74202084556       -2.94       -1.78    5.9    6.56s
  5   -73.74216513296       -3.84       -2.29    5.0    5.76s
  6   -73.74218158810       -4.78       -3.09    5.6    6.04s
  7   -73.74218163401       -7.34       -3.57    4.7    5.42s
  8   -73.74218164217       -8.09       -4.04    5.3    5.70s
  9   -73.74218164158   +   -9.23       -4.50    5.5    5.81s
 10   -73.74218164242       -9.08       -4.80    5.6    6.39s
 11   -73.74218164246      -10.33       -5.48    5.1    5.69s
 12   -73.74218164247      -11.52       -6.21    4.8    5.56s
 13   -73.74218164247      -13.15       -6.42    3.9    5.33s
 14   -73.74218164247   +  -13.55       -7.01    5.3    5.61s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1477931313213124e-8,1.4914342497404281e-7)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     4    -7.374218e+01     6.704688e-08
 * time: 922.7652311325073
 * Status: success

 * Candidate solution
    Final objective value:     -7.374218e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.68e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.98e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.31e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.13e-11 ≰ 0.0e+00
    |g(x)|                 = 6.70e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   923  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

V: 1062.130294 seconds (731.98 M allocations: 347.005 GiB, 6.05% gc time, 0.01% compilation time)
