┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-12T15:41:58.960
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458407458738                   -0.96    7.0    10.6s
  2   -8.460267016079       -2.73       -1.74    1.9    4.96s
  3   -8.460328229921       -4.21       -2.79    3.8    1.98s
  4   -8.460329064753       -6.08       -3.87    4.3    1.77s
  5   -8.460329073306       -8.07       -4.46    4.4    2.19s
  6   -8.460329073729       -9.37       -5.47    4.3    1.98s
  7   -8.460329073736      -11.19       -6.14    4.2    2.21s
  8   -8.460329073736      -12.60       -7.68    3.8    1.89s
Iter     Function value   Gradient norm 
     0    -8.460329e+00     1.731032e-03
 * time: 4.1961669921875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458394436236                   -0.96    7.2    2.58s
  2   -8.460268147590       -2.73       -1.75    2.0    1.44s
  3   -8.460330953361       -4.20       -2.79    3.7    2.09s
  4   -8.460331957539       -6.00       -3.86    4.3    2.02s
  5   -8.460331966052       -8.07       -4.44    4.5    1.79s
  6   -8.460331966507       -9.34       -5.46    4.4    1.95s
  7   -8.460331966513      -11.18       -6.12    4.3    1.76s
  8   -8.460331966514      -12.61       -7.61    3.7    1.81s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458398125220                   -0.96    7.2    2.55s
  2   -8.460269917719       -2.73       -1.75    2.0    1.41s
  3   -8.460331109224       -4.21       -2.79    3.8    1.65s
  4   -8.460331957930       -6.07       -3.86    4.5    2.07s
  5   -8.460331966075       -8.09       -4.45    4.5    1.79s
  6   -8.460331966507       -9.37       -5.47    4.4    1.92s
  7   -8.460331966513      -11.18       -6.13    4.3    1.79s
  8   -8.460331966514      -12.66       -7.65    3.7    1.83s
     1    -8.460332e+00     1.611195e-03
 * time: 42.44639301300049
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458398856194                   -0.96    7.4    2.56s
  2   -8.460288059066       -2.72       -1.75    2.3    1.17s
  3   -8.460349777309       -4.21       -2.77    3.7    1.94s
  4   -8.460350552050       -6.11       -3.86    4.3    1.74s
  5   -8.460350559456       -8.13       -4.46    4.5    2.06s
  6   -8.460350559842       -9.41       -5.48    4.3    1.59s
  7   -8.460350559848      -11.25       -6.17    4.2    2.00s
  8   -8.460350559848      -12.79       -7.64    3.8    1.53s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458399342513                   -0.96    7.3    2.49s
  2   -8.460287531455       -2.72       -1.75    2.3    1.16s
  3   -8.460349822825       -4.21       -2.77    3.8    1.93s
  4   -8.460350551738       -6.14       -3.86    4.4    1.72s
  5   -8.460350559420       -8.11       -4.44    4.5    2.07s
  6   -8.460350559842       -9.38       -5.47    4.4    1.58s
  7   -8.460350559848      -11.20       -6.12    4.4    1.99s
  8   -8.460350559848      -12.72       -7.69    3.7    1.51s
     2    -8.460351e+00     1.942188e-05
 * time: 83.7249219417572
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458391667617                   -0.96    7.6    2.59s
  2   -8.460287192231       -2.72       -1.75    2.2    1.46s
  3   -8.460349765081       -4.20       -2.77    3.9    1.66s
  4   -8.460350554755       -6.10       -3.86    4.4    2.03s
  5   -8.460350562108       -8.13       -4.45    4.4    1.79s
  6   -8.460350562505       -9.40       -5.50    4.3    1.86s
  7   -8.460350562511      -11.26       -6.14    4.4    1.74s
  8   -8.460350562511      -12.80       -7.70    3.7    1.79s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.458400796961                   -0.96    7.6    2.55s
  2   -8.460291415935       -2.72       -1.75    2.3    1.46s
  3   -8.460349760429       -4.23       -2.77    3.9    1.67s
  4   -8.460350555567       -6.10       -3.85    4.3    2.03s
  5   -8.460350562194       -8.18       -4.50    4.5    1.79s
  6   -8.460350562506       -9.50       -5.55    4.5    1.93s
  7   -8.460350562511      -11.39       -6.18    4.4    1.78s
  8   -8.460350562511      -12.83       -7.60    3.8    1.82s
     3    -8.460351e+00     2.159916e-07
 * time: 125.46226906776428
 * Status: success

 * Candidate solution
    Final objective value:     -8.460351e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.77e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.69e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.66e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.15e-10 ≰ 0.0e+00
    |g(x)|                 = 2.16e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   125  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 198.004546 seconds (308.15 M allocations: 58.920 GiB, 7.89% gc time, 24.98% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-12T15:45:17.602
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19976847992                   -1.17    8.6    19.2s
  2   -62.20378406907       -2.40       -1.22    2.7    7.76s
  3   -62.20812187553       -2.36       -2.07    4.1    10.0s
  4   -62.20815096313       -4.54       -2.88    3.8    9.51s
  5   -62.20815163092       -6.18       -3.62    4.0    10.1s
  6   -62.20815164281       -7.92       -4.45    3.8    9.77s
  7   -62.20815164308       -9.58       -5.26    3.9    10.5s
  8   -62.20815164309      -11.10       -6.52    4.1    10.5s
  9   -62.20815164309      -13.11       -7.72    4.2    10.8s
Iter     Function value   Gradient norm 
     0    -6.220815e+01     2.475887e-03
 * time: 3.814697265625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19978082633                   -1.17    8.3    16.2s
  2   -62.20378358648       -2.40       -1.22    2.6    7.11s
  3   -62.20812801682       -2.36       -2.07    4.0    9.56s
  4   -62.20815701971       -4.54       -2.87    3.8    9.69s
  5   -62.20815770226       -6.17       -3.61    4.0    9.91s
  6   -62.20815771476       -7.90       -4.43    3.9    9.76s
  7   -62.20815771505       -9.53       -5.15    4.0    10.5s
  8   -62.20815771506      -10.90       -6.63    4.0    10.2s
  9   -62.20815771506   +  -13.85       -7.73    4.3    11.5s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.19977929561                   -1.17    8.3    16.4s
  2   -62.20377894398       -2.40       -1.22    2.5    7.10s
  3   -62.20812832722       -2.36       -2.07    4.2    9.85s
  4   -62.20815705646       -4.54       -2.89    3.8    9.91s
  5   -62.20815770335       -6.19       -3.64    4.0    10.0s
  6   -62.20815771480       -7.94       -4.48    3.8    9.75s
  7   -62.20815771505       -9.61       -5.15    4.0    10.5s
  8   -62.20815771506      -10.87       -6.61    3.9    10.1s
  9   -62.20815771506   +  -13.19       -7.76    4.3    11.1s
     1    -6.220816e+01     2.428983e-03
 * time: 222.21719312667847
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.20030477735                   -1.17    8.2    16.3s
  2   -62.20432654834       -2.40       -1.23    2.8    7.63s
  3   -62.20828014890       -2.40       -2.08    4.0    9.69s
  4   -62.20830556861       -4.59       -2.92    3.8    9.57s
  5   -62.20830606292       -6.31       -3.65    4.1    9.88s
  6   -62.20830607310       -7.99       -4.48    3.9    9.73s
  7   -62.20830607331       -9.69       -5.19    4.1    10.5s
  8   -62.20830607331      -11.06       -6.72    4.0    10.1s
  9   -62.20830607331      -13.03       -7.76    4.3    11.1s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.20030635426                   -1.17    8.3    18.2s
  2   -62.20433118890       -2.40       -1.23    2.7    7.49s
  3   -62.20827999017       -2.40       -2.08    4.0    9.90s
  4   -62.20830555674       -4.59       -2.91    3.7    10.1s
  5   -62.20830606238       -6.30       -3.63    4.0    10.1s
  6   -62.20830607309       -7.97       -4.46    4.0    10.1s
  7   -62.20830607330       -9.67       -5.17    4.1    10.4s
  8   -62.20830607331      -11.04       -6.66    4.0    10.7s
  9   -62.20830607331   +  -13.67       -7.71    4.3    11.4s
     2    -6.220831e+01     1.725087e-04
 * time: 448.09402203559875
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.20028892503                   -1.17    8.3    16.1s
  2   -62.20429839436       -2.40       -1.23    2.6    7.12s
  3   -62.20828049590       -2.40       -2.08    4.0    9.69s
  4   -62.20830624458       -4.59       -2.92    3.7    9.84s
  5   -62.20830674826       -6.30       -3.64    3.9    10.0s
  6   -62.20830675894       -7.97       -4.46    3.9    9.84s
  7   -62.20830675916       -9.64       -5.18    3.9    10.6s
  8   -62.20830675917      -11.03       -6.67    3.9    10.5s
  9   -62.20830675917      -13.11       -7.71    4.4    11.7s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.20029057207                   -1.17    8.5    16.9s
  2   -62.20429087826       -2.40       -1.23    2.6    7.29s
  3   -62.20828077034       -2.40       -2.08    4.0    9.86s
  4   -62.20830629315       -4.59       -2.94    3.8    10.3s
  5   -62.20830674944       -6.34       -3.67    4.0    10.8s
  6   -62.20830675898       -8.02       -4.51    3.8    9.62s
  7   -62.20830675916       -9.74       -5.17    4.0    10.5s
  8   -62.20830675917      -10.96       -6.76    3.8    9.80s
  9   -62.20830675917      -13.30       -7.73    4.5    11.4s
     3    -6.220831e+01     1.090810e-05
 * time: 675.3475570678711
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.20027821061                   -1.17    8.0    15.9s
  2   -62.20430773181       -2.39       -1.23    2.6    7.22s
  3   -62.20828003173       -2.40       -2.08    4.0    9.71s
  4   -62.20830624980       -4.58       -2.91    3.7    9.62s
  5   -62.20830675050       -6.30       -3.62    3.9    9.87s
  6   -62.20830676170       -7.95       -4.43    3.9    9.94s
  7   -62.20830676193       -9.64       -5.16    3.9    10.2s
  8   -62.20830676194      -11.03       -6.62    3.9    10.4s
  9   -62.20830676194   +  -14.15       -7.65    4.4    11.2s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.20028383551                   -1.17    8.1    16.0s
  2   -62.20431051614       -2.40       -1.23    2.6    7.32s
  3   -62.20828007504       -2.40       -2.08    4.0    9.78s
  4   -62.20830625633       -4.58       -2.91    3.6    9.50s
  5   -62.20830675105       -6.31       -3.63    4.0    10.6s
  6   -62.20830676173       -7.97       -4.45    3.8    9.62s
  7   -62.20830676193       -9.69       -5.16    4.0    10.3s
  8   -62.20830676194      -11.06       -6.77    3.9    9.95s
  9   -62.20830676194      -13.11       -7.72    4.4    10.9s
     4    -6.220831e+01     4.924761e-08
 * time: 894.3817319869995
 * Status: success

 * Candidate solution
    Final objective value:     -6.220831e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 5.06e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.76e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.77e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 4.45e-11 ≰ 0.0e+00
    |g(x)|                 = 4.92e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   894  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

NaCl: 1017.622353 seconds (1.01 G allocations: 288.893 GiB, 5.27% gc time, 0.33% compilation time)
┌ Info: 2025-05-12T16:02:15.262
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317166479132                   -1.46    5.5    2.06s
  2   -2.317244968374       -4.11       -1.84    1.4    1.11s
  3   -2.317262896150       -4.75       -3.57    3.2    1.28s
  4   -2.317263093788       -6.70       -4.04    4.6    2.00s
  5   -2.317263094315       -9.28       -4.31    2.3    994ms
  6   -2.317263094476       -9.79       -5.02    2.7    1.36s
  7   -2.317263094481      -11.29       -5.80    2.6    1.13s
  8   -2.317263094481      -12.88       -6.48    2.8    1.43s
  9   -2.317263094481      -14.31       -7.00    2.5    1.08s
Iter     Function value   Gradient norm 
     0    -2.317263e+00     4.337108e-04
 * time: 3.3855438232421875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317169505691                   -1.46    5.4    2.03s
  2   -2.317245374584       -4.12       -1.84    1.3    756ms
  3   -2.317263025455       -4.75       -3.56    3.2    1.55s
  4   -2.317263277963       -6.60       -4.02    4.5    1.66s
  5   -2.317263278550       -9.23       -4.30    2.4    1.30s
  6   -2.317263278720       -9.77       -4.98    2.7    1.08s
  7   -2.317263278726      -11.27       -5.80    2.4    1.31s
  8   -2.317263278726      -12.79       -6.54    2.7    1.15s
  9   -2.317263278726      -14.35       -7.12    2.8    1.14s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317169092129                   -1.46    5.4    2.01s
  2   -2.317245797873       -4.12       -1.84    1.4    749ms
  3   -2.317263084419       -4.76       -3.58    3.2    1.52s
  4   -2.317263278050       -6.71       -4.05    4.6    1.63s
  5   -2.317263278565       -9.29       -4.32    2.4    1.29s
  6   -2.317263278721       -9.81       -5.02    2.6    1.05s
  7   -2.317263278726      -11.31       -5.82    2.7    1.12s
  8   -2.317263278726      -12.77       -6.56    2.7    1.32s
  9   -2.317263278726      -14.35       -7.00    2.9    1.11s
 10   -2.317263278726   +    -Inf       -7.64    2.2    1.20s
     1    -2.317263e+00     4.159103e-04
 * time: 53.90612292289734
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317170687370                   -1.46    5.5    2.05s
  2   -2.317247789486       -4.11       -1.84    1.3    758ms
  3   -2.317265198698       -4.76       -3.57    3.2    1.56s
  4   -2.317265400369       -6.70       -4.00    4.6    1.67s
  5   -2.317265401003       -9.20       -4.28    2.4    1.62s
  6   -2.317265401202       -9.70       -4.96    2.7    1.45s
  7   -2.317265401208      -11.22       -5.67    2.5    1.42s
  8   -2.317265401209      -12.57       -6.29    2.7    1.12s
  9   -2.317265401209      -14.05       -6.79    2.5    1.02s
 10   -2.317265401209      -15.35       -7.32    2.2    1.25s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317174381726                   -1.46    5.6    2.08s
  2   -2.317248525429       -4.13       -1.84    1.4    786ms
  3   -2.317265158193       -4.78       -3.57    3.3    1.55s
  4   -2.317265400399       -6.62       -4.01    4.5    1.69s
  5   -2.317265401007       -9.22       -4.28    2.3    1.33s
  6   -2.317265401202       -9.71       -4.97    2.7    1.29s
  7   -2.317265401208      -11.21       -5.68    2.5    1.54s
  8   -2.317265401209      -12.58       -6.50    2.7    1.23s
  9   -2.317265401209      -14.15       -6.77    2.8    1.26s
 10   -2.317265401209      -15.35       -7.25    2.0    1.19s
     2    -2.317265e+00     4.179634e-06
 * time: 111.05911684036255
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317170846694                   -1.46    5.6    2.14s
  2   -2.317248050398       -4.11       -1.84    1.4    1.11s
  3   -2.317265199902       -4.77       -3.58    3.2    1.69s
  4   -2.317265400646       -6.70       -4.02    4.6    1.62s
  5   -2.317265401234       -9.23       -4.29    2.5    1.29s
  6   -2.317265401419       -9.73       -4.97    2.8    1.08s
┌ Warning: Eigensolver not converged
│   n_iter =
│    195-element Vector{Int64}:
│     6
│     3
│     5
│     5
│     ⋮
│     2
│     2
│     3
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/scf/self_consistent_field.jl:76
  7   -2.317265401425      -11.22       -5.68    2.5    1.40s
  8   -2.317265401426      -12.64       -6.11    2.9    1.15s
  9   -2.317265401426      -13.75       -6.86    2.1    939ms
 10   -2.317265401426      -14.57       -7.31    2.7    1.36s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317171586366                   -1.46    5.6    2.09s
  2   -2.317248349484       -4.11       -1.84    1.4    772ms
  3   -2.317265208294       -4.77       -3.57    3.3    1.51s
  4   -2.317265400586       -6.72       -4.00    4.6    1.69s
  5   -2.317265401214       -9.20       -4.27    2.4    1.25s
  6   -2.317265401419       -9.69       -4.96    2.7    1.04s
  7   -2.317265401425      -11.20       -5.67    2.5    1.28s
  8   -2.317265401426      -12.56       -6.36    2.7    1.05s
  9   -2.317265401426      -14.10       -6.76    2.4    992ms
 10   -2.317265401426      -14.65       -7.32    2.2    1.23s
     3    -2.317265e+00     3.269895e-08
 * time: 166.87753987312317
 * Status: success

 * Candidate solution
    Final objective value:     -2.317265e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.03e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.35e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.17e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 9.36e-11 ≰ 0.0e+00
    |g(x)|                 = 3.27e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   167  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Al: 199.549344 seconds (165.31 M allocations: 39.352 GiB, 6.53% gc time, 0.04% compilation time)
┌ Info: 2025-05-12T16:05:34.812
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77437133340                   -0.87    9.6    8.98s
  2   -73.78535768087       -1.96       -1.07    5.2    5.27s
  3   -73.79172052075       -2.20       -1.41    6.7    6.92s
  4   -73.79277069576       -2.98       -1.77    5.8    5.87s
  5   -73.79292663648       -3.81       -2.23    4.9    5.28s
  6   -73.79294798304       -4.67       -3.07    5.4    5.92s
  7   -73.79294799993       -7.77       -3.51    5.0    5.73s
  8   -73.79294800581       -8.23       -4.07    4.6    5.01s
  9   -73.79294800566   +   -9.82       -4.40    5.7    5.78s
 10   -73.79294800636       -9.15       -4.77    5.6    5.71s
 11   -73.79294800638      -10.62       -5.53    4.4    4.96s
 12   -73.79294800638      -12.18       -6.38    4.7    5.40s
 13   -73.79294800638   +  -13.85       -6.58    4.5    5.70s
 14   -73.79294800638   +  -13.07       -6.90    4.9    5.18s
 15   -73.79294800638   +  -12.89       -7.68    5.2    5.44s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.379295e+01     9.074066e-03
 * time: 3.409385681152344e-5
┌ Warning: Negative ρcore detected: -3.386318861077984e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77461741995                   -0.87    9.7    9.41s
  2   -73.78547680886       -1.96       -1.07    5.2    5.48s
  3   -73.79180351456       -2.20       -1.41    6.8    7.23s
  4   -73.79284946603       -2.98       -1.77    5.9    5.90s
  5   -73.79300302091       -3.81       -2.24    5.1    5.46s
  6   -73.79302415206       -4.68       -3.07    5.5    6.00s
  7   -73.79302416837       -7.79       -3.52    5.1    5.64s
  8   -73.79302417485       -8.19       -4.06    4.8    5.47s
  9   -73.79302417469   +   -9.80       -4.42    5.7    5.99s
 10   -73.79302417542       -9.13       -4.79    5.7    5.85s
 11   -73.79302417545      -10.54       -5.50    4.7    5.23s
 12   -73.79302417545      -11.73       -6.34    4.8    5.58s
 13   -73.79302417545   +  -13.85       -6.56    4.8    5.44s
 14   -73.79302417545      -13.37       -6.91    5.0    5.24s
 15   -73.79302417545   +  -13.25       -7.64    5.2    5.41s
┌ Warning: Negative ρcore detected: -3.386318861077984e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77461287678                   -0.87    9.8    10.0s
  2   -73.78546756743       -1.96       -1.07    5.3    5.82s
  3   -73.79180573405       -2.20       -1.41    6.7    7.23s
  4   -73.79284911951       -2.98       -1.77    5.9    6.01s
  5   -73.79300289150       -3.81       -2.23    5.0    5.74s
  6   -73.79302415144       -4.67       -3.07    5.5    6.81s
  7   -73.79302416897       -7.76       -3.52    5.1    6.20s
  8   -73.79302417497       -8.22       -4.08    4.8    5.34s
  9   -73.79302417471   +   -9.59       -4.43    5.7    6.01s
 10   -73.79302417542       -9.15       -4.79    5.7    5.77s
 11   -73.79302417545      -10.52       -5.52    4.8    5.83s
 12   -73.79302417545      -11.73       -6.35    4.7    5.85s
 13   -73.79302417545   +  -13.15       -6.55    4.8    6.12s
 14   -73.79302417545   +    -Inf       -6.91    5.1    5.23s
 15   -73.79302417545   +  -13.37       -7.64    5.2    5.50s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.386318861077984e-8,-5.164241104485039e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.379302e+01     7.709445e-03
 * time: 243.64195013046265
┌ Warning: Negative ρcore detected: -3.0985009934879054e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77588005268                   -0.88    9.8    9.70s
  2   -73.78605915709       -1.99       -1.08    5.3    6.00s
  3   -73.79202101942       -2.22       -1.42    6.8    7.10s
  4   -73.79306714895       -2.98       -1.80    5.8    5.96s
  5   -73.79319914384       -3.88       -2.30    5.1    5.47s
  6   -73.79321481783       -4.80       -3.09    5.6    6.09s
  7   -73.79321483444       -7.78       -3.54    4.4    5.13s
  8   -73.79321486049       -7.58       -3.96    5.3    5.57s
  9   -73.79321486053      -10.36       -4.31    5.6    5.96s
 10   -73.79321486289       -8.63       -4.80    5.4    5.83s
 11   -73.79321486294      -10.26       -5.35    5.2    6.02s
 12   -73.79321486296      -10.87       -6.13    5.0    5.59s
 13   -73.79321486296      -12.57       -6.39    5.3    5.76s
 14   -73.79321486296      -13.55       -6.89    5.1    5.28s
 15   -73.79321486296      -13.55       -7.77    5.1    6.10s
┌ Warning: Negative ρcore detected: -3.0985009934879054e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77586875378                   -0.88    9.8    9.54s
  2   -73.78607700752       -1.99       -1.08    5.2    5.97s
  3   -73.79202018544       -2.23       -1.42    6.7    7.04s
  4   -73.79306679169       -2.98       -1.80    5.9    5.95s
  5   -73.79319891534       -3.88       -2.30    5.0    5.66s
  6   -73.79321481519       -4.80       -3.09    5.6    6.33s
  7   -73.79321483453       -7.71       -3.55    4.3    5.09s
  8   -73.79321486060       -7.58       -3.97    5.3    5.60s
  9   -73.79321486048   +   -9.92       -4.31    5.6    6.40s
 10   -73.79321486290       -8.62       -4.81    5.5    6.32s
 11   -73.79321486294      -10.34       -5.35    5.1    5.73s
 12   -73.79321486296      -10.88       -6.14    5.1    5.65s
 13   -73.79321486296      -12.55       -6.42    5.3    6.31s
 14   -73.79321486296   +  -13.15       -6.91    5.1    5.33s
 15   -73.79321486296      -13.00       -7.75    5.1    5.42s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0985009934879054e-8,-6.374233319323976e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.379321e+01     3.727329e-04
 * time: 487.4650950431824
┌ Warning: Negative ρcore detected: -3.1123068291113374e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77581458064                   -0.88    9.5    8.88s
  2   -73.78604653120       -1.99       -1.08    5.1    5.54s
  3   -73.79201995909       -2.22       -1.42    6.5    7.12s
  4   -73.79306655185       -2.98       -1.80    5.7    5.73s
  5   -73.79319905235       -3.88       -2.29    4.9    5.82s
  6   -73.79321523778       -4.79       -3.09    5.5    5.92s
  7   -73.79321526192       -7.62       -3.54    4.1    4.88s
  8   -73.79321528536       -7.63       -3.96    5.3    5.49s
  9   -73.79321528501   +   -9.46       -4.32    5.5    6.11s
 10   -73.79321528731       -8.64       -4.80    5.4    5.66s
 11   -73.79321528736      -10.27       -5.36    5.0    5.58s
 12   -73.79321528737      -10.93       -6.15    4.9    5.46s
 13   -73.79321528737      -12.85       -6.40    5.2    5.66s
 14   -73.79321528737      -12.81       -6.92    5.1    5.19s
 15   -73.79321528737   +  -13.37       -7.75    5.0    5.35s
┌ Warning: Negative ρcore detected: -3.1123068291113374e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77582229836                   -0.88    9.5    9.20s
  2   -73.78605246172       -1.99       -1.08    5.1    5.40s
  3   -73.79201899487       -2.22       -1.42    6.7    6.99s
  4   -73.79306661123       -2.98       -1.80    5.7    5.82s
  5   -73.79319906595       -3.88       -2.29    4.9    5.41s
  6   -73.79321524151       -4.79       -3.10    5.6    6.18s
  7   -73.79321525989       -7.74       -3.54    4.1    5.04s
  8   -73.79321528495       -7.60       -3.96    5.3    5.83s
  9   -73.79321528488   +  -10.22       -4.31    5.4    5.89s
 10   -73.79321528731       -8.62       -4.80    5.4    5.84s
 11   -73.79321528736      -10.29       -5.34    5.0    5.61s
 12   -73.79321528737      -10.88       -6.13    4.9    5.43s
 13   -73.79321528737      -12.50       -6.43    5.1    5.61s
 14   -73.79321528737      -13.55       -6.90    5.0    5.26s
 15   -73.79321528737      -13.25       -7.73    5.0    5.48s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1123068291113374e-8,-5.307916563287572e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.379322e+01     1.337077e-05
 * time: 725.8383450508118
┌ Warning: Negative ρcore detected: -3.1118707547033854e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77581320190                   -0.88    9.5    8.96s
  2   -73.78605064714       -1.99       -1.08    5.2    5.40s
  3   -73.79201893079       -2.22       -1.42    6.6    6.84s
  4   -73.79306702629       -2.98       -1.80    5.8    6.06s
  5   -73.79319930608       -3.88       -2.30    4.9    5.52s
  6   -73.79321524230       -4.80       -3.09    5.5    6.31s
  7   -73.79321526092       -7.73       -3.55    4.3    5.16s
  8   -73.79321528574       -7.61       -3.96    5.3    5.70s
  9   -73.79321528548   +   -9.59       -4.31    5.4    5.98s
 10   -73.79321528786       -8.62       -4.81    5.4    5.92s
 11   -73.79321528791      -10.29       -5.36    5.0    5.87s
 12   -73.79321528793      -10.91       -6.16    4.9    5.46s
 13   -73.79321528793      -12.55       -6.38    5.2    5.59s
 14   -73.79321528793   +    -Inf       -6.90    5.0    5.28s
 15   -73.79321528793   +  -13.85       -7.73    5.1    5.65s
┌ Warning: Negative ρcore detected: -3.1118707547033854e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.77581948624                   -0.88    9.5    9.78s
  2   -73.78604919304       -1.99       -1.08    5.2    5.44s
  3   -73.79202052519       -2.22       -1.42    6.6    6.97s
  4   -73.79306599134       -2.98       -1.80    5.8    6.02s
  5   -73.79319921113       -3.88       -2.30    4.9    5.48s
  6   -73.79321524255       -4.80       -3.09    5.5    6.19s
  7   -73.79321526089       -7.74       -3.55    4.1    5.64s
  8   -73.79321528568       -7.61       -3.97    5.3    6.15s
  9   -73.79321528551   +   -9.78       -4.32    5.5    6.91s
 10   -73.79321528787       -8.63       -4.81    5.4    6.17s
 11   -73.79321528791      -10.34       -5.35    5.0    5.81s
 12   -73.79321528793      -10.88       -6.15    4.9    6.52s
 13   -73.79321528793      -12.70       -6.41    5.2    5.69s
 14   -73.79321528793   +  -13.55       -6.90    5.0    5.50s
 15   -73.79321528793      -13.25       -7.74    5.0    5.73s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1118707547033854e-8,-5.3445380499429686e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     4    -7.379322e+01     2.280335e-08
 * time: 970.6591579914093
 * Status: success

 * Candidate solution
    Final objective value:     -7.379322e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 8.19e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.45e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 5.53e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 7.49e-12 ≰ 0.0e+00
    |g(x)|                 = 2.28e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   971  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

V: 1099.589722 seconds (758.77 M allocations: 365.843 GiB, 6.02% gc time, 0.01% compilation time)
