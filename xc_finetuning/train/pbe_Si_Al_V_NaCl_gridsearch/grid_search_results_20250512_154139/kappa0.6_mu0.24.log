┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-12T16:16:09.263
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465885357136                   -0.96    7.0    11.5s
  2   -8.467771458117       -2.72       -1.73    2.0    4.91s
  3   -8.467831148208       -4.22       -2.77    3.8    1.97s
  4   -8.467832235908       -5.96       -3.87    4.2    2.13s
  5   -8.467832242826       -8.16       -4.49    4.5    2.55s
  6   -8.467832243167       -9.47       -5.51    4.2    1.86s
  7   -8.467832243173      -11.26       -6.18    4.3    1.73s
  8   -8.467832243173      -12.75       -7.60    3.7    1.83s
Iter     Function value   Gradient norm 
     0    -8.467832e+00     8.378419e-04
 * time: 4.601478576660156e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465890614675                   -0.96    7.1    2.54s
  2   -8.467775186660       -2.72       -1.74    2.0    1.10s
  3   -8.467832115861       -4.24       -2.77    3.8    1.88s
  4   -8.467832912911       -6.10       -3.88    4.2    1.67s
  5   -8.467832920421       -8.12       -4.46    4.4    1.99s
  6   -8.467832920799       -9.42       -5.50    4.4    1.60s
  7   -8.467832920805      -11.25       -6.16    4.3    1.99s
  8   -8.467832920805      -12.70       -7.66    3.8    1.54s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465895489829                   -0.96    7.1    2.53s
  2   -8.467774920340       -2.73       -1.74    2.2    1.17s
  3   -8.467832170593       -4.24       -2.77    3.7    1.88s
  4   -8.467832912248       -6.13       -3.89    4.3    1.68s
  5   -8.467832920390       -8.09       -4.45    4.4    2.06s
  6   -8.467832920799       -9.39       -5.50    4.3    1.56s
  7   -8.467832920804      -11.24       -6.14    4.3    2.00s
  8   -8.467832920805      -12.65       -7.73    3.8    1.55s
     1    -8.467833e+00     7.797193e-04
 * time: 43.008485078811646
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465871196509                   -0.96    7.5    2.66s
  2   -8.467778979205       -2.72       -1.74    2.1    1.40s
  3   -8.467836554631       -4.24       -2.77    4.0    1.62s
  4   -8.467837278217       -6.14       -3.89    4.5    1.96s
  5   -8.467837284946       -8.17       -4.47    4.7    1.80s
  6   -8.467837285297       -9.45       -5.50    4.4    1.83s
  7   -8.467837285303      -11.22       -6.17    4.5    1.74s
  8   -8.467837285304      -12.67       -7.83    3.8    1.82s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465858712933                   -0.96    7.5    2.63s
  2   -8.467775597857       -2.72       -1.74    2.2    1.46s
  3   -8.467836323191       -4.22       -2.77    3.9    1.65s
  4   -8.467837278358       -6.02       -3.88    4.5    2.03s
  5   -8.467837284965       -8.18       -4.48    4.5    1.79s
  6   -8.467837285298       -9.48       -5.50    4.4    1.91s
  7   -8.467837285303      -11.27       -6.16    4.3    1.85s
  8   -8.467837285304      -12.69       -7.60    3.9    1.90s
     2    -8.467837e+00     4.498437e-06
 * time: 85.3924732208252
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465864980488                   -0.96    7.5    2.66s
  2   -8.467773805540       -2.72       -1.74    2.2    1.17s
  3   -8.467836361631       -4.20       -2.77    3.9    2.33s
  4   -8.467837277383       -6.04       -3.91    4.3    2.30s
  5   -8.467837285064       -8.11       -4.46    4.6    1.82s
  6   -8.467837285441       -9.42       -5.46    4.2    2.12s
  7   -8.467837285448      -11.18       -6.15    4.5    1.87s
  8   -8.467837285448      -12.59       -7.81    4.1    2.16s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465860399517                   -0.96    7.5    2.55s
  2   -8.467775784510       -2.72       -1.74    2.4    1.41s
  3   -8.467836465853       -4.22       -2.76    3.8    1.56s
  4   -8.467837277422       -6.09       -3.88    4.4    1.93s
  5   -8.467837285073       -8.12       -4.46    4.6    1.76s
  6   -8.467837285442       -9.43       -5.48    4.3    1.81s
  7   -8.467837285448      -11.23       -6.17    4.5    1.71s
  8   -8.467837285448      -12.69       -7.68    4.0    1.85s
     3    -8.467837e+00     2.308321e-08
 * time: 128.39944410324097
 * Status: success

 * Candidate solution
    Final objective value:     -8.467837e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 6.45e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 6.24e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.45e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.71e-11 ≰ 0.0e+00
    |g(x)|                 = 2.31e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   128  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 204.096900 seconds (309.39 M allocations: 59.290 GiB, 7.48% gc time, 25.48% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-12T16:19:34.019
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.24222536645                   -1.17    8.5    18.2s
  2   -62.24630710669       -2.39       -1.21    2.9    8.13s
  3   -62.25082935825       -2.34       -2.06    4.2    9.83s
  4   -62.25085966070       -4.52       -2.92    3.8    9.39s
  5   -62.25086020815       -6.26       -3.65    4.0    10.4s
  6   -62.25086021770       -8.02       -4.46    3.8    9.64s
  7   -62.25086021804       -9.48       -5.31    3.9    10.0s
  8   -62.25086021805      -11.03       -6.60    4.0    10.4s
  9   -62.25086021805      -13.37       -7.87    4.3    10.8s
Iter     Function value   Gradient norm 
     0    -6.225086e+01     2.309136e-03
 * time: 3.600120544433594e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.24222744683                   -1.17    8.6    17.1s
  2   -62.24631795379       -2.39       -1.21    2.8    8.19s
  3   -62.25083439905       -2.35       -2.06    4.2    9.84s
  4   -62.25086491355       -4.52       -2.90    3.8    10.7s
  5   -62.25086548831       -6.24       -3.63    4.1    10.2s
  6   -62.25086549869       -7.98       -4.43    3.9    10.5s
  7   -62.25086549902       -9.47       -5.24    4.0    10.5s
  8   -62.25086549904      -10.97       -6.58    4.1    10.4s
  9   -62.25086549904   +    -Inf       -7.83    4.3    11.2s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.24223048544                   -1.17    8.6    16.0s
  2   -62.24630128594       -2.39       -1.21    2.7    7.29s
  3   -62.25083472783       -2.34       -2.06    4.0    10.6s
  4   -62.25086494989       -4.52       -2.92    3.8    9.55s
  5   -62.25086548936       -6.27       -3.66    4.1    10.8s
  6   -62.25086549871       -8.03       -4.48    3.8    9.32s
  7   -62.25086549902       -9.51       -5.20    4.0    10.0s
  8   -62.25086549904      -10.79       -6.69    3.9    9.78s
  9   -62.25086549904   +  -13.25       -7.84    4.4    11.5s
     1    -6.225087e+01     2.264840e-03
 * time: 223.0353319644928
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.24271973747                   -1.17    8.4    16.3s
  2   -62.24680040654       -2.39       -1.23    2.7    7.34s
  3   -62.25096648102       -2.38       -2.08    4.1    10.3s
  4   -62.25099300583       -4.58       -2.98    3.8    9.89s
  5   -62.25099339098       -6.41       -3.72    4.0    10.1s
  6   -62.25099339785       -8.16       -4.53    3.7    9.57s
  7   -62.25099339807       -9.65       -5.18    4.0    10.3s
  8   -62.25099339809      -10.82       -6.71    3.8    9.56s
  9   -62.25099339809      -13.30       -7.85    4.4    11.0s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.24272129492                   -1.17    8.4    16.6s
  2   -62.24681004229       -2.39       -1.23    2.8    7.24s
  3   -62.25096619472       -2.38       -2.08    4.1    9.62s
  4   -62.25099298764       -4.57       -2.96    3.8    9.47s
  5   -62.25099339034       -6.40       -3.69    4.0    10.5s
  6   -62.25099339785       -8.12       -4.49    3.8    9.63s
  7   -62.25099339808       -9.65       -5.21    3.9    10.0s
  8   -62.25099339809      -10.97       -6.81    4.0    10.2s
  9   -62.25099339809      -13.00       -7.84    4.6    11.4s
     2    -6.225099e+01     1.474240e-04
 * time: 444.0271039009094
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.24269526204                   -1.17    8.3    16.7s
  2   -62.24680160609       -2.39       -1.23    2.6    7.06s
  3   -62.25096628764       -2.38       -2.08    4.0    9.57s
  4   -62.25099344822       -4.57       -2.93    3.7    9.26s
  5   -62.25099388920       -6.36       -3.65    4.0    10.2s
  6   -62.25099389799       -8.06       -4.43    3.9    9.79s
  7   -62.25099389826       -9.56       -5.19    4.0    10.0s
  8   -62.25099389827      -11.01       -6.80    4.1    10.4s
  9   -62.25099389827      -12.92       -7.81    4.5    11.2s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.24269315763                   -1.17    8.3    16.1s
  2   -62.24679861646       -2.39       -1.23    2.6    7.30s
  3   -62.25096607478       -2.38       -2.08    4.1    9.66s
  4   -62.25099342740       -4.56       -2.92    3.7    10.0s
  5   -62.25099388889       -6.34       -3.64    4.0    10.1s
  6   -62.25099389799       -8.04       -4.42    3.9    9.72s
  7   -62.25099389826       -9.57       -5.11    3.9    10.3s
  8   -62.25099389827      -10.89       -6.86    3.9    10.2s
  9   -62.25099389827   +  -13.67       -7.81    4.6    11.5s
     3    -6.225099e+01     8.590531e-06
 * time: 666.9862468242645
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.24269547356                   -1.17    8.7    17.3s
  2   -62.24679617887       -2.39       -1.23    2.8    7.52s
  3   -62.25096626434       -2.38       -2.08    4.2    10.1s
  4   -62.25099345869       -4.57       -2.94    3.8    9.41s
  5   -62.25099389153       -6.36       -3.66    4.1    10.0s
  6   -62.25099389972       -8.09       -4.45    3.9    10.0s
  7   -62.25099389997       -9.60       -5.16    4.0    10.1s
  8   -62.25099389998      -10.95       -6.73    4.0    10.4s
  9   -62.25099389998   +  -13.45       -7.86    4.6    12.0s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.24269279686                   -1.17    8.8    17.0s
  2   -62.24679581637       -2.39       -1.23    3.0    7.71s
  3   -62.25096623823       -2.38       -2.08    4.1    10.2s
  4   -62.25099342301       -4.57       -2.92    3.8    9.79s
  5   -62.25099389080       -6.33       -3.64    4.1    10.1s
  6   -62.25099389970       -8.05       -4.43    4.0    10.3s
  7   -62.25099389997       -9.57       -5.12    4.1    10.3s
  8   -62.25099389998      -10.88       -6.81    4.0    10.3s
  9   -62.25099389998      -13.30       -7.88    4.5    11.9s
     4    -6.225099e+01     2.716623e-08
 * time: 894.0361909866333
 * Status: success

 * Candidate solution
    Final objective value:     -6.225099e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.97e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.74e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.71e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.75e-11 ≰ 0.0e+00
    |g(x)|                 = 2.72e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   894  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

NaCl: 1015.462073 seconds (1.01 G allocations: 291.072 GiB, 5.19% gc time, 0.30% compilation time)
┌ Info: 2025-05-12T16:36:29.508
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318292179167                   -1.47    5.5    1.80s
  2   -2.318367249126       -4.12       -1.84    1.3    1.10s
  3   -2.318382896587       -4.81       -3.57    3.2    1.31s
  4   -2.318383076595       -6.74       -3.97    4.5    2.01s
  5   -2.318383077130       -9.27       -4.20    2.2    953ms
  6   -2.318383077335       -9.69       -5.05    2.6    1.10s
  7   -2.318383077344      -11.05       -5.75    3.0    1.48s
  8   -2.318383077344      -12.59       -6.30    2.8    1.13s
  9   -2.318383077344      -13.72       -6.70    2.8    1.48s
 10   -2.318383077344      -14.57       -7.49    2.5    1.02s
Iter     Function value   Gradient norm 
     0    -2.318383e+00     1.715268e-04
 * time: 3.1948089599609375e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318296506024                   -1.47    5.6    2.09s
  2   -2.318367232448       -4.15       -1.84    1.5    1.09s
  3   -2.318382903046       -4.80       -3.55    3.2    1.23s
  4   -2.318383105385       -6.69       -3.96    4.6    1.92s
  5   -2.318383105928       -9.27       -4.18    2.3    1.03s
  6   -2.318383106146       -9.66       -5.01    2.7    1.36s
  7   -2.318383106155      -11.04       -5.75    3.1    1.18s
  8   -2.318383106155      -12.53       -6.32    2.8    1.17s
  9   -2.318383106155      -13.73       -6.68    3.1    1.45s
 10   -2.318383106155      -14.65       -7.48    2.5    1.02s
┌ Warning: Eigensolver not converged
│   n_iter =
│    195-element Vector{Int64}:
│     28
│      6
│      6
│      6
│      ⋮
│     10
│      2
│      8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/scf/self_consistent_field.jl:76
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318298118771                   -1.47    5.6    2.00s
  2   -2.318367593171       -4.16       -1.84    1.4    1.13s
  3   -2.318382909842       -4.81       -3.55    3.2    1.32s
  4   -2.318383105349       -6.71       -3.96    4.6    2.05s
  5   -2.318383105921       -9.24       -4.18    2.3    1.03s
  6   -2.318383106145       -9.65       -5.00    2.7    1.44s
  7   -2.318383106155      -11.00       -5.73    3.0    1.20s
  8   -2.318383106155      -12.46       -6.30    2.7    1.17s
  9   -2.318383106155      -13.69       -6.67    3.1    1.56s
 10   -2.318383106155   +  -15.35       -7.47    2.4    1.06s
     1    -2.318383e+00     1.644173e-04
 * time: 57.5759060382843
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318298340246                   -1.47    5.6    1.87s
  2   -2.318368078221       -4.16       -1.84    1.4    1.08s
  3   -2.318383240733       -4.82       -3.55    3.3    1.32s
  4   -2.318383430406       -6.72       -3.98    4.5    1.99s
  5   -2.318383430948       -9.27       -4.21    2.2    1.00s
  6   -2.318383431145       -9.71       -5.01    2.7    1.47s
  7   -2.318383431153      -11.08       -5.82    2.9    1.30s
  8   -2.318383431153      -12.53       -6.41    2.9    1.78s
  9   -2.318383431153      -13.94       -6.81    3.1    1.54s
 10   -2.318383431153      -15.05       -7.48    2.5    1.36s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.318298432416                   -1.47    5.7    2.21s
  2   -2.318368584209       -4.15       -1.84    1.3    981ms
  3   -2.318383242437       -4.83       -3.55    3.3    2.08s
  4   -2.318383430389       -6.73       -3.97    4.6    1.86s
  5   -2.318383430945       -9.26       -4.21    2.2    1.59s
  6   -2.318383431144       -9.70       -5.01    2.6    1.38s
  7   -2.318383431153      -11.03       -5.78    3.0    1.94s
  8   -2.318383431153      -12.57       -6.44    2.8    1.30s
  9   -2.318383431153      -14.27       -6.73    2.9    1.62s
 10   -2.318383431153      -14.75       -7.51    2.2    1.16s
     2    -2.318383e+00     8.207166e-07
 * time: 120.21332216262817
 * Status: success

 * Candidate solution
    Final objective value:     -2.318383e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.97e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 5.19e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 3.25e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.40e-07 ≰ 0.0e+00
    |g(x)|                 = 8.21e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   120  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Al: 154.173525 seconds (121.32 M allocations: 29.170 GiB, 6.77% gc time, 0.06% compilation time)
┌ Info: 2025-05-12T16:39:03.682
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80891707879                   -0.88    9.7    10.0s
  2   -73.81895338012       -2.00       -1.08    5.2    5.74s
  3   -73.82499347853       -2.22       -1.43    6.6    7.46s
  4   -73.82597094460       -3.01       -1.78    5.7    6.25s
  5   -73.82611624807       -3.84       -2.24    5.0    5.82s
  6   -73.82613734503       -4.68       -3.07    5.4    6.61s
  7   -73.82613736101       -7.80       -3.52    5.0    5.84s
  8   -73.82613736748       -8.19       -4.04    4.8    5.43s
  9   -73.82613736743   +  -10.25       -4.41    5.7    6.20s
 10   -73.82613736816       -9.14       -4.74    5.6    6.00s
 11   -73.82613736819      -10.48       -5.48    4.5    5.24s
 12   -73.82613736819      -11.62       -6.25    4.6    5.54s
 13   -73.82613736819   +    -Inf       -6.40    4.6    5.51s
 14   -73.82613736819   +  -12.43       -6.86    5.3    5.53s
 15   -73.82613736819   +  -12.67       -7.67    5.0    5.48s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.382614e+01     7.627170e-03
 * time: 3.2901763916015625e-5
┌ Warning: Negative ρcore detected: -3.3933253576030064e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80910567222                   -0.89    9.7    9.71s
  2   -73.81908267407       -2.00       -1.08    5.2    5.59s
  3   -73.82504600626       -2.22       -1.43    6.7    7.10s
  4   -73.82602920022       -3.01       -1.79    5.8    5.84s
  5   -73.82617044624       -3.85       -2.24    4.9    5.42s
  6   -73.82619113631       -4.68       -3.08    5.6    6.15s
  7   -73.82619115523       -7.72       -3.53    4.5    5.59s
  8   -73.82619116245       -8.14       -4.03    4.9    5.46s
  9   -73.82619116215   +   -9.53       -4.47    5.6    6.03s
 10   -73.82619116288       -9.13       -4.79    5.6    5.69s
 11   -73.82619116293      -10.36       -5.46    5.0    5.42s
 12   -73.82619116293      -11.49       -6.20    4.7    5.53s
 13   -73.82619116293      -13.85       -6.35    4.8    5.88s
 14   -73.82619116293      -12.77       -6.87    5.4    5.50s
 15   -73.82619116293      -13.25       -7.82    4.9    5.47s
┌ Warning: Negative ρcore detected: -3.3933253576030064e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80911365040                   -0.89    9.7    9.52s
  2   -73.81907660916       -2.00       -1.08    5.2    5.51s
  3   -73.82504690785       -2.22       -1.43    6.7    7.16s
  4   -73.82602883467       -3.01       -1.79    5.8    5.99s
  5   -73.82617089263       -3.85       -2.25    5.0    5.39s
  6   -73.82619113797       -4.69       -3.08    5.5    6.32s
  7   -73.82619115536       -7.76       -3.53    4.6    5.43s
  8   -73.82619116243       -8.15       -4.03    4.9    6.32s
  9   -73.82619116205   +   -9.41       -4.45    5.7    6.88s
 10   -73.82619116288       -9.08       -4.77    5.7    6.12s
 11   -73.82619116293      -10.37       -5.45    4.9    5.33s
 12   -73.82619116293      -11.42       -6.21    4.7    5.34s
 13   -73.82619116293      -12.94       -6.34    4.8    5.56s
 14   -73.82619116293      -12.77       -6.89    5.3    6.57s
 15   -73.82619116293   +  -13.25       -7.74    5.0    6.12s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.3933253576030064e-8,-4.521677055352599e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.382619e+01     6.474943e-03
 * time: 245.44422793388367
┌ Warning: Negative ρcore detected: -3.1397406949557534e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.81002020991                   -0.89    9.7    9.85s
  2   -73.81956272729       -2.02       -1.09    5.2    5.57s
  3   -73.82520633762       -2.25       -1.43    6.6    6.63s
  4   -73.82618662265       -3.01       -1.81    5.8    5.76s
  5   -73.82631050701       -3.91       -2.30    4.9    5.28s
  6   -73.82632587607       -4.81       -3.10    5.6    5.86s
  7   -73.82632589059       -7.84       -3.54    4.4    5.13s
  8   -73.82632592161       -7.51       -3.97    5.3    5.68s
  9   -73.82632592161   +  -11.70       -4.30    5.6    5.91s
 10   -73.82632592418       -8.59       -4.83    5.5    5.71s
 11   -73.82632592421      -10.54       -5.33    5.0    5.43s
 12   -73.82632592423      -10.82       -6.08    5.1    6.05s
 13   -73.82632592423      -12.36       -6.41    5.4    6.24s
 14   -73.82632592423      -13.00       -6.87    4.8    5.27s
 15   -73.82632592423      -13.07       -7.83    5.1    6.19s
┌ Warning: Negative ρcore detected: -3.1397406949557534e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.81000601986                   -0.89    9.7    10.0s
  2   -73.81956588920       -2.02       -1.09    5.3    5.98s
  3   -73.82520748689       -2.25       -1.43    6.8    7.06s
  4   -73.82618633602       -3.01       -1.81    5.8    5.95s
  5   -73.82630997884       -3.91       -2.30    4.9    5.61s
  6   -73.82632587075       -4.80       -3.10    5.7    6.62s
  7   -73.82632588832       -7.76       -3.53    4.3    5.57s
  8   -73.82632592133       -7.48       -3.96    5.3    5.82s
  9   -73.82632592154       -9.68       -4.30    5.6    5.83s
 10   -73.82632592417       -8.58       -4.83    5.5    5.66s
 11   -73.82632592421      -10.41       -5.34    5.0    5.69s
 12   -73.82632592423      -10.85       -6.06    4.9    6.58s
 13   -73.82632592423      -12.19       -6.38    5.4    5.77s
 14   -73.82632592423      -13.85       -6.87    4.9    5.24s
 15   -73.82632592423      -13.55       -7.79    5.0    5.48s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1397406949557534e-8,-2.0521928429852436e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.382633e+01     2.587250e-04
 * time: 490.17687797546387
┌ Warning: Negative ρcore detected: -3.1425496384815735e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80998608575                   -0.89    9.6    9.38s
  2   -73.81954783714       -2.02       -1.09    5.2    6.08s
  3   -73.82520515118       -2.25       -1.43    6.6    7.86s
  4   -73.82618662826       -3.01       -1.81    5.8    6.08s
  5   -73.82631008061       -3.91       -2.30    4.9    5.43s
  6   -73.82632608420       -4.80       -3.10    5.5    6.01s
  7   -73.82632609353       -8.03       -3.53    4.6    5.24s
  8   -73.82632612744       -7.47       -3.96    5.3    5.65s
  9   -73.82632612787       -9.36       -4.30    5.5    6.51s
 10   -73.82632613052       -8.58       -4.82    5.5    5.69s
 11   -73.82632613056      -10.40       -5.34    5.1    5.91s
 12   -73.82632613058      -10.85       -6.06    5.0    5.60s
 13   -73.82632613058      -12.26       -6.38    5.3    6.65s
 14   -73.82632613058      -13.25       -6.87    4.9    5.46s
 15   -73.82632613058      -13.07       -7.80    5.2    5.77s
┌ Warning: Negative ρcore detected: -3.1425496384815735e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80998478073                   -0.89    9.6    9.76s
  2   -73.81955010242       -2.02       -1.09    5.1    5.62s
  3   -73.82520452237       -2.25       -1.43    6.7    7.22s
  4   -73.82618657534       -3.01       -1.81    5.9    6.10s
  5   -73.82631052106       -3.91       -2.30    5.0    5.61s
  6   -73.82632608512       -4.81       -3.10    5.6    6.26s
  7   -73.82632609358       -8.07       -3.53    4.5    5.43s
  8   -73.82632612741       -7.47       -3.96    5.3    5.77s
  9   -73.82632612777       -9.44       -4.29    5.5    6.01s
 10   -73.82632613052       -8.56       -4.82    5.5    5.86s
 11   -73.82632613056      -10.41       -5.33    5.1    5.79s
 12   -73.82632613058      -10.83       -6.07    5.0    5.68s
 13   -73.82632613058      -12.21       -6.37    5.2    5.84s
 14   -73.82632613058      -13.15       -6.85    5.0    5.41s
 15   -73.82632613058   +    -Inf       -7.78    5.2    5.79s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1425496384815735e-8,-1.360625673601205e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.382633e+01     7.947383e-06
 * time: 738.3380200862885
┌ Warning: Negative ρcore detected: -3.1424823382049405e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80999326959                   -0.89    9.7    9.65s
  2   -73.81956034524       -2.02       -1.09    5.2    5.54s
  3   -73.82520283083       -2.25       -1.43    6.7    7.16s
  4   -73.82618628875       -3.01       -1.81    5.7    6.68s
  5   -73.82631010163       -3.91       -2.30    4.8    6.05s
  6   -73.82632608017       -4.80       -3.10    5.5    6.05s
  7   -73.82632609373       -7.87       -3.52    4.4    5.55s
  8   -73.82632612772       -7.47       -3.96    5.4    7.04s
  9   -73.82632612795       -9.64       -4.29    5.5    6.35s
 10   -73.82632613072       -8.56       -4.82    5.5    5.82s
 11   -73.82632613076      -10.44       -5.33    5.0    5.52s
 12   -73.82632613077      -10.84       -6.06    5.0    5.39s
 13   -73.82632613077      -12.25       -6.34    5.3    5.71s
 14   -73.82632613077      -13.25       -6.84    5.0    5.35s
 15   -73.82632613077      -13.25       -7.74    5.1    5.64s
┌ Warning: Negative ρcore detected: -3.1424823382049405e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80998754164                   -0.89    9.7    10.5s
  2   -73.81956248157       -2.02       -1.09    5.2    5.98s
  3   -73.82520240393       -2.25       -1.43    6.7    7.24s
  4   -73.82618668005       -3.01       -1.81    5.8    6.08s
  5   -73.82631027615       -3.91       -2.30    4.9    5.61s
  6   -73.82632607694       -4.80       -3.10    5.6    6.30s
  7   -73.82632609610       -7.72       -3.53    4.3    6.25s
  8   -73.82632612810       -7.49       -3.97    5.3    6.09s
  9   -73.82632612801   +  -10.06       -4.29    5.4    6.36s
 10   -73.82632613072       -8.57       -4.83    5.5    6.12s
 11   -73.82632613076      -10.43       -5.34    5.1    6.47s
 12   -73.82632613077      -10.86       -6.07    5.0    6.05s
 13   -73.82632613077      -12.30       -6.38    5.3    6.34s
 14   -73.82632613077      -12.94       -6.89    4.8    5.48s
 15   -73.82632613077      -13.37       -7.77    5.1    7.47s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.1424823382049405e-8,-1.381107003455206e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     4    -7.382633e+01     9.323232e-09
 * time: 993.052531003952
 * Status: success

 * Candidate solution
    Final objective value:     -7.382633e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 4.91e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 8.69e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.97e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.67e-12 ≰ 0.0e+00
    |g(x)|                 = 9.32e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   993  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

V: 1129.565016 seconds (761.13 M allocations: 367.308 GiB, 5.97% gc time, 0.01% compilation time)
