┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-12T16:24:05.681
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.447983350993                   -0.96    7.0    11.3s
  2   -8.449801864803       -2.74       -1.76    2.0    4.82s
  3   -8.449866681544       -4.19       -2.80    3.7    1.94s
  4   -8.449867829558       -5.94       -3.78    4.4    1.75s
  5   -8.449867843830       -7.85       -4.47    4.4    1.96s
  6   -8.449867844445       -9.21       -5.46    4.5    1.94s
  7   -8.449867844453      -11.08       -6.16    4.2    1.74s
  8   -8.449867844454      -12.80       -7.47    3.6    1.88s
Iter     Function value   Gradient norm 
     0    -8.449868e+00     2.767089e-03
 * time: 4.291534423828125e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.448004906841                   -0.96    7.3    2.66s
  2   -8.449814223452       -2.74       -1.76    2.0    1.42s
  3   -8.449874244330       -4.22       -2.80    3.9    1.64s
  4   -8.449875223860       -6.01       -3.79    4.5    2.06s
  5   -8.449875236794       -7.89       -4.48    4.6    1.97s
  6   -8.449875237381       -9.23       -5.49    4.8    2.10s
  7   -8.449875237388      -11.15       -6.19    4.4    1.72s
  8   -8.449875237388      -12.77       -7.49    3.6    1.78s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.447991639067                   -0.96    7.4    2.54s
  2   -8.449809180196       -2.74       -1.76    2.0    1.40s
  3   -8.449874263737       -4.19       -2.80    3.9    1.65s
  4   -8.449875222340       -6.02       -3.79    4.6    2.05s
  5   -8.449875236731       -7.84       -4.46    4.7    1.74s
  6   -8.449875237380       -9.19       -5.47    4.6    1.91s
  7   -8.449875237388      -11.12       -6.19    4.2    1.68s
  8   -8.449875237388      -12.81       -7.50    3.8    1.86s
     1    -8.449875e+00     2.576304e-03
 * time: 42.7978630065918
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.447976165575                   -0.96    7.3    2.86s
  2   -8.449854741878       -2.73       -1.76    2.2    1.35s
  3   -8.449921845078       -4.17       -2.79    4.0    1.95s
  4   -8.449922714022       -6.06       -3.79    4.5    2.10s
  5   -8.449922726541       -7.90       -4.48    4.7    1.81s
  6   -8.449922727128       -9.23       -5.47    4.6    2.09s
  7   -8.449922727134      -11.17       -6.21    4.1    1.77s
  8   -8.449922727135      -12.86       -7.51    3.8    2.24s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.447981780834                   -0.96    7.2    2.85s
  2   -8.449856310214       -2.73       -1.76    2.2    1.59s
  3   -8.449921711305       -4.18       -2.79    3.8    1.71s
  4   -8.449922714776       -6.00       -3.76    4.5    2.05s
  5   -8.449922726596       -7.93       -4.50    4.5    1.72s
  6   -8.449922727129       -9.27       -5.51    4.8    2.07s
  7   -8.449922727134      -11.23       -6.22    4.2    2.07s
  8   -8.449922727135      -12.97       -7.40    3.8    2.00s
     2    -8.449923e+00     5.003311e-05
 * time: 87.08448600769043
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.447978696573                   -0.96    7.0    2.49s
  2   -8.449856879837       -2.73       -1.76    2.1    1.14s
  3   -8.449921842137       -4.19       -2.79    3.8    2.04s
  4   -8.449922731036       -6.05       -3.77    4.4    1.75s
  5   -8.449922744086       -7.88       -4.50    4.3    2.04s
  6   -8.449922744625       -9.27       -5.50    4.7    1.72s
  7   -8.449922744630      -11.29       -6.25    4.2    2.07s
  8   -8.449922744630      -12.97       -7.42    3.7    1.50s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.447974174457                   -0.96    7.2    2.59s
  2   -8.449854132302       -2.73       -1.76    2.0    1.14s
  3   -8.449921705738       -4.17       -2.79    3.8    1.96s
  4   -8.449922732216       -5.99       -3.75    4.4    2.02s
  5   -8.449922744119       -7.92       -4.52    4.5    1.70s
  6   -8.449922744626       -9.30       -5.52    4.7    1.96s
  7   -8.449922744630      -11.35       -6.24    4.0    1.65s
  8   -8.449922744630      -12.89       -7.31    3.8    1.97s
     3    -8.449923e+00     8.788983e-07
 * time: 128.89635181427002
 * Status: success

 * Candidate solution
    Final objective value:     -8.449923e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 7.12e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 6.91e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.75e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.07e-09 ≰ 0.0e+00
    |g(x)|                 = 8.79e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   129  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 202.188664 seconds (307.86 M allocations: 58.853 GiB, 7.83% gc time, 25.13% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-12T16:27:28.519
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.14987707044                   -1.17    8.4    18.1s
  2   -62.15401582816       -2.38       -1.23    2.5    7.77s
  3   -62.15810644549       -2.39       -2.07    3.9    9.44s
  4   -62.15813604768       -4.53       -2.88    3.8    9.36s
  5   -62.15813663154       -6.23       -3.58    4.0    10.1s
  6   -62.15813665955       -7.55       -4.42    3.7    9.25s
  7   -62.15813665984       -9.53       -5.07    4.0    10.1s
  8   -62.15813665986      -10.85       -6.48    3.9    11.0s
  9   -62.15813665986   +  -14.15       -7.20    4.5    11.3s
Iter     Function value   Gradient norm 
     0    -6.215814e+01     1.488000e-03
 * time: 4.1961669921875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.14987990597                   -1.17    8.0    15.9s
  2   -62.15400846108       -2.38       -1.23    2.5    7.13s
  3   -62.15810894244       -2.39       -2.07    3.8    10.9s
  4   -62.15813818635       -4.53       -2.86    3.6    9.57s
  5   -62.15813882367       -6.20       -3.56    4.0    10.1s
  6   -62.15813885267       -7.54       -4.39    3.7    9.62s
  7   -62.15813885301       -9.48       -5.01    4.0    10.4s
  8   -62.15813885303      -10.73       -6.37    3.8    11.0s
  9   -62.15813885303      -13.37       -7.11    4.3    11.1s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.14987535179                   -1.17    8.0    16.0s
  2   -62.15402384580       -2.38       -1.23    2.5    6.88s
  3   -62.15810860496       -2.39       -2.07    3.9    9.43s
  4   -62.15813810925       -4.53       -2.83    3.6    9.69s
  5   -62.15813882142       -6.15       -3.53    3.9    10.0s
  6   -62.15813885260       -7.51       -4.34    3.9    9.86s
  7   -62.15813885301       -9.39       -5.03    3.9    10.5s
  8   -62.15813885303      -10.72       -6.44    4.0    10.3s
  9   -62.15813885303      -12.92       -7.06    4.4    11.3s
     1    -6.215814e+01     1.459784e-03
 * time: 220.56586289405823
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.15018285763                   -1.17    8.6    16.9s
  2   -62.15429879356       -2.39       -1.23    2.7    7.10s
  3   -62.15816611183       -2.41       -2.08    4.1    9.68s
  4   -62.15819309740       -4.57       -2.91    3.8    9.86s
  5   -62.15819357695       -6.32       -3.61    4.0    11.3s
  6   -62.15819360261       -7.59       -4.45    3.9    9.86s
  7   -62.15819360284       -9.64       -5.04    4.1    10.6s
  8   -62.15819360285      -10.86       -6.49    3.9    9.92s
  9   -62.15819360285      -13.45       -7.24    4.5    11.2s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.15018047573                   -1.17    8.8    17.3s
  2   -62.15428954292       -2.39       -1.23    2.7    7.80s
  3   -62.15816632644       -2.41       -2.08    4.1    9.80s
  4   -62.15819311733       -4.57       -2.92    3.7    10.0s
  5   -62.15819357782       -6.34       -3.63    4.0    12.1s
  6   -62.15819360262       -7.61       -4.48    3.9    10.5s
  7   -62.15819360284       -9.65       -5.05    4.0    10.4s
  8   -62.15819360285      -10.90       -6.53    3.8    10.1s
  9   -62.15819360285   +  -14.15       -7.32    4.5    11.2s
     2    -6.215819e+01     5.750555e-05
 * time: 448.79783391952515
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.15016834803                   -1.17    8.5    17.6s
  2   -62.15428689358       -2.39       -1.23    2.7    7.08s
  3   -62.15816608778       -2.41       -2.08    4.0    9.60s
  4   -62.15819316208       -4.57       -2.90    3.7    9.67s
  5   -62.15819365701       -6.31       -3.60    4.0    9.93s
  6   -62.15819368324       -7.58       -4.43    3.9    10.1s
  7   -62.15819368349       -9.59       -5.04    4.0    10.2s
  8   -62.15819368351      -10.83       -6.49    4.0    10.3s
  9   -62.15819368351      -13.00       -7.16    4.5    11.7s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.15017315812                   -1.17    8.3    18.0s
  2   -62.15428837870       -2.39       -1.23    2.8    7.41s
  3   -62.15816611842       -2.41       -2.08    3.9    9.54s
  4   -62.15819316613       -4.57       -2.91    3.7    9.40s
  5   -62.15819365764       -6.31       -3.61    4.0    10.3s
  6   -62.15819368324       -7.59       -4.46    3.7    9.48s
  7   -62.15819368349       -9.60       -5.08    4.1    11.2s
  8   -62.15819368351      -10.90       -6.48    3.9    10.2s
  9   -62.15819368351      -13.19       -7.17    4.5    11.4s
     3    -6.215819e+01     2.223222e-06
 * time: 677.1492209434509
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.15017311823                   -1.17    8.8    17.0s
  2   -62.15429302799       -2.39       -1.23    2.7    7.24s
  3   -62.15816602199       -2.41       -2.08    4.0    9.54s
  4   -62.15819318968       -4.57       -2.91    3.6    9.55s
  5   -62.15819365785       -6.33       -3.61    4.1    10.0s
  6   -62.15819368338       -7.59       -4.46    3.5    9.06s
  7   -62.15819368361       -9.64       -5.07    4.0    10.3s
  8   -62.15819368363      -10.91       -6.41    3.8    9.66s
  9   -62.15819368363   +  -13.85       -7.28    4.4    10.9s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.15017382173                   -1.17    8.7    17.6s
  2   -62.15428885473       -2.39       -1.23    2.8    7.67s
  3   -62.15816614382       -2.41       -2.08    4.0    10.6s
  4   -62.15819316522       -4.57       -2.91    3.7    9.35s
  5   -62.15819365770       -6.31       -3.61    4.0    10.5s
  6   -62.15819368336       -7.59       -4.45    3.7    9.28s
  7   -62.15819368361       -9.60       -5.08    4.1    10.3s
  8   -62.15819368363      -10.89       -6.44    3.9    10.1s
  9   -62.15819368363      -13.67       -7.20    4.4    10.9s
     4    -6.215819e+01     2.642333e-09
 * time: 896.8359489440918
 * Status: success

 * Candidate solution
    Final objective value:     -6.215819e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.09e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.02e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.19e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.91e-12 ≰ 0.0e+00
    |g(x)|                 = 2.64e-09 ≤ 1.0e-06

 * Work counters
    Seconds run:   897  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

NaCl: 1018.034405 seconds (1.01 G allocations: 290.157 GiB, 5.25% gc time, 0.34% compilation time)
┌ Info: 2025-05-12T16:44:26.586
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315524187798                   -1.46    5.5    2.18s
  2   -2.315615222986       -4.04       -1.84    1.5    843ms
  3   -2.315636304064       -4.68       -3.59    3.3    1.65s
  4   -2.315636530164       -6.65       -4.18    4.7    1.80s
  5   -2.315636530473       -9.51       -4.64    2.6    1.45s
  6   -2.315636530522      -10.31       -5.27    2.8    1.19s
  7   -2.315636530525      -11.63       -5.98    2.8    1.23s
  8   -2.315636530525      -13.50       -6.56    2.5    1.39s
  9   -2.315636530525      -14.31       -7.39    2.5    1.13s
Iter     Function value   Gradient norm 
     0    -2.315637e+00     1.305854e-03
 * time: 3.695487976074219e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315525902128                   -1.46    5.4    1.89s
  2   -2.315616766779       -4.04       -1.84    1.4    1.20s
  3   -2.315638013069       -4.67       -3.58    3.3    1.45s
  4   -2.315638200809       -6.73       -4.15    4.6    2.14s
  5   -2.315638201159       -9.46       -4.61    2.6    1.19s
  6   -2.315638201215      -10.25       -5.23    2.7    1.53s
  7   -2.315638201218      -11.60       -5.93    2.9    1.37s
  8   -2.315638201218      -13.45       -6.50    2.6    1.47s
  9   -2.315638201218      -14.21       -7.40    2.4    1.15s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315527648653                   -1.46    5.5    2.19s
  2   -2.315617311237       -4.05       -1.84    1.5    1.16s
  3   -2.315638030378       -4.68       -3.58    3.4    1.51s
  4   -2.315638200817       -6.77       -4.17    4.6    2.09s
  5   -2.315638201158       -9.47       -4.61    2.7    1.20s
  6   -2.315638201215      -10.24       -5.22    2.9    1.53s
  7   -2.315638201218      -11.59       -5.95    2.8    1.19s
  8   -2.315638201218      -13.47       -6.46    2.7    1.45s
  9   -2.315638201218      -14.21       -7.27    2.5    1.12s
     1    -2.315638e+00     1.252935e-03
 * time: 56.35543203353882
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315555438224                   -1.45    5.4    2.12s
  2   -2.315637415060       -4.09       -1.83    1.3    810ms
  3   -2.315657434750       -4.70       -3.54    3.3    1.86s
  4   -2.315657662966       -6.64       -4.07    4.5    1.79s
  5   -2.315657663456       -9.31       -4.56    2.5    1.45s
  6   -2.315657663527      -10.15       -5.26    2.9    1.23s
  7   -2.315657663530      -11.59       -5.81    3.1    1.57s
  8   -2.315657663530      -13.20       -6.53    2.3    1.09s
  9   -2.315657663530      -14.51       -7.51    2.7    1.38s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315550105724                   -1.45    5.4    2.15s
  2   -2.315636971523       -4.06       -1.83    1.4    801ms
  3   -2.315657494898       -4.69       -3.54    3.3    1.79s
  4   -2.315657663020       -6.77       -4.10    4.4    2.40s
  5   -2.315657663468       -9.35       -4.59    2.5    1.52s
  6   -2.315657663527      -10.23       -5.31    2.9    1.22s
  7   -2.315657663530      -11.62       -5.83    3.0    1.93s
  8   -2.315657663530      -13.26       -6.54    2.5    1.33s
  9   -2.315657663530      -14.40       -7.30    2.6    1.52s
     2    -2.315658e+00     3.807416e-07
 * time: 115.05989193916321
 * Status: success

 * Candidate solution
    Final objective value:     -2.315658e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.09e-02 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.06e-03 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.95e-05 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 8.40e-06 ≰ 0.0e+00
    |g(x)|                 = 3.81e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   115  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Al: 148.700567 seconds (113.74 M allocations: 27.085 GiB, 6.19% gc time, 0.00% compilation time)
┌ Info: 2025-05-12T16:46:55.287
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.72801262361                   -0.86    9.6    10.3s
  2   -73.74029455153       -1.91       -1.06    5.4    6.24s
  3   -73.74693020903       -2.18       -1.40    6.9    7.38s
  4   -73.74807437663       -2.94       -1.77    5.8    6.37s
  5   -73.74822998378       -3.81       -2.25    5.0    5.63s
  6   -73.74824928636       -4.71       -3.09    5.5    6.07s
  7   -73.74824931533       -7.54       -3.54    4.3    5.28s
  8   -73.74824932116       -8.23       -4.13    5.0    5.62s
  9   -73.74824932079   +   -9.43       -4.53    5.1    6.38s
 10   -73.74824932142       -9.20       -4.82    5.5    6.21s
 11   -73.74824932143      -10.92       -5.75    4.0    4.89s
 12   -73.74824932143      -13.15       -6.36    4.6    5.66s
 13   -73.74824932143   +    -Inf       -6.56    3.0    4.87s
 14   -73.74824932143      -13.55       -7.00    4.9    5.48s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.374825e+01     9.784993e-03
 * time: 3.1948089599609375e-5
┌ Warning: Negative ρcore detected: -3.3825344839028443e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.72833614110                   -0.86    9.9    9.60s
  2   -73.74040606549       -1.92       -1.06    5.5    5.63s
  3   -73.74703045406       -2.18       -1.40    6.8    7.49s
  4   -73.74816021712       -2.95       -1.77    5.9    5.98s
  5   -73.74831836538       -3.80       -2.25    5.1    5.65s
  6   -73.74833789560       -4.71       -3.08    5.6    6.68s
  7   -73.74833791575       -7.70       -3.53    4.5    5.60s
  8   -73.74833792107       -8.27       -4.12    4.9    5.54s
  9   -73.74833792055   +   -9.28       -4.46    5.4    5.79s
 10   -73.74833792125       -9.16       -4.77    5.7    5.81s
 11   -73.74833792126      -10.80       -5.67    4.0    4.88s
 12   -73.74833792126      -12.45       -6.31    4.8    6.53s
 13   -73.74833792126      -13.55       -6.53    3.5    4.83s
 14   -73.74833792126   +  -13.15       -6.92    5.3    5.54s
 15   -73.74833792126      -13.55       -7.76    4.8    5.33s
┌ Warning: Negative ρcore detected: -3.3825344839028443e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.72833905068                   -0.86    9.9    10.1s
  2   -73.74040607480       -1.92       -1.06    5.5    6.17s
  3   -73.74703026762       -2.18       -1.40    6.8    8.64s
  4   -73.74816069395       -2.95       -1.77    5.9    6.32s
  5   -73.74831850423       -3.80       -2.25    5.1    6.26s
  6   -73.74833789599       -4.71       -3.08    5.5    6.30s
  7   -73.74833791612       -7.70       -3.53    4.3    5.07s
  8   -73.74833792106       -8.31       -4.12    5.0    5.82s
  9   -73.74833792058   +   -9.32       -4.46    5.4    5.70s
 10   -73.74833792125       -9.18       -4.77    5.7    5.72s
 11   -73.74833792126      -10.80       -5.67    4.0    4.83s
 12   -73.74833792126      -12.49       -6.33    4.9    6.59s
 13   -73.74833792126   +  -13.37       -6.51    3.6    4.72s
 14   -73.74833792126   +  -13.85       -6.92    5.2    5.37s
 15   -73.74833792126      -13.85       -7.78    4.9    5.36s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.3825344839028443e-8,-5.482324142984474e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.374834e+01     8.321012e-03
 * time: 246.6229269504547
┌ Warning: Negative ρcore detected: -3.0603272279594154e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.72986182366                   -0.86    9.8    9.44s
  2   -73.74092256408       -1.96       -1.06    5.5    5.94s
  3   -73.74729544073       -2.20       -1.40    6.8    7.26s
  4   -73.74839762293       -2.96       -1.78    5.9    6.09s
  5   -73.74854319789       -3.84       -2.28    5.0    5.42s
  6   -73.74856059896       -4.76       -3.09    5.6    5.96s
  7   -73.74856063220       -7.48       -3.56    4.5    5.32s
  8   -73.74856063793       -8.24       -4.03    5.1    5.51s
  9   -73.74856063756   +   -9.43       -4.52    5.3    5.61s
 10   -73.74856063819       -9.20       -4.79    5.6    5.70s
 11   -73.74856063823      -10.40       -5.49    4.9    5.33s
 12   -73.74856063824      -11.81       -6.26    4.7    5.51s
 13   -73.74856063824      -12.64       -6.42    4.3    5.11s
 14   -73.74856063824   +  -12.62       -6.97    5.2    5.33s
 15   -73.74856063824   +  -13.00       -7.83    5.0    5.54s
┌ Warning: Negative ρcore detected: -3.0603272279594154e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.72985847272                   -0.86    9.8    9.75s
  2   -73.74092026706       -1.96       -1.06    5.3    6.01s
  3   -73.74729653877       -2.20       -1.40    6.8    7.79s
  4   -73.74839757734       -2.96       -1.78    5.9    6.12s
  5   -73.74854295645       -3.84       -2.27    5.1    6.11s
  6   -73.74856060243       -4.75       -3.09    5.6    6.88s
  7   -73.74856063153       -7.54       -3.57    4.4    5.63s
  8   -73.74856063794       -8.19       -4.05    5.0    6.09s
  9   -73.74856063748   +   -9.33       -4.51    5.4    5.90s
 10   -73.74856063820       -9.14       -4.80    5.6    6.69s
 11   -73.74856063823      -10.41       -5.49    4.9    6.23s
 12   -73.74856063824      -11.76       -6.29    4.7    6.13s
 13   -73.74856063824      -12.70       -6.43    4.2    5.18s
 14   -73.74856063824   +  -12.55       -6.98    5.2    5.44s
 15   -73.74856063824   +  -13.37       -7.84    5.0    5.96s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.0603272279594154e-8,-8.719053592687432e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.374856e+01     4.377813e-04
 * time: 493.37791895866394
┌ Warning: Negative ρcore detected: -3.082754967487696e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.72980647263                   -0.86    9.6    10.5s
  2   -73.74088831153       -1.96       -1.06    5.2    6.59s
  3   -73.74729652498       -2.19       -1.40    6.8    7.45s
  4   -73.74839639752       -2.96       -1.78    5.7    6.86s
  5   -73.74854298444       -3.83       -2.27    5.0    5.44s
  6   -73.74856118801       -4.74       -3.09    5.5    5.98s
  7   -73.74856121488       -7.57       -3.56    4.2    5.13s
  8   -73.74856122122       -8.20       -4.04    4.9    5.54s
  9   -73.74856122082   +   -9.40       -4.52    5.3    5.74s
 10   -73.74856122147       -9.19       -4.80    5.6    5.76s
 11   -73.74856122151      -10.40       -5.49    4.9    5.36s
 12   -73.74856122152      -11.53       -6.30    4.7    5.45s
 13   -73.74856122152      -13.07       -6.44    4.5    5.90s
 14   -73.74856122152      -13.85       -6.96    5.3    7.05s
 15   -73.74856122152   +  -12.85       -7.83    5.0    5.84s
┌ Warning: Negative ρcore detected: -3.082754967487696e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.72980091801                   -0.86    9.6    9.42s
  2   -73.74089433445       -1.95       -1.06    5.2    6.43s
  3   -73.74729731958       -2.19       -1.40    6.7    9.60s
  4   -73.74839567740       -2.96       -1.78    5.8    7.63s
  5   -73.74854281511       -3.83       -2.26    4.9    6.21s
  6   -73.74856118573       -4.74       -3.09    5.4    6.11s
  7   -73.74856121502       -7.53       -3.55    4.4    5.32s
  8   -73.74856122120       -8.21       -4.02    4.9    5.96s
  9   -73.74856122089   +   -9.51       -4.53    5.2    6.35s
 10   -73.74856122148       -9.23       -4.79    5.5    6.64s
 11   -73.74856122151      -10.42       -5.48    4.9    6.78s
 12   -73.74856122152      -11.59       -6.19    4.6    7.36s
 13   -73.74856122152      -12.85       -6.42    4.6    7.46s
 14   -73.74856122152   +  -13.00       -6.99    5.5    7.29s
 15   -73.74856122152      -13.55       -7.94    5.0    6.91s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.082754967487696e-8,-7.42133486678475e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.374856e+01     1.753798e-05
 * time: 758.3629081249237
┌ Warning: Negative ρcore detected: -3.08195768727987e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.72979525707                   -0.86    9.6    10.1s
  2   -73.74089599332       -1.95       -1.06    5.2    5.62s
  3   -73.74729656224       -2.19       -1.40    6.8    7.24s
  4   -73.74839637281       -2.96       -1.78    5.8    5.82s
  5   -73.74854309379       -3.83       -2.27    5.0    5.39s
  6   -73.74856118853       -4.74       -3.09    5.5    5.90s
  7   -73.74856121513       -7.58       -3.56    4.2    5.06s
  8   -73.74856122215       -8.15       -4.03    5.0    5.29s
  9   -73.74856122176   +   -9.40       -4.52    5.4    5.55s
 10   -73.74856122244       -9.17       -4.79    5.7    5.86s
 11   -73.74856122248      -10.41       -5.48    4.9    5.48s
 12   -73.74856122248      -11.50       -6.28    4.8    6.01s
 13   -73.74856122248      -13.85       -6.42    4.9    6.94s
 14   -73.74856122248   +  -13.55       -6.94    5.3    6.05s
 15   -73.74856122248   +  -13.85       -7.81    5.1    6.11s
┌ Warning: Negative ρcore detected: -3.08195768727987e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.72979836617                   -0.86    9.6    9.36s
  2   -73.74089843261       -1.95       -1.06    5.2    5.49s
  3   -73.74729649900       -2.19       -1.40    6.7    7.16s
  4   -73.74839650467       -2.96       -1.78    5.8    5.95s
  5   -73.74854260945       -3.84       -2.26    4.9    6.04s
  6   -73.74856118613       -4.73       -3.09    5.5    7.21s
  7   -73.74856121573       -7.53       -3.56    4.3    5.51s
  8   -73.74856122218       -8.19       -4.03    4.9    6.05s
  9   -73.74856122179   +   -9.42       -4.52    5.3    6.12s
 10   -73.74856122244       -9.19       -4.80    5.5    5.74s
 11   -73.74856122248      -10.41       -5.48    4.9    5.38s
 12   -73.74856122248      -11.54       -6.28    4.7    5.47s
 13   -73.74856122248   +    -Inf       -6.43    4.8    5.57s
 14   -73.74856122248   +    -Inf       -6.95    5.3    5.78s
 15   -73.74856122248   +  -13.85       -7.77    5.1    7.36s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.08195768727987e-8,-7.47085542778768e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     4    -7.374856e+01     2.498500e-08
 * time: 1008.4020161628723
 * Status: success

 * Candidate solution
    Final objective value:     -7.374856e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.07e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.90e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 9.65e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.31e-11 ≰ 0.0e+00
    |g(x)|                 = 2.50e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   1008  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

V: 1138.806463 seconds (753.11 M allocations: 359.513 GiB, 5.85% gc time, 0.01% compilation time)
