┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-13T15:37:42.177
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465225147989                   -0.96    6.9    11.7s
  2   -8.466775667209       -2.81       -1.72    1.8    6.03s
  3   -8.466861389702       -4.07       -2.73    3.8    3.18s
  4   -8.466865235171       -5.42       -3.53    4.8    1.95s
  5   -8.466865410816       -6.76       -4.38    4.9    2.43s
  6   -8.466865417176       -8.20       -5.29    5.2    2.69s
  7   -8.466865417239      -10.20       -6.41    5.0    2.03s
  8   -8.466865417240      -12.36       -7.19    4.9    2.16s
Iter     Function value   Gradient norm 
     0    -8.466865e+00     1.033202e-03
 * time: 5.2928924560546875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465243197444                   -0.96    7.3    2.97s
  2   -8.466774305606       -2.81       -1.72    2.0    1.61s
  3   -8.466862697831       -4.05       -2.73    3.9    2.22s
  4   -8.466866259483       -5.45       -3.55    4.9    1.95s
  5   -8.466866440731       -6.74       -4.33    5.1    2.45s
  6   -8.466866448038       -8.14       -5.27    5.4    1.94s
  7   -8.466866448105      -10.17       -6.14    4.9    2.27s
  8   -8.466866448106      -12.18       -6.94    4.5    1.81s
  9   -8.466866448106      -13.97       -7.82    4.0    1.99s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465237924085                   -0.96    7.1    2.84s
  2   -8.466779968972       -2.81       -1.72    2.0    1.74s
  3   -8.466862454689       -4.08       -2.73    3.9    1.96s
  4   -8.466866261885       -5.42       -3.53    4.9    3.00s
  5   -8.466866441923       -6.74       -4.38    5.2    1.91s
  6   -8.466866448047       -8.21       -5.28    5.2    2.28s
  7   -8.466866448105      -10.23       -6.38    4.8    1.92s
  8   -8.466866448106      -12.35       -7.14    4.9    2.20s
     1    -8.466866e+00     9.623104e-04
 * time: 53.207237005233765
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465248583549                   -0.96    6.9    2.68s
  2   -8.466780387560       -2.81       -1.72    1.9    1.19s
  3   -8.466869066298       -4.05       -2.73    3.9    2.01s
  4   -8.466873042643       -5.40       -3.55    4.8    2.23s
  5   -8.466873222839       -6.74       -4.36    5.1    2.00s
  6   -8.466873229297       -8.19       -5.27    5.3    2.21s
  7   -8.466873229367      -10.15       -6.18    4.7    1.91s
  8   -8.466873229368      -12.19       -6.98    4.4    2.07s
  9   -8.466873229368      -13.85       -7.77    4.2    1.67s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465251854226                   -0.96    6.9    2.85s
  2   -8.466779318060       -2.82       -1.72    1.9    1.31s
  3   -8.466869090444       -4.05       -2.73    3.8    2.21s
  4   -8.466873045886       -5.40       -3.53    4.9    1.99s
  5   -8.466873223015       -6.75       -4.40    5.1    2.49s
  6   -8.466873229304       -8.20       -5.29    5.2    2.23s
  7   -8.466873229367      -10.20       -6.28    5.0    2.16s
  8   -8.466873229368      -12.44       -7.15    4.3    1.79s
     2    -8.466873e+00     6.876819e-06
 * time: 101.09534096717834
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465255945289                   -0.96    7.0    2.89s
  2   -8.466780986751       -2.82       -1.72    1.7    1.58s
  3   -8.466868941637       -4.06       -2.73    3.8    1.84s
  4   -8.466873040832       -5.39       -3.53    4.8    2.66s
  5   -8.466873223411       -6.74       -4.40    5.0    2.17s
  6   -8.466873229656       -8.20       -5.27    5.2    3.05s
  7   -8.466873229717      -10.22       -6.17    4.9    2.69s
  8   -8.466873229717      -12.43       -7.07    4.0    2.76s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465252988395                   -0.96    6.9    2.77s
  2   -8.466777842229       -2.82       -1.72    1.8    1.44s
  3   -8.466869281718       -4.04       -2.73    3.8    1.70s
  4   -8.466873045236       -5.42       -3.55    4.9    2.24s
  5   -8.466873222604       -6.75       -4.34    5.2    1.94s
  6   -8.466873229642       -8.15       -5.26    5.2    2.20s
  7   -8.466873229716      -10.13       -6.14    4.8    1.92s
  8   -8.466873229717      -12.18       -6.92    4.3    2.07s
  9   -8.466873229717      -13.85       -7.80    4.3    1.71s
     3    -8.466873e+00     4.870113e-08
 * time: 152.44454908370972
 * Status: success

 * Candidate solution
    Final objective value:     -8.466873e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.01e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 9.74e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 3.49e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 4.12e-11 ≰ 0.0e+00
    |g(x)|                 = 4.87e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   152  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 240.988574 seconds (318.96 M allocations: 62.807 GiB, 7.59% gc time, 24.97% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-13T15:41:43.924
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31485939935                   -1.10    8.5    28.4s
  2   -62.32131914629       -2.19       -1.21    2.5    9.52s
  3   -62.32538654781       -2.39       -2.02    3.6    10.9s
  4   -62.32544644359       -4.22       -2.91    2.9    9.82s
  5   -62.32544782405       -5.86       -3.58    4.1    10.8s
  6   -62.32544803530       -6.68       -4.15    3.4    9.18s
  7   -62.32544804486       -8.02       -4.63    4.0    11.4s
  8   -62.32544804537       -9.30       -5.53    3.5    10.0s
  9   -62.32544804538      -11.04       -6.70    3.9    10.4s
 10   -62.32544804538      -12.87       -7.44    4.5    12.3s
Iter     Function value   Gradient norm 
     0    -6.232545e+01     8.130140e-03
 * time: 3.695487976074219e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31489688294                   -1.10    8.3    20.0s
  2   -62.32133545955       -2.19       -1.21    2.5    8.71s
  3   -62.32545267295       -2.39       -2.02    3.6    12.7s
  4   -62.32551187704       -4.23       -2.93    2.9    8.65s
  5   -62.32551323929       -5.87       -3.55    4.1    12.7s
  6   -62.32551341367       -6.76       -4.22    3.4    11.6s
  7   -62.32551342227       -8.07       -4.67    4.0    11.7s
  8   -62.32551342273       -9.34       -5.51    3.5    10.5s
  9   -62.32551342274      -11.11       -6.64    3.8    11.4s
 10   -62.32551342274      -13.15       -7.25    4.1    12.5s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31489794530                   -1.10    8.2    19.7s
  2   -62.32132318239       -2.19       -1.21    2.6    10.2s
  3   -62.32545269363       -2.38       -2.02    3.6    10.7s
  4   -62.32551190930       -4.23       -2.97    2.9    11.4s
  5   -62.32551329289       -5.86       -3.47    4.2    16.4s
  6   -62.32551341464       -6.91       -4.32    3.7    14.7s
  7   -62.32551342232       -8.11       -4.74    4.2    15.2s
  8   -62.32551342274       -9.38       -5.58    3.4    12.5s
  9   -62.32551342274      -11.26       -6.82    3.8    14.8s
 10   -62.32551342274      -13.30       -7.43    3.8    11.6s
     1    -6.232551e+01     7.952757e-03
 * time: 298.72513699531555
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31477410951                   -1.08    8.8    25.8s
  2   -62.32162848454       -2.16       -1.16    2.6    8.24s
  3   -62.32702985497       -2.27       -1.97    3.6    11.2s
  4   -62.32711176305       -4.09       -2.92    2.9    9.22s
  5   -62.32711324507       -5.83       -3.58    4.0    12.1s
  6   -62.32711350091       -6.59       -4.19    3.2    9.84s
  7   -62.32711351227       -7.94       -4.60    3.8    12.3s
  8   -62.32711351288       -9.22       -5.46    3.5    11.4s
  9   -62.32711351290      -10.81       -6.23    3.8    12.3s
 10   -62.32711351290      -12.49       -6.95    3.9    12.3s
 11   -62.32711351290   +  -13.45       -7.52    3.8    12.9s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31476871019                   -1.08    8.7    19.5s
  2   -62.32163972593       -2.16       -1.16    2.6    8.23s
  3   -62.32703106351       -2.27       -1.97    3.7    10.4s
  4   -62.32711176945       -4.09       -2.91    2.8    8.55s
  5   -62.32711321123       -5.84       -3.60    4.1    11.9s
  6   -62.32711350052       -6.54       -4.18    3.3    9.67s
  7   -62.32711351231       -7.93       -4.63    3.8    11.0s
  8   -62.32711351288       -9.25       -5.55    3.5    10.0s
  9   -62.32711351290      -10.76       -6.20    3.9    11.5s
 10   -62.32711351290      -12.50       -6.94    4.0    12.5s
 11   -62.32711351290      -13.55       -7.79    3.7    11.6s
     2    -6.232711e+01     1.211288e-03
 * time: 602.4152500629425
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31446260803                   -1.08    8.4    19.3s
  2   -62.32142476037       -2.16       -1.16    2.8    8.21s
  3   -62.32707190865       -2.25       -1.96    3.5    10.0s
  4   -62.32715826383       -4.06       -2.91    2.7    8.42s
  5   -62.32715977968       -5.82       -3.60    3.9    11.6s
  6   -62.32716008105       -6.52       -4.16    3.2    10.2s
  7   -62.32716009256       -7.94       -4.59    3.6    10.7s
  8   -62.32716009320       -9.19       -5.56    3.4    10.1s
  9   -62.32716009322      -10.66       -6.18    3.8    12.6s
 10   -62.32716009322      -12.42       -6.89    3.9    12.7s
 11   -62.32716009322      -13.85       -8.00    3.6    12.4s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31446332424                   -1.08    8.4    20.1s
  2   -62.32142211010       -2.16       -1.16    2.9    8.99s
  3   -62.32707173338       -2.25       -1.96    3.6    10.0s
  4   -62.32715822524       -4.06       -2.92    2.6    8.59s
  5   -62.32715979659       -5.80       -3.60    3.9    12.1s
  6   -62.32716008098       -6.55       -4.21    3.3    10.9s
  7   -62.32716009257       -7.94       -4.64    3.7    12.0s
  8   -62.32716009320       -9.20       -5.51    3.4    11.6s
  9   -62.32716009322      -10.68       -6.20    3.7    13.4s
 10   -62.32716009322      -12.45       -6.80    3.9    12.1s
 11   -62.32716009322      -13.85       -8.04    3.5    13.7s
     3    -6.232716e+01     2.210863e-04
 * time: 898.3012850284576
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31438562771                   -1.08    8.7    22.2s
  2   -62.32136382485       -2.16       -1.15    2.8    10.7s
  3   -62.32707210842       -2.24       -1.95    3.6    11.5s
  4   -62.32715991144       -4.06       -2.92    2.7    10.0s
  5   -62.32716147720       -5.81       -3.60    4.1    12.6s
  6   -62.32716175201       -6.56       -4.23    3.3    10.0s
  7   -62.32716176403       -7.92       -4.65    3.8    11.5s
  8   -62.32716176461       -9.23       -5.54    3.3    11.9s
  9   -62.32716176463      -10.73       -6.18    3.8    12.4s
 10   -62.32716176463      -12.42       -6.85    3.7    12.8s
 11   -62.32716176463      -13.00       -7.64    3.6    12.0s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31438811445                   -1.08    8.8    20.3s
  2   -62.32136662398       -2.16       -1.15    2.8    8.41s
  3   -62.32707320261       -2.24       -1.95    3.6    12.2s
  4   -62.32715985356       -4.06       -2.92    2.5    9.01s
  5   -62.32716145729       -5.79       -3.60    4.0    13.4s
  6   -62.32716175109       -6.53       -4.23    3.3    11.3s
  7   -62.32716176405       -7.89       -4.68    3.8    11.8s
  8   -62.32716176461       -9.25       -5.55    3.3    10.8s
  9   -62.32716176463      -10.67       -6.17    3.8    12.3s
 10   -62.32716176463      -12.35       -6.79    3.7    12.7s
 11   -62.32716176463   +  -13.67       -8.07    3.6    11.8s
     4    -6.232716e+01     8.001067e-06
 * time: 1209.9904110431671
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31438285869                   -1.08    8.5    23.1s
  2   -62.32136649135       -2.16       -1.15    2.5    8.15s
  3   -62.32707220633       -2.24       -1.95    3.5    9.78s
  4   -62.32715984267       -4.06       -2.90    2.7    8.25s
  5   -62.32716143003       -5.80       -3.59    4.0    12.6s
  6   -62.32716175362       -6.49       -4.18    3.3    9.38s
  7   -62.32716176618       -7.90       -4.64    3.6    10.9s
  8   -62.32716176682       -9.20       -5.62    3.4    10.2s
  9   -62.32716176684      -10.63       -6.18    4.0    11.8s
 10   -62.32716176684      -12.30       -6.96    3.7    10.6s
 11   -62.32716176684   +  -13.85       -7.87    3.7    10.9s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31438308318                   -1.08    8.3    18.0s
  2   -62.32135826800       -2.16       -1.15    2.7    7.93s
  3   -62.32707230105       -2.24       -1.95    3.5    11.1s
  4   -62.32715982463       -4.06       -2.91    2.5    8.22s
  5   -62.32716145072       -5.79       -3.60    4.1    12.1s
  6   -62.32716175447       -6.52       -4.20    3.3    9.56s
  7   -62.32716176620       -7.93       -4.61    3.7    12.1s
  8   -62.32716176681       -9.21       -5.57    3.4    11.0s
  9   -62.32716176684      -10.55       -6.03    3.7    11.2s
 10   -62.32716176684      -12.27       -6.65    3.7    10.7s
 11   -62.32716176684      -13.37       -8.08    3.2    10.6s
     5    -6.232716e+01     5.167449e-08
 * time: 1499.6511499881744
 * Status: success

 * Candidate solution
    Final objective value:     -6.232716e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 5.49e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.90e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.21e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.55e-11 ≰ 0.0e+00
    |g(x)|                 = 5.17e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   1500  (vs limit Inf)
    Iterations:    5
    f(x) calls:    6
    ∇f(x) calls:   6

NaCl: 1653.933400 seconds (1.49 G allocations: 422.799 GiB, 5.43% gc time, 0.26% compilation time)
┌ Info: 2025-05-13T16:09:17.898
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317565413624                   -1.47    5.5    2.08s
  2   -2.317639191023       -4.13       -1.84    1.3    820ms
  3   -2.317654915515       -4.80       -3.57    3.1    1.82s
  4   -2.317655099530       -6.74       -4.06    4.6    2.08s
  5   -2.317655100026       -9.30       -4.33    2.4    1.47s
  6   -2.317655100183       -9.80       -4.98    2.6    1.36s
  7   -2.317655100188      -11.35       -5.63    2.4    1.38s
  8   -2.317655100188      -12.48       -6.35    2.7    1.71s
  9   -2.317655100188      -14.03       -6.82    2.6    1.15s
 10   -2.317655100188      -14.57       -7.55    2.1    1.29s
Iter     Function value   Gradient norm 
     0    -2.317655e+00     1.422341e-04
 * time: 2.9087066650390625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317564913654                   -1.47    5.3    2.23s
  2   -2.317638544215       -4.13       -1.84    1.3    794ms
  3   -2.317654926572       -4.79       -3.56    3.1    1.61s
  4   -2.317655119313       -6.72       -4.04    4.5    1.69s
  5   -2.317655119850       -9.27       -4.32    2.3    1.33s
  6   -2.317655120004       -9.81       -4.98    2.7    1.14s
  7   -2.317655120008      -11.34       -5.72    2.4    1.41s
  8   -2.317655120009      -12.61       -6.51    2.6    1.14s
  9   -2.317655120009      -14.18       -6.84    2.9    1.23s
 10   -2.317655120009      -15.35       -7.41    2.0    1.23s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317571116393                   -1.47    5.3    2.11s
  2   -2.317639518952       -4.16       -1.84    1.3    932ms
  3   -2.317654914978       -4.81       -3.57    3.1    1.87s
  4   -2.317655119326       -6.69       -4.04    4.5    1.72s
  5   -2.317655119850       -9.28       -4.32    2.3    1.30s
  6   -2.317655120003       -9.81       -4.99    2.6    1.10s
  7   -2.317655120008      -11.30       -5.72    2.4    1.35s
  8   -2.317655120009      -12.62       -6.52    2.6    1.43s
  9   -2.317655120009      -14.05       -6.97    3.1    1.57s
 10   -2.317655120009      -15.05       -7.55    2.2    1.42s
     1    -2.317655e+00     1.364660e-04
 * time: 60.186821937561035
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317569963157                   -1.47    5.5    2.28s
  2   -2.317639699119       -4.16       -1.84    1.3    778ms
  3   -2.317655101563       -4.81       -3.56    3.1    1.56s
  4   -2.317655349352       -6.61       -4.02    4.6    1.80s
  5   -2.317655349935       -9.23       -4.30    2.3    1.31s
  6   -2.317655350105       -9.77       -4.96    2.6    1.23s
  7   -2.317655350110      -11.25       -5.67    2.4    1.64s
  8   -2.317655350111      -12.53       -6.53    2.5    1.06s
  9   -2.317655350111      -13.97       -7.02    3.2    1.48s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317566737101                   -1.47    5.4    2.10s
  2   -2.317639358608       -4.14       -1.84    1.3    784ms
  3   -2.317655133080       -4.80       -3.57    3.1    1.64s
  4   -2.317655349404       -6.66       -4.04    4.5    1.71s
  5   -2.317655349940       -9.27       -4.32    2.3    1.35s
  6   -2.317655350106       -9.78       -4.96    2.7    1.17s
  7   -2.317655350111      -11.37       -5.61    2.4    1.39s
  8   -2.317655350111      -12.54       -6.39    2.6    1.16s
  9   -2.317655350111      -13.97       -6.81    2.8    1.16s
 10   -2.317655350111      -15.05       -7.45    1.9    1.26s
     2    -2.317655e+00     4.302803e-07
 * time: 119.30835890769958
 * Status: success

 * Candidate solution
    Final objective value:     -2.317655e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.37e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.41e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.30e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 9.93e-08 ≰ 0.0e+00
    |g(x)|                 = 4.30e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   119  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Al: 155.378628 seconds (120.15 M allocations: 28.317 GiB, 6.54% gc time, 0.00% compilation time)
┌ Info: 2025-05-13T16:11:53.278
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.82032946813                   -0.92    9.6    11.7s
  2   -73.82876882965       -2.07       -1.12    5.2    6.05s
  3   -73.83401691126       -2.28       -1.49    6.7    8.04s
  4   -73.83474494285       -3.14       -1.82    5.5    5.83s
  5   -73.83487245408       -3.89       -2.22    5.0    5.61s
  6   -73.83489522290       -4.64       -3.07    5.5    7.83s
  7   -73.83489525071       -7.56       -3.46    5.1    7.62s
  8   -73.83489525508       -8.36       -4.04    3.9    6.50s
  9   -73.83489525536       -9.55       -4.46    4.1    6.75s
 10   -73.83489525537      -11.43       -4.85    3.0    5.53s
 11   -73.83489525538      -10.85       -5.53    4.5    5.20s
 12   -73.83489525538      -11.58       -6.25    4.7    5.86s
 13   -73.83489525538      -13.25       -6.71    5.3    6.11s
 14   -73.83489525538   +  -13.37       -6.87    5.5    6.14s
 15   -73.83489525538   +  -13.37       -7.70    5.2    5.68s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.383490e+01     2.879429e-03
 * time: 6.103515625e-5
┌ Warning: Negative ρcore detected: -3.417041360117286e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.82030286902                   -0.92    9.5    11.3s
  2   -73.82877628622       -2.07       -1.12    5.2    6.07s
  3   -73.83402158298       -2.28       -1.49    6.7    7.60s
  4   -73.83475229287       -3.14       -1.82    5.5    6.66s
  5   -73.83488013751       -3.89       -2.22    5.0    6.34s
  6   -73.83490288313       -4.64       -3.07    5.5    7.23s
  7   -73.83490291086       -7.56       -3.47    5.1    5.97s
  8   -73.83490291516       -8.37       -4.05    3.7    5.07s
  9   -73.83490291545       -9.54       -4.47    4.2    5.25s
 10   -73.83490291545      -11.28       -4.87    3.0    4.46s
 11   -73.83490291547      -10.88       -5.56    4.6    6.21s
 12   -73.83490291547      -11.69       -6.31    4.8    5.60s
 13   -73.83490291547      -13.37       -6.76    5.2    5.93s
 14   -73.83490291547      -13.37       -7.05    5.4    5.89s
┌ Warning: Negative ρcore detected: -3.417041360117286e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.82029779006                   -0.92    9.5    9.30s
  2   -73.82876788501       -2.07       -1.12    5.3    5.43s
  3   -73.83402478911       -2.28       -1.49    6.7    7.61s
  4   -73.83475167546       -3.14       -1.82    5.4    7.25s
  5   -73.83488007142       -3.89       -2.22    4.9    7.89s
  6   -73.83490288227       -4.64       -3.07    5.5    5.88s
  7   -73.83490291102       -7.54       -3.46    5.1    6.31s
  8   -73.83490291515       -8.38       -4.04    3.6    5.21s
  9   -73.83490291545       -9.52       -4.49    4.1    5.19s
 10   -73.83490291545      -11.38       -4.86    2.9    4.04s
 11   -73.83490291547      -10.86       -5.55    4.6    5.21s
 12   -73.83490291547      -11.65       -6.30    4.8    5.76s
 13   -73.83490291547   +  -13.25       -6.75    5.3    5.93s
 14   -73.83490291547   +  -13.15       -7.05    5.4    6.63s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.417041360117286e-8,-4.97823384894541e-10)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.383490e+01     2.441152e-03
 * time: 244.0040681362152
┌ Warning: Negative ρcore detected: -3.3673333082546574e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.82004861786                   -0.92    9.7    10.8s
  2   -73.82877226551       -2.06       -1.12    5.3    6.09s
  3   -73.83402398578       -2.28       -1.48    6.9    7.49s
  4   -73.83477684634       -3.12       -1.82    5.7    6.11s
  5   -73.83490058097       -3.91       -2.23    5.1    6.33s
  6   -73.83492263339       -4.66       -3.10    5.5    6.35s
  7   -73.83492265222       -7.73       -3.49    4.8    5.82s
  8   -73.83492265571       -8.46       -4.05    3.2    4.42s
  9   -73.83492265615       -9.35       -4.61    4.6    5.58s
 10   -73.83492265618      -10.49       -4.92    4.9    5.67s
 11   -73.83492265619      -11.00       -5.82    4.7    5.69s
 12   -73.83492265619      -12.85       -6.50    4.7    6.15s
 13   -73.83492265619   +  -13.37       -7.07    3.5    5.26s
┌ Warning: Negative ρcore detected: -3.3673333082546574e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.82004844820                   -0.92    9.7    10.4s
  2   -73.82875736279       -2.06       -1.12    5.4    5.87s
  3   -73.83402727757       -2.28       -1.48    6.9    7.65s
  4   -73.83477649594       -3.13       -1.82    5.7    6.52s
  5   -73.83490005045       -3.91       -2.22    5.1    6.73s
  6   -73.83492263208       -4.65       -3.10    5.6    7.21s
  7   -73.83492265226       -7.70       -3.49    4.7    5.61s
  8   -73.83492265570       -8.46       -4.05    3.2    5.32s
  9   -73.83492265616       -9.35       -4.61    4.5    5.90s
 10   -73.83492265618      -10.55       -4.91    4.8    6.62s
 11   -73.83492265619      -10.97       -5.81    4.7    5.87s
 12   -73.83492265619      -12.67       -6.50    4.9    7.08s
 13   -73.83492265619      -13.37       -6.99    3.8    5.66s
 14   -73.83492265619   +    -Inf       -7.41    5.1    5.69s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.3673333082546574e-8,6.115014803072359e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.383492e+01     2.775410e-05
 * time: 483.9771251678467
┌ Warning: Negative ρcore detected: -3.3661993684279975e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.82004624296                   -0.92    9.9    10.0s
  2   -73.82876764856       -2.06       -1.12    5.4    6.21s
  3   -73.83402558697       -2.28       -1.48    6.9    8.18s
  4   -73.83477642963       -3.12       -1.82    5.7    6.85s
  5   -73.83490050553       -3.91       -2.23    5.1    6.12s
  6   -73.83492263480       -4.66       -3.10    5.6    6.79s
  7   -73.83492265517       -7.69       -3.50    4.9    6.78s
  8   -73.83492265831       -8.50       -4.06    3.1    5.28s
  9   -73.83492265871       -9.40       -4.63    4.4    5.83s
 10   -73.83492265876      -10.27       -4.95    5.1    7.10s
 11   -73.83492265877      -11.03       -5.85    4.8    5.75s
 12   -73.83492265877      -12.77       -6.55    4.4    6.13s
 13   -73.83492265877   +    -Inf       -6.91    3.6    5.30s
 14   -73.83492265877   +  -12.81       -7.49    5.0    5.68s
┌ Warning: Negative ρcore detected: -3.3661993684279975e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.82003466226                   -0.92   10.0    10.1s
  2   -73.82877771759       -2.06       -1.12    5.3    6.22s
  3   -73.83402377904       -2.28       -1.48    7.0    8.52s
  4   -73.83477696391       -3.12       -1.82    5.6    6.47s
  5   -73.83490024914       -3.91       -2.22    5.1    6.62s
  6   -73.83492263492       -4.65       -3.10    5.6    7.66s
  7   -73.83492265515       -7.69       -3.49    4.9    6.22s
  8   -73.83492265827       -8.51       -4.05    3.0    5.21s
  9   -73.83492265870       -9.37       -4.63    4.3    5.74s
 10   -73.83492265876      -10.22       -4.92    5.1    6.01s
 11   -73.83492265877      -11.00       -5.85    4.9    6.74s
 12   -73.83492265877      -13.15       -6.51    4.3    5.28s
 13   -73.83492265877      -13.00       -6.84    4.0    5.06s
 14   -73.83492265877   +  -13.55       -7.45    5.0    6.12s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.3661993684279975e-8,6.181249761767617e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.383492e+01     2.647256e-07
 * time: 732.4994120597839
 * Status: success

 * Candidate solution
    Final objective value:     -7.383492e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.84e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.23e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.58e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.49e-11 ≰ 0.0e+00
    |g(x)|                 = 2.65e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   732  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

V: 880.161171 seconds (556.23 M allocations: 261.704 GiB, 6.13% gc time, 0.01% compilation time)
