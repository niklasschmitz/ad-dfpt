┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-13T15:37:20.446
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460840446385                   -0.96    7.0    13.5s
  2   -8.462407097781       -2.81       -1.73    1.9    8.46s
  3   -8.462490491421       -4.08       -2.74    3.9    2.82s
  4   -8.462493998822       -5.46       -3.54    4.8    3.60s
  5   -8.462494160009       -6.79       -4.38    5.0    2.55s
  6   -8.462494165795       -8.24       -5.29    5.4    2.31s
  7   -8.462494165850      -10.26       -6.39    4.8    2.39s
  8   -8.462494165851      -12.43       -7.17    4.7    1.87s
Iter     Function value   Gradient norm 
     0    -8.462494e+00     3.461452e-04
 * time: 5.0067901611328125e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460845859986                   -0.96    6.9    3.65s
  2   -8.462406021063       -2.81       -1.73    1.9    1.50s
  3   -8.462490421344       -4.07       -2.74    3.9    2.67s
  4   -8.462494113165       -5.43       -3.53    4.7    2.98s
  5   -8.462494275676       -6.79       -4.38    5.0    2.65s
  6   -8.462494281500       -8.23       -5.28    5.2    3.40s
  7   -8.462494281554      -10.27       -6.37    4.8    2.49s
  8   -8.462494281554      -12.45       -7.16    4.6    2.23s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460837406949                   -0.96    7.0    2.68s
  2   -8.462403782644       -2.81       -1.73    1.7    1.46s
  3   -8.462490590798       -4.06       -2.74    3.9    1.71s
  4   -8.462494112390       -5.45       -3.55    4.8    2.19s
  5   -8.462494275374       -6.79       -4.36    4.8    1.86s
  6   -8.462494281491       -8.21       -5.28    5.2    2.24s
  7   -8.462494281554      -10.20       -6.16    4.8    2.02s
  8   -8.462494281554      -12.23       -6.98    4.4    2.17s
  9   -8.462494281554      -13.85       -7.70    4.1    1.94s
     1    -8.462494e+00     3.223994e-04
 * time: 56.46313405036926
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460874821767                   -0.96    6.9    2.71s
  2   -8.462407005510       -2.81       -1.73    1.9    1.20s
  3   -8.462491329050       -4.07       -2.74    3.8    2.03s
  4   -8.462494870882       -5.45       -3.54    4.7    2.34s
  5   -8.462495034560       -6.79       -4.38    4.9    2.01s
  6   -8.462495040591       -8.22       -5.29    5.2    2.24s
  7   -8.462495040648      -10.24       -6.35    4.6    2.04s
  8   -8.462495040648      -12.35       -7.11    4.7    2.75s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.460849612478                   -0.96    6.9    3.55s
  2   -8.462404360747       -2.81       -1.73    1.9    2.31s
  3   -8.462491183057       -4.06       -2.74    3.8    2.82s
  4   -8.462494873706       -5.43       -3.53    4.7    3.52s
  5   -8.462495034889       -6.79       -4.41    5.0    2.22s
  6   -8.462495040594       -8.24       -5.28    5.3    3.57s
  7   -8.462495040648      -10.26       -6.25    4.8    2.62s
  8   -8.462495040648      -12.58       -7.03    4.0    2.19s
     2    -8.462495e+00     8.960152e-07
 * time: 111.92973899841309
 * Status: success

 * Candidate solution
    Final objective value:     -8.462495e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 4.70e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.54e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 7.59e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 8.97e-08 ≰ 0.0e+00
    |g(x)|                 = 8.96e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   112  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Si: 208.375482 seconds (253.18 M allocations: 45.348 GiB, 6.73% gc time, 31.75% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-13T15:40:49.748
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.28527657536                   -1.11    8.4    27.0s
  2   -62.29147886441       -2.21       -1.21    2.8    9.26s
  3   -62.29547835749       -2.40       -2.02    3.8    11.4s
  4   -62.29553654199       -4.24       -2.88    3.1    10.0s
  5   -62.29553781408       -5.90       -3.57    4.2    12.4s
  6   -62.29553810277       -6.54       -4.10    3.6    9.83s
  7   -62.29553811204       -8.03       -4.64    3.7    10.8s
  8   -62.29553811248       -9.36       -5.84    3.7    12.0s
  9   -62.29553811249      -11.16       -6.84    4.3    13.6s
 10   -62.29553811249      -13.85       -7.59    4.1    12.5s
Iter     Function value   Gradient norm 
     0    -6.229554e+01     7.578412e-03
 * time: 4.482269287109375e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.28530959207                   -1.11    8.6    22.0s
  2   -62.29151116286       -2.21       -1.21    2.7    8.03s
  3   -62.29553484848       -2.40       -2.02    3.5    9.90s
  4   -62.29559337234       -4.23       -2.89    3.0    12.6s
  5   -62.29559463972       -5.90       -3.58    4.1    13.8s
  6   -62.29559491818       -6.56       -4.12    3.6    11.6s
  7   -62.29559492702       -8.05       -4.65    3.6    12.2s
  8   -62.29559492746       -9.36       -5.80    3.5    12.2s
  9   -62.29559492746      -11.12       -6.73    4.5    15.1s
 10   -62.29559492746      -13.11       -7.76    4.1    11.7s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.28530657671                   -1.11    8.4    18.7s
  2   -62.29151651414       -2.21       -1.21    2.7    8.69s
  3   -62.29553395859       -2.40       -2.02    3.6    9.61s
  4   -62.29559331906       -4.23       -2.87    2.9    9.13s
  5   -62.29559461140       -5.89       -3.55    3.9    11.3s
  6   -62.29559491733       -6.51       -4.09    3.8    10.7s
  7   -62.29559492699       -8.02       -4.67    3.7    11.7s
  8   -62.29559492746       -9.33       -5.93    3.6    13.0s
  9   -62.29559492746      -11.14       -6.77    4.5    15.4s
 10   -62.29559492746   +  -13.25       -7.75    4.1    12.5s
     1    -6.229559e+01     7.415672e-03
 * time: 290.8935170173645
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.28512009955                   -1.09    8.3    27.3s
  2   -62.29174176138       -2.18       -1.17    2.6    12.3s
  3   -62.29691938535       -2.29       -1.97    3.5    11.4s
  4   -62.29700069457       -4.09       -2.84    2.7    9.42s
  5   -62.29700212273       -5.85       -3.46    3.8    12.2s
  6   -62.29700256224       -6.36       -4.04    3.6    13.1s
  7   -62.29700257529       -7.88       -4.64    3.6    11.4s
  8   -62.29700257590       -9.22       -5.93    3.6    10.9s
  9   -62.29700257592      -10.67       -6.50    4.8    14.1s
 10   -62.29700257592      -12.69       -7.57    3.4    11.1s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.28511814478                   -1.09    8.4    20.8s
  2   -62.29170658737       -2.18       -1.17    2.6    9.91s
  3   -62.29692065180       -2.28       -1.97    3.6    10.4s
  4   -62.29700077132       -4.10       -2.88    2.7    12.0s
  5   -62.29700218468       -5.85       -3.54    4.0    11.7s
  6   -62.29700256407       -6.42       -4.11    3.6    11.7s
  7   -62.29700257534       -7.95       -4.64    3.7    12.0s
  8   -62.29700257590       -9.25       -5.99    3.5    10.4s
  9   -62.29700257592      -10.77       -6.40    4.9    13.0s
 10   -62.29700257592      -12.69       -7.76    3.3    10.3s
     2    -6.229700e+01     1.083881e-03
 * time: 585.5778298377991
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.28485669823                   -1.09    8.8    20.7s
  2   -62.29152064158       -2.18       -1.16    2.7    8.32s
  3   -62.29695365004       -2.26       -1.96    3.5    9.79s
  4   -62.29703808612       -4.07       -2.85    2.8    8.73s
  5   -62.29703949879       -5.85       -3.49    3.9    11.4s
  6   -62.29703992384       -6.37       -4.06    3.7    11.4s
  7   -62.29703993623       -7.91       -4.61    3.8    11.2s
  8   -62.29703993688       -9.19       -5.91    3.5    11.1s
  9   -62.29703993690      -10.74       -6.53    4.6    14.2s
 10   -62.29703993690      -13.30       -7.73    3.6    12.0s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.28485750101                   -1.09    8.7    19.8s
  2   -62.29149512941       -2.18       -1.16    2.9    9.44s
  3   -62.29695497161       -2.26       -1.96    3.6    10.8s
  4   -62.29703809524       -4.08       -2.89    2.6    11.8s
  5   -62.29703956050       -5.83       -3.55    3.9    14.1s
  6   -62.29703992497       -6.44       -4.12    3.5    10.6s
  7   -62.29703993627       -7.95       -4.62    3.5    11.2s
  8   -62.29703993688       -9.21       -5.87    3.3    10.5s
  9   -62.29703993690      -10.67       -6.37    4.6    16.5s
 10   -62.29703993690      -12.57       -7.42    3.4    13.4s
     3    -6.229704e+01     1.883703e-04
 * time: 871.2321548461914
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.28478728981                   -1.09    8.4    21.1s
  2   -62.29145735075       -2.18       -1.16    2.7    8.15s
  3   -62.29695544174       -2.26       -1.96    3.5    12.5s
  4   -62.29703925942       -4.08       -2.87    2.7    8.71s
  5   -62.29704071713       -5.84       -3.50    3.9    12.9s
  6   -62.29704113176       -6.38       -4.07    3.5    10.7s
  7   -62.29704114363       -7.93       -4.61    3.5    10.9s
  8   -62.29704114434       -9.15       -5.91    3.4    13.4s
  9   -62.29704114436      -10.66       -6.40    4.6    14.1s
 10   -62.29704114437      -12.63       -7.53    3.4    10.2s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.28478835722                   -1.09    8.5    19.9s
  2   -62.29144903609       -2.18       -1.16    2.7    7.97s
  3   -62.29695509363       -2.26       -1.96    3.5    9.85s
  4   -62.29703916839       -4.08       -2.90    2.4    8.55s
  5   -62.29704076357       -5.80       -3.54    3.9    11.7s
  6   -62.29704113268       -6.43       -4.12    3.6    11.0s
  7   -62.29704114361       -7.96       -4.57    3.6    10.8s
  8   -62.29704114434       -9.14       -5.92    3.3    10.9s
  9   -62.29704114436      -10.62       -6.22    4.8    13.1s
 10   -62.29704114437      -12.59       -7.16    3.0    9.53s
     4    -6.229704e+01     6.182445e-06
 * time: 1143.6842489242554
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.28478173874                   -1.09    8.3    18.8s
  2   -62.29145759727       -2.18       -1.16    2.6    7.90s
  3   -62.29695435761       -2.26       -1.96    3.4    10.2s
  4   -62.29703924766       -4.07       -2.87    2.6    8.72s
  5   -62.29704072671       -5.83       -3.51    3.9    12.1s
  6   -62.29704113326       -6.39       -4.08    3.4    12.0s
  7   -62.29704114494       -7.93       -4.60    3.6    10.5s
  8   -62.29704114565       -9.15       -5.89    3.4    11.7s
  9   -62.29704114568      -10.67       -6.43    4.7    14.0s
 10   -62.29704114568      -12.75       -7.66    3.5    10.4s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.28477940997                   -1.09    8.4    18.9s
  2   -62.29148309132       -2.17       -1.16    2.6    7.60s
  3   -62.29695388642       -2.26       -1.96    3.6    9.43s
  4   -62.29703924269       -4.07       -2.86    2.6    8.38s
  5   -62.29704070078       -5.84       -3.48    3.9    10.9s
  6   -62.29704113182       -6.37       -4.07    3.5    12.6s
  7   -62.29704114494       -7.88       -4.61    3.4    10.5s
  8   -62.29704114565       -9.15       -5.84    3.5    11.2s
  9   -62.29704114568      -10.66       -6.56    4.5    14.2s
 10   -62.29704114568      -12.87       -7.72    3.7    11.6s
     5    -6.229704e+01     3.691316e-08
 * time: 1416.8511099815369
 * Status: success

 * Candidate solution
    Final objective value:     -6.229704e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 4.22e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.78e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.31e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.10e-11 ≰ 0.0e+00
    |g(x)|                 = 3.69e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   1417  (vs limit Inf)
    Iterations:    5
    f(x) calls:    6
    ∇f(x) calls:   6

NaCl: 1578.254035 seconds (1.41 G allocations: 399.506 GiB, 5.29% gc time, 0.32% compilation time)
┌ Info: 2025-05-13T16:07:08.042
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316967823297                   -1.46    5.4    1.80s
  2   -2.317042629865       -4.13       -1.84    1.3    819ms
  3   -2.317059322414       -4.78       -3.58    3.1    1.74s
  4   -2.317059489059       -6.78       -4.10    4.6    2.34s
  5   -2.317059489532       -9.33       -4.43    2.5    1.19s
  6   -2.317059489647       -9.94       -5.02    2.7    1.26s
  7   -2.317059489651      -11.37       -5.71    2.4    1.39s
  8   -2.317059489651      -12.73       -6.53    2.6    1.12s
  9   -2.317059489651      -14.21       -7.09    2.7    1.43s
Iter     Function value   Gradient norm 
     0    -2.317059e+00     4.723723e-04
 * time: 3.790855407714844e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316970245982                   -1.46    5.5    2.77s
  2   -2.317042825038       -4.14       -1.84    1.3    1.22s
  3   -2.317059453820       -4.78       -3.57    3.2    1.96s
  4   -2.317059707666       -6.60       -4.08    4.6    1.76s
  5   -2.317059708150       -9.31       -4.41    2.3    1.38s
  6   -2.317059708271       -9.92       -5.01    2.7    1.18s
  7   -2.317059708275      -11.42       -5.72    2.3    1.05s
  8   -2.317059708275      -12.78       -6.57    2.8    2.00s
  9   -2.317059708275      -14.24       -7.21    2.7    1.41s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316968747887                   -1.46    5.4    2.09s
  2   -2.317042501299       -4.13       -1.84    1.3    764ms
  3   -2.317059478753       -4.77       -3.57    3.1    1.26s
  4   -2.317059707652       -6.64       -4.08    4.6    1.94s
  5   -2.317059708143       -9.31       -4.40    2.4    1.10s
  6   -2.317059708271       -9.89       -5.00    2.7    1.39s
  7   -2.317059708275      -11.39       -5.70    2.3    975ms
  8   -2.317059708275      -12.75       -6.58    2.6    1.40s
  9   -2.317059708275      -14.24       -7.20    2.9    1.16s
     1    -2.317060e+00     4.532694e-04
 * time: 60.94211506843567
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316973883766                   -1.46    5.6    2.17s
  2   -2.317045532726       -4.14       -1.84    1.3    1.10s
  3   -2.317062039612       -4.78       -3.55    3.3    1.37s
  4   -2.317062263580       -6.65       -4.05    4.5    2.00s
  5   -2.317062264158       -9.24       -4.36    2.5    1.11s
  6   -2.317062264313       -9.81       -4.96    2.7    1.15s
  7   -2.317062264318      -11.28       -5.58    2.5    1.40s
  8   -2.317062264319      -12.48       -6.53    2.6    1.18s
  9   -2.317062264319      -14.01       -7.15    3.0    1.54s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316973353698                   -1.46    5.6    2.46s
  2   -2.317045402188       -4.14       -1.84    1.4    898ms
  3   -2.317062019692       -4.78       -3.56    3.2    1.84s
  4   -2.317062263583       -6.61       -4.05    4.6    2.09s
  5   -2.317062264162       -9.24       -4.37    2.6    1.67s
  6   -2.317062264313       -9.82       -4.96    2.7    1.29s
  7   -2.317062264318      -11.29       -5.58    2.6    1.62s
  8   -2.317062264319      -12.51       -6.54    2.5    1.38s
  9   -2.317062264319      -14.01       -7.09    3.2    1.45s
     2    -2.317062e+00     3.751544e-06
 * time: 118.65743207931519
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316972941297                   -1.46    5.6    1.92s
  2   -2.317045227295       -4.14       -1.84    1.3    1.17s
  3   -2.317062046693       -4.77       -3.55    3.2    1.35s
  4   -2.317062263694       -6.66       -4.03    4.6    2.01s
  5   -2.317062264322       -9.20       -4.35    2.5    1.12s
  6   -2.317062264490       -9.77       -4.95    2.8    1.48s
  7   -2.317062264495      -11.33       -5.57    2.4    1.13s
  8   -2.317062264495      -12.48       -6.57    2.7    1.17s
  9   -2.317062264495      -14.03       -7.15    3.2    1.70s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.316974320630                   -1.46    5.6    2.16s
  2   -2.317045478964       -4.15       -1.84    1.4    845ms
  3   -2.317062070407       -4.78       -3.56    3.3    1.59s
  4   -2.317062263737       -6.71       -4.04    4.6    1.72s
  5   -2.317062264332       -9.23       -4.36    2.5    1.43s
  6   -2.317062264489       -9.80       -4.95    2.8    1.19s
  7   -2.317062264495      -11.27       -5.59    2.5    1.69s
  8   -2.317062264495      -12.56       -6.56    2.6    1.24s
  9   -2.317062264495      -14.05       -7.17    3.3    1.68s
     3    -2.317062e+00     1.575148e-08
 * time: 175.76630187034607
 * Status: success

 * Candidate solution
    Final objective value:     -2.317062e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 9.35e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.23e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.76e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 7.61e-11 ≰ 0.0e+00
    |g(x)|                 = 1.58e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   176  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Al: 212.331889 seconds (157.74 M allocations: 37.489 GiB, 6.42% gc time, 0.00% compilation time)
┌ Info: 2025-05-13T16:10:40.374
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.79922696648                   -0.91    9.5    9.65s
  2   -73.80830533346       -2.04       -1.11    5.3    5.63s
  3   -73.81378261859       -2.26       -1.47    6.8    7.43s
  4   -73.81456915594       -3.10       -1.81    5.6    6.88s
  5   -73.81470222978       -3.88       -2.22    5.0    6.48s
  6   -73.81472455866       -4.65       -3.08    5.4    6.32s
  7   -73.81472458199       -7.63       -3.48    4.9    5.76s
  8   -73.81472458564       -8.44       -4.05    3.3    4.71s
  9   -73.81472458591       -9.57       -4.53    4.1    6.21s
 10   -73.81472458594      -10.53       -4.86    4.4    5.55s
 11   -73.81472458595      -10.78       -5.64    4.9    5.87s
 12   -73.81472458595      -11.97       -6.40    4.7    6.34s
 13   -73.81472458595      -13.37       -6.77    5.4    6.76s
 14   -73.81472458595      -13.55       -7.11    5.4    6.44s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.381472e+01     1.277348e-03
 * time: 3.0040740966796875e-5
┌ Warning: Negative ρcore detected: -3.416434138898845e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.79920439145                   -0.91    9.6    10.0s
  2   -73.80830135495       -2.04       -1.11    5.3    6.55s
  3   -73.81378354618       -2.26       -1.47    6.7    8.48s
  4   -73.81457084135       -3.10       -1.81    5.5    6.36s
  5   -73.81470395785       -3.88       -2.22    5.0    5.78s
  6   -73.81472606781       -4.66       -3.08    5.5    6.28s
  7   -73.81472608948       -7.66       -3.48    4.8    5.63s
  8   -73.81472609350       -8.40       -4.05    3.7    4.68s
  9   -73.81472609381       -9.50       -4.52    4.5    5.30s
 10   -73.81472609382      -10.99       -4.85    3.5    4.46s
 11   -73.81472609384      -10.81       -5.63    4.8    5.57s
 12   -73.81472609384      -11.88       -6.42    4.7    5.89s
 13   -73.81472609384      -13.37       -6.80    5.4    6.07s
 14   -73.81472609384   +  -13.37       -7.11    5.4    5.85s
┌ Warning: Negative ρcore detected: -3.416434138898845e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.79920460689                   -0.91    9.7    9.63s
  2   -73.80830194894       -2.04       -1.11    5.3    5.73s
  3   -73.81378348568       -2.26       -1.47    6.6    7.51s
  4   -73.81457069219       -3.10       -1.81    5.6    6.33s
  5   -73.81470393529       -3.88       -2.22    4.9    6.01s
  6   -73.81472606898       -4.65       -3.08    5.5    6.80s
  7   -73.81472608918       -7.69       -3.47    4.7    5.64s
  8   -73.81472609343       -8.37       -4.03    3.8    5.01s
  9   -73.81472609381       -9.41       -4.52    4.6    5.95s
 10   -73.81472609382      -11.07       -4.83    3.7    4.59s
 11   -73.81472609384      -10.77       -5.64    4.8    5.34s
 12   -73.81472609384      -11.92       -6.40    4.8    5.54s
 13   -73.81472609384      -13.07       -6.79    5.2    5.84s
 14   -73.81472609384   +  -13.55       -7.11    5.4    6.35s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.416434138898845e-8,-7.095678900661339e-9)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.381473e+01     1.083388e-03
 * time: 237.13918089866638
┌ Warning: Negative ρcore detected: -3.411139428951196e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.79908718472                   -0.91    9.8    10.9s
  2   -73.80831426917       -2.03       -1.11    5.4    5.78s
  3   -73.81377469313       -2.26       -1.47    6.9    7.29s
  4   -73.81457703620       -3.10       -1.81    5.6    5.81s
  5   -73.81470834485       -3.88       -2.23    5.1    6.10s
  6   -73.81472994932       -4.67       -3.09    5.6    6.93s
  7   -73.81472996913       -7.70       -3.50    4.6    5.63s
  8   -73.81472997238       -8.49       -4.05    3.4    4.40s
  9   -73.81472997277       -9.42       -4.59    4.4    5.15s
 10   -73.81472997282      -10.24       -4.87    5.3    5.71s
 11   -73.81472997284      -10.86       -5.78    4.8    5.43s
 12   -73.81472997284      -12.49       -6.50    4.8    5.66s
 13   -73.81472997284   +  -13.25       -6.85    4.5    5.29s
 14   -73.81472997284      -13.55       -7.25    5.2    5.60s
┌ Warning: Negative ρcore detected: -3.411139428951196e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.79908710560                   -0.91    9.8    10.2s
  2   -73.80829727397       -2.04       -1.11    5.4    5.92s
  3   -73.81377809453       -2.26       -1.47    7.0    7.68s
  4   -73.81457716090       -3.10       -1.81    5.7    6.37s
  5   -73.81470812745       -3.88       -2.23    5.0    7.31s
  6   -73.81472994921       -4.66       -3.09    5.5    6.51s
  7   -73.81472996893       -7.71       -3.49    4.7    6.43s
  8   -73.81472997243       -8.46       -4.06    3.3    5.43s
  9   -73.81472997279       -9.44       -4.59    4.5    7.07s
 10   -73.81472997282      -10.51       -4.87    4.9    7.29s
 11   -73.81472997284      -10.86       -5.75    4.8    7.36s
 12   -73.81472997284      -12.32       -6.50    4.9    5.86s
 13   -73.81472997284   +  -13.25       -6.92    4.4    5.63s
 14   -73.81472997284      -13.25       -7.24    5.2    5.87s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.411139428951196e-8,2.1673960064950658e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.381473e+01     5.230855e-06
 * time: 485.7169678211212
┌ Warning: Negative ρcore detected: -3.4110641361753215e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.79907902679                   -0.91    9.8    9.75s
  2   -73.80829519932       -2.04       -1.11    5.4    5.87s
  3   -73.81378087997       -2.26       -1.47    6.8    7.49s
  4   -73.81457652543       -3.10       -1.81    5.7    6.17s
  5   -73.81470801132       -3.88       -2.23    5.0    5.63s
  6   -73.81472994967       -4.66       -3.09    5.6    6.34s
  7   -73.81472996884       -7.72       -3.49    4.5    6.10s
  8   -73.81472997246       -8.44       -4.05    3.5    4.71s
  9   -73.81472997290       -9.36       -4.59    4.7    5.56s
 10   -73.81472997292      -10.67       -4.86    4.7    5.24s
 11   -73.81472997293      -10.84       -5.75    4.6    5.28s
 12   -73.81472997293      -12.26       -6.49    4.9    6.14s
 13   -73.81472997293   +    -Inf       -6.91    4.5    5.39s
 14   -73.81472997293      -13.15       -7.23    5.3    6.07s
┌ Warning: Negative ρcore detected: -3.4110641361753215e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.79907878729                   -0.91    9.7    12.6s
  2   -73.80829491132       -2.04       -1.11    5.3    7.11s
  3   -73.81377851392       -2.26       -1.47    6.8    8.73s
  4   -73.81457725468       -3.10       -1.81    5.6    6.26s
  5   -73.81470792073       -3.88       -2.22    5.0    5.78s
  6   -73.81472994978       -4.66       -3.09    5.6    6.32s
  7   -73.81472996905       -7.72       -3.49    4.6    5.66s
  8   -73.81472997249       -8.46       -4.05    3.3    4.77s
  9   -73.81472997288       -9.41       -4.60    4.5    5.65s
 10   -73.81472997292      -10.43       -4.87    5.0    5.75s
 11   -73.81472997293      -10.85       -5.76    4.7    5.45s
 12   -73.81472997293      -12.40       -6.49    4.9    5.65s
 13   -73.81472997293      -13.15       -6.87    4.6    5.37s
 14   -73.81472997293   +    -Inf       -7.23    5.3    5.87s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4110641361753215e-8,2.1809680411926527e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.381473e+01     1.531066e-08
 * time: 728.9204158782959
 * Status: success

 * Candidate solution
    Final objective value:     -7.381473e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.46e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 6.06e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 9.31e-11 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.26e-12 ≰ 0.0e+00
    |g(x)|                 = 1.53e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   729  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

V: 864.138017 seconds (558.32 M allocations: 264.058 GiB, 5.98% gc time, 0.01% compilation time)
