┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-13T21:41:05.026
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.461978859833                   -0.96    7.0    10.2s
  2   -8.463501647817       -2.82       -1.73    1.8    4.26s
  3   -8.463597706470       -4.02       -2.72    4.0    1.80s
  4   -8.463602634193       -5.31       -3.48    4.9    1.76s
  5   -8.463602940670       -6.51       -4.28    5.0    1.88s
  6   -8.463602953131       -7.90       -5.18    5.2    1.91s
  7   -8.463602953280       -9.83       -6.15    4.9    1.70s
  8   -8.463602953281      -11.93       -6.81    4.5    1.86s
  9   -8.463602953281      -13.41       -7.51    4.0    1.73s
Iter     Function value   Gradient norm 
     0    -8.463603e+00     8.831972e-04
 * time: 4.1961669921875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.462011070687                   -0.96    7.5    2.46s
  2   -8.463505386734       -2.83       -1.73    1.9    1.29s
  3   -8.463598324316       -4.03       -2.72    4.0    1.54s
  4   -8.463603379838       -5.30       -3.46    5.1    1.99s
  5   -8.463603694972       -6.50       -4.32    5.3    1.68s
  6   -8.463603706481       -7.94       -5.16    5.2    1.98s
  7   -8.463603706631       -9.82       -6.12    5.1    1.69s
  8   -8.463603706632      -12.08       -6.93    4.1    1.76s
  9   -8.463603706632      -13.10       -8.06    5.0    1.62s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.462008611701                   -0.96    7.3    2.41s
  2   -8.463507942689       -2.82       -1.73    1.9    1.05s
  3   -8.463598301787       -4.04       -2.72    4.0    1.87s
  4   -8.463603381915       -5.29       -3.47    5.1    1.99s
  5   -8.463603695294       -6.50       -4.32    5.1    1.66s
  6   -8.463603706510       -7.95       -5.16    5.3    1.99s
  7   -8.463603706632       -9.92       -6.07    5.1    1.67s
  8   -8.463603706632      -12.09       -6.85    3.9    1.72s
  9   -8.463603706632      -13.05       -8.13    4.9    1.57s
     1    -8.463604e+00     8.227815e-04
 * time: 44.099875926971436
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.462037004268                   -0.96    7.0    2.33s
  2   -8.463509313983       -2.83       -1.73    1.7    1.26s
  3   -8.463603111982       -4.03       -2.73    3.8    1.50s
  4   -8.463608339614       -5.28       -3.47    4.9    1.97s
  5   -8.463608665809       -6.49       -4.34    5.1    1.68s
  6   -8.463608676542       -7.97       -5.21    5.3    2.01s
  7   -8.463608676668       -9.90       -6.11    5.2    1.70s
  8   -8.463608676669      -12.07       -6.94    4.2    1.78s
  9   -8.463608676669      -13.06       -8.10    5.0    1.63s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.462033359541                   -0.96    7.0    2.35s
  2   -8.463509977953       -2.83       -1.73    1.8    1.01s
  3   -8.463603085354       -4.03       -2.73    3.9    1.75s
  4   -8.463608340493       -5.28       -3.46    5.1    1.98s
  5   -8.463608665731       -6.49       -4.34    5.2    1.70s
  6   -8.463608676533       -7.97       -5.18    5.5    2.04s
  7   -8.463608676668       -9.87       -6.08    5.1    1.67s
  8   -8.463608676669      -12.09       -6.93    4.0    1.74s
  9   -8.463608676669      -13.06       -8.09    5.0    1.63s
     2    -8.463609e+00     5.219456e-06
 * time: 87.11425185203552
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.462028778002                   -0.96    7.1    2.39s
  2   -8.463507486416       -2.83       -1.73    1.8    1.29s
  3   -8.463602932225       -4.02       -2.72    3.8    1.49s
  4   -8.463608343803       -5.27       -3.46    4.9    1.98s
  5   -8.463608665281       -6.49       -4.33    5.0    1.66s
  6   -8.463608676726       -7.94       -5.17    5.3    2.02s
  7   -8.463608676870       -9.84       -6.07    5.0    1.68s
  8   -8.463608676871      -12.07       -6.91    3.9    1.72s
  9   -8.463608676871      -13.06       -8.08    4.9    1.59s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.462031968993                   -0.96    7.1    2.34s
  2   -8.463508132137       -2.83       -1.73    1.8    1.02s
  3   -8.463602845326       -4.02       -2.73    3.8    1.72s
  4   -8.463608335390       -5.26       -3.46    4.9    1.95s
  5   -8.463608666018       -6.48       -4.34    5.3    1.69s
  6   -8.463608676731       -7.97       -5.16    5.3    2.01s
  7   -8.463608676870       -9.86       -5.95    5.1    1.63s
  8   -8.463608676871      -12.04       -6.62    3.5    1.63s
  9   -8.463608676871      -13.47       -7.90    3.9    1.41s
     3    -8.463609e+00     3.093447e-08
 * time: 129.7907738685608
 * Status: success

 * Candidate solution
    Final objective value:     -8.463609e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 7.68e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 7.41e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.02e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.38e-11 ≰ 0.0e+00
    |g(x)|                 = 3.09e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   130  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 198.971168 seconds (329.22 M allocations: 65.957 GiB, 7.60% gc time, 22.92% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-13T21:44:24.577
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30933986533                   -1.09    8.4    18.4s
  2   -62.31617413586       -2.17       -1.21    2.5    6.89s
  3   -62.31998060204       -2.42       -2.02    3.6    8.03s
  4   -62.32006035839       -4.10       -2.93    2.8    7.61s
  5   -62.32006352535       -5.50       -3.39    4.0    9.58s
  6   -62.32006370257       -6.75       -4.26    3.3    8.47s
  7   -62.32006373340       -7.51       -4.79    3.9    9.26s
  8   -62.32006373466       -8.90       -5.79    3.7    8.77s
  9   -62.32006373467      -11.06       -6.38    4.0    9.77s
 10   -62.32006373467      -12.58       -7.27    3.6    9.03s
Iter     Function value   Gradient norm 
     0    -6.232006e+01     1.073551e-02
 * time: 3.600120544433594e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30941556457                   -1.09    8.4    15.7s
  2   -62.31624145560       -2.17       -1.21    2.7    6.76s
  3   -62.32009438085       -2.41       -2.01    3.6    8.14s
  4   -62.32017441087       -4.10       -2.95    2.9    7.50s
  5   -62.32017752404       -5.51       -3.39    4.3    10.1s
  6   -62.32017768257       -6.80       -4.24    3.4    8.89s
  7   -62.32017771525       -7.49       -4.80    3.8    8.98s
  8   -62.32017771665       -8.85       -5.78    3.6    9.16s
  9   -62.32017771666      -11.07       -6.46    3.9    9.73s
 10   -62.32017771666      -12.64       -7.28    3.7    9.30s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30941645414                   -1.09    8.3    15.9s
  2   -62.31622838948       -2.17       -1.21    2.8    6.71s
  3   -62.32009491369       -2.41       -2.02    3.5    8.63s
  4   -62.32017443134       -4.10       -2.98    2.8    7.31s
  5   -62.32017757206       -5.50       -3.44    4.2    9.87s
  6   -62.32017768384       -6.95       -4.19    3.3    8.41s
  7   -62.32017771520       -7.50       -4.79    3.7    9.18s
  8   -62.32017771665       -8.84       -5.61    3.8    9.13s
  9   -62.32017771666      -11.03       -6.60    3.6    9.19s
 10   -62.32017771666      -12.59       -7.55    4.1    9.93s
     1    -6.232018e+01     1.049943e-02
 * time: 220.71780109405518
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30985758150                   -1.07    8.7    17.5s
  2   -62.31744649801       -2.12       -1.16    2.6    7.28s
  3   -62.32288669533       -2.26       -1.94    3.6    9.03s
  4   -62.32300647098       -3.92       -2.94    2.3    6.96s
  5   -62.32301072880       -5.37       -3.47    4.2    11.0s
  6   -62.32301100662       -6.56       -4.19    3.2    8.98s
  7   -62.32301105265       -7.34       -4.77    3.6    9.40s
  8   -62.32301105569       -8.52       -5.51    3.7    9.57s
  9   -62.32301105572      -10.47       -6.65    3.4    9.53s
 10   -62.32301105572      -12.10       -7.08    4.4    11.1s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30985683913                   -1.07    8.6    17.4s
  2   -62.31740721547       -2.12       -1.15    2.7    7.40s
  3   -62.32288761321       -2.26       -1.95    3.5    8.79s
  4   -62.32300660184       -3.92       -2.95    2.5    7.17s
  5   -62.32301075904       -5.38       -3.45    4.2    10.8s
  6   -62.32301100678       -6.61       -4.21    3.2    8.95s
  7   -62.32301105269       -7.34       -4.73    3.6    9.35s
  8   -62.32301105569       -8.52       -5.47    3.6    9.46s
  9   -62.32301105572      -10.48       -6.60    3.4    9.44s
 10   -62.32301105572      -12.17       -6.98    4.1    10.6s
 11   -62.32301105572      -13.15       -7.81    3.2    8.68s
     2    -6.232301e+01     1.976727e-03
 * time: 461.3344120979309
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30934928699                   -1.06    8.5    17.3s
  2   -62.31716549072       -2.11       -1.14    2.5    7.04s
  3   -62.32300887946       -2.23       -1.93    3.4    8.66s
  4   -62.32313992800       -3.88       -2.90    2.4    7.14s
  5   -62.32314427374       -5.36       -3.48    4.1    10.7s
  6   -62.32314474223       -6.33       -4.23    3.2    8.91s
  7   -62.32314479470       -7.28       -4.72    3.5    9.44s
  8   -62.32314479821       -8.45       -5.42    3.8    9.54s
  9   -62.32314479824      -10.49       -6.23    3.5    9.44s
 10   -62.32314479824      -12.36       -6.83    3.3    9.17s
 11   -62.32314479824      -13.15       -7.50    3.7    9.70s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30934962538                   -1.06    8.5    17.8s
  2   -62.31712029287       -2.11       -1.14    2.6    7.13s
  3   -62.32300937029       -2.23       -1.93    3.4    8.94s
  4   -62.32313988728       -3.88       -2.94    2.4    7.20s
  5   -62.32314443812       -5.34       -3.48    4.2    11.0s
  6   -62.32314474593       -6.51       -4.19    3.2    9.05s
  7   -62.32314479478       -7.31       -4.75    3.5    9.33s
  8   -62.32314479819       -8.47       -5.46    3.7    9.52s
  9   -62.32314479824      -10.31       -6.50    3.5    9.53s
 10   -62.32314479824      -12.03       -6.80    4.3    10.9s
 11   -62.32314479824      -12.83       -7.59    2.8    7.71s
     3    -6.232314e+01     4.633403e-04
 * time: 709.8884160518646
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30914627212                   -1.06    8.4    20.9s
  2   -62.31698682357       -2.11       -1.14    2.5    8.96s
  3   -62.32300949812       -2.22       -1.92    3.4    10.8s
  4   -62.32314438721       -3.87       -2.93    2.4    9.23s
  5   -62.32314890632       -5.34       -3.48    4.0    13.1s
  6   -62.32314926598       -6.44       -4.22    3.3    11.6s
  7   -62.32314931636       -7.30       -4.74    3.6    11.6s
  8   -62.32314931981       -8.46       -5.46    3.5    12.0s
  9   -62.32314931985      -10.39       -6.56    3.4    11.3s
 10   -62.32314931985      -12.23       -7.03    4.1    13.4s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30914705975                   -1.06    8.5    21.3s
  2   -62.31700628695       -2.10       -1.14    2.4    8.78s
  3   -62.32300842227       -2.22       -1.92    3.4    10.9s
  4   -62.32314433074       -3.87       -2.91    2.3    9.33s
  5   -62.32314884563       -5.35       -3.49    4.0    13.0s
  6   -62.32314926587       -6.38       -4.24    3.2    11.4s
  7   -62.32314931609       -7.30       -4.71    3.6    11.8s
  8   -62.32314931981       -8.43       -5.43    3.6    11.7s
  9   -62.32314931985      -10.41       -6.43    3.2    11.3s
 10   -62.32314931985      -12.37       -6.89    3.6    12.6s
 11   -62.32314931985      -13.07       -7.57    3.5    11.4s
     4    -6.232315e+01     2.774608e-05
 * time: 1002.5811579227448
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30913963423                   -1.06    8.6    21.8s
  2   -62.31694220814       -2.11       -1.14    2.7    9.21s
  3   -62.32301027130       -2.22       -1.92    3.3    11.0s
  4   -62.32314423255       -3.87       -2.96    2.4    9.01s
  5   -62.32314909583       -5.31       -3.50    4.3    13.8s
  6   -62.32314930275       -6.68       -4.14    3.4    12.0s
  7   -62.32314934664       -7.36       -4.74    3.4    10.6s
  8   -62.32314935025       -8.44       -5.39    3.8    13.2s
  9   -62.32314935036       -9.98       -6.07    3.7    12.5s
 10   -62.32314935036      -12.14       -6.48    3.5    12.1s
 11   -62.32314935036      -12.53       -7.45    3.0    11.1s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30913518984                   -1.06    8.6    21.7s
  2   -62.31696060159       -2.11       -1.14    2.8    8.91s
  3   -62.32301130017       -2.22       -1.92    3.6    11.4s
  4   -62.32314434844       -3.88       -2.96    2.3    8.81s
  5   -62.32314902364       -5.33       -3.51    4.3    13.8s
  6   -62.32314929981       -6.56       -4.15    3.3    11.8s
  7   -62.32314934672       -7.33       -4.77    3.4    10.9s
  8   -62.32314935029       -8.45       -5.37    3.8    12.5s
  9   -62.32314935036      -10.14       -6.08    3.3    11.6s
 10   -62.32314935036      -12.07       -6.59    3.5    11.9s
 11   -62.32314935036      -12.64       -7.25    3.2    11.7s
     5    -6.232315e+01     5.061968e-07
 * time: 1311.5698149204254
 * Status: success

 * Candidate solution
    Final objective value:     -6.232315e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.16e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.90e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 3.05e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 4.90e-10 ≰ 0.0e+00
    |g(x)|                 = 5.06e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   1312  (vs limit Inf)
    Iterations:    5
    f(x) calls:    6
    ∇f(x) calls:   6

NaCl: 1430.961989 seconds (1.58 G allocations: 433.598 GiB, 5.03% gc time, 0.20% compilation time)
┌ Info: 2025-05-13T22:08:15.564
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317026919144                   -1.46    5.4    1.71s
  2   -2.317102315009       -4.12       -1.84    1.4    765ms
  3   -2.317118820460       -4.78       -3.59    3.2    1.25s
  4   -2.317119024039       -6.69       -4.12    4.6    1.59s
  5   -2.317119024474       -9.36       -4.43    2.4    1.24s
  6   -2.317119024588       -9.94       -5.02    2.7    1.01s
  7   -2.317119024592      -11.39       -5.71    2.5    1.26s
  8   -2.317119024592      -12.75       -6.59    2.5    983ms
  9   -2.317119024592      -14.24       -7.15    3.0    1.13s
Iter     Function value   Gradient norm 
     0    -2.317119e+00     4.278675e-04
 * time: 2.9087066650390625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317026225332                   -1.46    5.4    1.93s
  2   -2.317102635438       -4.12       -1.84    1.4    731ms
  3   -2.317118924702       -4.79       -3.60    3.1    1.42s
  4   -2.317119203442       -6.55       -4.12    4.6    1.59s
  5   -2.317119203848       -9.39       -4.42    2.4    1.24s
  6   -2.317119203966       -9.93       -5.03    2.8    1.05s
  7   -2.317119203970      -11.48       -5.70    2.3    1.22s
  8   -2.317119203970      -12.72       -6.52    2.6    1.02s
  9   -2.317119203970      -14.12       -7.12    2.7    1.32s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317025397021                   -1.46    5.4    1.91s
  2   -2.317102206012       -4.11       -1.84    1.3    721ms
  3   -2.317118987467       -4.78       -3.58    3.1    1.44s
  4   -2.317119203383       -6.67       -4.10    4.6    1.63s
  5   -2.317119203844       -9.34       -4.42    2.4    1.24s
  6   -2.317119203966       -9.91       -5.02    2.7    1.07s
  7   -2.317119203970      -11.47       -5.69    2.3    1.19s
  8   -2.317119203970      -12.70       -6.55    2.7    1.02s
  9   -2.317119203970      -14.03       -7.17    2.8    1.32s
     1    -2.317119e+00     4.106007e-04
 * time: 50.75642704963684
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317032009215                   -1.46    5.6    1.97s
  2   -2.317105141503       -4.14       -1.84    1.4    729ms
  3   -2.317121079061       -4.80       -3.58    3.2    1.46s
  4   -2.317121303235       -6.65       -4.07    4.6    1.59s
  5   -2.317121303768       -9.27       -4.38    2.4    1.23s
┌ Warning: Eigensolver not converged
│   n_iter =
│    195-element Vector{Int64}:
│     3
│     3
│     4
│     4
│     ⋮
│     2
│     3
│     4
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/scf/self_consistent_field.jl:76
  6   -2.317121303914       -9.83       -4.98    2.8    1.13s
  7   -2.317121303919      -11.35       -5.56    2.5    1.27s
  8   -2.317121303919      -12.47       -6.48    2.6    1.02s
  9   -2.317121303919      -13.94       -6.87    3.0    1.38s
 10   -2.317121303919      -15.05       -7.38    1.8    811ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317034231357                   -1.46    5.5    1.90s
  2   -2.317105323051       -4.15       -1.84    1.3    719ms
  3   -2.317121147463       -4.80       -3.57    3.2    1.43s
  4   -2.317121303257       -6.81       -4.08    4.7    1.56s
  5   -2.317121303774       -9.29       -4.39    2.5    1.20s
  6   -2.317121303915       -9.85       -4.99    2.8    1.02s
  7   -2.317121303919      -11.36       -5.58    2.5    1.23s
  8   -2.317121303919      -12.51       -6.47    2.5    971ms
  9   -2.317121303919      -13.94       -7.00    3.1    1.34s
 10   -2.317121303919      -14.88       -7.58    1.8    803ms
     2    -2.317121e+00     2.959090e-06
 * time: 103.35913491249084
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317031516698                   -1.46    5.6    1.89s
  2   -2.317105610514       -4.13       -1.84    1.4    725ms
  3   -2.317121140110       -4.81       -3.59    3.2    1.43s
  4   -2.317121303426       -6.79       -4.10    4.6    1.62s
  5   -2.317121303893       -9.33       -4.40    2.5    1.24s
  6   -2.317121304025       -9.88       -5.00    2.7    1.14s
  7   -2.317121304029      -11.38       -5.61    2.7    1.40s
  8   -2.317121304029      -12.58       -6.41    2.5    998ms
  9   -2.317121304029      -13.92       -6.94    2.8    1.33s
 10   -2.317121304029   +  -15.35       -7.46    2.2    893ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317034348535                   -1.46    5.6    1.96s
  2   -2.317105156918       -4.15       -1.83    1.3    722ms
  3   -2.317121134511       -4.80       -3.56    3.2    1.48s
  4   -2.317121303298       -6.77       -4.05    4.6    1.57s
  5   -2.317121303873       -9.24       -4.37    2.5    1.29s
  6   -2.317121304024       -9.82       -4.96    2.7    1.02s
  7   -2.317121304029      -11.29       -5.58    2.5    1.26s
  8   -2.317121304029      -12.51       -6.50    2.6    996ms
  9   -2.317121304029      -13.95       -7.17    3.1    1.40s
     3    -2.317121e+00     1.214549e-08
 * time: 156.04136991500854
 * Status: success

 * Candidate solution
    Final objective value:     -2.317121e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 7.39e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 9.68e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.10e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 4.74e-11 ≰ 0.0e+00
    |g(x)|                 = 1.21e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   156  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Al: 186.653156 seconds (161.30 M allocations: 38.501 GiB, 6.19% gc time, 0.04% compilation time)
┌ Info: 2025-05-13T22:11:22.218
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80712583745                   -0.92    9.6    9.03s
  2   -73.81575469095       -2.06       -1.12    5.3    5.24s
  3   -73.82104052213       -2.28       -1.49    6.7    6.84s
  4   -73.82177198644       -3.14       -1.82    5.5    5.48s
  5   -73.82189829890       -3.90       -2.22    5.0    5.28s
  6   -73.82192040066       -4.66       -3.08    5.5    5.71s
  7   -73.82192042540       -7.61       -3.47    5.1    5.34s
  8   -73.82192042986       -8.35       -4.06    3.9    4.76s
  9   -73.82192043020       -9.48       -4.54    4.7    5.44s
 10   -73.82192043020      -11.73       -4.90    3.1    4.02s
 11   -73.82192043021      -10.92       -5.61    4.6    5.02s
 12   -73.82192043021      -11.71       -6.43    4.8    5.12s
 13   -73.82192043021      -13.55       -6.86    5.4    5.74s
 14   -73.82192043021   +  -13.55       -7.12    5.4    5.52s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.382192e+01     3.624300e-03
 * time: 4.100799560546875e-5
┌ Warning: Negative ρcore detected: -3.4169650924734894e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80707626266                   -0.92    9.6    9.22s
  2   -73.81578918456       -2.06       -1.12    5.3    5.18s
  3   -73.82104702646       -2.28       -1.49    6.8    7.02s
  4   -73.82178428493       -3.13       -1.82    5.5    5.68s
  5   -73.82191072387       -3.90       -2.23    5.1    5.35s
  6   -73.82193254032       -4.66       -3.09    5.6    5.83s
  7   -73.82193255977       -7.71       -3.48    4.6    5.63s
  8   -73.82193256401       -8.37       -4.04    3.6    4.37s
  9   -73.82193256449       -9.32       -4.59    4.8    5.32s
 10   -73.82193256450      -11.28       -4.92    3.6    4.20s
 11   -73.82193256451      -10.92       -5.70    4.7    4.86s
 12   -73.82193256451      -12.07       -6.51    4.9    5.29s
 13   -73.82193256451      -13.37       -6.92    5.4    5.80s
 14   -73.82193256451   +  -13.25       -7.18    5.3    5.45s
┌ Warning: Negative ρcore detected: -3.4169650924734894e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80707485958                   -0.92    9.6    9.13s
  2   -73.81577167096       -2.06       -1.12    5.2    5.31s
  3   -73.82104838729       -2.28       -1.49    6.8    6.89s
  4   -73.82178497013       -3.13       -1.82    5.5    5.59s
  5   -73.82191086113       -3.90       -2.23    5.0    5.33s
  6   -73.82193253938       -4.66       -3.09    5.5    5.76s
  7   -73.82193255983       -7.69       -3.48    4.7    5.15s
  8   -73.82193256403       -8.38       -4.04    3.7    4.39s
  9   -73.82193256449       -9.33       -4.59    4.7    5.23s
 10   -73.82193256450      -11.34       -4.92    3.6    4.19s
 11   -73.82193256451      -10.92       -5.71    4.7    4.98s
 12   -73.82193256451      -12.01       -6.51    4.8    5.23s
 13   -73.82193256451   +    -Inf       -6.92    5.3    5.72s
 14   -73.82193256451   +    -Inf       -7.17    5.4    5.44s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4169650924734894e-8,2.5426329007467965e-9)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.382193e+01     3.071946e-03
 * time: 215.7918040752411
┌ Warning: Negative ρcore detected: -3.333402215256072e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80675689194                   -0.92    9.7    9.24s
  2   -73.81579234343       -2.04       -1.12    5.4    5.49s
  3   -73.82105417235       -2.28       -1.48    6.9    7.07s
  4   -73.82182441887       -3.11       -1.83    5.6    5.59s
  5   -73.82194242966       -3.93       -2.23    5.1    5.45s
  6   -73.82196377721       -4.67       -3.12    5.6    5.80s
  7   -73.82196379624       -7.72       -3.52    4.7    5.19s
  8   -73.82196379876       -8.60       -4.12    4.2    4.96s
  9   -73.82196379924       -9.32       -4.63    4.3    4.66s
 10   -73.82196379940       -9.81       -5.09    5.2    5.38s
 11   -73.82196379940      -11.43       -5.99    5.0    5.08s
 12   -73.82196379940   +  -12.38       -6.42    6.0    6.11s
 13   -73.82196379940   +  -12.64       -6.92    3.2    3.76s
 14   -73.82196379940      -12.77       -7.29    3.9    4.26s
┌ Warning: Negative ρcore detected: -3.333402215256072e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80675512903                   -0.92    9.7    8.82s
  2   -73.81578296064       -2.04       -1.12    5.4    5.42s
  3   -73.82105575992       -2.28       -1.48    7.0    6.69s
  4   -73.82182379032       -3.11       -1.83    5.6    5.55s
  5   -73.82194305138       -3.92       -2.24    5.1    5.68s
  6   -73.82196377756       -4.68       -3.12    5.6    5.73s
  7   -73.82196379628       -7.73       -3.52    4.7    5.16s
  8   -73.82196379874       -8.61       -4.12    3.9    4.50s
  9   -73.82196379926       -9.29       -4.66    4.3    4.76s
 10   -73.82196379940       -9.86       -5.11    5.1    5.34s
 11   -73.82196379940      -11.40       -6.00    5.1    5.60s
 12   -73.82196379940   +  -12.36       -6.44    5.8    6.26s
 13   -73.82196379940   +  -12.67       -6.92    4.5    4.87s
 14   -73.82196379940      -13.07       -7.40    4.6    5.02s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.333402215256072e-8,7.826142450694033e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.382196e+01     3.792477e-05
 * time: 431.3132960796356
┌ Warning: Negative ρcore detected: -3.331419450578867e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80675155827                   -0.92    9.8    9.25s
  2   -73.81576908639       -2.04       -1.12    5.3    5.35s
  3   -73.82105952213       -2.28       -1.48    6.8    6.87s
  4   -73.82182332481       -3.12       -1.83    5.6    5.58s
  5   -73.82194204916       -3.93       -2.23    5.1    5.37s
  6   -73.82196378172       -4.66       -3.11    5.6    5.81s
  7   -73.82196380078       -7.72       -3.52    4.8    5.50s
  8   -73.82196380347       -8.57       -4.13    3.6    4.37s
  9   -73.82196380396       -9.31       -4.65    4.4    4.67s
 10   -73.82196380406       -9.99       -5.13    5.1    5.30s
 11   -73.82196380406      -11.41       -6.02    5.2    5.55s
 12   -73.82196380406   +  -12.36       -6.46    5.8    6.21s
 13   -73.82196380406   +  -12.70       -6.94    4.2    4.37s
 14   -73.82196380406      -12.85       -7.39    4.2    4.54s
┌ Warning: Negative ρcore detected: -3.331419450578867e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80675274977                   -0.92    9.7    9.19s
  2   -73.81578579823       -2.04       -1.12    5.3    5.11s
  3   -73.82105519787       -2.28       -1.48    7.0    6.90s
  4   -73.82182400618       -3.11       -1.83    5.7    5.57s
  5   -73.82194252430       -3.93       -2.23    5.2    5.55s
  6   -73.82196378242       -4.67       -3.11    5.6    5.95s
  7   -73.82196380099       -7.73       -3.52    4.9    5.36s
  8   -73.82196380348       -8.60       -4.14    4.1    4.84s
  9   -73.82196380392       -9.35       -4.65    4.3    4.72s
 10   -73.82196380406       -9.87       -5.05    5.2    5.14s
 11   -73.82196380406      -11.22       -6.04    5.0    5.28s
 12   -73.82196380406   +  -12.30       -6.42    5.9    5.83s
 13   -73.82196380406   +  -12.70       -6.86    4.6    4.69s
 14   -73.82196380406      -13.25       -7.47    4.4    4.78s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.331419450578867e-8,7.912782777432266e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.382196e+01     3.836033e-07
 * time: 647.6439061164856
 * Status: success

 * Candidate solution
    Final objective value:     -7.382196e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.52e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.40e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 4.66e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 6.32e-11 ≰ 0.0e+00
    |g(x)|                 = 3.84e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   648  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

V: 766.622806 seconds (561.35 M allocations: 265.371 GiB, 5.88% gc time, 0.01% compilation time)
