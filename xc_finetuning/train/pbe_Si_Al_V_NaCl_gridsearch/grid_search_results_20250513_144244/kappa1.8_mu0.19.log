┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-13T16:26:55.415
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.452231981773                   -0.96    6.9    11.8s
  2   -8.453829784879       -2.80       -1.74    1.8    4.81s
  3   -8.453914269078       -4.07       -2.75    3.8    1.95s
  4   -8.453917409631       -5.50       -3.55    4.9    2.19s
  5   -8.453917550218       -6.85       -4.35    5.0    1.84s
  6   -8.453917556107       -8.23       -5.28    5.2    2.24s
  7   -8.453917556163      -10.25       -6.24    4.6    1.83s
  8   -8.453917556163      -12.51       -6.96    4.1    1.91s
  9   -8.453917556163      -14.05       -7.77    4.1    1.86s
Iter     Function value   Gradient norm 
     0    -8.453918e+00     9.700312e-04
 * time: 4.100799560546875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.452236443042                   -0.96    7.2    2.62s
  2   -8.453832981322       -2.80       -1.74    1.8    1.39s
  3   -8.453915391368       -4.08       -2.75    4.0    1.69s
  4   -8.453918316249       -5.53       -3.56    4.8    2.14s
  5   -8.453918458785       -6.85       -4.32    4.9    1.87s
  6   -8.453918464847       -8.22       -5.25    5.2    2.59s
  7   -8.453918464914      -10.17       -6.06    4.5    2.28s
  8   -8.453918464915      -12.35       -7.01    4.0    2.00s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.452228421725                   -0.96    7.2    2.80s
  2   -8.453834890089       -2.79       -1.74    2.1    1.42s
  3   -8.453915210164       -4.10       -2.75    3.9    1.67s
  4   -8.453918318190       -5.51       -3.54    4.8    2.12s
  5   -8.453918459762       -6.85       -4.38    4.9    1.76s
  6   -8.453918464870       -8.29       -5.30    5.2    2.14s
  7   -8.453918464914      -10.35       -6.37    4.7    1.78s
  8   -8.453918464915      -12.48       -7.14    5.0    2.11s
     1    -8.453918e+00     9.035962e-04
 * time: 46.16407799720764
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.452216092130                   -0.96    7.3    3.09s
  2   -8.453839060333       -2.79       -1.75    2.0    1.46s
  3   -8.453921412384       -4.08       -2.75    4.0    2.45s
  4   -8.453924267215       -5.54       -3.57    4.9    1.91s
  5   -8.453924392522       -6.90       -4.34    5.0    2.58s
  6   -8.453924398526       -8.22       -5.30    5.3    2.04s
  7   -8.453924398569      -10.37       -6.50    4.6    2.19s
  8   -8.453924398569      -12.68       -7.17    4.5    1.88s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.452206467595                   -0.96    7.5    2.70s
  2   -8.453838608338       -2.79       -1.75    2.1    1.17s
  3   -8.453921352809       -4.08       -2.75    3.9    1.97s
  4   -8.453924267397       -5.54       -3.56    4.9    1.94s
  5   -8.453924392785       -6.90       -4.33    5.0    2.14s
  6   -8.453924398519       -8.24       -5.28    5.3    1.80s
  7   -8.453924398569      -10.30       -6.28    4.7    2.12s
  8   -8.453924398569      -12.45       -7.02    4.5    1.99s
     2    -8.453924e+00     6.068859e-06
 * time: 91.43896508216858
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.452205936871                   -0.96    7.4    2.68s
  2   -8.453836246540       -2.79       -1.75    2.0    1.45s
  3   -8.453921487560       -4.07       -2.75    4.0    1.70s
  4   -8.453924266926       -5.56       -3.57    4.9    2.17s
  5   -8.453924392696       -6.90       -4.33    5.0    1.82s
  6   -8.453924398788       -8.22       -5.30    5.2    2.18s
  7   -8.453924398833      -10.35       -6.28    4.7    1.79s
  8   -8.453924398834      -12.54       -7.01    4.3    1.96s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.452203583666                   -0.96    7.4    2.60s
  2   -8.453834550958       -2.79       -1.75    2.0    1.39s
  3   -8.453921379519       -4.06       -2.75    4.0    1.66s
  4   -8.453924265257       -5.54       -3.57    4.7    2.06s
  5   -8.453924392825       -6.89       -4.33    5.1    1.79s
  6   -8.453924398788       -8.22       -5.30    5.1    2.12s
  7   -8.453924398833      -10.35       -6.30    4.6    1.78s
  8   -8.453924398834      -12.56       -7.06    4.3    1.95s
     3    -8.453924e+00     3.758558e-08
 * time: 134.896910905838
 * Status: success

 * Candidate solution
    Final objective value:     -8.453924e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 8.80e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 8.52e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.65e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.13e-11 ≰ 0.0e+00
    |g(x)|                 = 3.76e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   135  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 216.485380 seconds (312.87 M allocations: 61.249 GiB, 7.42% gc time, 25.03% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-13T16:30:32.620
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.22893640239                   -1.12    8.4    18.8s
  2   -62.23474444185       -2.24       -1.22    2.6    7.59s
  3   -62.23856137250       -2.42       -2.03    3.7    8.82s
  4   -62.23861961829       -4.23       -2.84    2.8    8.09s
  5   -62.23862090310       -5.89       -3.42    3.8    9.78s
  6   -62.23862132500       -6.37       -4.06    3.6    9.31s
  7   -62.23862133475       -8.01       -4.57    3.7    9.93s
  8   -62.23862133531       -9.25       -5.96    3.6    9.41s
  9   -62.23862133532      -11.00       -6.47    4.7    11.8s
 10   -62.23862133532      -12.77       -7.71    3.6    9.86s
Iter     Function value   Gradient norm 
     0    -6.223862e+01     6.853373e-03
 * time: 3.409385681152344e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.22896464087                   -1.12    8.4    16.4s
  2   -62.23476896751       -2.24       -1.22    2.6    6.88s
  3   -62.23860728310       -2.42       -2.03    3.6    9.03s
  4   -62.23866608063       -4.23       -2.84    3.0    8.07s
  5   -62.23866738606       -5.88       -3.42    4.0    10.0s
  6   -62.23866780411       -6.38       -4.06    3.8    9.49s
  7   -62.23866781389       -8.01       -4.61    4.0    10.1s
  8   -62.23866781440       -9.30       -5.91    3.7    9.50s
  9   -62.23866781440      -11.09       -6.76    4.7    11.4s
 10   -62.23866781440      -12.92       -7.62    4.0    10.2s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.22896727160                   -1.12    8.4    16.4s
  2   -62.23474401226       -2.24       -1.22    2.7    7.05s
  3   -62.23860840347       -2.41       -2.03    3.7    8.59s
  4   -62.23866616240       -4.24       -2.88    3.0    7.88s
  5   -62.23866745077       -5.89       -3.50    4.0    9.91s
  6   -62.23866780538       -6.45       -4.13    3.7    9.28s
  7   -62.23866781394       -8.07       -4.65    4.0    9.94s
  8   -62.23866781440       -9.34       -5.93    3.6    9.21s
  9   -62.23866781440      -11.08       -6.87    4.7    11.2s
 10   -62.23866781440      -13.25       -7.78    4.3    10.4s
     1    -6.223867e+01     6.710625e-03
 * time: 231.49405598640442
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.22871468484                   -1.10    8.1    17.0s
  2   -62.23489165631       -2.21       -1.18    2.6    7.14s
  3   -62.23976879537       -2.31       -1.98    3.5    9.00s
  4   -62.23984790988       -4.10       -2.81    2.7    7.62s
  5   -62.23984945896       -5.81       -3.36    3.8    10.2s
  6   -62.23985002687       -6.25       -3.99    3.4    9.57s
  7   -62.23985004091       -7.85       -4.48    3.6    9.79s
  8   -62.23985004183       -9.03       -5.92    3.4    9.24s
  9   -62.23985004186      -10.61       -6.47    4.9    12.1s
 10   -62.23985004186      -12.97       -7.46    3.4    9.26s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.22871730603                   -1.10    8.2    16.6s
  2   -62.23488193169       -2.21       -1.18    2.5    7.05s
  3   -62.23976902419       -2.31       -1.98    3.5    8.95s
  4   -62.23984794914       -4.10       -2.83    2.6    7.50s
  5   -62.23984948095       -5.81       -3.39    3.8    10.1s
  6   -62.23985002774       -6.26       -4.03    3.4    8.99s
  7   -62.23985004105       -7.88       -4.54    3.6    9.74s
  8   -62.23985004183       -9.11       -5.93    3.5    9.40s
  9   -62.23985004186      -10.63       -6.37    4.8    11.6s
 10   -62.23985004186      -12.83       -7.50    3.4    9.12s
     2    -6.223985e+01     9.310819e-04
 * time: 461.93117117881775
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.22849211787                   -1.10    8.3    16.9s
  2   -62.23471567911       -2.21       -1.18    2.5    7.09s
  3   -62.23979322547       -2.29       -1.98    3.5    8.82s
  4   -62.23987577893       -4.08       -2.82    2.5    7.32s
  5   -62.23987738185       -5.80       -3.34    3.9    10.3s
  6   -62.23987797688       -6.23       -3.96    3.3    8.99s
  7   -62.23987799190       -7.82       -4.43    3.5    9.59s
  8   -62.23987799305       -8.94       -5.83    3.2    9.14s
  9   -62.23987799308      -10.48       -6.19    4.8    12.0s
 10   -62.23987799308      -12.63       -7.47    3.0    8.47s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.22849104904                   -1.10    8.3    16.5s
  2   -62.23471073793       -2.21       -1.18    2.6    7.16s
  3   -62.23979269437       -2.29       -1.98    3.4    8.92s
  4   -62.23987583889       -4.08       -2.82    2.6    7.49s
  5   -62.23987739731       -5.81       -3.36    3.8    10.0s
  6   -62.23987797749       -6.24       -4.00    3.4    9.43s
  7   -62.23987799219       -7.83       -4.51    3.7    9.85s
  8   -62.23987799305       -9.07       -5.91    3.4    9.53s
  9   -62.23987799308      -10.58       -6.46    4.8    11.7s
 10   -62.23987799308      -12.64       -7.45    3.5    9.25s
     3    -6.223988e+01     1.522809e-04
 * time: 694.6967611312866
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.22844200496                   -1.10    8.3    16.9s
  2   -62.23466943946       -2.21       -1.17    2.6    7.25s
  3   -62.23979424883       -2.29       -1.98    3.5    9.12s
  4   -62.23987665010       -4.08       -2.84    2.6    7.61s
  5   -62.23987822259       -5.80       -3.40    3.8    10.2s
  6   -62.23987877260       -6.26       -4.05    3.6    9.24s
  7   -62.23987878621       -7.87       -4.55    3.8    9.84s
  8   -62.23987878697       -9.12       -5.95    3.5    9.52s
  9   -62.23987878700      -10.62       -6.48    4.9    11.7s
 10   -62.23987878700      -12.64       -7.50    3.5    9.56s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.22844478316                   -1.10    8.3    17.3s
  2   -62.23465906536       -2.21       -1.17    2.5    7.25s
  3   -62.23979471530       -2.29       -1.98    3.6    8.89s
  4   -62.23987673793       -4.09       -2.86    2.5    7.81s
  5   -62.23987826143       -5.82       -3.44    3.8    9.83s
  6   -62.23987877389       -6.29       -4.08    3.6    9.50s
  7   -62.23987878631       -7.91       -4.55    3.7    9.62s
  8   -62.23987878697       -9.18       -5.93    3.4    9.33s
  9   -62.23987878700      -10.62       -6.43    4.9    11.6s
 10   -62.23987878700      -12.60       -7.57    3.4    9.40s
     4    -6.223988e+01     4.405450e-06
 * time: 928.6093909740448
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.22843995233                   -1.10    8.4    16.9s
  2   -62.23467443997       -2.21       -1.17    2.7    7.39s
  3   -62.23979450395       -2.29       -1.98    3.5    8.76s
  4   -62.23987665855       -4.09       -2.84    2.7    7.72s
  5   -62.23987822723       -5.80       -3.40    3.9    9.78s
  6   -62.23987877358       -6.26       -4.04    3.5    9.53s
  7   -62.23987878681       -7.88       -4.51    3.8    9.88s
  8   -62.23987878764       -9.08       -5.92    3.4    9.29s
  9   -62.23987878767      -10.60       -6.48    5.1    12.4s
 10   -62.23987878767      -13.07       -7.55    3.6    9.61s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.22844265442                   -1.10    8.5    17.5s
  2   -62.23467343400       -2.21       -1.17    2.6    7.16s
  3   -62.23979381594       -2.29       -1.98    3.6    9.05s
  4   -62.23987666809       -4.08       -2.83    2.8    7.74s
  5   -62.23987822055       -5.81       -3.40    3.8    10.0s
  6   -62.23987877342       -6.26       -4.04    3.5    9.16s
  7   -62.23987878693       -7.87       -4.55    3.7    9.87s
  8   -62.23987878764       -9.15       -5.94    3.4    9.11s
  9   -62.23987878767      -10.62       -6.47    5.0    12.0s
 10   -62.23987878767      -12.77       -7.49    3.5    9.22s
     5    -6.223988e+01     1.909878e-08
 * time: 1164.8608751296997
 * Status: success

 * Candidate solution
    Final objective value:     -6.223988e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.02e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.71e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 6.70e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.08e-11 ≰ 0.0e+00
    |g(x)|                 = 1.91e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   1165  (vs limit Inf)
    Iterations:    5
    f(x) calls:    6
    ∇f(x) calls:   6

NaCl: 1294.851855 seconds (1.41 G allocations: 398.681 GiB, 5.15% gc time, 0.25% compilation time)
┌ Info: 2025-05-13T16:52:07.536
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315774264720                   -1.46    5.5    1.97s
  2   -2.315857619954       -4.08       -1.84    1.4    762ms
  3   -2.315877389221       -4.70       -3.58    3.2    1.44s
  4   -2.315877650241       -6.58       -4.16    4.7    1.59s
  5   -2.315877650592       -9.45       -4.60    2.5    1.26s
  6   -2.315877650648      -10.25       -5.30    2.9    1.06s
  7   -2.315877650650      -11.63       -5.90    3.0    1.37s
  8   -2.315877650650      -13.44       -6.51    2.2    893ms
  9   -2.315877650650      -14.57       -7.32    2.6    990ms
Iter     Function value   Gradient norm 
     0    -2.315878e+00     1.126541e-03
 * time: 3.314018249511719e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315775333018                   -1.46    5.4    1.63s
  2   -2.315859036410       -4.08       -1.84    1.3    949ms
  3   -2.315878681516       -4.71       -3.56    3.3    1.20s
  4   -2.315878893749       -6.67       -4.14    4.5    1.77s
  5   -2.315878894135       -9.41       -4.59    2.5    969ms
  6   -2.315878894196      -10.21       -5.27    2.8    1.25s
  7   -2.315878894199      -11.57       -5.85    2.9    1.08s
  8   -2.315878894199      -13.27       -6.49    2.3    1.18s
  9   -2.315878894199      -14.51       -7.46    2.5    953ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315777145082                   -1.46    5.5    1.90s
  2   -2.315859662870       -4.08       -1.84    1.4    724ms
  3   -2.315878637617       -4.72       -3.58    3.3    1.43s
  4   -2.315878893786       -6.59       -4.15    4.6    1.55s
  5   -2.315878894138       -9.45       -4.60    2.5    1.23s
  6   -2.315878894196      -10.23       -5.29    2.7    1.02s
  7   -2.315878894199      -11.59       -5.88    3.0    1.33s
  8   -2.315878894199      -13.38       -6.46    2.1    864ms
  9   -2.315878894199      -14.57       -7.42    2.4    941ms
     1    -2.315879e+00     1.081197e-03
 * time: 50.18553805351257
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315795674591                   -1.45    5.4    1.61s
  2   -2.315874506227       -4.10       -1.83    1.4    966ms
  3   -2.315893250321       -4.73       -3.54    3.2    1.16s
  4   -2.315893465885       -6.67       -4.10    4.6    1.75s
  5   -2.315893466330       -9.35       -4.57    2.7    1.01s
  6   -2.315893466396      -10.18       -5.32    2.7    1.28s
  7   -2.315893466399      -11.58       -5.77    3.2    1.12s
  8   -2.315893466399      -13.12       -6.53    2.3    907ms
  9   -2.315893466399      -14.57       -7.05    2.7    1.24s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.315796448059                   -1.45    5.5    1.95s
  2   -2.315874998557       -4.10       -1.83    1.4    737ms
  3   -2.315893274594       -4.74       -3.56    3.3    1.43s
  4   -2.315893465978       -6.72       -4.15    4.6    1.55s
  5   -2.315893466341       -9.44       -4.60    2.7    1.34s
  6   -2.315893466397      -10.25       -5.40    2.9    1.05s
  7   -2.315893466399      -11.76       -5.94    3.2    1.41s
  8   -2.315893466399      -13.44       -6.61    2.2    866ms
  9   -2.315893466399      -14.88       -7.21    2.8    1.04s
     2    -2.315893e+00     5.443960e-08
 * time: 100.60433006286621
 * Status: success

 * Candidate solution
    Final objective value:     -2.315893e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.69e-02 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.53e-03 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.46e-05 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 6.29e-06 ≰ 0.0e+00
    |g(x)|                 = 5.44e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   101  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Al: 137.559222 seconds (113.11 M allocations: 26.891 GiB, 5.71% gc time, 0.00% compilation time)
┌ Info: 2025-05-13T16:54:25.096
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.75782520913                   -0.89    9.5    9.18s
  2   -73.76826777889       -1.98       -1.09    5.4    5.32s
  3   -73.77414534563       -2.23       -1.44    6.7    6.85s
  4   -73.77506109645       -3.04       -1.80    5.7    5.84s
  5   -73.77519875929       -3.86       -2.24    5.0    5.42s
  6   -73.77521927786       -4.69       -3.10    5.6    5.79s
  7   -73.77521930258       -7.61       -3.51    4.4    4.94s
  8   -73.77521930539       -8.55       -4.08    4.3    4.74s
  9   -73.77521930572       -9.48       -4.67    3.8    4.58s
 10   -73.77521930587       -9.82       -4.89    5.3    5.35s
 11   -73.77521930588      -10.86       -5.85    4.8    4.98s
 12   -73.77521930588      -13.07       -6.48    4.7    5.42s
 13   -73.77521930588   +  -13.37       -6.66    3.7    4.43s
 14   -73.77521930588      -12.94       -7.06    4.8    5.33s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.377522e+01     1.665523e-03
 * time: 3.504753112792969e-5
┌ Warning: Negative ρcore detected: -3.412538684043776e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.75785770750                   -0.89    9.6    8.78s
  2   -73.76827988110       -1.98       -1.09    5.4    5.31s
  3   -73.77414959137       -2.23       -1.44    6.8    6.82s
  4   -73.77506302783       -3.04       -1.80    5.7    5.52s
  5   -73.77520109341       -3.86       -2.24    5.1    5.26s
  6   -73.77522184076       -4.68       -3.10    5.6    6.00s
  7   -73.77522186670       -7.59       -3.51    4.5    4.95s
  8   -73.77522186950       -8.55       -4.07    4.2    4.66s
  9   -73.77522186986       -9.45       -4.67    3.8    4.62s
 10   -73.77522187001       -9.81       -4.89    5.4    5.42s
 11   -73.77522187003      -10.86       -5.84    4.7    4.96s
 12   -73.77522187003      -12.89       -6.48    4.6    5.34s
 13   -73.77522187003   +  -13.55       -6.62    4.0    4.49s
 14   -73.77522187003      -13.00       -7.05    4.8    5.15s
┌ Warning: Negative ρcore detected: -3.412538684043776e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.75786077474                   -0.89    9.7    9.11s
  2   -73.76827912664       -1.98       -1.09    5.3    5.26s
  3   -73.77414951290       -2.23       -1.44    6.9    6.49s
  4   -73.77506326789       -3.04       -1.80    5.7    5.38s
  5   -73.77520129233       -3.86       -2.24    5.1    5.12s
  6   -73.77522184211       -4.69       -3.10    5.5    5.79s
  7   -73.77522186678       -7.61       -3.52    4.5    5.07s
  8   -73.77522186948       -8.57       -4.07    4.2    4.78s
  9   -73.77522186985       -9.44       -4.67    3.9    4.49s
 10   -73.77522187001       -9.79       -4.90    5.4    5.62s
 11   -73.77522187003      -10.85       -5.84    4.7    5.34s
 12   -73.77522187003      -12.64       -6.49    4.7    5.44s
 13   -73.77522187003      -13.37       -6.61    4.2    4.73s
 14   -73.77522187003   +  -13.37       -7.05    4.8    4.93s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.412538684043776e-8,-1.9422843570739006e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.377522e+01     1.413373e-03
 * time: 213.60826706886292
┌ Warning: Negative ρcore detected: -3.375533983015207e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.75806894712                   -0.89    9.8    8.97s
  2   -73.76828066352       -1.99       -1.09    5.4    5.33s
  3   -73.77416858287       -2.23       -1.45    6.9    6.84s
  4   -73.77506560478       -3.05       -1.80    5.8    5.68s
  5   -73.77520817239       -3.85       -2.24    5.1    5.48s
  6   -73.77522841482       -4.69       -3.08    5.6    5.68s
  7   -73.77522843473       -7.70       -3.49    4.3    4.90s
  8   -73.77522843808       -8.47       -4.05    3.4    4.23s
  9   -73.77522843844       -9.45       -4.55    4.4    5.04s
 10   -73.77522843850      -10.21       -4.81    5.1    5.21s
 11   -73.77522843852      -10.65       -5.68    4.7    5.18s
 12   -73.77522843853      -11.99       -6.39    4.7    5.41s
 13   -73.77522843853      -13.85       -6.71    5.3    5.44s
 14   -73.77522843853      -13.85       -7.15    5.3    5.39s
┌ Warning: Negative ρcore detected: -3.375533983015207e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.75806496770                   -0.89    9.9    9.20s
  2   -73.76828308004       -1.99       -1.09    5.4    5.26s
  3   -73.77416862940       -2.23       -1.45    6.9    6.72s
  4   -73.77506521230       -3.05       -1.80    5.7    5.31s
  5   -73.77520746319       -3.85       -2.23    5.1    5.31s
  6   -73.77522841442       -4.68       -3.08    5.4    5.82s
  7   -73.77522843478       -7.69       -3.49    4.4    4.93s
  8   -73.77522843808       -8.48       -4.06    3.5    4.35s
  9   -73.77522843842       -9.46       -4.57    4.2    4.85s
 10   -73.77522843850      -10.09       -4.82    5.2    5.25s
 11   -73.77522843853      -10.64       -5.69    4.8    5.06s
 12   -73.77522843853      -12.10       -6.39    4.9    5.51s
 13   -73.77522843853      -13.15       -6.67    5.3    5.64s
 14   -73.77522843853      -13.07       -7.16    5.3    5.53s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.375533983015207e-8,-6.030101393628972e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.377523e+01     8.626025e-06
 * time: 429.7414119243622
┌ Warning: Negative ρcore detected: -3.3758747313472726e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.75807271083                   -0.89    9.8    8.93s
  2   -73.76828432737       -1.99       -1.09    5.4    5.78s
  3   -73.77416766747       -2.23       -1.44    6.9    6.74s
  4   -73.77506546988       -3.05       -1.80    5.7    5.73s
  5   -73.77520825110       -3.85       -2.24    5.1    5.46s
  6   -73.77522841561       -4.70       -3.09    5.7    6.13s
  7   -73.77522843498       -7.71       -3.50    4.3    4.86s
  8   -73.77522843833       -8.47       -4.06    3.4    4.26s
  9   -73.77522843869       -9.44       -4.55    4.4    4.79s
 10   -73.77522843875      -10.23       -4.80    5.1    5.13s
 11   -73.77522843877      -10.65       -5.68    4.7    4.94s
 12   -73.77522843877      -11.97       -6.40    4.7    5.23s
 13   -73.77522843877      -13.25       -6.73    5.2    5.60s
 14   -73.77522843877   +  -12.94       -7.16    5.3    5.55s
┌ Warning: Negative ρcore detected: -3.3758747313472726e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.75806146995                   -0.89    9.8    9.04s
  2   -73.76828910191       -1.99       -1.09    5.4    5.30s
  3   -73.77416775661       -2.23       -1.44    6.9    6.76s
  4   -73.77506540195       -3.05       -1.80    5.7    5.37s
  5   -73.77520791205       -3.85       -2.24    5.1    5.19s
  6   -73.77522841497       -4.69       -3.08    5.5    5.65s
  7   -73.77522843505       -7.70       -3.50    4.3    4.77s
  8   -73.77522843834       -8.48       -4.06    3.5    4.29s
  9   -73.77522843868       -9.47       -4.54    4.4    4.82s
 10   -73.77522843875      -10.14       -4.81    5.1    5.31s
 11   -73.77522843877      -10.67       -5.69    4.7    5.07s
 12   -73.77522843877      -12.03       -6.40    4.8    5.43s
 13   -73.77522843877      -12.73       -6.72    5.2    5.44s
 14   -73.77522843877   +  -13.55       -7.15    5.4    5.31s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.3758747313472726e-8,-6.004494594644357e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.377523e+01     4.512149e-08
 * time: 644.7576639652252
 * Status: success

 * Candidate solution
    Final objective value:     -7.377523e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 5.66e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 9.96e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.49e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.37e-12 ≰ 0.0e+00
    |g(x)|                 = 4.51e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   645  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

V: 776.217604 seconds (559.90 M allocations: 263.657 GiB, 5.80% gc time, 0.01% compilation time)
