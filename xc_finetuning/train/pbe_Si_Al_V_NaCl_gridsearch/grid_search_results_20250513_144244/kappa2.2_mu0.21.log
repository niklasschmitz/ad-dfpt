┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-13T19:57:00.530
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.461729646340                   -0.96    7.0    10.6s
  2   -8.463252715143       -2.82       -1.73    1.9    4.42s
  3   -8.463348112326       -4.02       -2.73    3.9    1.83s
  4   -8.463352882435       -5.32       -3.48    5.0    1.77s
  5   -8.463353153276       -6.57       -4.33    4.9    1.90s
  6   -8.463353163382       -8.00       -5.19    5.3    2.27s
  7   -8.463353163497       -9.94       -6.19    4.9    1.69s
  8   -8.463353163497      -12.17       -7.05    4.2    1.79s
Iter     Function value   Gradient norm 
     0    -8.463353e+00     7.599598e-04
 * time: 4.9114227294921875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.461725585653                   -0.96    6.9    2.39s
  2   -8.463255094019       -2.82       -1.73    1.7    1.29s
  3   -8.463348948390       -4.03       -2.72    3.9    1.53s
  4   -8.463353439461       -5.35       -3.50    4.9    2.05s
  5   -8.463353709975       -6.57       -4.29    5.0    1.73s
  6   -8.463353721147       -7.95       -5.20    5.1    1.98s
  7   -8.463353721262       -9.94       -6.14    4.8    1.71s
  8   -8.463353721263      -11.96       -6.85    4.3    1.83s
  9   -8.463353721263      -13.57       -7.67    4.1    1.43s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.461729036217                   -0.96    6.8    2.38s
  2   -8.463259027997       -2.82       -1.73    1.8    1.02s
  3   -8.463348906280       -4.05       -2.73    3.8    1.82s
  4   -8.463353444158       -5.34       -3.49    4.8    1.72s
  5   -8.463353711368       -6.57       -4.34    5.0    1.97s
  6   -8.463353721158       -8.01       -5.22    5.2    1.80s
  7   -8.463353721262       -9.98       -6.30    4.8    1.96s
  8   -8.463353721263      -12.13       -7.07    4.4    1.59s
     1    -8.463354e+00     7.079461e-04
 * time: 42.333731174468994
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.461765369047                   -0.96    7.2    2.45s
  2   -8.463261564386       -2.83       -1.73    2.0    1.14s
  3   -8.463352047908       -4.04       -2.73    3.8    1.75s
  4   -8.463357112773       -5.30       -3.47    5.0    2.04s
  5   -8.463357387358       -6.56       -4.35    5.3    1.83s
  6   -8.463357396040       -8.06       -5.10    5.3    2.14s
  7   -8.463357396158       -9.93       -5.79    4.9    1.66s
  8   -8.463357396159      -12.02       -6.31    3.3    1.61s
  9   -8.463357396159      -13.17       -7.66    3.2    1.29s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.461767135534                   -0.96    7.2    2.40s
  2   -8.463266537612       -2.82       -1.73    1.9    1.14s
  3   -8.463352157917       -4.07       -2.73    4.0    1.75s
  4   -8.463357112998       -5.30       -3.47    4.9    1.73s
  5   -8.463357387549       -6.56       -4.34    5.0    1.87s
  6   -8.463357396041       -8.07       -5.09    5.3    1.81s
  7   -8.463357396157       -9.93       -5.80    4.8    1.85s
  8   -8.463357396159      -11.98       -6.58    3.4    1.43s
  9   -8.463357396159      -13.35       -8.02    4.1    1.80s
     2    -8.463357e+00     3.799465e-06
 * time: 86.01186203956604
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.461758435769                   -0.96    7.2    2.42s
  2   -8.463258829121       -2.82       -1.73    1.9    1.07s
  3   -8.463352236206       -4.03       -2.73    4.0    1.77s
  4   -8.463357117611       -5.31       -3.49    5.0    1.78s
  5   -8.463357386192       -6.57       -4.33    5.1    1.93s
  6   -8.463357396136       -8.00       -5.21    5.3    1.83s
  7   -8.463357396264       -9.89       -6.29    5.1    1.99s
  8   -8.463357396265      -12.09       -7.07    4.7    1.70s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.461759482220                   -0.96    7.1    2.36s
  2   -8.463261733012       -2.82       -1.73    2.0    1.04s
  3   -8.463352499740       -4.04       -2.73    3.8    1.76s
  4   -8.463357122871       -5.34       -3.49    5.0    1.75s
  5   -8.463357386581       -6.58       -4.33    5.2    1.90s
  6   -8.463357396157       -8.02       -5.22    5.4    1.76s
  7   -8.463357396264       -9.97       -6.29    5.0    1.93s
  8   -8.463357396265      -12.00       -7.09    4.9    1.68s
     3    -8.463357e+00     3.255629e-08
 * time: 126.1229190826416
 * Status: success

 * Candidate solution
    Final objective value:     -8.463357e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 5.58e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 5.39e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.07e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.26e-11 ≰ 0.0e+00
    |g(x)|                 = 3.26e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   126  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 195.972205 seconds (318.01 M allocations: 62.533 GiB, 7.38% gc time, 24.41% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-13T20:00:17.114
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30376320649                   -1.09    8.5    18.2s
  2   -62.31044048807       -2.18       -1.21    2.6    6.96s
  3   -62.31430173954       -2.41       -2.02    3.5    8.05s
  4   -62.31437554438       -4.13       -2.91    3.0    7.58s
  5   -62.31437809361       -5.59       -3.43    4.1    9.65s
  6   -62.31437832296       -6.64       -4.28    3.5    8.68s
  7   -62.31437834543       -7.65       -4.73    4.2    9.92s
  8   -62.31437834638       -9.02       -5.58    3.6    8.71s
  9   -62.31437834639      -11.03       -6.51    3.9    9.09s
 10   -62.31437834639      -13.00       -7.49    4.0    9.67s
Iter     Function value   Gradient norm 
     0    -6.231438e+01     9.963037e-03
 * time: 3.314018249511719e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30382797492                   -1.09    8.2    15.2s
  2   -62.31047995941       -2.18       -1.21    2.5    6.39s
  3   -62.31440037231       -2.41       -2.02    3.4    7.97s
  4   -62.31447380317       -4.13       -2.95    2.8    7.42s
  5   -62.31447634882       -5.59       -3.39    4.0    9.66s
  6   -62.31447649842       -6.83       -4.32    3.4    8.66s
  7   -62.31447651994       -7.67       -4.78    4.0    9.39s
  8   -62.31447652095       -9.00       -5.75    3.5    8.56s
  9   -62.31447652096      -11.14       -6.44    3.9    9.30s
 10   -62.31447652096      -13.00       -7.42    3.8    9.22s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30382146168                   -1.09    8.2    14.9s
  2   -62.31049697455       -2.18       -1.21    2.6    6.63s
  3   -62.31440017857       -2.41       -2.02    3.6    8.04s
  4   -62.31447378620       -4.13       -2.93    2.9    7.20s
  5   -62.31447631221       -5.60       -3.41    4.1    9.77s
  6   -62.31447649827       -6.73       -4.31    3.4    8.35s
  7   -62.31447651992       -7.66       -4.74    4.1    9.71s
  8   -62.31447652095       -8.99       -5.62    3.5    8.40s
  9   -62.31447652096      -11.05       -6.74    3.7    9.33s
 10   -62.31447652096   +  -13.55       -7.38    4.0    9.39s
     1    -6.231448e+01     9.745030e-03
 * time: 213.0379660129547
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30407269530                   -1.07    8.4    17.3s
  2   -62.31140104346       -2.13       -1.16    2.7    7.06s
  3   -62.31680321883       -2.27       -1.95    3.5    8.79s
  4   -62.31691047080       -3.97       -2.94    2.4    7.05s
  5   -62.31691383062       -5.47       -3.53    4.1    10.8s
  6   -62.31691415315       -6.49       -4.30    3.4    9.31s
  7   -62.31691418242       -7.53       -4.83    3.6    9.43s
  8   -62.31691418398       -8.81       -5.46    3.7    9.45s
  9   -62.31691418400      -10.73       -6.04    3.5    9.42s
 10   -62.31691418400      -12.19       -6.52    2.7    8.10s
 11   -62.31691418400      -12.87       -7.21    3.4    9.24s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30407311096                   -1.07    8.4    17.1s
  2   -62.31142534960       -2.13       -1.16    2.6    7.05s
  3   -62.31680079960       -2.27       -1.95    3.5    8.93s
  4   -62.31691057796       -3.96       -2.90    2.5    7.38s
  5   -62.31691378419       -5.49       -3.47    3.9    10.5s
  6   -62.31691415039       -6.44       -4.26    3.3    9.07s
  7   -62.31691418181       -7.50       -4.62    4.0    10.6s
  8   -62.31691418397       -8.66       -5.38    3.2    8.92s
  9   -62.31691418400      -10.53       -6.56    3.4    9.58s
 10   -62.31691418400      -12.44       -6.71    4.4    11.3s
 11   -62.31691418400      -12.94       -7.23    2.8    8.23s
     2    -6.231691e+01     1.741356e-03
 * time: 463.951425075531
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30363034526                   -1.07    8.6    17.5s
  2   -62.31111131818       -2.13       -1.15    2.8    7.28s
  3   -62.31689635971       -2.24       -1.94    3.5    9.00s
  4   -62.31701240950       -3.94       -2.93    2.4    7.32s
  5   -62.31701579925       -5.47       -3.49    4.1    10.7s
  6   -62.31701614249       -6.46       -4.29    3.2    8.89s
  7   -62.31701617604       -7.47       -4.72    3.6    9.58s
  8   -62.31701617816       -8.67       -5.44    3.4    8.96s
  9   -62.31701617819      -10.61       -6.19    3.5    9.45s
 10   -62.31701617819      -12.25       -6.87    3.2    8.97s
 11   -62.31701617819      -13.11       -7.69    3.6    9.54s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30363058423                   -1.07    8.6    17.7s
  2   -62.31108384010       -2.13       -1.15    2.8    7.38s
  3   -62.31689596986       -2.24       -1.94    3.6    9.02s
  4   -62.31701249126       -3.93       -2.94    2.5    7.40s
  5   -62.31701584220       -5.47       -3.47    4.1    10.8s
  6   -62.31701614108       -6.52       -4.28    3.4    9.68s
  7   -62.31701617602       -7.46       -4.73    4.0    10.2s
  8   -62.31701617816       -8.67       -5.47    3.6    9.34s
  9   -62.31701617819      -10.65       -6.26    3.7    9.88s
 10   -62.31701617819      -12.49       -6.92    3.3    9.13s
 11   -62.31701617819      -13.37       -7.75    3.8    9.84s
     3    -6.231702e+01     3.834631e-04
 * time: 713.1542689800262
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30347225334                   -1.07    8.3    17.0s
  2   -62.31099664929       -2.12       -1.14    2.4    6.73s
  3   -62.31689822551       -2.23       -1.93    3.4    8.66s
  4   -62.31701775266       -3.92       -2.92    2.4    7.04s
  5   -62.31702128435       -5.45       -3.53    4.2    11.0s
  6   -62.31702165536       -6.43       -4.31    3.3    9.10s
  7   -62.31702168740       -7.49       -4.73    3.4    9.29s
  8   -62.31702168957       -8.66       -5.40    3.4    8.83s
  9   -62.31702168960      -10.55       -6.20    3.4    9.34s
 10   -62.31702168960      -12.18       -6.80    3.1    8.59s
 11   -62.31702168960      -13.85       -7.37    3.5    9.48s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30347696489                   -1.07    8.1    17.2s
  2   -62.31102042729       -2.12       -1.14    2.6    7.08s
  3   -62.31689649974       -2.23       -1.93    3.3    8.77s
  4   -62.31701766202       -3.92       -2.91    2.3    7.07s
  5   -62.31702123612       -5.45       -3.53    4.1    10.7s
  6   -62.31702165525       -6.38       -4.31    3.4    9.77s
  7   -62.31702168754       -7.49       -4.71    3.6    9.88s
  8   -62.31702168957       -8.69       -5.36    3.5    9.13s
  9   -62.31702168960      -10.49       -6.43    3.3    9.31s
 10   -62.31702168960      -12.21       -6.60    4.2    11.1s
 11   -62.31702168960      -13.07       -6.93    3.0    8.46s
 12   -62.31702168960   +  -13.67       -7.71    2.7    8.01s
     4    -6.231702e+01     2.085792e-05
 * time: 969.557135105133
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30347195164                   -1.07    8.5    17.6s
  2   -62.31097699837       -2.12       -1.14    2.8    7.46s
  3   -62.31690053462       -2.23       -1.94    3.5    9.25s
  4   -62.31701787532       -3.93       -2.95    2.5    7.41s
  5   -62.31702135399       -5.46       -3.51    4.2    10.9s
  6   -62.31702166999       -6.50       -4.27    3.3    9.09s
  7   -62.31702170429       -7.46       -4.79    3.6    9.64s
  8   -62.31702170620       -8.72       -5.47    3.4    9.10s
  9   -62.31702170622      -10.64       -6.25    3.4    9.45s
 10   -62.31702170622      -12.42       -6.87    3.1    9.01s
 11   -62.31702170622      -12.94       -7.86    3.6    9.35s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.30347025900                   -1.07    8.6    17.9s
  2   -62.31097591094       -2.12       -1.14    2.7    7.18s
  3   -62.31689972002       -2.23       -1.93    3.6    9.15s
  4   -62.31701785653       -3.93       -2.94    2.3    7.02s
  5   -62.31702130967       -5.46       -3.51    4.2    10.9s
  6   -62.31702166821       -6.45       -4.26    3.3    9.28s
  7   -62.31702170420       -7.44       -4.78    3.6    9.77s
  8   -62.31702170620       -8.70       -5.45    3.7    9.69s
  9   -62.31702170622      -10.63       -6.10    3.4    9.70s
 10   -62.31702170622      -12.18       -6.80    2.9    8.35s
 11   -62.31702170622      -13.30       -7.68    3.6    9.86s
     5    -6.231702e+01     2.654682e-07
 * time: 1223.9074001312256
 * Status: success

 * Candidate solution
    Final objective value:     -6.231702e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.57e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.39e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.66e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.67e-10 ≰ 0.0e+00
    |g(x)|                 = 2.65e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   1224  (vs limit Inf)
    Iterations:    5
    f(x) calls:    6
    ∇f(x) calls:   6

NaCl: 1344.117334 seconds (1.51 G allocations: 424.826 GiB, 5.33% gc time, 0.23% compilation time)
┌ Info: 2025-05-13T20:22:41.259
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317014383319                   -1.46    5.4    1.96s
  2   -2.317088875105       -4.13       -1.84    1.4    752ms
  3   -2.317105629062       -4.78       -3.57    3.1    1.44s
  4   -2.317105817424       -6.73       -4.09    4.5    1.60s
  5   -2.317105817915       -9.31       -4.40    2.5    1.28s
  6   -2.317105818041       -9.90       -5.00    2.8    1.09s
  7   -2.317105818045      -11.39       -5.67    2.5    1.25s
  8   -2.317105818045      -12.67       -6.59    2.6    1.02s
  9   -2.317105818045      -14.10       -7.14    3.0    1.13s
Iter     Function value   Gradient norm 
     0    -2.317106e+00     4.377448e-04
 * time: 2.5987625122070312e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317015317300                   -1.46    5.4    1.71s
  2   -2.317089097543       -4.13       -1.84    1.3    1.01s
  3   -2.317105843763       -4.78       -3.57    3.1    1.24s
  4   -2.317106005176       -6.79       -4.09    4.6    1.89s
  5   -2.317106005665       -9.31       -4.40    2.4    1.02s
  6   -2.317106005794       -9.89       -5.00    2.6    1.36s
  7   -2.317106005798      -11.41       -5.67    2.4    1.02s
  8   -2.317106005798      -12.66       -6.55    2.6    1.38s
  9   -2.317106005798      -14.21       -7.07    2.9    1.16s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317013985520                   -1.46    5.4    2.03s
  2   -2.317089345832       -4.12       -1.84    1.3    775ms
  3   -2.317105797914       -4.78       -3.57    3.2    1.53s
  4   -2.317106005166       -6.68       -4.08    4.5    1.86s
  5   -2.317106005659       -9.31       -4.40    2.4    1.02s
  6   -2.317106005794       -9.87       -5.00    2.7    1.11s
  7   -2.317106005798      -11.41       -5.64    2.4    1.24s
  8   -2.317106005798      -12.62       -6.62    2.6    1.06s
  9   -2.317106005798      -14.24       -7.14    3.3    1.48s
     1    -2.317106e+00     4.200716e-04
 * time: 52.60508704185486
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317019327609                   -1.46    5.7    2.01s
  2   -2.317092050616       -4.14       -1.84    1.4    752ms
  3   -2.317107975670       -4.80       -3.58    3.3    1.51s
  4   -2.317108202551       -6.64       -4.09    4.6    1.60s
  5   -2.317108203029       -9.32       -4.40    2.5    1.30s
  6   -2.317108203164       -9.87       -4.99    2.8    1.12s
  7   -2.317108203168      -11.33       -5.60    2.7    1.34s
  8   -2.317108203169      -12.52       -6.47    2.6    1.05s
  9   -2.317108203169      -13.95       -6.96    3.0    1.15s
 10   -2.317108203169      -14.75       -7.56    2.0    1.19s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317015680898                   -1.46    5.7    2.01s
  2   -2.317091829565       -4.12       -1.84    1.4    738ms
  3   -2.317107947596       -4.79       -3.58    3.3    1.48s
  4   -2.317108202452       -6.59       -4.06    4.6    1.61s
  5   -2.317108203007       -9.26       -4.37    2.5    1.26s
┌ Warning: Eigensolver not converged
│   n_iter =
│    195-element Vector{Int64}:
│     5
│     2
│     4
│     6
│     ⋮
│     1
│     3
│     2
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/scf/self_consistent_field.jl:76
  6   -2.317108203164       -9.81       -4.97    2.8    1.14s
  7   -2.317108203168      -11.36       -5.55    2.6    1.26s
  8   -2.317108203169      -12.44       -6.52    2.7    1.05s
  9   -2.317108203169      -13.95       -7.05    3.2    1.19s
     2    -2.317108e+00     3.119842e-06
 * time: 105.67386817932129
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317020778342                   -1.46    5.7    2.05s
  2   -2.317092491526       -4.14       -1.84    1.4    759ms
  3   -2.317107960451       -4.81       -3.59    3.2    1.53s
  4   -2.317108202621       -6.62       -4.07    4.7    1.62s
  5   -2.317108203133       -9.29       -4.37    2.5    1.29s
  6   -2.317108203286       -9.82       -4.97    2.8    1.10s
  7   -2.317108203290      -11.33       -5.57    2.5    1.30s
  8   -2.317108203291      -12.48       -6.49    2.6    1.08s
  9   -2.317108203291      -13.99       -7.00    3.0    1.16s
 10   -2.317108203291      -14.75       -7.32    2.1    1.15s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317020530486                   -1.46    5.8    2.06s
  2   -2.317091852751       -4.15       -1.84    1.4    744ms
  3   -2.317107972145       -4.79       -3.56    3.2    1.47s
  4   -2.317108202568       -6.64       -4.05    4.6    1.60s
  5   -2.317108203133       -9.25       -4.36    2.5    1.26s
  6   -2.317108203285       -9.82       -4.96    2.8    1.07s
  7   -2.317108203290      -11.30       -5.58    2.5    1.28s
  8   -2.317108203291      -12.53       -6.51    2.6    997ms
  9   -2.317108203291      -14.05       -6.96    3.0    1.14s
 10   -2.317108203291      -15.05       -7.41    1.9    1.12s
     3    -2.317108e+00     1.173409e-08
 * time: 159.5216841697693
 * Status: success

 * Candidate solution
    Final objective value:     -2.317108e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 7.79e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.02e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.22e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 5.26e-11 ≰ 0.0e+00
    |g(x)|                 = 1.17e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   160  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Al: 190.412454 seconds (162.50 M allocations: 38.811 GiB, 6.40% gc time, 0.04% compilation time)
┌ Info: 2025-05-13T20:25:51.672
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80535083776                   -0.92    9.5    8.80s
  2   -73.81407343658       -2.06       -1.12    5.4    5.05s
  3   -73.81940921514       -2.27       -1.48    6.8    6.55s
  4   -73.82015150636       -3.13       -1.82    5.5    5.24s
  5   -73.82027927310       -3.89       -2.22    5.0    5.03s
  6   -73.82030181002       -4.65       -3.08    5.5    5.46s
  7   -73.82030183403       -7.62       -3.47    5.0    5.11s
  8   -73.82030183836       -8.36       -4.04    3.8    4.26s
  9   -73.82030183871       -9.45       -4.55    4.6    5.07s
 10   -73.82030183871      -11.87       -4.89    3.1    3.88s
 11   -73.82030183873      -10.90       -5.61    4.8    4.98s
 12   -73.82030183873      -11.73       -6.40    4.8    5.26s
 13   -73.82030183873      -12.94       -6.84    5.4    5.56s
 14   -73.82030183873   +  -13.85       -7.11    5.4    5.37s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.382030e+01     3.088333e-03
 * time: 2.7894973754882812e-5
┌ Warning: Negative ρcore detected: -3.4170428482089025e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80529637317                   -0.92    9.9    8.87s
  2   -73.81409709743       -2.06       -1.12    5.3    5.22s
  3   -73.81941195163       -2.27       -1.48    7.0    6.88s
  4   -73.82016195312       -3.12       -1.82    5.5    5.41s
  5   -73.82028858977       -3.90       -2.23    5.1    5.20s
  6   -73.82031062436       -4.66       -3.09    5.5    5.54s
  7   -73.82031064619       -7.66       -3.49    4.9    5.17s
  8   -73.82031064990       -8.43       -4.06    3.5    4.19s
  9   -73.82031065026       -9.44       -4.58    4.7    4.97s
 10   -73.82031065028      -10.71       -4.92    4.6    4.63s
 11   -73.82031065029      -10.90       -5.71    4.7    4.88s
 12   -73.82031065029      -12.23       -6.51    4.8    5.18s
 13   -73.82031065029      -13.55       -6.87    5.5    5.59s
 14   -73.82031065029      -13.37       -7.17    5.4    5.55s
┌ Warning: Negative ρcore detected: -3.4170428482089025e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80530064626                   -0.92    9.8    9.26s
  2   -73.81409810493       -2.06       -1.12    5.4    5.23s
  3   -73.81941157293       -2.27       -1.48    6.9    6.85s
  4   -73.82016194700       -3.12       -1.82    5.6    5.45s
  5   -73.82028873591       -3.90       -2.23    5.0    5.17s
  6   -73.82031062468       -4.66       -3.09    5.6    5.72s
  7   -73.82031064598       -7.67       -3.49    4.9    5.28s
  8   -73.82031064987       -8.41       -4.07    3.5    4.32s
  9   -73.82031065026       -9.41       -4.57    4.7    5.17s
 10   -73.82031065028      -10.80       -4.91    4.3    4.77s
 11   -73.82031065029      -10.88       -5.71    4.7    5.00s
 12   -73.82031065029      -12.13       -6.49    4.8    5.28s
 13   -73.82031065029      -13.85       -6.88    5.5    5.66s
 14   -73.82031065029      -13.85       -7.17    5.4    5.37s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4170428482089025e-8,3.566316414565663e-10)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.382031e+01     2.618077e-03
 * time: 213.9984610080719
┌ Warning: Negative ρcore detected: -3.358655305276147e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80501532707                   -0.91    9.6    8.72s
  2   -73.81410027077       -2.04       -1.12    5.4    5.26s
  3   -73.81941678397       -2.27       -1.48    6.8    6.81s
  4   -73.82019062822       -3.11       -1.83    5.5    5.33s
  5   -73.82031170589       -3.92       -2.23    5.1    5.21s
  6   -73.82033330657       -4.67       -3.11    5.6    5.59s
  7   -73.82033332631       -7.70       -3.51    4.5    4.93s
  8   -73.82033332884       -8.60       -4.09    3.7    4.36s
  9   -73.82033332939       -9.26       -4.65    4.2    4.65s
 10   -73.82033332952       -9.89       -5.04    5.1    5.20s
 11   -73.82033332953      -11.18       -5.95    5.0    5.30s
 12   -73.82033332953   +  -12.30       -6.42    5.7    5.67s
 13   -73.82033332952   +  -12.57       -6.85    4.5    4.68s
 14   -73.82033332953      -12.70       -7.63    4.6    4.67s
┌ Warning: Negative ρcore detected: -3.358655305276147e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80500944793                   -0.91    9.7    8.94s
  2   -73.81411353507       -2.04       -1.12    5.3    5.19s
  3   -73.81941345633       -2.28       -1.48    6.8    6.71s
  4   -73.82019141560       -3.11       -1.83    5.6    5.49s
  5   -73.82031223427       -3.92       -2.24    5.1    5.29s
  6   -73.82033330685       -4.68       -3.11    5.5    5.81s
  7   -73.82033332650       -7.71       -3.52    4.6    4.96s
  8   -73.82033332892       -8.62       -4.09    4.0    4.50s
  9   -73.82033332936       -9.36       -4.66    4.1    4.59s
 10   -73.82033332952       -9.79       -5.03    5.3    5.23s
 11   -73.82033332953      -11.23       -5.96    4.9    5.13s
 12   -73.82033332953   +  -12.27       -6.42    5.7    5.69s
 13   -73.82033332952   +  -12.49       -6.91    4.6    4.70s
 14   -73.82033332953      -12.73       -7.70    5.0    4.96s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.358655305276147e-8,6.602565038310578e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.382033e+01     2.806517e-05
 * time: 426.1455569267273
┌ Warning: Negative ρcore detected: -3.357419019214253e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80501401588                   -0.91    9.5    8.86s
  2   -73.81410848469       -2.04       -1.12    5.2    5.10s
  3   -73.81941539422       -2.28       -1.48    6.7    6.66s
  4   -73.82019035658       -3.11       -1.83    5.6    5.50s
  5   -73.82031157418       -3.92       -2.23    5.0    5.43s
  6   -73.82033330908       -4.66       -3.11    5.4    5.86s
  7   -73.82033332887       -7.70       -3.51    4.4    5.46s
  8   -73.82033333137       -8.60       -4.09    3.9    4.47s
  9   -73.82033333188       -9.29       -4.65    4.3    4.71s
 10   -73.82033333203       -9.82       -5.03    5.1    5.20s
 11   -73.82033333204      -11.19       -5.96    5.0    5.14s
 12   -73.82033333204   +  -12.20       -6.44    5.7    5.80s
 13   -73.82033333204   +  -12.53       -6.85    4.5    4.77s
 14   -73.82033333204      -12.53       -7.64    4.7    4.81s
┌ Warning: Negative ρcore detected: -3.357419019214253e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80500464182                   -0.91    9.5    8.86s
  2   -73.81410215938       -2.04       -1.12    5.2    5.02s
  3   -73.81941638367       -2.27       -1.48    6.7    6.51s
  4   -73.82019058062       -3.11       -1.83    5.6    5.28s
  5   -73.82031151270       -3.92       -2.23    5.0    5.11s
  6   -73.82033330933       -4.66       -3.11    5.4    5.58s
  7   -73.82033332880       -7.71       -3.51    4.4    5.01s
  8   -73.82033333148       -8.57       -4.09    3.7    4.21s
  9   -73.82033333189       -9.39       -4.64    4.0    4.54s
 10   -73.82033333203       -9.86       -5.03    5.1    5.21s
 11   -73.82033333204      -11.22       -5.95    4.9    5.23s
 12   -73.82033333204   +  -12.22       -6.44    5.6    5.67s
 13   -73.82033333204   +  -12.53       -6.88    4.6    4.76s
 14   -73.82033333204      -12.64       -7.65    4.9    4.99s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.357419019214253e-8,6.668680062334775e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.382033e+01     2.547627e-07
 * time: 638.8011720180511
 * Status: success

 * Candidate solution
    Final objective value:     -7.382033e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.86e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 3.26e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.51e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.40e-11 ≰ 0.0e+00
    |g(x)|                 = 2.55e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   639  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

V: 754.811139 seconds (561.04 M allocations: 265.577 GiB, 5.86% gc time, 0.01% compilation time)
