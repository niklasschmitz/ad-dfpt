┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-13T16:32:14.447
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465456463995                   -0.96    7.0    11.7s
  2   -8.466999699981       -2.81       -1.72    1.7    4.80s
  3   -8.467090071323       -4.04       -2.72    3.8    1.94s
  4   -8.467094101570       -5.39       -3.53    4.8    1.85s
  5   -8.467094301539       -6.70       -4.35    5.1    2.13s
  6   -8.467094309261       -8.11       -5.27    5.2    2.09s
  7   -8.467094309342      -10.09       -6.29    4.8    1.78s
  8   -8.467094309342      -12.23       -7.02    4.6    2.04s
Iter     Function value   Gradient norm 
     0    -8.467094e+00     1.141518e-03
 * time: 4.601478576660156e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465473968526                   -0.96    7.6    2.69s
  2   -8.467006051169       -2.81       -1.72    2.2    1.44s
  3   -8.467091477910       -4.07       -2.73    4.0    1.64s
  4   -8.467095357558       -5.41       -3.53    5.0    2.12s
  5   -8.467095560269       -6.69       -4.36    5.2    1.83s
  6   -8.467095567615       -8.13       -5.28    5.5    2.17s
  7   -8.467095567689      -10.14       -6.28    4.8    1.82s
  8   -8.467095567689      -12.16       -7.00    4.9    2.10s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465476608266                   -0.96    7.6    2.65s
  2   -8.467003672606       -2.82       -1.72    2.0    1.38s
  3   -8.467091327670       -4.06       -2.72    4.0    1.62s
  4   -8.467095359981       -5.39       -3.52    5.2    2.16s
  5   -8.467095560668       -6.70       -4.36    5.1    1.81s
  6   -8.467095567621       -8.16       -5.28    5.5    2.14s
  7   -8.467095567689      -10.17       -6.28    4.9    1.77s
  8   -8.467095567689      -12.22       -7.00    5.0    2.05s
     1    -8.467096e+00     1.063229e-03
 * time: 44.069040060043335
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465483438159                   -0.96    7.0    2.45s
  2   -8.467006436429       -2.82       -1.72    1.9    1.09s
  3   -8.467099383316       -4.03       -2.73    3.7    1.80s
  4   -8.467103640261       -5.37       -3.52    4.9    2.05s
  5   -8.467103846756       -6.69       -4.38    4.9    1.74s
  6   -8.467103854028       -8.14       -5.27    5.3    2.12s
  7   -8.467103854106      -10.11       -6.29    5.0    1.79s
  8   -8.467103854107      -12.30       -7.14    4.4    2.01s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465502699266                   -0.96    7.0    2.50s
  2   -8.467011142448       -2.82       -1.72    1.9    1.38s
  3   -8.467099374290       -4.05       -2.73    3.8    1.59s
  4   -8.467103640582       -5.37       -3.53    4.8    2.10s
  5   -8.467103846428       -6.69       -4.36    5.1    1.82s
  6   -8.467103854024       -8.12       -5.28    5.2    2.17s
  7   -8.467103854106      -10.09       -6.36    4.8    1.74s
  8   -8.467103854107      -12.25       -7.13    4.7    1.99s
     2    -8.467104e+00     8.478069e-06
 * time: 85.90509009361267
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465506174024                   -0.96    6.9    2.42s
  2   -8.467011694325       -2.82       -1.72    1.9    1.09s
  3   -8.467099198484       -4.06       -2.73    3.8    1.86s
  4   -8.467103634861       -5.35       -3.50    4.7    2.02s
  5   -8.467103848101       -6.67       -4.40    5.2    1.71s
  6   -8.467103854560       -8.19       -5.22    5.3    2.11s
  7   -8.467103854637      -10.11       -5.97    5.0    1.69s
  8   -8.467103854637      -12.30       -6.67    3.5    1.73s
  9   -8.467103854637      -13.75       -8.01    3.6    1.44s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.465483055769                   -0.96    6.9    2.45s
  2   -8.467007039677       -2.82       -1.72    1.9    1.08s
  3   -8.467099245860       -4.04       -2.73    3.8    1.86s
  4   -8.467103638615       -5.36       -3.52    5.0    1.81s
  5   -8.467103847700       -6.68       -4.40    5.0    1.98s
  6   -8.467103854552       -8.16       -5.28    5.4    1.85s
  7   -8.467103854636      -10.07       -6.29    4.9    1.98s
  8   -8.467103854637      -12.22       -7.14    4.7    1.76s
     3    -8.467104e+00     6.551077e-08
 * time: 128.73046493530273
 * Status: success

 * Candidate solution
    Final objective value:     -8.467104e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.25e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.20e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 5.30e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 6.26e-11 ≰ 0.0e+00
    |g(x)|                 = 6.55e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   129  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 203.050589 seconds (313.37 M allocations: 61.543 GiB, 7.67% gc time, 25.12% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-13T16:35:38.177
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31957507502                   -1.09    8.6    18.5s
  2   -62.32614028500       -2.18       -1.21    2.7    7.18s
  3   -62.33018945674       -2.39       -2.02    3.5    7.96s
  4   -62.33025193162       -4.20       -2.95    3.0    7.70s
  5   -62.33025353865       -5.79       -3.44    4.2    9.91s
  6   -62.33025369167       -6.82       -4.28    3.5    9.03s
  7   -62.33025370242       -7.97       -4.73    4.2    10.0s
  8   -62.33025370298       -9.25       -5.57    3.4    8.27s
  9   -62.33025370298      -11.19       -6.76    3.8    9.20s
 10   -62.33025370298      -12.97       -7.45    3.9    9.90s
Iter     Function value   Gradient norm 
     0    -6.233025e+01     8.700145e-03
 * time: 3.0040740966796875e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31962115643                   -1.09    8.7    15.9s
  2   -62.32616447493       -2.18       -1.21    2.8    6.71s
  3   -62.33026522771       -2.39       -2.02    3.7    8.35s
  4   -62.33032689905       -4.21       -2.99    2.9    7.25s
  5   -62.33032844212       -5.81       -3.40    4.1    9.56s
  6   -62.33032855323       -6.95       -4.37    3.4    8.60s
  7   -62.33032856404       -7.97       -4.81    4.3    9.93s
  8   -62.33032856451       -9.33       -5.70    3.6    8.78s
  9   -62.33032856451      -11.38       -6.94    3.8    9.34s
 10   -62.33032856451   +  -13.55       -7.55    4.1    9.82s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31961979628                   -1.09    8.7    16.0s
  2   -62.32617144739       -2.18       -1.21    2.7    6.48s
  3   -62.33026528632       -2.39       -2.02    3.7    8.09s
  4   -62.33032687304       -4.21       -2.97    2.8    7.36s
  5   -62.33032841797       -5.81       -3.44    4.2    9.78s
  6   -62.33032855315       -6.87       -4.36    3.4    8.67s
  7   -62.33032856400       -7.96       -4.81    4.2    9.67s
  8   -62.33032856451       -9.30       -5.65    3.5    8.21s
  9   -62.33032856451      -11.34       -6.79    3.8    9.05s
 10   -62.33032856451   +  -13.85       -7.48    4.1    9.87s
     1    -6.233033e+01     8.509341e-03
 * time: 216.4396231174469
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31958138277                   -1.08    8.8    18.1s
  2   -62.32661981944       -2.15       -1.16    2.8    7.84s
  3   -62.33207224552       -2.26       -1.96    3.7    9.07s
  4   -62.33215842195       -4.06       -2.98    2.6    7.76s
  5   -62.33216033708       -5.72       -3.55    4.3    10.9s
  6   -62.33216050988       -6.76       -4.41    3.4    9.48s
  7   -62.33216052300       -7.88       -4.84    3.8    9.91s
  8   -62.33216052366       -9.19       -5.51    3.4    9.49s
  9   -62.33216052366      -11.09       -6.22    3.5    9.49s
 10   -62.33216052366      -12.70       -6.96    3.4    9.77s
 11   -62.33216052366      -13.55       -7.54    3.9    10.2s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31958298171                   -1.08    8.7    17.8s
  2   -62.32662700227       -2.15       -1.16    2.7    7.21s
  3   -62.33207169238       -2.26       -1.96    3.6    9.10s
  4   -62.33215830962       -4.06       -2.96    2.6    7.29s
  5   -62.33216031550       -5.70       -3.55    4.1    10.6s
  6   -62.33216050972       -6.71       -4.37    3.4    9.20s
  7   -62.33216052293       -7.88       -4.79    4.0    10.8s
  8   -62.33216052365       -9.14       -5.44    3.6    9.42s
  9   -62.33216052366      -10.95       -6.37    3.4    9.65s
 10   -62.33216052366      -12.60       -6.75    3.5    9.71s
 11   -62.33216052366   +    -Inf       -7.51    3.5    9.39s
     2    -6.233216e+01     1.362557e-03
 * time: 474.8918581008911
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31924481909                   -1.08    9.2    18.8s
  2   -62.32633247273       -2.15       -1.15    2.8    7.48s
  3   -62.33212800146       -2.24       -1.96    3.8    9.61s
  4   -62.33221794716       -4.05       -3.01    2.6    7.46s
  5   -62.33222007382       -5.67       -3.53    4.5    11.5s
  6   -62.33222019982       -6.90       -4.32    3.5    9.66s
  7   -62.33222021395       -7.85       -4.94    3.6    9.63s
  8   -62.33222021459       -9.19       -5.63    3.7    9.83s
  9   -62.33222021460      -10.94       -6.20    3.8    9.94s
 10   -62.33222021460      -12.34       -6.96    3.0    8.55s
 11   -62.33222021460   +  -13.67       -7.55    3.9    10.4s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31924537989                   -1.08    9.2    19.0s
  2   -62.32636983831       -2.15       -1.15    2.8    7.36s
  3   -62.33212493018       -2.24       -1.95    3.7    9.14s
  4   -62.33221804450       -4.03       -2.96    2.8    7.54s
  5   -62.33222000529       -5.71       -3.51    4.2    10.8s
  6   -62.33222019977       -6.71       -4.34    3.3    9.14s
  7   -62.33222021378       -7.85       -4.72    4.1    10.8s
  8   -62.33222021459       -9.09       -5.44    3.5    9.15s
  9   -62.33222021460      -10.91       -6.58    3.6    9.82s
 10   -62.33222021460      -12.83       -6.80    3.7    9.93s
 11   -62.33222021460      -14.15       -7.30    3.3    8.99s
     3    -6.233222e+01     2.636361e-04
 * time: 735.1480720043182
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31914531507                   -1.08    8.6    17.5s
  2   -62.32631504247       -2.14       -1.15    2.7    7.07s
  3   -62.33212605283       -2.24       -1.95    3.5    8.85s
  4   -62.33222050090       -4.02       -2.93    2.6    7.38s
  5   -62.33222235827       -5.73       -3.57    4.0    10.6s
  6   -62.33222262823       -6.57       -4.29    3.2    9.15s
  7   -62.33222264332       -7.82       -4.71    3.8    10.3s
  8   -62.33222264410       -9.11       -5.41    3.3    9.11s
  9   -62.33222264412      -10.76       -6.24    3.5    9.60s
 10   -62.33222264412      -12.27       -6.73    4.1    10.8s
 11   -62.33222264412   +  -13.67       -7.17    3.4    9.47s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31914229557                   -1.08    8.6    17.6s
  2   -62.32629996121       -2.15       -1.15    2.7    7.15s
  3   -62.33212741725       -2.23       -1.95    3.5    8.98s
  4   -62.33222046369       -4.03       -2.95    2.6    7.26s
  5   -62.33222239393       -5.71       -3.55    4.2    10.8s
  6   -62.33222262873       -6.63       -4.32    3.1    8.62s
  7   -62.33222264328       -7.84       -4.73    3.8    10.2s
  8   -62.33222264410       -9.08       -5.39    3.2    8.74s
  9   -62.33222264412      -10.85       -6.30    3.2    8.98s
 10   -62.33222264412      -12.47       -6.65    4.0    10.4s
 11   -62.33222264412      -13.15       -7.19    3.0    8.45s
     4    -6.233222e+01     1.088471e-05
 * time: 990.5942380428314
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31913491839                   -1.08    8.4    16.5s
  2   -62.32631413643       -2.14       -1.15    2.6    7.02s
  3   -62.33212520669       -2.24       -1.95    3.3    8.49s
  4   -62.33222040648       -4.02       -2.91    2.7    7.44s
  5   -62.33222231486       -5.72       -3.59    4.0    10.6s
  6   -62.33222263154       -6.50       -4.24    3.2    8.76s
  7   -62.33222264738       -7.80       -4.66    3.7    9.85s
  8   -62.33222264827       -9.05       -5.43    3.3    8.81s
  9   -62.33222264829      -10.62       -6.03    3.6    9.76s
 10   -62.33222264829      -12.08       -6.53    3.8    10.0s
 11   -62.33222264829      -13.67       -7.11    3.3    9.42s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31913785158                   -1.08    8.4    17.2s
  2   -62.32632296055       -2.14       -1.15    2.6    7.07s
  3   -62.33212467207       -2.24       -1.95    3.5    9.02s
  4   -62.33222041863       -4.02       -2.92    2.6    7.35s
  5   -62.33222233636       -5.72       -3.59    4.0    10.7s
  6   -62.33222263249       -6.53       -4.28    3.2    8.98s
  7   -62.33222264746       -7.82       -4.67    3.8    10.4s
  8   -62.33222264827       -9.09       -5.42    3.4    9.37s
  9   -62.33222264829      -10.65       -6.01    3.5    9.87s
 10   -62.33222264829      -12.06       -6.55    3.8    10.2s
 11   -62.33222264829      -13.55       -7.09    3.4    9.81s
     5    -6.233222e+01     1.007987e-07
 * time: 1242.4749550819397
 * Status: success

 * Candidate solution
    Final objective value:     -6.233222e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 7.64e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 6.80e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 4.18e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 6.70e-11 ≰ 0.0e+00
    |g(x)|                 = 1.01e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   1242  (vs limit Inf)
    Iterations:    5
    f(x) calls:    6
    ∇f(x) calls:   6

NaCl: 1364.011686 seconds (1.50 G allocations: 427.171 GiB, 5.40% gc time, 0.24% compilation time)
┌ Info: 2025-05-13T16:58:22.220
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317578534290                   -1.47    5.5    2.01s
  2   -2.317651735251       -4.14       -1.84    1.4    757ms
  3   -2.317667234958       -4.81       -3.58    3.1    1.56s
  4   -2.317667464008       -6.64       -4.05    4.5    1.55s
  5   -2.317667464513       -9.30       -4.31    2.4    1.24s
  6   -2.317667464669       -9.80       -5.00    2.7    995ms
  7   -2.317667464674      -11.30       -5.70    2.5    1.24s
  8   -2.317667464675      -12.62       -6.53    2.6    997ms
  9   -2.317667464675      -14.07       -7.00    3.2    1.18s
 10   -2.317667464675      -15.05       -7.54    2.2    1.12s
Iter     Function value   Gradient norm 
     0    -2.317667e+00     1.329964e-04
 * time: 3.314018249511719e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317578078712                   -1.47    5.4    1.88s
  2   -2.317651919902       -4.13       -1.84    1.3    680ms
  3   -2.317667292761       -4.81       -3.58    3.1    1.44s
  4   -2.317667481362       -6.72       -4.06    4.5    1.50s
  5   -2.317667481853       -9.31       -4.34    2.2    1.16s
  6   -2.317667482000       -9.83       -5.01    2.7    1.00s
  7   -2.317667482004      -11.39       -5.71    2.4    1.21s
  8   -2.317667482004      -12.63       -6.33    2.6    997ms
  9   -2.317667482004      -14.18       -6.79    2.2    907ms
 10   -2.317667482004      -15.05       -7.48    2.2    1.22s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317578326475                   -1.47    5.3    1.88s
  2   -2.317651594703       -4.14       -1.84    1.3    720ms
  3   -2.317667274578       -4.80       -3.59    3.2    1.45s
  4   -2.317667481389       -6.68       -4.07    4.5    1.57s
  5   -2.317667481855       -9.33       -4.33    2.3    1.21s
  6   -2.317667481999       -9.84       -5.01    2.5    987ms
  7   -2.317667482004      -11.33       -5.73    2.4    1.25s
  8   -2.317667482004      -12.62       -6.53    2.7    1.03s
  9   -2.317667482004      -14.31       -6.79    2.8    1.11s
 10   -2.317667482004      -14.88       -7.44    1.9    1.05s
     1    -2.317667e+00     1.276024e-04
 * time: 52.20458793640137
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317577191284                   -1.47    5.4    1.85s
  2   -2.317651836052       -4.13       -1.84    1.3    687ms
  3   -2.317667417201       -4.81       -3.59    3.2    1.41s
  4   -2.317667682544       -6.58       -4.04    4.5    1.50s
  5   -2.317667683063       -9.28       -4.30    2.2    1.20s
  6   -2.317667683232       -9.77       -4.96    2.6    986ms
  7   -2.317667683237      -11.27       -5.61    2.4    1.20s
  8   -2.317667683238      -12.46       -6.31    2.7    995ms
  9   -2.317667683238      -13.86       -6.73    2.6    999ms
 10   -2.317667683238      -14.75       -7.38    2.2    1.15s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317580126044                   -1.47    5.4    1.90s
  2   -2.317651930665       -4.14       -1.84    1.3    703ms
  3   -2.317667447414       -4.81       -3.57    3.1    1.41s
  4   -2.317667682476       -6.63       -4.02    4.5    1.51s
  5   -2.317667683058       -9.24       -4.30    2.3    1.18s
  6   -2.317667683232       -9.76       -4.96    2.6    988ms
  7   -2.317667683237      -11.25       -5.66    2.3    1.22s
  8   -2.317667683238      -12.52       -6.54    2.6    972ms
  9   -2.317667683238      -14.03       -7.00    3.2    1.16s
 10   -2.317667683238      -15.35       -7.55    2.1    1.26s
     2    -2.317668e+00     4.384496e-07
 * time: 104.96307706832886
 * Status: success

 * Candidate solution
    Final objective value:     -2.317668e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.15e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.12e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.01e-07 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 8.68e-08 ≰ 0.0e+00
    |g(x)|                 = 4.38e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   105  (vs limit Inf)
    Iterations:    2
    f(x) calls:    3
    ∇f(x) calls:   3

Al: 136.926671 seconds (120.46 M allocations: 28.513 GiB, 6.53% gc time, 0.00% compilation time)
┌ Info: 2025-05-13T17:00:39.176
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.82194689229                   -0.92    9.5    9.02s
  2   -73.83029099052       -2.08       -1.12    5.2    5.25s
  3   -73.83549556384       -2.28       -1.49    6.8    6.81s
  4   -73.83621366985       -3.14       -1.82    5.5    5.49s
  5   -73.83633995931       -3.90       -2.22    4.9    5.23s
  6   -73.83636259582       -4.65       -3.07    5.5    5.69s
  7   -73.83636262788       -7.49       -3.46    5.3    5.88s
  8   -73.83636263182       -8.40       -4.04    3.6    4.49s
  9   -73.83636263209       -9.58       -4.46    4.0    4.55s
 10   -73.83636263209      -11.23       -4.86    2.7    3.57s
 11   -73.83636263211      -10.89       -5.52    4.4    4.71s
 12   -73.83636263211      -11.58       -6.26    4.7    5.16s
 13   -73.83636263211      -12.81       -6.70    5.2    5.41s
 14   -73.83636263211   +  -13.55       -6.85    5.5    5.53s
 15   -73.83636263211   +    -Inf       -7.70    5.2    5.19s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.383636e+01     3.347466e-03
 * time: 3.0994415283203125e-5
┌ Warning: Negative ρcore detected: -3.417019875184495e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.82189054519                   -0.92    9.5    8.98s
  2   -73.83030180349       -2.08       -1.12    5.2    5.23s
  3   -73.83550407220       -2.28       -1.49    6.7    6.82s
  4   -73.83622388127       -3.14       -1.82    5.5    5.50s
  5   -73.83635043348       -3.90       -2.22    4.9    5.13s
  6   -73.83637295087       -4.65       -3.07    5.5    5.86s
  7   -73.83637297994       -7.54       -3.47    5.2    6.05s
  8   -73.83637298388       -8.40       -4.06    3.5    4.33s
  9   -73.83637298415       -9.57       -4.47    4.1    4.66s
 10   -73.83637298416      -11.07       -4.87    2.8    3.70s
 11   -73.83637298417      -10.89       -5.58    4.5    4.92s
 12   -73.83637298417      -11.76       -6.33    4.8    5.19s
 13   -73.83637298417      -13.00       -6.75    5.3    5.53s
 14   -73.83637298417   +  -13.00       -7.05    5.4    5.36s
┌ Warning: Negative ρcore detected: -3.417019875184495e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.82189587261                   -0.92    9.5    9.16s
  2   -73.83029277944       -2.08       -1.12    5.2    5.20s
  3   -73.83550462271       -2.28       -1.49    6.7    6.67s
  4   -73.83622393872       -3.14       -1.82    5.5    5.39s
  5   -73.83635012797       -3.90       -2.22    4.9    5.22s
  6   -73.83637295157       -4.64       -3.08    5.5    5.68s
  7   -73.83637297945       -7.55       -3.46    5.1    5.37s
  8   -73.83637298383       -8.36       -4.02    3.9    4.58s
  9   -73.83637298416       -9.49       -4.49    4.4    4.85s
 10   -73.83637298416      -11.47       -4.88    3.2    4.00s
 11   -73.83637298417      -10.96       -5.56    4.4    4.66s
 12   -73.83637298417      -11.70       -6.33    4.8    5.16s
 13   -73.83637298417   +    -Inf       -6.77    5.3    5.47s
 14   -73.83637298417   +    -Inf       -7.05    5.4    5.36s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.417019875184495e-8,1.4146477852644077e-9)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.383637e+01     2.837665e-03
 * time: 212.6317298412323
┌ Warning: Negative ρcore detected: -3.346934424160408e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.82160792697                   -0.92    9.7    9.13s
  2   -73.83026904303       -2.06       -1.12    5.4    5.22s
  3   -73.83551729816       -2.28       -1.49    6.8    6.82s
  4   -73.83625523343       -3.13       -1.83    5.6    5.41s
  5   -73.83637722583       -3.91       -2.22    5.1    5.48s
  6   -73.83639964664       -4.65       -3.10    5.5    5.65s
  7   -73.83639966588       -7.72       -3.50    4.6    5.06s
  8   -73.83639966956       -8.43       -4.07    3.3    4.19s
  9   -73.83639967015       -9.23       -4.65    4.8    5.30s
 10   -73.83639967018      -10.50       -4.99    4.8    5.09s
 11   -73.83639967019      -11.02       -5.90    4.9    5.21s
 12   -73.83639967019      -13.00       -6.54    4.3    4.88s
 13   -73.83639967019   +  -13.55       -6.97    4.0    4.50s
 14   -73.83639967019   +  -13.25       -7.70    4.4    4.64s
┌ Warning: Negative ρcore detected: -3.346934424160408e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.82161197002                   -0.92    9.7    9.04s
  2   -73.83028177163       -2.06       -1.12    5.3    5.17s
  3   -73.83551370472       -2.28       -1.49    6.9    6.57s
  4   -73.83625564546       -3.13       -1.83    5.7    5.48s
  5   -73.83637744806       -3.91       -2.23    5.0    5.08s
  6   -73.83639964613       -4.65       -3.10    5.5    6.08s
  7   -73.83639966632       -7.69       -3.49    4.7    5.06s
  8   -73.83639966961       -8.48       -4.05    3.1    4.05s
  9   -73.83639967015       -9.27       -4.65    4.6    4.96s
 10   -73.83639967018      -10.46       -4.96    4.9    4.98s
 11   -73.83639967019      -11.07       -5.89    4.7    5.03s
 12   -73.83639967019      -13.07       -6.52    4.4    5.25s
 13   -73.83639967019      -13.55       -6.97    4.2    4.69s
 14   -73.83639967019      -13.85       -7.63    4.9    5.07s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.346934424160408e-8,7.201142075202076e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.383640e+01     3.637612e-05
 * time: 425.23996782302856
┌ Warning: Negative ρcore detected: -3.345181828926892e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.82161170806                   -0.92    9.7    8.95s
  2   -73.83028143957       -2.06       -1.12    5.4    5.25s
  3   -73.83551480910       -2.28       -1.49    6.8    6.74s
  4   -73.83625514221       -3.13       -1.83    5.6    5.48s
  5   -73.83637724389       -3.91       -2.22    5.0    5.23s
  6   -73.83639965031       -4.65       -3.10    5.5    5.56s
  7   -73.83639967077       -7.69       -3.50    4.7    5.01s
  8   -73.83639967403       -8.49       -4.06    3.1    4.05s
  9   -73.83639967454       -9.30       -4.65    4.5    5.24s
 10   -73.83639967459      -10.32       -4.98    4.9    4.95s
 11   -73.83639967459      -11.07       -5.91    4.8    5.17s
 12   -73.83639967459      -13.85       -6.51    4.5    5.10s
 13   -73.83639967459   +    -Inf       -6.85    4.5    4.86s
 14   -73.83639967459      -13.25       -7.74    4.4    4.70s
┌ Warning: Negative ρcore detected: -3.345181828926892e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.82161310479                   -0.92    9.6    9.04s
  2   -73.83028512408       -2.06       -1.12    5.3    5.40s
  3   -73.83551349634       -2.28       -1.49    6.8    6.92s
  4   -73.83625546822       -3.13       -1.83    5.6    5.50s
  5   -73.83637736292       -3.91       -2.22    5.0    5.28s
  6   -73.83639965107       -4.65       -3.10    5.5    5.76s
  7   -73.83639967091       -7.70       -3.50    4.8    5.28s
  8   -73.83639967409       -8.50       -4.07    3.0    4.06s
  9   -73.83639967453       -9.35       -4.65    4.4    4.92s
 10   -73.83639967459      -10.26       -4.98    5.0    5.17s
 11   -73.83639967459      -11.07       -5.90    4.9    5.22s
 12   -73.83639967459      -12.85       -6.53    4.7    5.38s
 13   -73.83639967459   +  -13.15       -6.83    4.6    4.84s
 14   -73.83639967459      -13.85       -7.64    4.7    4.84s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.345181828926892e-8,7.285703186397185e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.383640e+01     3.744273e-07
 * time: 637.6222879886627
 * Status: success

 * Candidate solution
    Final objective value:     -7.383640e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.42e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.23e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 4.40e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 5.96e-11 ≰ 0.0e+00
    |g(x)|                 = 3.74e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   638  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

V: 759.754114 seconds (561.48 M allocations: 263.398 GiB, 6.24% gc time, 0.01% compilation time)
