┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-13T22:29:14.790
│   name = "Si"
│   Ecut = 18.0
│   kgrid = MonkhorstPack([14, 14, 14])
│   p0 = ComponentVector{Float64}(a = 10.347246312603742)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.462104927933                   -0.96    6.9    10.2s
  2   -8.463611624368       -2.82       -1.72    1.9    4.84s
  3   -8.463708001427       -4.02       -2.72    3.8    1.58s
  4   -8.463713456294       -5.26       -3.46    4.9    2.01s
  5   -8.463713793918       -6.47       -4.31    4.9    1.67s
  6   -8.463713806246       -7.91       -5.13    5.3    2.02s
  7   -8.463713806386       -9.85       -5.96    4.9    1.97s
  8   -8.463713806387      -12.00       -6.61    3.4    1.34s
  9   -8.463713806387      -13.45       -7.83    4.1    1.68s
Iter     Function value   Gradient norm 
     0    -8.463714e+00     9.383256e-04
 * time: 3.790855407714844e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.462112304173                   -0.96    7.3    2.48s
  2   -8.463614700104       -2.82       -1.73    2.1    1.37s
  3   -8.463709168530       -4.02       -2.72    3.9    1.57s
  4   -8.463714308292       -5.29       -3.47    5.0    2.05s
  5   -8.463714644094       -6.47       -4.30    5.3    1.76s
  6   -8.463714656583       -7.90       -5.19    5.3    2.03s
  7   -8.463714656735       -9.82       -6.18    5.1    1.75s
  8   -8.463714656737      -11.86       -6.91    4.9    1.95s
  9   -8.463714656737      -13.43       -7.52    4.0    1.47s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.462108036334                   -0.96    7.4    2.42s
  2   -8.463617507001       -2.82       -1.73    1.9    1.05s
  3   -8.463709161667       -4.04       -2.72    4.0    1.86s
  4   -8.463714311876       -5.29       -3.46    4.9    1.74s
  5   -8.463714645275       -6.48       -4.33    5.2    1.95s
  6   -8.463714656589       -7.95       -5.18    5.3    1.77s
  7   -8.463714656736       -9.83       -6.17    5.2    1.99s
  8   -8.463714656737      -12.08       -6.94    4.2    1.56s
  9   -8.463714656737      -13.08       -8.08    5.0    1.93s
     1    -8.463715e+00     8.741645e-04
 * time: 46.655165910720825
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.462135383372                   -0.96    7.0    2.40s
  2   -8.463617218938       -2.83       -1.73    1.9    1.03s
  3   -8.463714491195       -4.01       -2.72    3.9    1.79s
  4   -8.463719917427       -5.27       -3.46    4.9    1.77s
  5   -8.463720257956       -6.47       -4.33    5.3    1.99s
  6   -8.463720269946       -7.92       -5.17    5.3    1.77s
  7   -8.463720270087       -9.85       -6.05    4.8    1.90s
  8   -8.463720270088      -12.02       -6.93    3.8    1.43s
  9   -8.463720270088      -13.02       -8.02    5.0    1.88s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.462130169452                   -0.96    7.0    2.31s
  2   -8.463618551184       -2.83       -1.73    1.8    1.26s
  3   -8.463714334687       -4.02       -2.72    3.9    1.48s
  4   -8.463719917326       -5.25       -3.46    4.9    1.96s
  5   -8.463720257828       -6.47       -4.32    5.2    1.68s
  6   -8.463720269939       -7.92       -5.15    5.3    2.05s
  7   -8.463720270087       -9.83       -6.06    4.9    1.66s
  8   -8.463720270088      -11.94       -6.91    3.9    1.76s
  9   -8.463720270088      -12.97       -8.07    5.1    1.68s
     2    -8.463720e+00     5.792884e-06
 * time: 91.45598292350769
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.462128478514                   -0.96    7.0    2.40s
  2   -8.463614805637       -2.83       -1.73    1.8    1.30s
  3   -8.463714390311       -4.00       -2.72    3.9    1.53s
  4   -8.463719916644       -5.26       -3.46    5.1    2.02s
  5   -8.463720257863       -6.47       -4.32    5.1    1.72s
  6   -8.463720270190       -7.91       -5.18    5.2    2.04s
  7   -8.463720270336       -9.84       -6.05    5.0    1.68s
  8   -8.463720270337      -11.99       -6.92    4.0    1.72s
  9   -8.463720270337      -12.99       -8.03    5.2    1.66s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -8.462139984882                   -0.96    6.9    2.33s
  2   -8.463616858204       -2.83       -1.73    1.8    1.02s
  3   -8.463714147594       -4.01       -2.72    3.9    1.74s
  4   -8.463719918281       -5.24       -3.45    5.0    1.74s
  5   -8.463720258558       -6.47       -4.32    5.3    1.92s
  6   -8.463720270168       -7.94       -5.09    5.1    1.76s
  7   -8.463720270335       -9.78       -5.88    4.9    1.90s
  8   -8.463720270337      -11.88       -6.51    3.4    1.38s
  9   -8.463720270337      -13.41       -7.69    3.8    1.61s
     3    -8.463720e+00     3.494014e-08
 * time: 134.87492299079895
 * Status: success

 * Candidate solution
    Final objective value:     -8.463720e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 8.53e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 8.23e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.49e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 2.94e-11 ≰ 0.0e+00
    |g(x)|                 = 3.49e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   135  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Si: 206.104457 seconds (329.85 M allocations: 65.817 GiB, 7.37% gc time, 23.23% compilation time: <1% of which was recompilation)
┌ Info: 2025-05-13T22:32:41.507
│   name = "NaCl"
│   Ecut = 44.0
│   kgrid = MonkhorstPack([13, 13, 13])
│   p0 = ComponentVector{Float64}(a = 10.746130571470083)
│   temperature = 0
└   smearing = DFTK.Smearing.None()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31184923849                   -1.08    8.5    17.6s
  2   -62.31874164418       -2.16       -1.21    2.6    6.84s
  3   -62.32253260156       -2.42       -2.01    3.6    7.95s
  4   -62.32261572795       -4.08       -2.93    2.8    7.08s
  5   -62.32261916052       -5.46       -3.39    4.1    9.74s
  6   -62.32261934199       -6.74       -4.22    3.5    8.49s
  7   -62.32261937872       -7.43       -4.80    3.9    8.69s
  8   -62.32261938019       -8.83       -5.72    3.8    9.16s
  9   -62.32261938020      -11.01       -6.50    3.8    9.05s
 10   -62.32261938020      -12.64       -7.25    4.0    9.36s
Iter     Function value   Gradient norm 
     0    -6.232262e+01     1.109159e-02
 * time: 3.2901763916015625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31192642698                   -1.08    8.3    15.2s
  2   -62.31883652109       -2.16       -1.21    2.6    6.38s
  3   -62.32265386480       -2.42       -2.01    3.7    7.95s
  4   -62.32273730405       -4.08       -2.95    2.8    7.40s
  5   -62.32274086194       -5.45       -3.41    4.1    9.53s
  6   -62.32274100935       -6.83       -4.18    3.4    8.38s
  7   -62.32274104417       -7.46       -4.78    3.7    8.83s
  8   -62.32274104581       -8.79       -5.61    3.7    8.87s
  9   -62.32274104582      -10.89       -6.43    3.6    8.76s
 10   -62.32274104582      -12.36       -7.38    4.0    9.45s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31193043967                   -1.08    8.5    15.3s
  2   -62.31883285141       -2.16       -1.21    2.6    6.23s
  3   -62.32265454122       -2.42       -2.01    3.4    7.79s
  4   -62.32273732099       -4.08       -2.95    2.8    7.14s
  5   -62.32274084563       -5.45       -3.42    4.1    9.37s
  6   -62.32274100869       -6.79       -4.19    3.6    8.56s
  7   -62.32274104434       -7.45       -4.83    3.8    8.80s
  8   -62.32274104581       -8.83       -5.66    3.9    8.97s
  9   -62.32274104582      -10.92       -6.49    3.5    8.60s
 10   -62.32274104582      -12.44       -7.40    4.0    9.57s
     1    -6.232274e+01     1.084716e-02
 * time: 212.05002903938293
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31247440197                   -1.07    8.7    18.2s
  2   -62.32013978012       -2.12       -1.15    2.8    7.36s
  3   -62.32563797665       -2.26       -1.94    3.6    9.31s
  4   -62.32576195791       -3.91       -2.98    2.3    7.06s
  5   -62.32576690526       -5.31       -3.53    4.3    11.3s
  6   -62.32576711468       -6.68       -4.06    3.4    9.43s
  7   -62.32576716568       -7.29       -4.79    3.2    8.93s
  8   -62.32576716911       -8.46       -5.28    4.2    10.8s
  9   -62.32576716921      -10.02       -5.90    3.5    9.60s
 10   -62.32576716921      -11.94       -6.70    3.3    9.21s
 11   -62.32576716921      -12.85       -7.92    3.5    10.0s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31247481785                   -1.07    8.7    18.1s
  2   -62.32016822375       -2.11       -1.15    2.6    6.97s
  3   -62.32563771896       -2.26       -1.94    3.6    9.07s
  4   -62.32576201611       -3.91       -2.96    2.2    6.90s
  5   -62.32576685227       -5.32       -3.50    4.2    10.6s
  6   -62.32576711437       -6.58       -4.11    3.4    9.24s
  7   -62.32576716566       -7.29       -4.78    3.3    8.98s
  8   -62.32576716913       -8.46       -5.34    3.9    10.3s
  9   -62.32576716921      -10.09       -6.00    3.5    9.58s
 10   -62.32576716921      -12.06       -6.60    3.3    9.15s
 11   -62.32576716921      -12.87       -7.43    3.6    9.82s
     2    -6.232577e+01     2.089072e-03
 * time: 466.434858083725
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31192436547                   -1.06    8.5    21.6s
  2   -62.31986452846       -2.10       -1.14    2.4    8.46s
  3   -62.32576971430       -2.23       -1.92    3.2    10.9s
  4   -62.32590839481       -3.86       -2.91    2.3    8.80s
  5   -62.32591344014       -5.30       -3.48    4.0    13.2s
  6   -62.32591388985       -6.35       -4.19    3.2    11.6s
  7   -62.32591394855       -7.23       -4.74    3.5    11.5s
  8   -62.32591395262       -8.39       -5.47    3.5    11.8s
  9   -62.32591395267      -10.27       -6.49    3.4    11.6s
 10   -62.32591395267      -12.16       -6.99    3.8    12.7s
 11   -62.32591395267      -12.43       -7.99    3.7    12.1s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31192557334                   -1.06    8.5    21.7s
  2   -62.31981476772       -2.10       -1.14    2.6    8.69s
  3   -62.32577186486       -2.22       -1.93    3.3    11.3s
  4   -62.32590835849       -3.86       -2.95    2.2    8.67s
  5   -62.32591357746       -5.28       -3.49    4.2    13.8s
  6   -62.32591389323       -6.50       -4.11    3.3    11.7s
  7   -62.32591394873       -7.26       -4.78    3.2    10.7s
  8   -62.32591395256       -8.42       -5.46    3.7    12.4s
  9   -62.32591395267       -9.96       -6.34    3.8    12.7s
 10   -62.32591395267      -12.02       -7.22    3.5    12.3s
     3    -6.232591e+01     5.019887e-04
 * time: 761.0846099853516
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31171132900                   -1.06    8.1    21.6s
  2   -62.31966229696       -2.10       -1.14    2.6    9.40s
  3   -62.32577766603       -2.21       -1.92    3.4    11.5s
  4   -62.32591814018       -3.85       -2.96    2.2    8.91s
  5   -62.32592350376       -5.27       -3.50    4.2    13.9s
  6   -62.32592378398       -6.55       -4.08    3.2    12.1s
  7   -62.32592384157       -7.24       -4.77    3.2    10.7s
  8   -62.32592384601       -8.35       -5.32    3.9    13.5s
  9   -62.32592384611       -9.98       -6.04    3.4    11.8s
 10   -62.32592384611      -11.83       -6.62    3.4    12.3s
 11   -62.32592384611      -12.97       -7.49    3.3    11.9s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31171069458                   -1.06    8.0    21.1s
  2   -62.31971205800       -2.10       -1.14    2.6    8.88s
  3   -62.32577683759       -2.22       -1.92    3.5    11.4s
  4   -62.32591815506       -3.85       -2.93    2.4    9.13s
  5   -62.32592340793       -5.28       -3.48    4.1    13.5s
  6   -62.32592378269       -6.43       -4.13    3.3    11.6s
  7   -62.32592384151       -7.23       -4.74    3.4    11.2s
  8   -62.32592384602       -8.35       -5.39    3.7    12.2s
  9   -62.32592384611      -10.02       -6.27    3.4    11.6s
 10   -62.32592384611      -11.89       -6.46    3.7    12.4s
 11   -62.32592384611      -13.55       -7.39    2.5    9.78s
     4    -6.232592e+01     3.339163e-05
 * time: 1069.423842906952
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31170010420                   -1.06    8.7    21.7s
  2   -62.31968118830       -2.10       -1.14    2.5    8.80s
  3   -62.32577636578       -2.22       -1.92    3.4    10.8s
  4   -62.32591820035       -3.85       -2.94    2.3    8.73s
  5   -62.32592349787       -5.28       -3.49    4.2    13.6s
  6   -62.32592382880       -6.48       -4.12    3.2    11.7s
  7   -62.32592388627       -7.24       -4.74    3.3    10.8s
  8   -62.32592389095       -8.33       -5.38    3.8    12.4s
  9   -62.32592389104      -10.04       -6.28    3.4    11.8s
 10   -62.32592389104      -11.83       -6.90    3.8    12.7s
 11   -62.32592389104   +  -13.37       -7.35    3.5    12.4s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -62.31169774291                   -1.06    8.5    21.9s
  2   -62.31967265180       -2.10       -1.14    2.5    8.94s
  3   -62.32577661851       -2.21       -1.92    3.5    11.4s
  4   -62.32591837500       -3.85       -2.93    2.4    9.03s
  5   -62.32592351854       -5.29       -3.46    4.1    13.9s
  6   -62.32592382723       -6.51       -4.15    3.2    11.7s
  7   -62.32592388601       -7.23       -4.68    3.5    11.5s
  8   -62.32592389097       -8.30       -5.37    3.6    11.8s
  9   -62.32592389104      -10.16       -6.42    3.3    11.7s
 10   -62.32592389104      -11.93       -6.79    4.0    13.4s
 11   -62.32592389104      -13.85       -7.84    3.2    10.9s
     5    -6.232592e+01     5.835711e-07
 * time: 1375.4919879436493
 * Status: success

 * Candidate solution
    Final objective value:     -6.232592e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.65e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.32e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 4.49e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 7.21e-10 ≰ 0.0e+00
    |g(x)|                 = 5.84e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   1375  (vs limit Inf)
    Iterations:    5
    f(x) calls:    6
    ∇f(x) calls:   6

NaCl: 1493.259576 seconds (1.64 G allocations: 443.807 GiB, 4.84% gc time, 0.19% compilation time)
┌ Info: 2025-05-13T22:57:34.792
│   name = "Al"
│   Ecut = 20.0
│   kgrid = MonkhorstPack([18, 18, 18])
│   p0 = ComponentVector{Float64}(a = 7.641925528121933)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317033846011                   -1.46    5.5    1.89s
  2   -2.317108189823       -4.13       -1.84    1.4    734ms
  3   -2.317124627020       -4.78       -3.57    3.2    1.50s
  4   -2.317124846137       -6.66       -4.08    4.5    1.53s
  5   -2.317124846637       -9.30       -4.39    2.5    1.27s
  6   -2.317124846772       -9.87       -5.00    2.7    1.06s
  7   -2.317124846776      -11.44       -5.67    2.4    1.20s
  8   -2.317124846776      -12.68       -6.63    2.6    1.06s
  9   -2.317124846776      -14.15       -7.21    3.2    1.19s
Iter     Function value   Gradient norm 
     0    -2.317125e+00     4.235131e-04
 * time: 2.9802322387695312e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317034590745                   -1.46    5.5    1.64s
  2   -2.317108095876       -4.13       -1.84    1.3    944ms
  3   -2.317124767418       -4.78       -3.56    3.1    1.18s
  4   -2.317125021887       -6.59       -4.08    4.5    1.81s
  5   -2.317125022385       -9.30       -4.39    2.5    989ms
  6   -2.317125022516       -9.88       -5.00    2.7    1.26s
  7   -2.317125022521      -11.37       -5.67    2.3    946ms
  8   -2.317125022521      -12.67       -6.57    2.6    1.25s
  9   -2.317125022521      -14.18       -7.14    3.0    1.13s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317035472236                   -1.46    5.4    1.63s
  2   -2.317108003437       -4.14       -1.84    1.3    950ms
  3   -2.317124808231       -4.77       -3.55    3.2    1.18s
  4   -2.317125021868       -6.67       -4.07    4.6    1.83s
  5   -2.317125022380       -9.29       -4.39    2.4    973ms
  6   -2.317125022516       -9.87       -4.99    2.6    1.26s
  7   -2.317125022521      -11.36       -5.66    2.4    956ms
  8   -2.317125022521      -12.62       -6.62    2.5    1.03s
  9   -2.317125022521      -14.18       -7.20    3.3    1.39s
     1    -2.317125e+00     4.064228e-04
 * time: 54.88816595077515
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317037480344                   -1.46    5.4    1.95s
  2   -2.317111408895       -4.13       -1.84    1.3    730ms
  3   -2.317126866580       -4.81       -3.59    3.3    1.50s
  4   -2.317127079560       -6.67       -4.08    4.5    1.84s
  5   -2.317127080057       -9.30       -4.39    2.5    1.03s
  6   -2.317127080194       -9.86       -4.98    2.7    1.06s
  7   -2.317127080199      -11.34       -5.60    2.5    1.26s
  8   -2.317127080199      -12.54       -6.46    2.6    1.06s
  9   -2.317127080199      -13.97       -6.95    2.9    1.36s
 10   -2.317127080199   +    -Inf       -7.44    2.1    944ms
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317039116168                   -1.46    5.6    1.71s
  2   -2.317110882590       -4.14       -1.83    1.3    964ms
  3   -2.317126786601       -4.80       -3.56    3.2    1.21s
  4   -2.317127079494       -6.53       -4.05    4.7    1.84s
  5   -2.317127080045       -9.26       -4.37    2.3    962ms
  6   -2.317127080194       -9.83       -4.97    2.8    1.31s
  7   -2.317127080199      -11.34       -5.58    2.5    988ms
  8   -2.317127080199      -12.50       -6.52    2.5    1.28s
  9   -2.317127080199      -14.01       -6.96    3.1    1.13s
 10   -2.317127080199      -15.35       -7.36    1.9    856ms
     2    -2.317127e+00     2.947116e-06
 * time: 112.26825380325317
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317038118550                   -1.46    5.5    1.96s
  2   -2.317110836784       -4.14       -1.83    1.3    745ms
  3   -2.317126844487       -4.80       -3.57    3.2    1.50s
  4   -2.317127079634       -6.63       -4.07    4.6    1.60s
┌ Warning: Eigensolver not converged
│   n_iter =
│    195-element Vector{Int64}:
│     2
│     2
│     4
│     3
│     ⋮
│     2
│     4
│     3
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/scf/self_consistent_field.jl:76
  5   -2.317127080160       -9.28       -4.38    2.5    1.33s
  6   -2.317127080303       -9.84       -4.98    2.8    1.09s
  7   -2.317127080308      -11.36       -5.59    2.4    1.24s
  8   -2.317127080308      -12.52       -6.51    2.6    1.06s
  9   -2.317127080308      -13.99       -7.08    3.0    1.15s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -2.317038547239                   -1.46    5.6    1.98s
  2   -2.317110618869       -4.14       -1.83    1.3    727ms
  3   -2.317126888312       -4.79       -3.57    3.2    1.45s
  4   -2.317127079633       -6.72       -4.07    4.6    1.57s
  5   -2.317127080164       -9.27       -4.39    2.5    1.23s
  6   -2.317127080303       -9.86       -4.98    2.6    1.01s
  7   -2.317127080308      -11.33       -5.59    2.6    1.27s
  8   -2.317127080308      -12.51       -6.49    2.5    998ms
  9   -2.317127080308      -14.01       -6.93    3.0    1.39s
 10   -2.317127080308      -14.88       -7.42    2.0    876ms
     3    -2.317127e+00     1.312806e-08
 * time: 168.77279591560364
 * Status: success

 * Candidate solution
    Final objective value:     -2.317127e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 7.36e-05 ≰ -1.0e+00
    |x - x'|/|x'|          = 9.64e-06 ≰ 0.0e+00
    |f(x) - f(x')|         = 1.09e-10 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 4.71e-11 ≰ 0.0e+00
    |g(x)|                 = 1.31e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   169  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

Al: 199.341330 seconds (162.53 M allocations: 38.612 GiB, 5.79% gc time, 0.04% compilation time)
┌ Info: 2025-05-13T23:00:54.134
│   name = "V"
│   Ecut = 42.0
│   kgrid = MonkhorstPack([20, 20, 20])
│   p0 = ComponentVector{Float64}(a = 5.699267600684394)
│   temperature = 0.001
└   smearing = DFTK.Smearing.Gaussian()
┌ Warning: Negative ρcore detected: -3.4151886922104144e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80792161497                   -0.92    9.6    8.69s
  2   -73.81649543844       -2.07       -1.12    5.4    5.21s
  3   -73.82176537167       -2.28       -1.49    6.8    6.57s
  4   -73.82249029163       -3.14       -1.82    5.5    5.30s
  5   -73.82261556943       -3.90       -2.22    5.0    5.17s
  6   -73.82263813222       -4.65       -3.08    5.5    5.79s
  7   -73.82263815540       -7.63       -3.47    4.9    5.09s
  8   -73.82263816042       -8.30       -4.05    4.1    4.55s
  9   -73.82263816081       -9.41       -4.54    4.8    5.21s
 10   -73.82263816080   +  -11.66       -4.91    3.5    4.07s
 11   -73.82263816081      -10.96       -5.59    4.5    4.73s
 12   -73.82263816082      -11.63       -6.43    4.8    5.18s
 13   -73.82263816082      -12.94       -6.89    5.4    5.60s
 14   -73.82263816082      -13.25       -7.11    5.4    5.39s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.4151886922104144e-8,-1.2413273474001241e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
Iter     Function value   Gradient norm 
     0    -7.382264e+01     3.863477e-03
 * time: 3.695487976074219e-5
┌ Warning: Negative ρcore detected: -3.416892642661719e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80785443352                   -0.92    9.6    8.91s
  2   -73.81651098995       -2.06       -1.12    5.1    5.08s
  3   -73.82177474887       -2.28       -1.49    6.7    6.60s
  4   -73.82250517681       -3.14       -1.82    5.4    5.29s
  5   -73.82262981726       -3.90       -2.22    5.1    5.30s
  6   -73.82265192227       -4.66       -3.09    5.5    5.57s
  7   -73.82265194431       -7.66       -3.48    4.8    5.09s
  8   -73.82265194850       -8.38       -4.05    3.5    4.13s
  9   -73.82265194896       -9.34       -4.60    4.7    5.04s
 10   -73.82265194897      -11.25       -4.94    3.6    4.05s
 11   -73.82265194898      -10.94       -5.71    4.8    4.85s
 12   -73.82265194898      -12.03       -6.52    4.9    5.11s
 13   -73.82265194898   +  -13.55       -6.95    5.4    5.49s
 14   -73.82265194898      -13.25       -7.18    5.2    5.12s
┌ Warning: Negative ρcore detected: -3.416892642661719e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80785972068                   -0.92    9.5    8.92s
  2   -73.81651191247       -2.06       -1.12    5.2    5.04s
  3   -73.82177610747       -2.28       -1.49    6.8    6.65s
  4   -73.82250417317       -3.14       -1.82    5.5    5.30s
  5   -73.82263007255       -3.90       -2.23    5.0    5.13s
  6   -73.82265192259       -4.66       -3.09    5.5    5.65s
  7   -73.82265194432       -7.66       -3.49    4.8    5.05s
  8   -73.82265194853       -8.38       -4.04    3.6    4.22s
  9   -73.82265194896       -9.36       -4.59    4.7    5.01s
 10   -73.82265194897      -11.39       -4.94    3.4    3.96s
 11   -73.82265194898      -10.97       -5.70    4.6    4.86s
 12   -73.82265194898      -11.98       -6.54    4.8    5.08s
 13   -73.82265194898      -13.07       -6.93    5.4    5.54s
 14   -73.82265194898   +  -13.37       -7.20    5.2    5.30s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.416892642661719e-8,3.5152615059995867e-9)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     1    -7.382265e+01     3.274450e-03
 * time: 216.65922594070435
┌ Warning: Negative ρcore detected: -3.320777685912336e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80752453361                   -0.92    9.6    8.89s
  2   -73.81651682733       -2.05       -1.12    5.2    5.12s
  3   -73.82178685675       -2.28       -1.49    6.9    6.73s
  4   -73.82254831371       -3.12       -1.83    5.6    5.44s
  5   -73.82266594699       -3.93       -2.23    5.0    5.19s
  6   -73.82268741778       -4.67       -3.11    5.5    5.62s
  7   -73.82268743656       -7.73       -3.50    4.8    5.25s
  8   -73.82268743932       -8.56       -4.13    3.6    4.14s
  9   -73.82268743973       -9.38       -4.61    4.2    4.59s
 10   -73.82268743986       -9.89       -5.13    5.1    5.06s
 11   -73.82268743987      -11.35       -6.02    5.1    5.16s
 12   -73.82268743987   +  -12.02       -6.45    5.7    5.80s
 13   -73.82268743987   +  -12.62       -7.02    4.4    4.35s
┌ Warning: Negative ρcore detected: -3.320777685912336e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80751768821                   -0.92    9.6    8.74s
  2   -73.81653250313       -2.05       -1.12    5.2    5.00s
  3   -73.82178534803       -2.28       -1.49    6.8    6.53s
  4   -73.82254868535       -3.12       -1.83    5.5    5.20s
  5   -73.82266542479       -3.93       -2.23    5.0    5.02s
  6   -73.82268741742       -4.66       -3.11    5.6    5.50s
  7   -73.82268743673       -7.71       -3.52    4.7    4.85s
  8   -73.82268743920       -8.61       -4.14    4.0    4.58s
  9   -73.82268743970       -9.30       -4.61    4.3    4.65s
 10   -73.82268743986       -9.80       -5.07    5.1    5.06s
 11   -73.82268743987      -11.19       -6.03    5.1    5.07s
 12   -73.82268743987   +  -12.08       -6.43    5.9    5.94s
 13   -73.82268743987   +  -12.47       -6.87    4.2    4.38s
 14   -73.82268743987      -13.00       -7.37    3.5    3.91s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.320777685912336e-8,8.359360018883639e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     2    -7.382269e+01     4.268087e-05
 * time: 428.53223609924316
┌ Warning: Negative ρcore detected: -3.31839297108338e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80751396230                   -0.92    9.9    8.90s
  2   -73.81653484256       -2.04       -1.12    5.5    5.29s
  3   -73.82178247972       -2.28       -1.49    7.0    6.71s
  4   -73.82254912425       -3.12       -1.83    5.7    5.37s
  5   -73.82266627543       -3.93       -2.24    5.1    5.37s
  6   -73.82268742381       -4.67       -3.12    5.7    5.62s
  7   -73.82268744265       -7.72       -3.52    4.9    5.13s
  8   -73.82268744506       -8.62       -4.14    4.3    4.64s
  9   -73.82268744555       -9.31       -4.64    4.3    4.76s
 10   -73.82268744572       -9.77       -5.08    5.2    5.17s
 11   -73.82268744572      -11.31       -6.02    5.1    5.08s
 12   -73.82268744572   +  -12.03       -6.44    6.0    5.80s
 13   -73.82268744572   +  -12.37       -6.85    4.6    4.55s
 14   -73.82268744572      -12.85       -7.36    4.3    4.37s
┌ Warning: Negative ρcore detected: -3.31839297108338e-8
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -73.80750978364                   -0.92    9.8    8.92s
  2   -73.81653703518       -2.04       -1.12    5.4    5.19s
  3   -73.82178145852       -2.28       -1.48    7.1    6.70s
  4   -73.82254930145       -3.11       -1.83    5.7    5.38s
  5   -73.82266658327       -3.93       -2.24    5.1    5.14s
  6   -73.82268742362       -4.68       -3.12    5.6    5.81s
  7   -73.82268744261       -7.72       -3.51    4.7    4.97s
  8   -73.82268744512       -8.60       -4.13    3.9    4.36s
  9   -73.82268744557       -9.35       -4.64    4.2    4.68s
 10   -73.82268744572       -9.83       -5.10    5.2    5.17s
 11   -73.82268744572      -11.47       -6.00    5.1    5.22s
 12   -73.82268744572   +  -12.04       -6.42    5.9    5.80s
 13   -73.82268744572   +  -12.59       -6.91    3.4    3.88s
 14   -73.82268744572      -13.00       -7.31    3.6    4.02s
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.31839297108338e-8,8.45550739665432e-8)
└ @ DFTK ~/.julia/packages/DFTK/n2IL4/src/terms/xc.jl:39
     3    -7.382269e+01     4.767367e-07
 * time: 646.6966309547424
 * Status: success

 * Candidate solution
    Final objective value:     -7.382269e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 2.84e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 4.95e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 5.85e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 7.93e-11 ≰ 0.0e+00
    |g(x)|                 = 4.77e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   647  (vs limit Inf)
    Iterations:    3
    f(x) calls:    4
    ∇f(x) calls:   4

V: 763.238892 seconds (557.27 M allocations: 262.996 GiB, 5.69% gc time, 0.01% compilation time)
