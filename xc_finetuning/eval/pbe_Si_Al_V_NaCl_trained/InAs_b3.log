n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -172.4324032055                   -1.02    8.6    71.5s
  2   -172.4443383953       -1.92       -1.52    5.1    40.4s
  3   -172.4456204784       -2.89       -2.03    5.9    40.8s
  4   -172.4457145244       -4.03       -2.74    5.4    39.2s
  5   -172.4457151491       -6.20       -3.60    5.1    38.1s
  6   -172.4457152274       -7.11       -4.08    5.7    39.2s
  7   -172.4457152399       -7.91       -4.64    5.9    39.7s
  8   -172.4457152409       -8.96       -5.36    5.8    40.8s
  9   -172.4457152410      -10.53       -6.59    5.9    41.3s
 10   -172.4457152410      -12.77       -7.35    6.7    43.2s
Iter     Function value   Gradient norm 
     0    -1.724457e+02     4.933403e-03
 * time: 9.059906005859375e-6
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -172.4324270098                   -1.02    8.8    63.2s
  2   -172.4443549831       -1.92       -1.52    5.1    36.4s
  3   -172.4456432389       -2.89       -2.03    6.2    43.0s
  4   -172.4457383669       -4.02       -2.74    5.5    42.0s
  5   -172.4457389744       -6.22       -3.59    5.2    40.4s
  6   -172.4457390560       -7.09       -4.08    6.0    41.2s
  7   -172.4457390684       -7.91       -4.64    6.0    41.2s
  8   -172.4457390695       -8.96       -5.37    5.8    41.6s
  9   -172.4457390695      -10.53       -6.62    6.2    42.3s
 10   -172.4457390695   +  -13.25       -7.35    6.9    45.2s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -172.4324288169                   -1.02    8.8    62.6s
  2   -172.4443548145       -1.92       -1.52    5.2    37.4s
  3   -172.4456432294       -2.89       -2.03    6.1    42.5s
  4   -172.4457383656       -4.02       -2.74    5.5    41.9s
  5   -172.4457389749       -6.22       -3.59    5.2    40.0s
  6   -172.4457390560       -7.09       -4.08    5.7    41.7s
  7   -172.4457390684       -7.90       -4.64    5.8    40.5s
  8   -172.4457390695       -8.96       -5.37    5.9    41.1s
  9   -172.4457390695      -10.54       -6.61    6.1    42.3s
 10   -172.4457390695   +  -13.07       -7.35    6.8    44.6s
     1    -1.724457e+02     4.726526e-03
 * time: 941.8027031421661
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -172.4326605118                   -1.01    8.9    49.9s
  2   -172.4445004505       -1.93       -1.51    5.2    28.9s
  3   -172.4458881498       -2.86       -2.02    6.4    33.2s
  4   -172.4459935724       -3.98       -2.75    5.4    31.4s
  5   -172.4459943083       -6.13       -3.61    5.2    31.0s
  6   -172.4459943831       -7.13       -4.12    6.1    32.1s
  7   -172.4459943931       -8.00       -4.71    6.1    32.3s
  8   -172.4459943938       -9.14       -5.44    6.1    32.4s
  9   -172.4459943939      -10.68       -6.62    6.3    32.3s
 10   -172.4459943939   +  -13.07       -7.42    6.9    34.5s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -172.4326605374                   -1.01    8.9    49.5s
  2   -172.4445013708       -1.93       -1.51    5.3    28.7s
  3   -172.4458883668       -2.86       -2.02    6.5    33.6s
  4   -172.4459935657       -3.98       -2.75    5.5    32.2s
  5   -172.4459943089       -6.13       -3.61    5.2    31.2s
  6   -172.4459943831       -7.13       -4.12    6.1    32.6s
  7   -172.4459943931       -8.00       -4.71    6.0    31.6s
  8   -172.4459943938       -9.14       -5.44    5.9    31.4s
  9   -172.4459943939      -10.70       -6.60    6.1    32.0s
 10   -172.4459943939      -12.64       -7.42    7.0    33.7s
     2    -1.724460e+02     2.903458e-04
 * time: 1672.2411360740662
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -172.4326606535                   -1.01    8.9    46.7s
  2   -172.4445077061       -1.93       -1.51    5.5    27.4s
  3   -172.4458896170       -2.86       -2.02    6.3    31.1s
  4   -172.4459944842       -3.98       -2.75    5.5    29.8s
  5   -172.4459952016       -6.14       -3.61    5.3    29.1s
  6   -172.4459952779       -7.12       -4.11    6.0    29.6s
  7   -172.4459952881       -7.99       -4.71    5.9    28.8s
  8   -172.4459952889       -9.13       -5.43    6.1    29.2s
  9   -172.4459952889      -10.66       -6.61    6.0    29.4s
 10   -172.4459952889      -12.55       -7.41    6.9    31.0s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -172.4326608706                   -1.01    8.9    44.3s
  2   -172.4445062268       -1.93       -1.51    5.4    26.2s
  3   -172.4458892665       -2.86       -2.02    6.3    29.9s
  4   -172.4459944887       -3.98       -2.75    5.5    28.7s
  5   -172.4459952013       -6.15       -3.60    5.4    28.4s
  6   -172.4459952780       -7.12       -4.12    6.1    29.1s
  7   -172.4459952881       -7.99       -4.71    5.9    28.4s
  8   -172.4459952889       -9.12       -5.43    6.0    28.9s
  9   -172.4459952889      -10.67       -6.62    6.2    28.9s
 10   -172.4459952889      -12.70       -7.41    6.9    30.9s
     3    -1.724460e+02     1.559763e-05
 * time: 2351.746152162552
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -172.4326632908                   -1.01    9.2    44.9s
  2   -172.4445075237       -1.93       -1.51    5.5    25.7s
  3   -172.4458895994       -2.86       -2.02    6.4    29.4s
  4   -172.4459944823       -3.98       -2.75    5.6    28.6s
  5   -172.4459952052       -6.14       -3.61    5.4    27.5s
  6   -172.4459952806       -7.12       -4.12    6.1    28.4s
  7   -172.4459952907       -8.00       -4.71    6.1    28.2s
  8   -172.4459952915       -9.12       -5.43    6.2    28.7s
  9   -172.4459952915      -10.67       -6.61    6.2    28.9s
 10   -172.4459952915   +  -13.55       -7.41    7.0    30.8s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -172.4326643294                   -1.01    9.2    44.6s
  2   -172.4445085152       -1.93       -1.51    5.5    26.3s
  3   -172.4458897222       -2.86       -2.02    6.3    29.9s
  4   -172.4459944782       -3.98       -2.75    5.7    29.0s
  5   -172.4459952055       -6.14       -3.61    5.4    28.4s
  6   -172.4459952806       -7.12       -4.12    6.2    28.8s
  7   -172.4459952907       -8.00       -4.71    5.9    28.1s
  8   -172.4459952915       -9.12       -5.43    6.2    28.8s
  9   -172.4459952915      -10.68       -6.60    6.3    29.3s
 10   -172.4459952915   +  -12.85       -7.41    7.0    30.7s
     4    -1.724460e+02     4.983717e-08
 * time: 3011.445949077606
 * Status: success

 * Candidate solution
    Final objective value:     -1.724460e+02

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 3.33e-04 ≰ -1.0e+00
    |x - x'|/|x'|          = 2.87e-05 ≰ 0.0e+00
    |f(x) - f(x')|         = 2.60e-09 ≤ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 1.51e-11 ≰ 0.0e+00
    |g(x)|                 = 4.98e-08 ≤ 1.0e-06

 * Work counters
    Seconds run:   3011  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

InAs_b3: 3543.965553 seconds (1.62 G allocations: 907.526 GiB, 2.53% gc time, 1.59% compilation time: <1% of which was recompilation)
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -172.4403006056                   -1.03    3.8    20.3s
  2   -172.4531376005       -1.89       -1.59    1.9    11.5s
  3   -172.4544406562       -2.89       -2.04    2.0    14.5s
  4   -172.4544593608       -4.73       -2.84    1.1    10.1s
  5   -172.4544622046       -5.55       -3.32    2.9    16.1s
  6   -172.4544623255       -6.92       -4.05    2.1    13.0s
  7   -172.4544623331       -8.12       -4.43    2.9    15.1s
  8   -172.4544623340       -9.06       -5.10    2.2    13.4s
  9   -172.4544623341       -9.93       -6.00    2.9    14.7s
 10   -172.4544623341      -11.39       -6.31    3.5    16.6s
 11   -172.4544623341      -12.77       -6.80    2.0    13.9s
 12   -172.4544623341   +  -12.94       -7.43    1.5    10.6s
 13   -172.4544623341      -12.94       -7.90    2.4    14.8s
 14   -172.4544623341      -12.77       -8.24    1.7    10.8s
┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-23T00:46:29.533
│   name = "InAs_b3"
│   Ecut = 42.0
└   kgrid = MonkhorstPack([12, 12, 12])
┌ Warning: Negative ρcore detected: -2.00417637310482e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-2.00417637310482e-8,1.3146342122136558e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -2.0039141619406786e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -2.0039141619406786e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-2.0039141619406786e-8,-1.4283994300339793e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -2.1144547426985305e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -2.1144547426985305e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-2.1144547426985305e-8,-8.00699540052556e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -2.1628555836376755e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -2.1628555836376755e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-2.1628555836376755e-8,-6.839149666187712e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -2.160571453182859e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -2.160571453182859e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-2.160571453182859e-8,-6.897756821680815e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -2.160571453182859e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
