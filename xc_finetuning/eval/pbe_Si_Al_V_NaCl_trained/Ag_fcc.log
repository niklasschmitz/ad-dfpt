n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -154.9740172856                   -0.92    7.6    27.5s
  2   -154.9922994204       -1.74       -1.45    4.5    15.1s
  3   -154.9931436297       -3.07       -2.34    4.8    12.0s
  4   -154.9931495574       -5.23       -3.07    4.8    12.0s
  5   -154.9931498194       -6.58       -3.91    4.7    11.7s
  6   -154.9931498362       -7.77       -4.49    4.5    12.0s
  7   -154.9931498373       -8.94       -5.30    4.6    11.4s
  8   -154.9931498374      -10.68       -6.08    4.7    12.0s
  9   -154.9931498374      -12.43       -6.77    4.4    11.0s
 10   -154.9931498374      -12.94       -7.76    4.4    11.4s
Iter     Function value   Gradient norm 
     0    -1.549931e+02     6.688795e-03
 * time: 1.0013580322265625e-5
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -154.9740312202                   -0.92    7.4    17.4s
  2   -154.9923458804       -1.74       -1.45    4.4    10.9s
  3   -154.9931873513       -3.07       -2.34    4.8    12.2s
  4   -154.9931931461       -5.24       -3.07    4.8    11.9s
  5   -154.9931933969       -6.60       -3.88    4.7    11.7s
  6   -154.9931934151       -7.74       -4.48    4.4    12.0s
  7   -154.9931934163       -8.92       -5.27    4.6    11.4s
  8   -154.9931934163      -10.63       -6.04    4.6    11.7s
  9   -154.9931934163      -12.25       -6.84    4.3    11.5s
 10   -154.9931934163   +    -Inf       -7.72    4.5    11.6s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -154.9740324303                   -0.92    7.5    17.0s
  2   -154.9923482160       -1.74       -1.45    4.4    10.9s
  3   -154.9931874078       -3.08       -2.34    4.8    12.2s
  4   -154.9931931615       -5.24       -3.08    4.7    11.7s
  5   -154.9931934024       -6.62       -3.97    4.7    11.6s
  6   -154.9931934154       -7.88       -4.54    4.6    12.1s
  7   -154.9931934163       -9.05       -5.38    4.7    11.5s
  8   -154.9931934163      -10.82       -6.17    4.7    12.2s
  9   -154.9931934163      -12.77       -6.75    4.3    11.2s
 10   -154.9931934163      -13.07       -7.90    4.5    11.5s
     1    -1.549932e+02     6.340887e-03
 * time: 287.91098403930664
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -154.9740569607                   -0.91    7.5    16.9s
  2   -154.9927460253       -1.73       -1.46    4.4    10.6s
  3   -154.9935390390       -3.10       -2.34    4.7    12.0s
  4   -154.9935445733       -5.26       -3.14    4.7    11.5s
  5   -154.9935447276       -6.81       -4.21    4.5    11.1s
  6   -154.9935447312       -8.45       -4.73    4.8    12.5s
  7   -154.9935447315       -9.46       -5.83    4.7    11.3s
  8   -154.9935447315      -12.01       -6.67    4.8    12.1s
  9   -154.9935447315      -12.77       -7.33    4.5    11.6s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -154.9740572421                   -0.91    7.5    16.7s
  2   -154.9927460527       -1.73       -1.46    4.3    10.4s
  3   -154.9935390195       -3.10       -2.34    4.8    12.0s
  4   -154.9935445702       -5.26       -3.13    4.7    11.4s
  5   -154.9935447276       -6.80       -4.21    4.5    11.1s
  6   -154.9935447312       -8.45       -4.74    4.7    12.4s
  7   -154.9935447315       -9.47       -5.82    4.6    11.2s
  8   -154.9935447315      -12.01       -6.65    4.9    12.0s
  9   -154.9935447315      -12.94       -7.33    4.7    11.8s
     2    -1.549935e+02     8.468951e-04
 * time: 547.1043889522552
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -154.9740930991                   -0.91    7.6    17.4s
  2   -154.9927487086       -1.73       -1.46    4.4    10.8s
  3   -154.9935446358       -3.10       -2.34    4.8    11.8s
  4   -154.9935500116       -5.27       -3.13    4.7    11.9s
  5   -154.9935501723       -6.79       -4.19    4.6    11.4s
  6   -154.9935501764       -8.38       -4.73    4.8    12.4s
  7   -154.9935501768       -9.46       -5.75    4.7    11.4s
  8   -154.9935501768      -11.69       -6.60    4.9    12.0s
  9   -154.9935501768   +  -13.07       -7.32    4.7    12.1s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -154.9740921974                   -0.91    7.6    17.0s
  2   -154.9927467336       -1.73       -1.46    4.4    10.8s
  3   -154.9935445112       -3.10       -2.34    4.8    12.3s
  4   -154.9935500008       -5.26       -3.13    4.7    11.6s
  5   -154.9935501699       -6.77       -4.11    4.6    11.3s
  6   -154.9935501763       -8.20       -4.66    4.6    12.2s
  7   -154.9935501768       -9.29       -5.64    4.6    11.3s
  8   -154.9935501768      -11.45       -6.41    4.8    12.1s
  9   -154.9935501768   +  -13.55       -6.91    4.2    11.4s
 10   -154.9935501768   +    -Inf       -8.25    4.3    10.9s
     3    -1.549936e+02     8.490461e-05
 * time: 820.3367409706116
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -154.9740871792                   -0.91    7.6    17.0s
  2   -154.9927481682       -1.73       -1.46    4.3    10.7s
  3   -154.9935446793       -3.10       -2.34    4.8    12.3s
  4   -154.9935500637       -5.27       -3.13    4.8    11.8s
  5   -154.9935502274       -6.79       -4.15    4.7    11.5s
  6   -154.9935502326       -8.29       -4.70    4.7    12.3s
  7   -154.9935502330       -9.38       -5.68    4.7    11.1s
  8   -154.9935502330      -11.53       -6.44    4.7    11.8s
  9   -154.9935502330   +    -Inf       -7.29    4.5    11.9s
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -154.9740886263                   -0.91    7.6    17.1s
  2   -154.9927480256       -1.73       -1.46    4.3    10.5s
  3   -154.9935446072       -3.10       -2.34    4.8    12.2s
  4   -154.9935500582       -5.26       -3.13    4.7    11.7s
  5   -154.9935502256       -6.78       -4.09    4.6    11.6s
  6   -154.9935502324       -8.17       -4.64    4.6    12.1s
  7   -154.9935502330       -9.26       -5.62    4.6    11.0s
  8   -154.9935502330      -11.40       -6.41    4.6    12.0s
  9   -154.9935502330      -13.25       -6.91    4.2    10.9s
 10   -154.9935502330   +    -Inf       -8.21    4.3    10.9s
     4    -1.549936e+02     9.601731e-07
 * time: 1093.007493019104
 * Status: success

 * Candidate solution
    Final objective value:     -1.549936e+02

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x'|               = 1.31e-03 ≰ -1.0e+00
    |x - x'|/|x'|          = 1.69e-04 ≰ 0.0e+00
    |f(x) - f(x')|         = 5.62e-08 ≰ 1.0e-08
    |f(x) - f(x')|/|f(x')| = 3.63e-10 ≰ 0.0e+00
    |g(x)|                 = 9.60e-07 ≤ 1.0e-06

 * Work counters
    Seconds run:   1093  (vs limit Inf)
    Iterations:    4
    f(x) calls:    5
    ∇f(x) calls:   5

Ag_fcc: 1303.182199 seconds (640.66 M allocations: 302.898 GiB, 4.29% gc time, 4.52% compilation time: <1% of which was recompilation)
n     Energy            log10(ΔE)   log10(Δρ)   Diag   Δtime
---   ---------------   ---------   ---------   ----   ------
  1   -154.9774065915                   -0.91    3.4    9.73s
  2   -154.9962940927       -1.72       -1.52    1.9    6.70s
  3   -154.9969376637       -3.19       -2.12    1.8    6.53s
  4   -154.9969516630       -4.85       -2.48    2.0    7.34s
  5   -154.9969583784       -5.17       -3.07    1.1    5.86s
  6   -154.9969590546       -6.17       -3.35    2.2    7.28s
  7   -154.9969591988       -6.84       -3.76    1.0    5.68s
  8   -154.9969592338       -7.46       -5.02    2.0    7.04s
  9   -154.9969592340       -9.72       -5.31    3.2    8.67s
 10   -154.9969592340      -10.99       -5.61    1.3    6.04s
 11   -154.9969592340      -11.59       -5.73    1.3    5.73s
 12   -154.9969592340      -11.49       -6.81    1.9    7.10s
 13   -154.9969592340   +    -Inf       -6.91    2.7    8.26s
 14   -154.9969592340      -13.25       -7.00    1.0    5.69s
 15   -154.9969592340   +  -13.55       -7.73    1.1    5.42s
 16   -154.9969592340      -13.25       -8.59    1.8    6.22s
┌ Info: Threading setup: 
│   Threads.nthreads() = 1
│   n_DFTK = 1
│   n_fft = 1
└   n_blas = 1
┌ Info: 2025-05-23T00:57:08.573
│   name = "Ag_fcc"
│   Ecut = 41.0
└   kgrid = MonkhorstPack([18, 18, 18])
┌ Warning: Negative ρcore detected: -3.964392946301127e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.964392946301127e-8,3.4964023825303666e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.980630626644967e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.980630626644967e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.980630626644967e-8,1.3420496112297434e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -4.0934976883054626e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -4.0934976883054626e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-4.0934976883054626e-8,4.4943853813710166e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.996214832474705e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -3.996214832474705e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-3.996214832474705e-8,8.966613467111598e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -4.007697957975603e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -4.007697957975603e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: Dual{ForwardDiff.Tag{var"#19#21"{@NamedTuple{ham::Hamiltonian, basis::PlaneWaveBasis{Float64, Float64, DFTK.CPU, FFTGrid{Float64, Float64, Array{StaticArraysCore.SVector{3, Int64}, 3}, Array{StaticArraysCore.SVector{3, Float64}, 3}}, Vector{StaticArraysCore.SVector{3, Int64}}}, energies::Energies{Float64}, converged::Bool, occupation_threshold::Float64, ρ::Array{Float64, 4}, τ::Nothing, α::Float64, eigenvalues::Vector{Vector{Float64}}, occupation::Vector{Vector{Float64}}, εF::Float64, n_bands_converge::Int64, n_iter::Int64, n_matvec::Int64, ψ::Vector{Matrix{ComplexF64}}, diagonalization::Vector{@NamedTuple{λ::Vector{Vector{Float64}}, X::Vector{Matrix{ComplexF64}}, residual_norms::Vector{Vector{Float64}}, n_iter::Vector{Int64}, converged::Bool, n_matvec::Int64}}, stage::Symbol, history_Δρ::Vector{Float64}, history_Etot::Vector{Float64}, timedout::Bool, runtime_ns::UInt64, algorithm::String}, Model{Float64, Float64}, Float64, MonkhorstPack, var"#case#4"{Matrix{Float64}, Float64, MonkhorstPack, Vector{StaticArraysCore.SVector{3, Float64}}, Vector{ElementPsp{PspUpf{Float64, Interpolations.Extrapolation{Float64, 1, Interpolations.GriddedInterpolation{Float64, 1, Vector{Float64}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Tuple{Vector{Float64}}}, Interpolations.Gridded{Interpolations.Linear{Interpolations.Throw{Interpolations.OnGrid}}}, Interpolations.Throw{Nothing}}}}}, Float64, Float64, String}}, Float64}}(-4.007697957975603e-8,8.580074665642627e-8)
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
┌ Warning: Negative ρcore detected: -4.007697957975603e-8
└ @ DFTK ~/.julia/packages/DFTK/NCxPt/src/terms/xc.jl:39
